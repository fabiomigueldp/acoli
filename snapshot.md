# acoli

## Structure

```
acoli/
├── accounts/
│   ├── migrations/
│   │   ├── 0001_initial.py
│   │   └── __init__.py [empty]
│   ├── __init__.py [empty]
│   ├── admin.py
│   ├── apps.py
│   ├── forms.py
│   ├── models.py
│   ├── tests.py
│   ├── urls.py
│   └── views.py
├── acoli/
│   ├── __init__.py [empty]
│   ├── asgi.py
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
├── api/
│   ├── migrations/
│   │   └── __init__.py [empty]
│   ├── __init__.py [empty]
│   ├── apps.py
│   ├── serializers.py
│   ├── urls.py
│   └── views.py
├── core/
│   ├── management/
│   │   ├── commands/
│   │   │   ├── __init__.py
│   │   │   ├── archive_event_series.py
│   │   │   ├── generate_mass_instances.py
│   │   │   ├── lock_consolidation_window.py
│   │   │   ├── populate_eventseries_ruleset.py
│   │   │   ├── process_position_claims.py
│   │   │   ├── recompute_acolyte_stats.py
│   │   │   └── sync_slots.py
│   │   └── __init__.py
│   ├── migrations/
│   │   ├── 0001_initial.py
│   │   ├── 0002_eventseries_candidate_pool_and_more.py
│   │   ├── 0003_alter_massinstance_unique_together_and_more.py
│   │   ├── 0004_assignment_end_reason_assignment_ended_at_and_more.py
│   │   ├── 0005_replacementrequest_resolved_at_and_more.py
│   │   ├── 0006_assignmentslot_external_coverage_notes_and_more.py
│   │   ├── 0007_acolyteprofile_experience_level_and_more.py
│   │   ├── 0008_eventseries_is_active.py
│   │   ├── 0009_add_moved_to_another_slot_end_reason.py
│   │   ├── 0010_acolyte_scheduling_mode.py
│   │   ├── 0011_add_manual_adjustment_reason.py
│   │   ├── 0012_add_swap_group_id.py
│   │   ├── 0013_mass_interest.py
│   │   ├── 0014_position_claim_request.py
│   │   ├── 0015_rename_core_positi_slot_id_6a0f4c_idx_core_positi_slot_id_5cc0fb_idx_and_more.py
│   │   ├── 0016_eventseries_interest_deadline_at.py
│   │   └── __init__.py [empty]
│   ├── services/
│   │   ├── __init__.py [empty]
│   │   ├── acolytes.py
│   │   ├── assignments.py
│   │   ├── audit.py
│   │   ├── availability.py
│   │   ├── calendar_generation.py
│   │   ├── claims.py
│   │   ├── event_series.py
│   │   ├── permissions.py
│   │   ├── preferences.py
│   │   ├── publishing.py
│   │   ├── recommendations.py
│   │   ├── replacements.py
│   │   ├── slots.py
│   │   ├── stats.py
│   │   ├── swaps.py
│   │   └── time_windows.py
│   ├── tests/
│   │   ├── __init__.py [empty]
│   │   ├── test_assignments_service.py
│   │   ├── test_availability.py
│   │   ├── test_calendar.py
│   │   ├── test_consolidation.py
│   │   ├── test_event_series.py
│   │   ├── test_event_series_archive_command.py
│   │   ├── test_permissions.py
│   │   ├── test_preferences.py
│   │   ├── test_publishing.py
│   │   ├── test_recommendations.py
│   │   ├── test_replacements.py
│   │   ├── test_slots.py
│   │   └── test_stats.py
│   ├── __init__.py [empty]
│   ├── admin.py
│   ├── apps.py
│   ├── context_processors.py
│   ├── middleware.py
│   └── models.py
├── docs/
├── fixtures/
│   └── seed_parish.json
├── maintenance_backups/
│   ├── clear_masses_2026-01-27_20260127T053843/
│   ├── clear_masses_2026-01-27_20260127T053859/
│   │   ├── serializers/
│   │   │   ├── acolytecreditledger.json
│   │   │   ├── auditevent.json [large]
│   │   │   ├── confirmation.json
│   │   │   ├── future_assignment_active.json [large]
│   │   │   ├── massinterest.json
│   │   │   ├── massoverride.json
│   │   │   ├── past_assignment.json
│   │   │   ├── past_assignmentslot.json
│   │   │   ├── past_massinstance.json
│   │   │   ├── positionclaimrequest.json
│   │   │   ├── replacementrequest.json
│   │   │   └── swaprequest.json
│   │   └── meta.json
│   ├── clear_masses_2026-01-27_20260127T062401/
│   │   ├── serializers/
│   │   │   ├── acolytecreditledger.json
│   │   │   ├── auditevent.json
│   │   │   ├── confirmation.json
│   │   │   ├── future_assignment_active.json
│   │   │   ├── massinterest.json
│   │   │   ├── massoverride.json
│   │   │   ├── past_assignment.json
│   │   │   ├── past_assignmentslot.json
│   │   │   ├── past_massinstance.json
│   │   │   ├── positionclaimrequest.json
│   │   │   ├── replacementrequest.json
│   │   │   └── swaprequest.json
│   │   └── meta.json
│   ├── clear_masses_2026-01-27_20260127T081444/
│   │   ├── serializers/
│   │   │   ├── acolytecreditledger.json
│   │   │   ├── auditevent.json
│   │   │   ├── confirmation.json
│   │   │   ├── future_assignment_active.json
│   │   │   ├── massinterest.json
│   │   │   ├── massoverride.json
│   │   │   ├── past_assignment.json
│   │   │   ├── past_assignmentslot.json
│   │   │   ├── past_massinstance.json
│   │   │   ├── positionclaimrequest.json
│   │   │   ├── replacementrequest.json
│   │   │   └── swaprequest.json
│   │   └── meta.json
│   ├── clear_masses_2026-01-27_20260127T083429/
│   │   ├── serializers/
│   │   │   ├── acolytecreditledger.json
│   │   │   ├── auditevent.json
│   │   │   ├── confirmation.json
│   │   │   ├── future_assignment_active.json
│   │   │   ├── massinterest.json
│   │   │   ├── massoverride.json
│   │   │   ├── past_assignment.json
│   │   │   ├── past_assignmentslot.json
│   │   │   ├── past_massinstance.json
│   │   │   ├── positionclaimrequest.json
│   │   │   ├── replacementrequest.json
│   │   │   └── swaprequest.json
│   │   └── meta.json
│   ├── clear_masses_2026-01-27_20260127T083740/
│   │   ├── serializers/
│   │   │   ├── acolytecreditledger.json
│   │   │   ├── auditevent.json
│   │   │   ├── confirmation.json
│   │   │   ├── future_assignment_active.json
│   │   │   ├── massinterest.json
│   │   │   ├── massoverride.json
│   │   │   ├── past_assignment.json
│   │   │   ├── past_assignmentslot.json
│   │   │   ├── past_massinstance.json
│   │   │   ├── positionclaimrequest.json
│   │   │   ├── replacementrequest.json
│   │   │   └── swaprequest.json
│   │   └── meta.json
│   └── clear_masses_2026-01-27_20260127T092124/
│       ├── serializers/
│       │   ├── acolytecreditledger.json
│       │   ├── auditevent.json
│       │   ├── confirmation.json
│       │   ├── future_assignment_active.json
│       │   ├── massinterest.json
│       │   ├── massoverride.json
│       │   ├── past_assignment.json
│       │   ├── past_assignmentslot.json
│       │   ├── past_massinstance.json
│       │   ├── positionclaimrequest.json
│       │   ├── replacementrequest.json
│       │   └── swaprequest.json
│       └── meta.json
├── notifications/
│   ├── management/
│   │   ├── commands/
│   │   │   ├── __init__.py
│   │   │   └── send_notifications.py
│   │   └── __init__.py
│   ├── migrations/
│   │   ├── 0001_initial.py
│   │   ├── 0002_notification_last_attempt_at_and_more.py
│   │   ├── 0003_alter_notification_status.py
│   │   └── __init__.py [empty]
│   ├── __init__.py [empty]
│   ├── apps.py
│   ├── models.py
│   ├── services.py
│   └── tests.py
├── scheduler/
│   ├── management/
│   │   ├── commands/
│   │   │   ├── __init__.py
│   │   │   └── run_global_scheduler.py
│   │   └── __init__.py
│   ├── migrations/
│   │   ├── 0001_initial.py
│   │   ├── 0002_alter_schedulejobrequest_status.py
│   │   ├── 0003_schedulejobrequest_job_type_payload.py
│   │   └── __init__.py [empty]
│   ├── services/
│   │   ├── __init__.py [empty]
│   │   ├── horizon.py
│   │   ├── jobs.py
│   │   ├── quick_fill.py
│   │   └── solver.py
│   ├── tests/
│   │   ├── __init__.py [empty]
│   │   ├── test_job_claim.py
│   │   ├── test_quick_fill.py
│   │   └── test_solver.py
│   ├── __init__.py [empty]
│   ├── apps.py
│   └── models.py
├── static/
│   └── css/
│       └── app.css
├── templates/
│   ├── acolytes/
│   │   ├── _partials/
│   │   │   ├── assignment_card.html
│   │   │   ├── calendar_feed_section.html
│   │   │   ├── claim_card.html
│   │   │   ├── dashboard_hero_assignment.html
│   │   │   ├── dashboard_pending_row.html
│   │   │   └── swap_card.html
│   │   ├── assignments.html
│   │   ├── link_user.html
│   │   ├── list.html
│   │   ├── preferences.html
│   │   ├── swap_assign.html
│   │   ├── swap_form.html
│   │   └── swaps.html
│   ├── audit/
│   │   └── list.html
│   ├── calendar/
│   │   ├── _slots_section.html
│   │   ├── assign_slot.html
│   │   ├── detail.html
│   │   └── month.html
│   ├── events/
│   │   ├── basics.html
│   │   ├── days.html
│   │   ├── detail.html
│   │   ├── form.html
│   │   ├── interest.html
│   │   └── list.html
│   ├── mass_templates/
│   │   ├── form.html
│   │   └── list.html
│   ├── modals/
│   │   └── assignment_conflict.html
│   ├── partials/
│   │   └── _messages.html
│   ├── people/
│   │   ├── acolyte_tabs/
│   │   │   ├── _assign_slot_modal.html
│   │   │   ├── _schedule_row.html
│   │   │   ├── audit.html
│   │   │   ├── availability.html
│   │   │   ├── credits.html
│   │   │   ├── notifications.html
│   │   │   ├── overview.html
│   │   │   ├── preferences.html
│   │   │   ├── qualifications.html
│   │   │   ├── schedule.html
│   │   │   └── swaps.html
│   │   ├── _people_list.html
│   │   ├── acolyte_assign_multiple_slots.html
│   │   ├── acolyte_detail.html
│   │   ├── create.html
│   │   ├── detail.html
│   │   └── directory.html
│   ├── replacements/
│   │   ├── center.html
│   │   ├── pick.html
│   │   └── resolve.html
│   ├── reports/
│   │   └── frequency.html
│   ├── roster/
│   │   ├── _open_slots_table.html
│   │   ├── _slot_candidates.html
│   │   ├── index.html
│   │   └── open_slots.html
│   ├── scheduling/
│   │   ├── _jobs_list.html
│   │   ├── dashboard.html
│   │   ├── job_detail.html
│   │   └── publish_preview.html
│   ├── settings/
│   │   └── parish.html
│   ├── structure/
│   │   ├── communities_form.html
│   │   ├── communities_list.html
│   │   ├── requirement_profiles_form.html
│   │   ├── requirement_profiles_list.html
│   │   ├── roles_form.html
│   │   └── roles_list.html
│   ├── base.html
│   ├── dashboard.html
│   ├── login.html
│   ├── logout.html
│   └── logout_confirm.html
├── web/
│   ├── migrations/
│   │   └── __init__.py [empty]
│   ├── templatetags/
│   │   ├── __init__.py [empty]
│   │   └── extras.py
│   ├── tests/
│   │   ├── __init__.py [empty]
│   │   ├── test_acolyte_link.py
│   │   ├── test_assignments.py
│   │   ├── test_audit_log.py
│   │   ├── test_calendar_feed.py
│   │   ├── test_dashboard.py
│   │   ├── test_event_series_forms.py
│   │   ├── test_event_series_views.py
│   │   ├── test_forms.py
│   │   ├── test_mass_detail.py
│   │   ├── test_mass_templates.py
│   │   ├── test_parish_settings.py
│   │   ├── test_people.py
│   │   ├── test_permissions.py
│   │   ├── test_preferences_view.py
│   │   ├── test_replacement_resolve.py
│   │   ├── test_reports_frequency.py
│   │   ├── test_roster.py
│   │   ├── test_scheduling_dashboard.py
│   │   ├── test_smoke.py
│   │   ├── test_structure_views.py
│   │   ├── test_swaps.py
│   │   └── test_templatetags.py
│   ├── __init__.py [empty]
│   ├── apps.py
│   ├── forms.py
│   ├── urls.py
│   └── views.py [large]
├── .env.example
├── db.sqlite3 [binary]
├── delete_mass.py
├── fix_slots.py
├── gunicorn.conf.py
├── limpar.py
├── manage.py
├── README.md
├── requirements.txt
└── runtime.txt
```

## Files

### accounts\migrations\0001_initial.py
```python
# Generated by Django 5.0.7 on 2026-01-19 23:05

import accounts.models
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('full_name', models.CharField(max_length=200)),
                ('phone', models.CharField(blank=True, max_length=30)),
                ('is_active', models.BooleanField(default=True)),
                ('is_staff', models.BooleanField(default=False)),
                ('is_system_admin', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'abstract': False,
            },
            managers=[
                ('objects', accounts.models.UserManager()),
            ],
        ),
    ]
```

### accounts\admin.py
```python
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin as DjangoUserAdmin

from .models import User


@admin.register(User)
class UserAdmin(DjangoUserAdmin):
    model = User
    list_display = ("email", "full_name", "is_system_admin", "is_staff", "is_active")
    list_filter = ("is_system_admin", "is_staff", "is_active")
    fieldsets = (
        (None, {"fields": ("email", "password")}),
        ("Personal info", {"fields": ("full_name", "phone")}),
        ("Permissions", {"fields": ("is_active", "is_staff", "is_superuser", "is_system_admin", "groups", "user_permissions")}),
        ("Important dates", {"fields": ("last_login",)}),
    )
    add_fieldsets = (
        (
            None,
            {
                "classes": ("wide",),
                "fields": ("email", "full_name", "password1", "password2", "is_staff", "is_system_admin"),
            },
        ),
    )
    search_fields = ("email", "full_name")
    ordering = ("email",)
```

### accounts\apps.py
```python
from django.apps import AppConfig


class AccountsConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "accounts"
```

### accounts\forms.py
```python
from django import forms
from django.contrib.auth.forms import AuthenticationForm


class LoginForm(AuthenticationForm):
    username = forms.EmailField(label="Email")
```

### accounts\models.py
```python
from django.contrib.auth.base_user import BaseUserManager
from django.contrib.auth.models import AbstractBaseUser, PermissionsMixin
from django.db import models


class UserManager(BaseUserManager):
    use_in_migrations = True

    def _create_user(self, email, password, **extra_fields):
        if not email:
            raise ValueError("The Email must be set")
        email = self.normalize_email(email)
        user = self.model(email=email, **extra_fields)
        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_user(self, email, password=None, **extra_fields):
        extra_fields.setdefault("is_staff", False)
        extra_fields.setdefault("is_superuser", False)
        return self._create_user(email, password, **extra_fields)

    def create_superuser(self, email, password=None, **extra_fields):
        extra_fields.setdefault("is_staff", True)
        extra_fields.setdefault("is_superuser", True)
        extra_fields.setdefault("is_system_admin", True)
        return self._create_user(email, password, **extra_fields)


class User(AbstractBaseUser, PermissionsMixin):
    email = models.EmailField(unique=True)
    full_name = models.CharField(max_length=200)
    phone = models.CharField(max_length=30, blank=True)
    is_active = models.BooleanField(default=True)
    is_staff = models.BooleanField(default=False)
    is_system_admin = models.BooleanField(default=False)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    objects = UserManager()

    USERNAME_FIELD = "email"
    REQUIRED_FIELDS = ["full_name"]

    def __str__(self):
        return self.full_name or self.email
```

### accounts\tests.py
```python
from django.test import TestCase

from .models import User


class UserModelTests(TestCase):
    def test_create_user(self):
        user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.assertTrue(user.check_password("pass"))
```

### accounts\urls.py
```python
from django.urls import path

from .views import LogoutConfirmView, UserLoginView, UserLogoutView

urlpatterns = [
    path("login/", UserLoginView.as_view(), name="login"),
    path("logout/", UserLogoutView.as_view(), name="logout"),
    path("logout/confirm/", LogoutConfirmView.as_view(), name="logout_confirm"),
]
```

### accounts\views.py
```python
from django.contrib.auth.views import LoginView, LogoutView
from django.views.generic import TemplateView

from .forms import LoginForm


class UserLoginView(LoginView):
    template_name = "login.html"
    authentication_form = LoginForm


class UserLogoutView(LogoutView):
    template_name = "logout.html"


class LogoutConfirmView(TemplateView):
    """Página de confirmação de logout (GET request)."""

    template_name = "logout_confirm.html"
```

### acoli\asgi.py
```python
import os
from django.core.asgi import get_asgi_application

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "acoli.settings")

application = get_asgi_application()
```

### acoli\settings.py
```python
import os
import sys
from pathlib import Path

import dj_database_url

BASE_DIR = Path(__file__).resolve().parent.parent

SECRET_KEY = os.environ.get("SECRET_KEY", "dev-insecure-key")
DEBUG = os.environ.get("DEBUG")
if DEBUG is None:
    DEBUG = "1" if "DYNO" not in os.environ else "0"
DEBUG = DEBUG == "1"

ALLOWED_HOSTS = [host.strip() for host in os.environ.get("ALLOWED_HOSTS", "").split(",") if host.strip()]
if not ALLOWED_HOSTS:
    ALLOWED_HOSTS = ["localhost", "127.0.0.1"]

INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "django.contrib.postgres",
    "django_htmx",
    "rest_framework",
    "accounts",
    "core",
    "scheduler",
    "notifications",
    "web",
    "api",
]

MIDDLEWARE = [
    "django.middleware.security.SecurityMiddleware",
    "whitenoise.middleware.WhiteNoiseMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
    "django_htmx.middleware.HtmxMiddleware",
    "core.middleware.BackUrlMiddleware",
    "core.middleware.ActiveParishMiddleware",
    "core.middleware.ApiParishHeaderMiddleware",
]

ROOT_URLCONF = "acoli.urls"

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [BASE_DIR / "templates"],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
                "core.context_processors.active_parish",
                "core.context_processors.back_url",
            ],
        },
    },
]

WSGI_APPLICATION = "acoli.wsgi.application"
ASGI_APPLICATION = "acoli.asgi.application"

DATABASES = {
    "default": dj_database_url.config(
        default=os.environ.get("DATABASE_URL", "sqlite:///" + str(BASE_DIR / "db.sqlite3")),
        conn_max_age=int(os.environ.get("DB_CONN_MAX_AGE", "60")),
        ssl_require=False,
    )
}

AUTH_PASSWORD_VALIDATORS = [
    {"NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator"},
    {"NAME": "django.contrib.auth.password_validation.MinimumLengthValidator"},
    {"NAME": "django.contrib.auth.password_validation.CommonPasswordValidator"},
    {"NAME": "django.contrib.auth.password_validation.NumericPasswordValidator"},
]

LANGUAGE_CODE = "pt-br"
TIME_ZONE = "America/Sao_Paulo"
USE_I18N = True
USE_TZ = True

STATIC_URL = "/static/"
STATIC_ROOT = BASE_DIR / "staticfiles"
STATICFILES_DIRS = [BASE_DIR / "static"]
if DEBUG or "test" in sys.argv:
    STATICFILES_STORAGE = "django.contrib.staticfiles.storage.StaticFilesStorage"
else:
    STATICFILES_STORAGE = "whitenoise.storage.CompressedManifestStaticFilesStorage"

MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"

AUTH_USER_MODEL = "accounts.User"

LOGIN_URL = "login"
LOGIN_REDIRECT_URL = "dashboard"
LOGOUT_REDIRECT_URL = "login"

EMAIL_BACKEND = os.environ.get("EMAIL_BACKEND", "django.core.mail.backends.smtp.EmailBackend")
EMAIL_HOST = os.environ.get("EMAIL_HOST", "")
EMAIL_PORT = int(os.environ.get("EMAIL_PORT", "587"))
EMAIL_HOST_USER = os.environ.get("EMAIL_HOST_USER", "")
EMAIL_HOST_PASSWORD = os.environ.get("EMAIL_HOST_PASSWORD", "")
EMAIL_USE_TLS = os.environ.get("EMAIL_USE_TLS", "1") == "1"
DEFAULT_FROM_EMAIL = os.environ.get("DEFAULT_FROM_EMAIL", "acoli@example.com")
APP_BASE_URL = os.environ.get("APP_BASE_URL", "").rstrip("/")

SECURE_PROXY_SSL_HEADER = ("HTTP_X_FORWARDED_PROTO", "https")
SECURE_SSL_REDIRECT = os.environ.get("SECURE_SSL_REDIRECT", "0") == "1"
CSRF_TRUSTED_ORIGINS = [origin.strip() for origin in os.environ.get("CSRF_TRUSTED_ORIGINS", "").split(",") if origin.strip()]

REST_FRAMEWORK = {
    "DEFAULT_AUTHENTICATION_CLASSES": [
        "rest_framework.authentication.SessionAuthentication",
        "rest_framework.authentication.BasicAuthentication",
    ],
    "DEFAULT_PERMISSION_CLASSES": [
        "rest_framework.permissions.IsAuthenticated",
    ],
}

WHITENOISE_MAX_AGE = int(os.environ.get("WHITENOISE_MAX_AGE", "31536000"))
```

### acoli\urls.py
```python
from django.contrib import admin
from django.urls import include, path

urlpatterns = [
    path("admin/", admin.site.urls),
    path("", include("web.urls")),
    path("api/", include("api.urls")),
]
```

### acoli\wsgi.py
```python
import os
from django.core.wsgi import get_wsgi_application

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "acoli.settings")

application = get_wsgi_application()
```

### api\apps.py
```python
from django.apps import AppConfig


class ApiConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "api"
```

### api\serializers.py
```python
from rest_framework import serializers

from core.models import AcolyteProfile, Assignment, MassInstance


class AcolyteProfileSerializer(serializers.ModelSerializer):
    class Meta:
        model = AcolyteProfile
        fields = ["id", "display_name", "community_of_origin", "active"]


class MassInstanceSerializer(serializers.ModelSerializer):
    class Meta:
        model = MassInstance
        fields = ["id", "community", "starts_at", "liturgy_label", "status"]


class AssignmentSerializer(serializers.ModelSerializer):
    class Meta:
        model = Assignment
        fields = ["id", "slot", "acolyte", "assignment_state", "published_at"]
```

### api\urls.py
```python
from django.urls import include, path
from rest_framework.routers import DefaultRouter

from api.views import AcolyteProfileViewSet, AssignmentViewSet, MassInstanceViewSet

router = DefaultRouter()
router.register("acolytes", AcolyteProfileViewSet)
router.register("masses", MassInstanceViewSet)
router.register("assignments", AssignmentViewSet)

urlpatterns = [
    path("", include(router.urls)),
]
```

### api\views.py
```python
from rest_framework import permissions, viewsets

from core.models import AcolyteProfile, Assignment, MassInstance
from api.serializers import AcolyteProfileSerializer, AssignmentSerializer, MassInstanceSerializer


class ParishScopedMixin:
    def get_queryset(self):
        parish = getattr(self.request, "active_parish", None)
        return super().get_queryset().filter(parish=parish)


class AcolyteProfileViewSet(ParishScopedMixin, viewsets.ReadOnlyModelViewSet):
    queryset = AcolyteProfile.objects.all()
    serializer_class = AcolyteProfileSerializer
    permission_classes = [permissions.IsAuthenticated]


class MassInstanceViewSet(ParishScopedMixin, viewsets.ReadOnlyModelViewSet):
    queryset = MassInstance.objects.all()
    serializer_class = MassInstanceSerializer
    permission_classes = [permissions.IsAuthenticated]


class AssignmentViewSet(ParishScopedMixin, viewsets.ReadOnlyModelViewSet):
    queryset = Assignment.objects.all()
    serializer_class = AssignmentSerializer
    permission_classes = [permissions.IsAuthenticated]
```

### core\management\commands\__init__.py
```python

```

### core\management\commands\archive_event_series.py
```python
from django.core.management.base import BaseCommand
from django.utils import timezone

from core.models import EventSeries
from core.services.audit import log_audit


class Command(BaseCommand):
    help = "Archive event series that ended before today."

    def handle(self, *args, **options):
        today = timezone.localdate()
        to_archive = EventSeries.objects.filter(is_active=True, end_date__lt=today)
        archived = 0
        for series in to_archive:
            series.is_active = False
            series.save(update_fields=["is_active", "updated_at"])
            log_audit(series.parish, None, "EventSeries", series.id, "archive", {"auto": True})
            archived += 1
        self.stdout.write(self.style.SUCCESS(f"Archived {archived} event series."))
```

### core\management\commands\generate_mass_instances.py
```python
from datetime import date, timedelta

from django.core.management.base import BaseCommand

from core.models import Parish
from core.services.calendar_generation import generate_instances_for_parish


class Command(BaseCommand):
    help = "Generate rolling mass instances for the next N days."

    def add_arguments(self, parser):
        parser.add_argument("--days", type=int, default=60)
        parser.add_argument("--parish-id", type=int)

    def handle(self, *args, **options):
        days = options["days"]
        parish_id = options.get("parish_id")
        start_date = date.today()
        end_date = start_date + timedelta(days=days)
        parishes = Parish.objects.all()
        if parish_id:
            parishes = parishes.filter(id=parish_id)
        for parish in parishes:
            created = generate_instances_for_parish(parish, start_date, end_date)
            self.stdout.write(self.style.SUCCESS(f"Parish {parish.id}: created {len(created)} instances"))
```

### core\management\commands\lock_consolidation_window.py
```python
from datetime import timedelta

from django.core.management.base import BaseCommand
from django.utils import timezone
from django.db.models import Prefetch

from core.models import Assignment, AssignmentSlot, Parish
from core.services.audit import log_audit


class Command(BaseCommand):
    help = "Lock assignments inside the consolidation window."

    def add_arguments(self, parser):
        parser.add_argument("--parish-id", type=int)

    def handle(self, *args, **options):
        parish_id = options.get("parish_id")
        parishes = Parish.objects.all()
        if parish_id:
            parishes = parishes.filter(id=parish_id)

        for parish in parishes:
            end = timezone.now() + timedelta(days=parish.consolidation_days)
            slots = AssignmentSlot.objects.filter(
                parish=parish,
                mass_instance__starts_at__lte=end,
                mass_instance__starts_at__gte=timezone.now(),
            ).prefetch_related(
                Prefetch("assignments", queryset=Assignment.objects.filter(is_active=True), to_attr="active_assignments")
            )
            locked = 0
            for slot in slots:
                if not slot.is_locked:
                    slot.is_locked = True
                    slot.locked_at = timezone.now()
                    slot.save(update_fields=["is_locked", "locked_at", "updated_at"])
                assignment = slot.get_active_assignment()
                if assignment:
                    if assignment.assignment_state != "locked":
                        assignment.assignment_state = "locked"
                        assignment.save(update_fields=["assignment_state", "updated_at"])
                    if slot.status != "finalized":
                        slot.status = "finalized"
                        slot.save(update_fields=["status", "updated_at"])
                locked += 1
            log_audit(parish, None, "Consolidation", parish.id, "lock", {"locked_slots": locked})
            self.stdout.write(self.style.SUCCESS(f"Parish {parish.id}: locked {locked} slots"))
```

### core\management\commands\populate_eventseries_ruleset.py
```python
"""
Django management command to populate empty ruleset_json in EventSeries.

This fixes EventSeries created before the ruleset_json field was properly populated.
It infers default_time and default_requirement_profile_id from existing EventOccurrences.
"""
from django.core.management.base import BaseCommand
from core.models import EventSeries


class Command(BaseCommand):
    help = "Populate empty ruleset_json in EventSeries from EventOccurrence data"

    def add_arguments(self, parser):
        parser.add_argument(
            "--dry-run",
            action="store_true",
            help="Show what would be updated without making changes",
        )

    def handle(self, *args, **options):
        dry_run = options["dry_run"]

        series_list = EventSeries.objects.filter(ruleset_json={})

        if not series_list.exists():
            self.stdout.write(self.style.SUCCESS("No EventSeries with empty ruleset_json found"))
            return

        self.stdout.write(f"Found {series_list.count()} EventSeries with empty ruleset_json\n")

        updated_count = 0
        for series in series_list:
            first_occurrence = series.occurrences.first()

            # Infer default_time from first occurrence
            if first_occurrence and first_occurrence.time:
                default_time = first_occurrence.time.strftime("%H:%M")
            else:
                default_time = "19:00"  # Reasonable default

            # Infer default_requirement_profile_id from first occurrence
            profile_id = None
            if first_occurrence and first_occurrence.requirement_profile:
                profile_id = first_occurrence.requirement_profile.id

            ruleset = {
                "default_time": default_time,
                "default_requirement_profile_id": profile_id,
            }

            self.stdout.write(f"  {series.title} (ID: {series.id})")
            self.stdout.write(f"    - default_time: {default_time}")
            if profile_id:
                self.stdout.write(f"    - default_requirement_profile_id: {profile_id}")

            if not dry_run:
                series.ruleset_json = ruleset
                series.save()
                updated_count += 1

        if dry_run:
            self.stdout.write(self.style.WARNING(f"\nDry run: {series_list.count()} would be updated"))
        else:
            self.stdout.write(self.style.SUCCESS(f"\nSuccessfully updated {updated_count} EventSeries"))
```

### core\management\commands\process_position_claims.py
```python
from django.core.management.base import BaseCommand

from core.models import Parish
from core.services.claims import process_due_claims


class Command(BaseCommand):
    help = "Processa solicitacoes de posicao vencidas para auto-aprovacao."

    def add_arguments(self, parser):
        parser.add_argument("--parish-id", type=int)

    def handle(self, *args, **options):
        parish_id = options.get("parish_id")
        parishes = Parish.objects.all()
        if parish_id:
            parishes = parishes.filter(id=parish_id)

        processed = 0
        for parish in parishes:
            process_due_claims(parish=parish)
            processed += 1
        self.stdout.write(self.style.SUCCESS(f"Processadas solicitacoes em {processed} paroquias"))
```

### core\management\commands\recompute_acolyte_stats.py
```python
from django.core.management.base import BaseCommand

from core.models import Parish
from core.services.stats import recompute_stats


class Command(BaseCommand):
    help = "Recompute acolyte statistics and reliability metrics."

    def add_arguments(self, parser):
        parser.add_argument("--parish-id", type=int)

    def handle(self, *args, **options):
        parish_id = options.get("parish_id")
        parishes = Parish.objects.all()
        if parish_id:
            parishes = parishes.filter(id=parish_id)
        for parish in parishes:
            recompute_stats(parish)
            self.stdout.write(self.style.SUCCESS(f"Parish {parish.id}: stats recomputed"))
```

### core\management\commands\sync_slots.py
```python
from datetime import date, timedelta

from django.core.management.base import BaseCommand

from core.models import Parish
from core.services.slots import sync_slots_for_parish


class Command(BaseCommand):
    help = "Ensure assignment slots exist for mass instances in a range."

    def add_arguments(self, parser):
        parser.add_argument("--days", type=int, default=60)
        parser.add_argument("--parish-id", type=int)
        parser.add_argument("--start-date", type=str)
        parser.add_argument("--end-date", type=str)

    def handle(self, *args, **options):
        parish_id = options.get("parish_id")
        start_date = options.get("start_date")
        end_date = options.get("end_date")

        if start_date and end_date:
            start = date.fromisoformat(start_date)
            end = date.fromisoformat(end_date)
        else:
            start = date.today()
            end = start + timedelta(days=options["days"])

        parishes = Parish.objects.all()
        if parish_id:
            parishes = parishes.filter(id=parish_id)
        for parish in parishes:
            count = sync_slots_for_parish(parish, start, end)
            self.stdout.write(self.style.SUCCESS(f"Parish {parish.id}: synced {count} instances"))
```

### core\management\__init__.py
```python

```

### core\migrations\0001_initial.py
```python
# Generated by Django 5.0.7 on 2026-01-19 23:05

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AssignmentSlot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('slot_index', models.PositiveSmallIntegerField(default=1)),
                ('required', models.BooleanField(default=True)),
                ('status', models.CharField(choices=[('open', 'Open'), ('assigned', 'Assigned'), ('finalized', 'Finalized')], default='open', max_length=20)),
                ('is_locked', models.BooleanField(default=False)),
                ('locked_at', models.DateTimeField(blank=True, null=True)),
            ],
        ),
        migrations.CreateModel(
            name='Community',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('code', models.CharField(max_length=10)),
                ('name', models.CharField(max_length=200)),
                ('address', models.TextField(blank=True)),
                ('active', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='MembershipRole',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(max_length=40, unique=True)),
                ('name', models.CharField(max_length=100)),
            ],
        ),
        migrations.CreateModel(
            name='Parish',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=200)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('state', models.CharField(blank=True, max_length=50)),
                ('timezone', models.CharField(default='America/Sao_Paulo', max_length=64)),
                ('contact_email', models.EmailField(blank=True, max_length=254)),
                ('contact_phone', models.CharField(blank=True, max_length=30)),
                ('consolidation_days', models.PositiveIntegerField(default=14)),
                ('horizon_days', models.PositiveIntegerField(default=60)),
                ('schedule_weights', models.JSONField(blank=True, default=dict)),
                ('swap_requires_approval', models.BooleanField(default=True)),
                ('notify_on_cancellation', models.BooleanField(default=True)),
                ('auto_assign_on_decline', models.BooleanField(default=False)),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='AcolyteProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('display_name', models.CharField(max_length=200)),
                ('notes', models.TextField(blank=True)),
                ('active', models.BooleanField(default=True)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('community_of_origin', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.community')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='acolytes', to='core.parish')),
            ],
        ),
        migrations.CreateModel(
            name='Assignment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_at', models.DateTimeField(auto_now_add=True)),
                ('assignment_state', models.CharField(choices=[('proposed', 'Proposed'), ('published', 'Published'), ('locked', 'Locked')], default='proposed', max_length=20)),
                ('published_at', models.DateTimeField(blank=True, null=True)),
                ('acolyte', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.acolyteprofile')),
                ('assigned_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('slot', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='assignment', to='core.assignmentslot')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='EventSeries',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('series_type', models.CharField(max_length=40)),
                ('title', models.CharField(max_length=200)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('ruleset_json', models.JSONField(blank=True, default=dict)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='eventseries_created', to=settings.AUTH_USER_MODEL)),
                ('default_community', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.community')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='eventseries_updated', to=settings.AUTH_USER_MODEL)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='MassInstance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('starts_at', models.DateTimeField()),
                ('liturgy_label', models.CharField(blank=True, max_length=200)),
                ('status', models.CharField(choices=[('scheduled', 'Scheduled'), ('canceled', 'Canceled')], default='scheduled', max_length=20)),
                ('community', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.community')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='mass_created', to=settings.AUTH_USER_MODEL)),
                ('event_series', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.eventseries')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='mass_updated', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.AddField(
            model_name='assignmentslot',
            name='mass_instance',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='slots', to='core.massinstance'),
        ),
        migrations.CreateModel(
            name='MassTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('title', models.CharField(max_length=200)),
                ('weekday', models.PositiveSmallIntegerField(choices=[(0, 'Mon'), (1, 'Tue'), (2, 'Wed'), (3, 'Thu'), (4, 'Fri'), (5, 'Sat'), (6, 'Sun')])),
                ('time', models.TimeField()),
                ('rrule_text', models.TextField(blank=True)),
                ('active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('community', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.community')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='massinstance',
            name='template',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.masstemplate'),
        ),
        migrations.CreateModel(
            name='MassOverride',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('override_type', models.CharField(choices=[('cancel_instance', 'Cancel instance'), ('move_instance', 'Move instance'), ('change_requirements', 'Change requirements'), ('change_display_fields', 'Change display fields')], max_length=40)),
                ('payload', models.JSONField(blank=True, default=dict)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('instance', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.massinstance')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='massinstance',
            name='parish',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish'),
        ),
        migrations.CreateModel(
            name='FunctionType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('code', models.CharField(max_length=10)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True)),
                ('active', models.BooleanField(default=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'unique_together': {('parish', 'code')},
            },
        ),
        migrations.CreateModel(
            name='Confirmation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('confirmed', 'Confirmed'), ('declined', 'Declined'), ('canceled_by_acolyte', 'Canceled'), ('replaced', 'Replaced'), ('no_show', 'No show')], default='pending', max_length=30)),
                ('notes', models.TextField(blank=True)),
                ('timestamp', models.DateTimeField(auto_now=True)),
                ('assignment', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='confirmation', to='core.assignment')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='community',
            name='parish',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish'),
        ),
        migrations.AddField(
            model_name='assignmentslot',
            name='parish',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish'),
        ),
        migrations.CreateModel(
            name='AcolyteStats',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('services_last_30_days', models.PositiveIntegerField(default=0)),
                ('services_last_90_days', models.PositiveIntegerField(default=0)),
                ('confirmation_rate', models.FloatField(default=0.0)),
                ('cancellations_rate', models.FloatField(default=0.0)),
                ('no_show_count', models.PositiveIntegerField(default=0)),
                ('last_served_at', models.DateTimeField(blank=True, null=True)),
                ('reliability_score', models.FloatField(default=0.0)),
                ('credit_balance', models.IntegerField(default=0)),
                ('acolyte', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, to='core.acolyteprofile')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='AcolyteIntent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('desired_frequency_per_month', models.PositiveIntegerField(blank=True, null=True)),
                ('willingness_level', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High')], default='normal', max_length=10)),
                ('acolyte', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, to='core.acolyteprofile')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='AcolyteCreditLedger',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('delta', models.IntegerField()),
                ('reason_code', models.CharField(choices=[('served_unpopular_slot', 'Served unpopular slot'), ('accepted_last_minute_substitution', 'Accepted last minute substitution'), ('high_attendance_streak', 'High attendance streak'), ('received_high_demand_assignment', 'Received high demand assignment')], max_length=40)),
                ('acolyte', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.acolyteprofile')),
                ('related_assignment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.assignment')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='AcolyteAvailabilityRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('rule_type', models.CharField(choices=[('unavailable', 'Unavailable'), ('available_only', 'Available only')], max_length=20)),
                ('day_of_week', models.PositiveSmallIntegerField(blank=True, null=True)),
                ('start_time', models.TimeField(blank=True, null=True)),
                ('end_time', models.TimeField(blank=True, null=True)),
                ('start_date', models.DateField(blank=True, null=True)),
                ('end_date', models.DateField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('acolyte', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.acolyteprofile')),
                ('community', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.community')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='ParishMembership',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('active', models.BooleanField(default=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('roles', models.ManyToManyField(blank=True, to='core.membershiprole')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='PositionType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('code', models.CharField(max_length=20)),
                ('name', models.CharField(max_length=100)),
                ('active', models.BooleanField(default=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
        ),
        migrations.AddField(
            model_name='assignmentslot',
            name='position_type',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.positiontype'),
        ),
        migrations.CreateModel(
            name='AcolyteQualification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('qualified', models.BooleanField(default=True)),
                ('acolyte', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.acolyteprofile')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('position_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.positiontype')),
            ],
        ),
        migrations.CreateModel(
            name='AcolytePreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('preference_type', models.CharField(choices=[('preferred_community', 'Preferred community'), ('avoid_community', 'Avoid community'), ('preferred_timeslot', 'Preferred timeslot'), ('preferred_mass_template', 'Preferred mass template'), ('preferred_position', 'Preferred position'), ('avoid_position', 'Avoid position'), ('preferred_function', 'Preferred function'), ('avoid_function', 'Avoid function'), ('preferred_partner', 'Preferred partner'), ('avoid_partner', 'Avoid partner')], max_length=40)),
                ('weekday', models.PositiveSmallIntegerField(blank=True, null=True)),
                ('start_time', models.TimeField(blank=True, null=True)),
                ('end_time', models.TimeField(blank=True, null=True)),
                ('weight', models.PositiveIntegerField(default=50)),
                ('acolyte', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.acolyteprofile')),
                ('target_acolyte', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='preferred_by', to='core.acolyteprofile')),
                ('target_community', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.community')),
                ('target_function', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.functiontype')),
                ('target_template', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.masstemplate')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('target_position', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.positiontype')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='PositionTypeFunction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('function_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.functiontype')),
                ('position_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.positiontype')),
            ],
        ),
        migrations.AddField(
            model_name='positiontype',
            name='functions',
            field=models.ManyToManyField(blank=True, through='core.PositionTypeFunction', to='core.functiontype'),
        ),
        migrations.CreateModel(
            name='RequirementProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=150)),
                ('notes', models.TextField(blank=True)),
                ('active', models.BooleanField(default=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='masstemplate',
            name='default_requirement_profile',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.requirementprofile'),
        ),
        migrations.AddField(
            model_name='massinstance',
            name='requirement_profile',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.requirementprofile'),
        ),
        migrations.CreateModel(
            name='RequirementProfilePosition',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.PositiveSmallIntegerField(default=1)),
                ('position_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.positiontype')),
                ('profile', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='positions', to='core.requirementprofile')),
            ],
        ),
        migrations.CreateModel(
            name='SwapRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('swap_type', models.CharField(choices=[('acolyte_swap', 'Acolyte swap'), ('role_swap', 'Role swap')], max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('accepted', 'Accepted'), ('rejected', 'Rejected'), ('canceled', 'Canceled')], default='pending', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('from_slot', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='swap_from', to='core.assignmentslot')),
                ('mass_instance', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.massinstance')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('requestor_acolyte', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='swap_requests', to='core.acolyteprofile')),
                ('target_acolyte', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='swap_targets', to='core.acolyteprofile')),
                ('to_slot', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='swap_to', to='core.assignmentslot')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AlterUniqueTogether(
            name='community',
            unique_together={('parish', 'code')},
        ),
        migrations.CreateModel(
            name='AuditEvent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('entity_type', models.CharField(max_length=100)),
                ('entity_id', models.CharField(max_length=100)),
                ('action_type', models.CharField(max_length=50)),
                ('diff_json', models.JSONField(blank=True, default=dict)),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('actor_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('parish', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.parish')),
            ],
            options={
                'indexes': [models.Index(fields=['entity_type', 'entity_id'], name='core_audite_entity__e1955d_idx'), models.Index(fields=['parish', 'timestamp'], name='core_audite_parish__8cf4e5_idx')],
            },
        ),
        migrations.AddConstraint(
            model_name='acolyteprofile',
            constraint=models.UniqueConstraint(condition=models.Q(('user__isnull', False)), fields=('parish', 'user'), name='unique_acolyte_user_per_parish'),
        ),
        migrations.AlterUniqueTogether(
            name='parishmembership',
            unique_together={('parish', 'user')},
        ),
        migrations.AlterUniqueTogether(
            name='assignmentslot',
            unique_together={('mass_instance', 'position_type', 'slot_index')},
        ),
        migrations.AlterUniqueTogether(
            name='acolytequalification',
            unique_together={('parish', 'acolyte', 'position_type')},
        ),
        migrations.AlterUniqueTogether(
            name='positiontypefunction',
            unique_together={('position_type', 'function_type')},
        ),
        migrations.AlterUniqueTogether(
            name='positiontype',
            unique_together={('parish', 'code')},
        ),
        migrations.AlterUniqueTogether(
            name='massinstance',
            unique_together={('parish', 'starts_at', 'community')},
        ),
        migrations.AlterUniqueTogether(
            name='requirementprofileposition',
            unique_together={('profile', 'position_type')},
        ),
    ]
```

### core\migrations\0002_eventseries_candidate_pool_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-20 04:01

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='eventseries',
            name='candidate_pool',
            field=models.CharField(choices=[('all', 'All'), ('interested_only', 'Interested only')], default='all', max_length=20),
        ),
        migrations.AddField(
            model_name='parish',
            name='default_mass_duration_minutes',
            field=models.PositiveIntegerField(default=60),
        ),
        migrations.AddField(
            model_name='parish',
            name='min_rest_minutes_between_masses',
            field=models.PositiveIntegerField(default=0),
        ),
        migrations.AlterField(
            model_name='swaprequest',
            name='status',
            field=models.CharField(choices=[('pending', 'Pending'), ('awaiting_approval', 'Awaiting approval'), ('accepted', 'Accepted'), ('rejected', 'Rejected'), ('canceled', 'Canceled')], default='pending', max_length=20),
        ),
        migrations.CreateModel(
            name='EventOccurrence',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('date', models.DateField()),
                ('time', models.TimeField()),
                ('label', models.CharField(blank=True, max_length=200)),
                ('conflict_action', models.CharField(choices=[('keep', 'Keep existing'), ('cancel_existing', 'Cancel existing'), ('move_existing', 'Move existing'), ('skip', 'Skip')], default='keep', max_length=20)),
                ('move_to_date', models.DateField(blank=True, null=True)),
                ('move_to_time', models.TimeField(blank=True, null=True)),
                ('community', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.community')),
                ('event_series', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='occurrences', to='core.eventseries')),
                ('move_to_community', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='moved_occurrences', to='core.community')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('requirement_profile', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.requirementprofile')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='ReplacementRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('assigned', 'Assigned'), ('canceled', 'Canceled')], default='pending', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('proposed_acolyte', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.acolyteprofile')),
                ('requested_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('slot', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.assignmentslot')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='EventInterest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('interested', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('acolyte', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.acolyteprofile')),
                ('event_series', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.eventseries')),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'unique_together': {('event_series', 'acolyte')},
            },
        ),
    ]
```

### core\migrations\0003_alter_massinstance_unique_together_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-20 04:11

from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0002_eventseries_candidate_pool_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterUniqueTogether(
            name='massinstance',
            unique_together=set(),
        ),
        migrations.AddConstraint(
            model_name='massinstance',
            constraint=models.UniqueConstraint(condition=models.Q(('status', 'scheduled')), fields=('parish', 'starts_at', 'community'), name='unique_scheduled_mass_per_slot'),
        ),
    ]
```

### core\migrations\0004_assignment_end_reason_assignment_ended_at_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-20 04:57

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0003_alter_massinstance_unique_together_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='assignment',
            name='end_reason',
            field=models.CharField(blank=True, choices=[('declined', 'Declined'), ('canceled', 'Canceled'), ('replaced', 'Replaced'), ('replaced_by_solver', 'Replaced by solver'), ('manual_unassign', 'Manual unassign'), ('swap', 'Swap')], max_length=30),
        ),
        migrations.AddField(
            model_name='assignment',
            name='ended_at',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='assignment',
            name='is_active',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='swaprequest',
            name='open_to_admin',
            field=models.BooleanField(default=False),
        ),
        migrations.AlterField(
            model_name='assignment',
            name='slot',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assignments', to='core.assignmentslot'),
        ),
        migrations.AddConstraint(
            model_name='assignment',
            constraint=models.UniqueConstraint(condition=models.Q(('is_active', True)), fields=('slot',), name='unique_active_assignment_per_slot'),
        ),
    ]
```

### core\migrations\0005_replacementrequest_resolved_at_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-20 07:22

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0004_assignment_end_reason_assignment_ended_at_and_more'),
    ]

    operations = [
        migrations.AddField(
            model_name='replacementrequest',
            name='resolved_at',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='replacementrequest',
            name='resolved_notes',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='replacementrequest',
            name='resolved_reason',
            field=models.CharField(blank=True, choices=[('mass_canceled', 'Mass canceled'), ('slot_not_required', 'Slot not required'), ('covered_externally', 'Covered externally'), ('other', 'Other')], max_length=30),
        ),
        migrations.AlterField(
            model_name='replacementrequest',
            name='status',
            field=models.CharField(choices=[('pending', 'Pending'), ('assigned', 'Assigned'), ('canceled', 'Canceled'), ('resolved', 'Resolved')], default='pending', max_length=20),
        ),
    ]
```

### core\migrations\0006_assignmentslot_external_coverage_notes_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-20 08:44

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0005_replacementrequest_resolved_at_and_more'),
    ]

    operations = [
        migrations.AddField(
            model_name='assignmentslot',
            name='external_coverage_notes',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='assignmentslot',
            name='externally_covered',
            field=models.BooleanField(default=False),
        ),
    ]
```

### core\migrations\0007_acolyteprofile_experience_level_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-21 06:28

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0006_assignmentslot_external_coverage_notes_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='acolyteprofile',
            name='experience_level',
            field=models.CharField(choices=[('beginner', 'Beginner'), ('intermediate', 'Intermediate'), ('senior', 'Senior')], default='intermediate', max_length=20),
        ),
        migrations.AddField(
            model_name='requirementprofile',
            name='min_senior_per_mass',
            field=models.PositiveSmallIntegerField(default=0),
        ),
        migrations.CreateModel(
            name='FamilyGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=120)),
                ('notes', models.TextField(blank=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='acolyteprofile',
            name='family_group',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.familygroup'),
        ),
        migrations.CreateModel(
            name='CalendarFeedToken',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('token', models.CharField(max_length=64, unique=True)),
                ('rotated_at', models.DateTimeField(blank=True, null=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'unique_together': {('parish', 'user')},
            },
        ),
    ]
```

### core\migrations\0008_eventseries_is_active.py
```python
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("core", "0007_acolyteprofile_experience_level_and_more"),
    ]

    operations = [
        migrations.AddField(
            model_name="eventseries",
            name="is_active",
            field=models.BooleanField(default=True),
        ),
    ]
```

### core\migrations\0009_add_moved_to_another_slot_end_reason.py
```python
# Generated by Django 5.0.7 on 2026-01-23 07:08

from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0008_eventseries_is_active'),
    ]

    operations = [
        # Adiciona suporte ao end_reason "moved_to_another_slot" usado na função move_acolyte_to_slot
        # Esta migração apenas documenta a adição do choice ao modelo Assignment.END_REASON_CHOICES
        # Não há mudanças no schema do banco de dados
        migrations.RunSQL(
            sql="",
            reverse_sql="",
            elidable=True,
        ),
    ]
```

### core\migrations\0010_acolyte_scheduling_mode.py
```python
# Generated by Django 5.0.7 on 2026-01-23 08:32

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0009_add_moved_to_another_slot_end_reason'),
    ]

    operations = [
        migrations.AddField(
            model_name='acolyteprofile',
            name='scheduling_mode',
            field=models.CharField(choices=[('normal', 'Normal'), ('reserve', 'Reserva tecnica')], default='normal', max_length=20),
        ),
        migrations.AlterField(
            model_name='acolyteavailabilityrule',
            name='rule_type',
            field=models.CharField(choices=[('unavailable', 'Indisponivel'), ('available_only', 'Disponivel apenas')], max_length=20),
        ),
        migrations.AlterField(
            model_name='acolytecreditledger',
            name='reason_code',
            field=models.CharField(choices=[('served_unpopular_slot', 'Serviu em horario pouco procurado'), ('accepted_last_minute_substitution', 'Aceitou substituicao de ultima hora'), ('high_attendance_streak', 'Boa sequencia de presencas'), ('received_high_demand_assignment', 'Recebeu funcao disputada')], max_length=40),
        ),
        migrations.AlterField(
            model_name='acolyteintent',
            name='willingness_level',
            field=models.CharField(choices=[('low', 'Baixo'), ('normal', 'Normal'), ('high', 'Alto')], default='normal', max_length=10),
        ),
        migrations.AlterField(
            model_name='acolytepreference',
            name='preference_type',
            field=models.CharField(choices=[('preferred_community', 'Preferir comunidade'), ('avoid_community', 'Evitar comunidade'), ('preferred_timeslot', 'Preferir horario'), ('preferred_mass_template', 'Preferir modelo'), ('preferred_position', 'Preferir funcao'), ('avoid_position', 'Evitar funcao'), ('preferred_function', 'Preferir funcao base'), ('avoid_function', 'Evitar funcao base'), ('preferred_partner', 'Preferir parceiro'), ('avoid_partner', 'Evitar parceiro')], max_length=40),
        ),
        migrations.AlterField(
            model_name='acolyteprofile',
            name='experience_level',
            field=models.CharField(choices=[('beginner', 'Iniciante'), ('intermediate', 'Intermediario'), ('senior', 'Senior')], default='intermediate', max_length=20),
        ),
        migrations.AlterField(
            model_name='assignment',
            name='assignment_state',
            field=models.CharField(choices=[('proposed', 'Proposta'), ('published', 'Publicada'), ('locked', 'Consolidada')], default='proposed', max_length=20),
        ),
        migrations.AlterField(
            model_name='assignment',
            name='end_reason',
            field=models.CharField(blank=True, choices=[('declined', 'Recusado'), ('canceled', 'Cancelado'), ('replaced', 'Substituido'), ('replaced_by_solver', 'Substituido pelo sistema'), ('manual_unassign', 'Removido manualmente'), ('moved_to_another_slot', 'Movido para outra posicao'), ('swap', 'Trocado')], max_length=30),
        ),
        migrations.AlterField(
            model_name='assignmentslot',
            name='status',
            field=models.CharField(choices=[('open', 'Aberta'), ('assigned', 'Atribuida'), ('finalized', 'Finalizada')], default='open', max_length=20),
        ),
        migrations.AlterField(
            model_name='confirmation',
            name='status',
            field=models.CharField(choices=[('pending', 'Pendente'), ('confirmed', 'Confirmada'), ('declined', 'Recusada'), ('canceled_by_acolyte', 'Cancelada'), ('replaced', 'Substituida'), ('no_show', 'Nao compareceu')], default='pending', max_length=30),
        ),
        migrations.AlterField(
            model_name='eventoccurrence',
            name='conflict_action',
            field=models.CharField(choices=[('keep', 'Manter existente'), ('cancel_existing', 'Cancelar existente'), ('move_existing', 'Mover existente'), ('skip', 'Ignorar')], default='keep', max_length=20),
        ),
        migrations.AlterField(
            model_name='eventseries',
            name='candidate_pool',
            field=models.CharField(choices=[('all', 'Todos'), ('interested_only', 'Somente interessados')], default='all', max_length=20),
        ),
        migrations.AlterField(
            model_name='massinstance',
            name='status',
            field=models.CharField(choices=[('scheduled', 'Agendada'), ('canceled', 'Cancelada')], default='scheduled', max_length=20),
        ),
        migrations.AlterField(
            model_name='massoverride',
            name='override_type',
            field=models.CharField(choices=[('cancel_instance', 'Cancelar missa'), ('move_instance', 'Mover missa'), ('change_requirements', 'Alterar requisitos'), ('change_display_fields', 'Alterar exibicao')], max_length=40),
        ),
        migrations.AlterField(
            model_name='replacementrequest',
            name='resolved_reason',
            field=models.CharField(blank=True, choices=[('mass_canceled', 'Missa cancelada'), ('slot_not_required', 'Funcao nao necessaria'), ('covered_externally', 'Coberto externamente'), ('other', 'Outro')], max_length=30),
        ),
        migrations.AlterField(
            model_name='replacementrequest',
            name='status',
            field=models.CharField(choices=[('pending', 'Pendente'), ('assigned', 'Atribuida'), ('canceled', 'Cancelada'), ('resolved', 'Resolvida')], default='pending', max_length=20),
        ),
        migrations.AlterField(
            model_name='swaprequest',
            name='status',
            field=models.CharField(choices=[('pending', 'Pendente'), ('awaiting_approval', 'Aguardando aprovacao'), ('accepted', 'Aceita'), ('rejected', 'Recusada'), ('canceled', 'Cancelada')], default='pending', max_length=20),
        ),
        migrations.AlterField(
            model_name='swaprequest',
            name='swap_type',
            field=models.CharField(choices=[('acolyte_swap', 'Troca de acolito'), ('role_swap', 'Troca de funcao')], max_length=20),
        ),
    ]
```

### core\migrations\0011_add_manual_adjustment_reason.py
```python
# Generated manually

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0010_acolyte_scheduling_mode'),
    ]

    operations = [
        migrations.AlterField(
            model_name='acolytecreditledger',
            name='reason_code',
            field=models.CharField(
                choices=[
                    ('served_unpopular_slot', 'Serviu em horario pouco procurado'),
                    ('accepted_last_minute_substitution', 'Aceitou substituicao de ultima hora'),
                    ('high_attendance_streak', 'Boa sequencia de presencas'),
                    ('received_high_demand_assignment', 'Recebeu funcao disputada'),
                    ('manual_adjustment', 'Ajuste manual'),
                ],
                max_length=40
            ),
        ),
        migrations.AddField(
            model_name='acolytecreditledger',
            name='notes',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='acolytecreditledger',
            name='created_by',
            field=models.ForeignKey(
                null=True,
                blank=True,
                on_delete=models.SET_NULL,
                to='accounts.user',
            ),
        ),
    ]
```

### core\migrations\0012_add_swap_group_id.py
```python
# Generated by Django 5.0.7 on 2026-01-23 13:08

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0011_add_manual_adjustment_reason'),
    ]

    operations = [
        migrations.AddField(
            model_name='swaprequest',
            name='group_id',
            field=models.UUIDField(blank=True, db_index=True, null=True),
        ),
    ]
```

### core\migrations\0013_mass_interest.py
```python
# Generated by Django 5.0.7 on 2026-01-24 00:00

from collections import defaultdict

import django.db.models.deletion
from django.db import migrations, models


def forward_fill_mass_interests(apps, schema_editor):
    EventInterest = apps.get_model("core", "EventInterest")
    MassInstance = apps.get_model("core", "MassInstance")
    MassInterest = apps.get_model("core", "MassInterest")

    interested_entries = EventInterest.objects.filter(interested=True)
    if not interested_entries.exists():
        return

    series_ids = list(interested_entries.values_list("event_series_id", flat=True).distinct())
    masses_by_series = defaultdict(list)
    for mass_id, series_id, parish_id in MassInstance.objects.filter(event_series_id__in=series_ids).values_list(
        "id", "event_series_id", "parish_id"
    ):
        masses_by_series[series_id].append((mass_id, parish_id))

    bulk = []
    for interest in interested_entries.iterator():
        for mass_id, parish_id in masses_by_series.get(interest.event_series_id, []):
            bulk.append(
                MassInterest(
                    parish_id=parish_id,
                    mass_instance_id=mass_id,
                    acolyte_id=interest.acolyte_id,
                    interested=True,
                )
            )
    if bulk:
        MassInterest.objects.bulk_create(bulk, ignore_conflicts=True)


class Migration(migrations.Migration):

    dependencies = [
        ("core", "0012_add_swap_group_id"),
    ]

    operations = [
        migrations.CreateModel(
            name="MassInterest",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("interested", models.BooleanField(default=True)),
                ("notes", models.TextField(blank=True)),
                ("acolyte", models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to="core.acolyteprofile")),
                ("mass_instance", models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to="core.massinstance")),
                ("parish", models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to="core.parish")),
            ],
            options={
                "unique_together": {("mass_instance", "acolyte")},
            },
        ),
        migrations.RunPython(forward_fill_mass_interests, migrations.RunPython.noop),
    ]
```

### core\migrations\0014_position_claim_request.py
```python
# Generated by OpenCode on 2026-01-24

from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("core", "0013_mass_interest"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name="parish",
            name="claim_auto_approve_enabled",
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name="parish",
            name="claim_auto_approve_hours",
            field=models.PositiveIntegerField(default=48),
        ),
        migrations.AddField(
            model_name="parish",
            name="claim_require_coordination",
            field=models.BooleanField(default=False),
        ),
        migrations.CreateModel(
            name="PositionClaimRequest",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending_target", "Aguardando titular"),
                            ("pending_coordination", "Aguardando coordenacao"),
                            ("scheduled_auto_approve", "Aguardando prazo"),
                            ("approved", "Aprovada"),
                            ("rejected", "Recusada"),
                            ("expired", "Expirada"),
                        ],
                        default="pending_target",
                        max_length=30,
                    ),
                ),
                (
                    "approval_mode",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("target", "Titular"),
                            ("coordination", "Coordenacao"),
                            ("auto", "Automatica"),
                        ],
                        max_length=30,
                    ),
                ),
                (
                    "resolution_reason",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("holder_approved", "Titular aprovou"),
                            ("holder_confirmed", "Titular confirmou"),
                            ("holder_rejected", "Titular recusou"),
                            ("holder_selected_other", "Outro solicitante escolhido"),
                            ("coordination_approved", "Aprovada pela coordenacao"),
                            ("coordination_rejected", "Recusada pela coordenacao"),
                            ("auto_approved", "Aprovada pelo prazo"),
                            ("auto_expired", "Expirada pelo prazo"),
                            ("requestor_canceled", "Cancelada pelo solicitante"),
                            ("assignment_changed", "Escala alterada"),
                        ],
                        max_length=40,
                    ),
                ),
                ("auto_approve_at", models.DateTimeField(blank=True, null=True)),
                ("resolved_at", models.DateTimeField(blank=True, null=True)),
                (
                    "approved_by",
                    models.ForeignKey(blank=True, null=True, on_delete=models.SET_NULL, to=settings.AUTH_USER_MODEL),
                ),
                (
                    "parish",
                    models.ForeignKey(on_delete=models.CASCADE, to="core.parish"),
                ),
                (
                    "requestor_acolyte",
                    models.ForeignKey(on_delete=models.CASCADE, related_name="position_claim_requests", to="core.acolyteprofile"),
                ),
                (
                    "slot",
                    models.ForeignKey(on_delete=models.CASCADE, related_name="position_claims", to="core.assignmentslot"),
                ),
                (
                    "target_assignment",
                    models.ForeignKey(blank=True, null=True, on_delete=models.SET_NULL, related_name="position_claims", to="core.assignment"),
                ),
            ],
        ),
        migrations.AddIndex(
            model_name="positionclaimrequest",
            index=models.Index(fields=["slot", "status"], name="core_positi_slot_id_6a0f4c_idx"),
        ),
        migrations.AddIndex(
            model_name="positionclaimrequest",
            index=models.Index(fields=["requestor_acolyte", "status"], name="core_positi_reques_0f3c65_idx"),
        ),
    ]
```

### core\migrations\0015_rename_core_positi_slot_id_6a0f4c_idx_core_positi_slot_id_5cc0fb_idx_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-24 13:07

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0014_position_claim_request'),
    ]

    operations = [
        migrations.RenameIndex(
            model_name='positionclaimrequest',
            new_name='core_positi_slot_id_5cc0fb_idx',
            old_name='core_positi_slot_id_6a0f4c_idx',
        ),
        migrations.RenameIndex(
            model_name='positionclaimrequest',
            new_name='core_positi_request_e0c581_idx',
            old_name='core_positi_reques_0f3c65_idx',
        ),
        migrations.AlterField(
            model_name='assignment',
            name='end_reason',
            field=models.CharField(blank=True, choices=[('declined', 'Recusado'), ('canceled', 'Cancelado'), ('replaced', 'Substituido'), ('replaced_by_solver', 'Substituido pelo sistema'), ('manual_unassign', 'Removido manualmente'), ('moved_to_another_slot', 'Movido para outra posicao'), ('swap', 'Trocado'), ('claim_transfer', 'Transferido por solicitacao')], max_length=30),
        ),
    ]
```

### core\migrations\0016_eventseries_interest_deadline_at.py
```python
# Generated by Django 5.0.7 on 2026-01-27 08:04

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0015_rename_core_positi_slot_id_6a0f4c_idx_core_positi_slot_id_5cc0fb_idx_and_more'),
    ]

    operations = [
        migrations.AddField(
            model_name='eventseries',
            name='interest_deadline_at',
            field=models.DateTimeField(blank=True, null=True),
        ),
    ]
```

### core\services\acolytes.py
```python
from datetime import timedelta

from django.utils import timezone

from core.models import Assignment
from core.services.assignments import deactivate_assignment
from core.services.replacements import create_replacement_request, should_create_replacement


def deactivate_future_assignments_for_acolyte(acolyte, actor=None, now=None):
    if not acolyte:
        return 0
    now = now or timezone.now()
    parish = acolyte.parish
    assignments = (
        Assignment.objects.filter(
            parish=parish,
            acolyte=acolyte,
            is_active=True,
            slot__mass_instance__starts_at__gt=now,
            slot__mass_instance__status="scheduled",
        )
        .select_related("slot__mass_instance", "slot")
        .order_by("slot__mass_instance__starts_at")
    )
    count = assignments.count()
    for assignment in assignments:
        slot = assignment.slot
        deactivate_assignment(assignment, "manual_unassign", actor=actor)
        if slot.required and not slot.externally_covered:
            slot.status = "open"
            slot.save(update_fields=["status", "updated_at"])
            if should_create_replacement(parish, slot, now=now):
                create_replacement_request(parish, slot, actor=actor, notes="Acolito desativado")
    return count
```

### core\services\assignments.py
```python
from django.db import IntegrityError, connection, transaction
from django.utils import timezone

from core.models import Assignment, AssignmentSlot, Confirmation
from core.services.audit import log_audit


class ConcurrentUpdateError(RuntimeError):
    pass


def _ensure_same_parish(slot, acolyte):
    if slot.parish_id != acolyte.parish_id:
        raise ValueError("Paroquia invalida para atribuicao.")


def _lock_slot(slot_id):
    qs = AssignmentSlot.objects
    if connection.features.has_select_for_update:
        qs = qs.select_for_update()
    return qs.select_related("mass_instance").get(id=slot_id)


def _assign_acolyte_to_slot_locked(
    slot,
    acolyte,
    actor=None,
    assignment_state="proposed",
    end_reason="replaced",
    create_confirmation=False,
):
    _ensure_same_parish(slot, acolyte)
    current = slot.get_active_assignment()
    if current and current.acolyte_id == acolyte.id:
        return current
    if current:
        deactivate_assignment(current, end_reason, actor=actor)
    try:
        assignment = create_assignment(slot, acolyte, actor=actor, assignment_state=assignment_state)
    except IntegrityError:
        existing = Assignment.objects.filter(slot=slot, is_active=True).first()
        if existing and existing.acolyte_id == acolyte.id:
            return existing
        raise ConcurrentUpdateError("Slot atualizado por outra acao.")
    if create_confirmation:
        Confirmation.objects.get_or_create(parish=slot.parish, assignment=assignment)
    return assignment


def deactivate_assignment(assignment, reason, actor=None):
    if not assignment or not assignment.is_active:
        return assignment
    assignment.is_active = False
    assignment.ended_at = timezone.now()
    assignment.end_reason = reason
    assignment.save(update_fields=["is_active", "ended_at", "end_reason", "updated_at"])
    log_audit(
        assignment.parish,
        actor,
        "Assignment",
        assignment.id,
        "deactivate",
        {"reason": reason, "slot_id": assignment.slot_id},
    )
    if reason != "claim_transfer":
        from core.services.claims import expire_claims_for_assignment

        expire_claims_for_assignment(assignment, "assignment_changed", actor=actor)
    return assignment


def create_assignment(slot, acolyte, actor=None, assignment_state="proposed"):
    assignment = Assignment.objects.create(
        parish=slot.parish,
        slot=slot,
        acolyte=acolyte,
        assigned_by=actor,
        assignment_state=assignment_state,
    )
    log_audit(
        slot.parish,
        actor,
        "Assignment",
        assignment.id,
        "create",
        {"acolyte_id": acolyte.id, "slot_id": slot.id},
    )
    return assignment


def assign_acolyte_to_slot(
    slot,
    acolyte,
    actor=None,
    assignment_state="proposed",
    end_reason="replaced",
    create_confirmation=False,
):
    with transaction.atomic():
        locked_slot = _lock_slot(slot.id)
        return _assign_acolyte_to_slot_locked(
            locked_slot,
            acolyte,
            actor=actor,
            assignment_state=assignment_state,
            end_reason=end_reason,
            create_confirmation=create_confirmation,
        )


def _validate_no_conflict_in_mass(slot, acolyte):
    from core.models import Assignment
    existing_assignments = Assignment.objects.filter(
        slot__mass_instance=slot.mass_instance,
        acolyte=acolyte,
        is_active=True
    ).exclude(slot=slot).select_related("slot__position_type")
    if existing_assignments.exists():
        current_slot = existing_assignments.first().slot
        raise ValueError(
            f"O acólito {acolyte.display_name} já está atribuído à posição {current_slot.position_type.name} nesta missa.",
            "conflict",
            current_slot
        )


def move_acolyte_to_slot(current_slot, new_slot, acolyte, actor=None):
    with transaction.atomic():
        # Valida se o acólito está no current_slot
        current_assignment = current_slot.assignments.filter(acolyte=acolyte, is_active=True).first()
        if not current_assignment:
            raise ValueError("Acólito não está atribuído ao slot atual.")

        # Desativa a atribuição anterior
        deactivate_assignment(current_assignment, "moved_to_another_slot", actor=actor)

        # Atribui ao novo slot
        return assign_manual(new_slot, acolyte, actor=actor)


def assign_manual(slot, acolyte, actor=None):
    _validate_no_conflict_in_mass(slot, acolyte)
    with transaction.atomic():
        locked_slot = _lock_slot(slot.id)
        assignment_state = "locked" if locked_slot.is_locked else "published"
        assignment = _assign_acolyte_to_slot_locked(
            locked_slot,
            acolyte,
            actor=actor,
            assignment_state=assignment_state,
            end_reason="manual_unassign",
            create_confirmation=True,
        )
        locked_slot.status = "finalized" if locked_slot.is_locked else "assigned"
        locked_slot.save(update_fields=["status", "updated_at"])
        log_audit(
            locked_slot.parish,
            actor,
            "Assignment",
            assignment.id,
            "manual_assign",
            {"slot_id": locked_slot.id, "acolyte_id": acolyte.id},
        )
        return assignment
```

### core\services\audit.py
```python
from core.models import AuditEvent


def log_audit(parish, actor, entity_type, entity_id, action_type, diff=None):
    AuditEvent.objects.create(
        parish=parish,
        actor_user=actor,
        entity_type=entity_type,
        entity_id=str(entity_id),
        action_type=action_type,
        diff_json=diff or {},
    )
```

### core\services\availability.py
```python
from collections import defaultdict

from core.models import AcolyteAvailabilityRule


def _is_valid_interval(rule):
    if rule.start_time and rule.end_time:
        return rule.start_time < rule.end_time
    return True


def _time_matches(rule, mass_time):
    if not rule.start_time and not rule.end_time:
        return True
    if rule.start_time and rule.end_time:
        if rule.start_time >= rule.end_time:
            return False
        return rule.start_time <= mass_time < rule.end_time
    if rule.start_time:
        return mass_time >= rule.start_time
    return mass_time < rule.end_time


def _rule_applies(rule, mass_instance):
    start = mass_instance.starts_at
    if rule.start_date and start.date() < rule.start_date:
        return False
    if rule.end_date and start.date() > rule.end_date:
        return False
    if rule.day_of_week is not None and start.weekday() != rule.day_of_week:
        return False
    if rule.community and rule.community_id != mass_instance.community_id:
        return False
    if not _time_matches(rule, start.time()):
        return False
    return True


def _split_rules(rules):
    unavailable_rules = []
    available_only_rules = []
    for rule in rules:
        if not _is_valid_interval(rule):
            continue
        if rule.rule_type == "unavailable":
            unavailable_rules.append(rule)
        elif rule.rule_type == "available_only":
            available_only_rules.append(rule)
    return unavailable_rules, available_only_rules


def group_rules_by_acolyte(rules):
    rules_by_acolyte = defaultdict(list)
    for rule in rules:
        rules_by_acolyte[rule.acolyte_id].append(rule)
    return rules_by_acolyte


def is_acolyte_available_with_rules(rules, mass_instance):
    unavailable_rules, available_only_rules = _split_rules(rules)

    if any(_rule_applies(rule, mass_instance) for rule in unavailable_rules):
        return False

    if available_only_rules:
        return any(_rule_applies(rule, mass_instance) for rule in available_only_rules)

    return True


def is_acolyte_available(acolyte, mass_instance):
    rules = list(AcolyteAvailabilityRule.objects.filter(acolyte=acolyte, parish=acolyte.parish))
    return is_acolyte_available_with_rules(rules, mass_instance)
```

### core\services\calendar_generation.py
```python
from datetime import datetime, timedelta

from dateutil import rrule
from django.utils import timezone

from core.models import MassInstance, MassTemplate
from core.services.audit import log_audit
from core.services.slots import sync_slots_for_instance


def generate_instances_for_parish(parish, start_date, end_date, actor=None):
    templates = MassTemplate.objects.filter(parish=parish, active=True)
    created = []
    for template in templates:
        if template.rrule_text:
            rule = rrule.rrulestr(template.rrule_text, dtstart=datetime.combine(start_date, template.time))
            occurrences = rule.between(datetime.combine(start_date, template.time), datetime.combine(end_date, template.time), inc=True)
        else:
            occurrences = []
            current = start_date
            while current <= end_date:
                if current.weekday() == template.weekday:
                    occurrences.append(datetime.combine(current, template.time))
                current += timedelta(days=1)
        for occ in occurrences:
            starts_at = timezone.make_aware(occ)
            existing = MassInstance.objects.filter(
                parish=parish,
                community=template.community,
                starts_at=starts_at,
                status="scheduled",
            ).first()
            if existing:
                continue
            instance = MassInstance.objects.create(
                parish=parish,
                community=template.community,
                starts_at=starts_at,
                template=template,
                requirement_profile=template.default_requirement_profile,
                status="scheduled",
                created_by=actor,
                updated_by=actor,
            )
            created.append(instance)
            log_audit(parish, actor, "MassInstance", instance.id, "create", {"template_id": template.id})
            sync_slots_for_instance(instance)
    return created
```

### core\services\claims.py
```python
from collections import defaultdict
from datetime import timedelta

from django.db import transaction
from django.utils import timezone

from core.models import AcolyteQualification, PositionClaimRequest
from core.services.assignments import _lock_slot, _assign_acolyte_to_slot_locked
from core.services.audit import log_audit
from core.services.availability import is_acolyte_available
from core.services.assignments import _validate_no_conflict_in_mass
from core.services.permissions import ADMIN_ROLE_CODES, users_with_roles
from notifications.services import enqueue_notification


PENDING_STATUSES = {"pending_target", "scheduled_auto_approve", "pending_coordination"}


def _is_qualified(parish, acolyte, position_type):
    return AcolyteQualification.objects.filter(
        parish=parish, acolyte=acolyte, position_type=position_type, qualified=True
    ).exists()


def _get_auto_approve_at(parish, slot):
    if not parish.claim_auto_approve_enabled:
        return None
    hours = int(parish.claim_auto_approve_hours or 0)
    if hours <= 0:
        return None
    return slot.mass_instance.starts_at - timedelta(hours=hours)


def create_position_claim(parish, slot, requestor, actor=None):
    if slot.parish_id != parish.id:
        return None, "Paroquia invalida."
    if slot.mass_instance.status != "scheduled":
        return None, "Missa cancelada."
    assignment = slot.get_active_assignment()
    if not assignment:
        return None, "Nao ha acolito atribuido para solicitar."
    if assignment.acolyte_id == requestor.id:
        return None, "Voce ja esta nesta posicao."
    if not _is_qualified(parish, requestor, slot.position_type):
        return None, "Voce nao esta qualificado para esta funcao."
    if not is_acolyte_available(requestor, slot.mass_instance):
        return None, "Voce nao esta disponivel para esta missa."
    try:
        _validate_no_conflict_in_mass(slot, requestor)
    except ValueError:
        return None, "Voce ja esta escalado nesta missa."

    existing = PositionClaimRequest.objects.filter(
        parish=parish,
        slot=slot,
        requestor_acolyte=requestor,
        status__in=PENDING_STATUSES,
    ).exists()
    if existing:
        return None, "Solicitacao ja registrada."

    auto_approve_at = None
    status = "pending_target"
    confirmation = getattr(assignment, "confirmation", None)
    if confirmation is None or confirmation.status != "confirmed":
        auto_approve_at = _get_auto_approve_at(parish, slot)
        if auto_approve_at:
            status = "scheduled_auto_approve"
            if auto_approve_at <= timezone.now():
                auto_approve_at = timezone.now()

    claim = PositionClaimRequest.objects.create(
        parish=parish,
        slot=slot,
        requestor_acolyte=requestor,
        target_assignment=assignment,
        status=status,
        auto_approve_at=auto_approve_at,
    )
    log_audit(parish, actor, "PositionClaimRequest", claim.id, "create", {
        "slot_id": slot.id,
        "requestor_id": requestor.id,
    })
    if assignment.acolyte.user:
        enqueue_notification(
            parish,
            assignment.acolyte.user,
            "POSITION_CLAIM_REQUESTED",
            {"claim_id": claim.id},
            idempotency_key=f"claim:{claim.id}:requested",
        )
    return claim, None


def reject_claim(claim, actor=None, reason="holder_rejected", approval_mode="target"):
    if claim.status not in PENDING_STATUSES:
        return False
    claim.status = "rejected"
    claim.resolution_reason = reason
    claim.resolved_at = timezone.now()
    claim.approval_mode = approval_mode
    claim.approved_by = actor
    claim.save(update_fields=[
        "status",
        "resolution_reason",
        "resolved_at",
        "approval_mode",
        "approved_by",
        "updated_at",
    ])
    log_audit(claim.parish, actor, "PositionClaimRequest", claim.id, "reject", {"reason": reason})
    if claim.requestor_acolyte.user:
        enqueue_notification(
            claim.parish,
            claim.requestor_acolyte.user,
            "POSITION_CLAIM_REJECTED",
            {"claim_id": claim.id},
            idempotency_key=f"claim:{claim.id}:rejected",
        )
    return True


def expire_claims_for_assignment(assignment, reason, actor=None, exclude_claim_id=None):
    if not assignment:
        return 0
    claims = PositionClaimRequest.objects.filter(
        parish=assignment.parish,
        slot=assignment.slot,
        status__in=PENDING_STATUSES,
    )
    if exclude_claim_id:
        claims = claims.exclude(id=exclude_claim_id)
    now = timezone.now()
    updated = claims.update(
        status="expired",
        resolution_reason=reason,
        resolved_at=now,
        updated_at=now,
    )
    if updated:
        log_audit(
            assignment.parish,
            actor,
            "PositionClaimRequest",
            assignment.slot_id,
            "expire",
            {"reason": reason, "count": updated},
        )
    return updated


def _resolve_other_claims(claim, actor=None, status="rejected", reason="holder_selected_other"):
    claims = PositionClaimRequest.objects.filter(
        parish=claim.parish,
        slot=claim.slot,
        status__in=PENDING_STATUSES,
    ).exclude(id=claim.id)
    now = timezone.now()
    count = claims.update(
        status=status,
        resolution_reason=reason,
        resolved_at=now,
        updated_at=now,
    )
    if count:
        log_audit(
            claim.parish,
            actor,
            "PositionClaimRequest",
            claim.slot_id,
            "resolve_others",
            {"count": count, "status": status, "reason": reason},
        )
    return count


def choose_claim(claim, actor=None, require_coordination=False):
    if claim.status not in PENDING_STATUSES:
        return False
    if require_coordination:
        claim.status = "pending_coordination"
        claim.approval_mode = "coordination"
        claim.auto_approve_at = None
        claim.save(update_fields=["status", "approval_mode", "auto_approve_at", "updated_at"])
        _resolve_other_claims(claim, actor=actor)
        log_audit(claim.parish, actor, "PositionClaimRequest", claim.id, "select", {"mode": "coordination"})
        for user in users_with_roles(claim.parish, ADMIN_ROLE_CODES):
            enqueue_notification(
                claim.parish,
                user,
                "POSITION_CLAIM_COORDINATION_REQUIRED",
                {"claim_id": claim.id},
                idempotency_key=f"claim:{claim.id}:coordination:{user.id}",
            )
        return True
    return approve_claim(
        claim,
        actor=actor,
        approval_mode="target",
        resolution_reason="holder_approved",
        other_status="rejected",
        other_reason="holder_selected_other",
    )


def approve_claim(
    claim,
    actor=None,
    approval_mode="target",
    resolution_reason="coordination_approved",
    other_status=None,
    other_reason=None,
):
    if claim.status not in PENDING_STATUSES:
        return False
    parish = claim.parish
    requestor = claim.requestor_acolyte
    with transaction.atomic():
        locked_slot = _lock_slot(claim.slot_id)
        assignment = locked_slot.get_active_assignment()
        if not assignment:
            expire_claims_for_assignment(claim.target_assignment, "assignment_changed", actor=actor)
            return False
        if claim.target_assignment_id and assignment.id != claim.target_assignment_id:
            expire_claims_for_assignment(assignment, "assignment_changed", actor=actor)
            return False
        if not _is_qualified(parish, requestor, locked_slot.position_type):
            reject_claim(claim, actor=actor, reason="holder_rejected")
            return False
        if not is_acolyte_available(requestor, locked_slot.mass_instance):
            reject_claim(claim, actor=actor, reason="holder_rejected")
            return False
        try:
            _validate_no_conflict_in_mass(locked_slot, requestor)
        except ValueError:
            reject_claim(claim, actor=actor, reason="holder_rejected")
            return False

        new_assignment = _assign_acolyte_to_slot_locked(
            locked_slot,
            requestor,
            actor=actor,
            assignment_state=assignment.assignment_state,
            end_reason="claim_transfer",
            create_confirmation=True,
        )

        claim.status = "approved"
        claim.approval_mode = approval_mode
        claim.resolution_reason = resolution_reason
        claim.resolved_at = timezone.now()
        claim.approved_by = actor
        claim.auto_approve_at = None
        claim.target_assignment = assignment
        claim.save(update_fields=[
            "status",
            "approval_mode",
            "resolution_reason",
            "resolved_at",
            "approved_by",
            "auto_approve_at",
            "target_assignment",
            "updated_at",
        ])
        if other_status:
            _resolve_other_claims(claim, actor=actor, status=other_status, reason=other_reason or "holder_selected_other")
        log_audit(parish, actor, "PositionClaimRequest", claim.id, "approve", {"assignment_id": new_assignment.id})
        if claim.requestor_acolyte.user:
            enqueue_notification(
                parish,
                claim.requestor_acolyte.user,
                "POSITION_CLAIM_APPROVED",
                {"claim_id": claim.id},
                idempotency_key=f"claim:{claim.id}:approved",
            )
    return True


def cancel_claim(claim, actor=None):
    if claim.status not in PENDING_STATUSES:
        return False
    claim.status = "expired"
    claim.resolution_reason = "requestor_canceled"
    claim.resolved_at = timezone.now()
    claim.save(update_fields=["status", "resolution_reason", "resolved_at", "updated_at"])
    log_audit(claim.parish, actor, "PositionClaimRequest", claim.id, "cancel", {})
    return True


def process_due_claims(parish=None):
    now = timezone.now()
    claims = PositionClaimRequest.objects.filter(
        status="scheduled_auto_approve",
        auto_approve_at__lte=now,
    ).select_related("slot__mass_instance", "target_assignment", "requestor_acolyte")
    if parish:
        claims = claims.filter(parish=parish)

    claims_by_slot = defaultdict(list)
    for claim in claims.order_by("created_at"):
        claims_by_slot[claim.slot_id].append(claim)

    for slot_id, slot_claims in claims_by_slot.items():
        with transaction.atomic():
            locked_slot = _lock_slot(slot_id)
            assignment = locked_slot.get_active_assignment()
            if not assignment:
                for claim in slot_claims:
                    if claim.status in PENDING_STATUSES:
                        claim.status = "expired"
                        claim.resolution_reason = "assignment_changed"
                        claim.resolved_at = now
                        claim.save(update_fields=["status", "resolution_reason", "resolved_at", "updated_at"])
                continue
            confirmation = getattr(assignment, "confirmation", None)
            if confirmation and confirmation.status == "confirmed":
                expire_claims_for_assignment(assignment, "holder_confirmed")
                continue

            selected = slot_claims[0]
            approved = approve_claim(
                selected,
                actor=None,
                approval_mode="auto",
                resolution_reason="auto_approved",
                other_status="expired",
                other_reason="auto_expired",
            )
            if not approved:
                continue
```

### core\services\event_series.py
```python
from datetime import datetime

from django.utils import timezone

from django.db import transaction

from core.models import AuditEvent, EventInterest, EventOccurrence, MassInstance, MassOverride
from core.services.audit import log_audit
from core.services.slots import sync_slots_for_instance


def _build_datetime(date_value, time_value):
    return timezone.make_aware(datetime.combine(date_value, time_value))


def apply_event_occurrences(event_series, occurrences, actor=None):
    created = []
    for occ in occurrences:
        if isinstance(occ, EventOccurrence):
            date_value = occ.date
            time_value = occ.time
            community_id = occ.community_id
            profile_id = occ.requirement_profile_id
            label = occ.label
            conflict_action = occ.conflict_action
            move_to_date = occ.move_to_date
            move_to_time = occ.move_to_time
            move_to_community_id = occ.move_to_community_id
        else:
            date_value = occ["date"]
            time_value = occ["time"]
            community_id = occ["community_id"]
            profile_id = occ.get("requirement_profile_id")
            label = occ.get("label", "")
            conflict_action = occ.get("conflict_action", "keep")
            move_to_date = occ.get("move_to_date")
            move_to_time = occ.get("move_to_time")
            move_to_community_id = occ.get("move_to_community_id")

        if not label:
            label = event_series.title
        starts_at = _build_datetime(date_value, time_value)
        if conflict_action == "skip":
            continue
        existing = MassInstance.objects.filter(
            parish=event_series.parish,
            community_id=community_id,
            starts_at=starts_at,
            status="scheduled",
        ).first()

        if existing and existing.event_series_id == event_series.id:
            updated_fields = []
            if label and existing.liturgy_label != label:
                existing.liturgy_label = label
                updated_fields.append("liturgy_label")
            if profile_id and existing.requirement_profile_id != profile_id:
                existing.requirement_profile_id = profile_id
                updated_fields.append("requirement_profile")
            if updated_fields:
                existing.save(update_fields=updated_fields + ["updated_at"])
                log_audit(event_series.parish, actor, "MassInstance", existing.id, "update", {"event_series_id": event_series.id})
                sync_slots_for_instance(existing)
            continue

        if existing and conflict_action == "keep":
            updated_fields = []
            if existing.event_series_id != event_series.id:
                existing.event_series = event_series
                updated_fields.append("event_series")
            if label and existing.liturgy_label != label:
                existing.liturgy_label = label
                updated_fields.append("liturgy_label")
            if profile_id and existing.requirement_profile_id != profile_id:
                existing.requirement_profile_id = profile_id
                updated_fields.append("requirement_profile")
            if updated_fields:
                existing.save(update_fields=updated_fields + ["updated_at"])
                log_audit(event_series.parish, actor, "MassInstance", existing.id, "update", {"event_series_id": event_series.id})
                sync_slots_for_instance(existing)
            continue

        if existing and conflict_action == "cancel_existing":
            existing.status = "canceled"
            existing.save(update_fields=["status", "updated_at"])
            MassOverride.objects.create(
                parish=event_series.parish,
                instance=existing,
                override_type="cancel_instance",
                payload={"reason": "event_series", "event_series_id": event_series.id},
                created_by=actor,
            )
            log_audit(event_series.parish, actor, "MassInstance", existing.id, "cancel", {"event_series_id": event_series.id})

        if existing and conflict_action == "move_existing":
            if move_to_date and move_to_time and move_to_community_id:
                move_to = _build_datetime(move_to_date, move_to_time)
                conflict = MassInstance.objects.filter(
                    parish=event_series.parish,
                    community_id=move_to_community_id,
                    starts_at=move_to,
                    status="scheduled",
                ).exclude(id=existing.id).exists()
                if conflict:
                    raise ValueError("Conflito ao mover missa existente para o novo horario/comunidade.")
                payload = {
                    "from": {"starts_at": existing.starts_at.isoformat(), "community_id": existing.community_id},
                    "to": {"starts_at": move_to.isoformat(), "community_id": move_to_community_id},
                }
                existing.starts_at = move_to
                existing.community_id = move_to_community_id
                existing.save(update_fields=["starts_at", "community", "updated_at"])
                MassOverride.objects.create(
                    parish=event_series.parish,
                    instance=existing,
                    override_type="move_instance",
                    payload=payload,
                    created_by=actor,
                )
                log_audit(event_series.parish, actor, "MassInstance", existing.id, "move", payload)
            else:
                continue

        instance = MassInstance.objects.create(
            parish=event_series.parish,
            event_series=event_series,
            community_id=community_id,
            starts_at=starts_at,
            liturgy_label=label,
            requirement_profile_id=profile_id,
            status="scheduled",
            created_by=actor,
            updated_by=actor,
        )
        created.append(instance)
        log_audit(event_series.parish, actor, "MassInstance", instance.id, "create", {"event_series_id": event_series.id})
        sync_slots_for_instance(instance)
    return created


def generate_instances_for_event_series(event_series, actor=None):
    rules = event_series.ruleset_json or {}
    days = rules.get("days", [])
    occurrences = []
    for day in days:
        date_str = day.get("date")
        time_str = day.get("time")
        community_id = day.get("community_id") or (event_series.default_community_id)
        profile_id = day.get("requirement_profile_id")
        label = day.get("label", "")
        conflict_action = day.get("conflict_action", "keep")
        move_to_date = day.get("move_to_date")
        move_to_time = day.get("move_to_time")
        move_to_community_id = day.get("move_to_community_id")
        if not (date_str and time_str and community_id):
            continue
        occurrences.append(
            {
                "date": datetime.fromisoformat(date_str).date(),
                "time": datetime.fromisoformat(f"{date_str}T{time_str}").time(),
                "community_id": community_id,
                "requirement_profile_id": profile_id,
                "label": label,
                "conflict_action": conflict_action,
                "move_to_date": datetime.fromisoformat(move_to_date).date() if move_to_date else None,
                "move_to_time": datetime.fromisoformat(f"{move_to_date}T{move_to_time}").time() if move_to_date and move_to_time else None,
                "move_to_community_id": move_to_community_id,
            }
        )
    return apply_event_occurrences(event_series, occurrences, actor=actor)


def delete_event_series_with_masses(parish, series, actor=None):
    if series.parish_id != parish.id:
        raise ValueError("Serie nao pertence a esta paroquia.")
    with transaction.atomic():
        mass_ids = list(
            MassInstance.objects.filter(parish=parish, event_series=series).values_list("id", flat=True)
        )
        slot_ids = []
        assignment_ids = []
        replacement_ids = []
        swap_ids = []
        if mass_ids:
            from core.models import Assignment, AssignmentSlot, ReplacementRequest, SwapRequest

            slot_ids = list(
                AssignmentSlot.objects.filter(parish=parish, mass_instance_id__in=mass_ids).values_list("id", flat=True)
            )
            assignment_ids = list(
                Assignment.objects.filter(parish=parish, slot_id__in=slot_ids).values_list("id", flat=True)
            )
            replacement_ids = list(
                ReplacementRequest.objects.filter(parish=parish, slot_id__in=slot_ids).values_list("id", flat=True)
            )
            swap_ids = list(
                SwapRequest.objects.filter(parish=parish, mass_instance_id__in=mass_ids).values_list("id", flat=True)
            )
            AuditEvent.objects.filter(
                parish=parish,
                entity_type="MassInstance",
                entity_id__in=[str(mass_id) for mass_id in mass_ids],
            ).delete()
            if assignment_ids:
                AuditEvent.objects.filter(
                    parish=parish,
                    entity_type="Assignment",
                    entity_id__in=[str(assignment_id) for assignment_id in assignment_ids],
                ).delete()
            if replacement_ids:
                AuditEvent.objects.filter(
                    parish=parish,
                    entity_type="ReplacementRequest",
                    entity_id__in=[str(req_id) for req_id in replacement_ids],
                ).delete()
            if swap_ids:
                AuditEvent.objects.filter(
                    parish=parish,
                    entity_type="SwapRequest",
                    entity_id__in=[str(swap_id) for swap_id in swap_ids],
                ).delete()
        EventInterest.objects.filter(parish=parish, event_series=series).delete()
        EventOccurrence.objects.filter(parish=parish, event_series=series).delete()
        MassInstance.objects.filter(parish=parish, id__in=mass_ids).delete()
        AuditEvent.objects.filter(parish=parish, entity_type="EventSeries", entity_id=str(series.id)).delete()
        series.delete()
```

### core\services\permissions.py
```python
from functools import wraps

from django.contrib import messages
from django.http import HttpResponseForbidden
from django.shortcuts import redirect

from core.models import ParishMembership

ADMIN_ROLE_CODES = ["PARISH_ADMIN", "ACOLYTE_COORDINATOR", "PASTOR", "SECRETARY"]


def _get_membership_roles(request):
    if hasattr(request, "_parish_roles"):
        return request._parish_roles
    if not request.user.is_authenticated or not request.active_parish:
        request._parish_roles = []
        return request._parish_roles
    membership = ParishMembership.objects.filter(
        user=request.user, parish=request.active_parish, active=True
    ).prefetch_related("roles").first()
    if not membership:
        request._parish_roles = []
        return request._parish_roles
    request._parish_roles = list(membership.roles.values_list("code", flat=True))
    return request._parish_roles


def user_has_role(user, parish, role_codes):
    if user.is_system_admin:
        return True
    membership = ParishMembership.objects.filter(user=user, parish=parish, active=True).first()
    if not membership:
        return False
    return membership.roles.filter(code__in=role_codes).exists()


def request_has_role(request, role_codes):
    if request.user.is_system_admin:
        return True
    roles = _get_membership_roles(request)
    return any(role in roles for role in role_codes)


def users_with_roles(parish, role_codes):
    memberships = (
        ParishMembership.objects.filter(parish=parish, active=True, roles__code__in=role_codes)
        .select_related("user")
        .distinct()
    )
    return [membership.user for membership in memberships]


def require_parish_roles(role_codes):
    def decorator(view_func):
        @wraps(view_func)
        def _wrapped(request, *args, **kwargs):
            if request_has_role(request, role_codes):
                return view_func(request, *args, **kwargs)
            return HttpResponseForbidden("Sem permissao para acessar esta area.")

        return _wrapped

    return decorator


def require_active_parish(view_func):
    @wraps(view_func)
    def _wrapped(request, *args, **kwargs):
        if not getattr(request, "active_parish", None):
            messages.info(request, "Selecione uma paroquia para continuar.")
            return redirect("dashboard")
        return view_func(request, *args, **kwargs)

    return _wrapped
```

### core\services\preferences.py
```python
def preference_score_breakdown(acolyte, mass_instance, slot, preferences):
    total = 0
    community_score = 0
    other_score = 0
    for pref in preferences:
        weight = pref.weight or 0
        if pref.preference_type == "preferred_community" and pref.target_community_id == mass_instance.community_id:
            total += weight
            community_score += weight
        elif pref.preference_type == "avoid_community" and pref.target_community_id == mass_instance.community_id:
            total -= weight
            community_score -= weight
        elif pref.preference_type == "preferred_position" and pref.target_position_id == slot.position_type_id:
            total += weight
            other_score += weight
        elif pref.preference_type == "avoid_position" and pref.target_position_id == slot.position_type_id:
            total -= weight
            other_score -= weight
        elif pref.target_function_id:
            if not hasattr(slot.position_type, "_function_id_cache"):
                slot.position_type._function_id_cache = {fn.id for fn in slot.position_type.functions.all()}
            has_function = pref.target_function_id in slot.position_type._function_id_cache
            if pref.preference_type == "preferred_function" and has_function:
                total += weight
                other_score += weight
            if pref.preference_type == "avoid_function" and has_function:
                total -= weight
                other_score -= weight
        elif pref.preference_type == "preferred_mass_template" and pref.target_template_id == mass_instance.template_id:
            total += weight
            other_score += weight
        elif pref.preference_type == "preferred_timeslot":
            if pref.weekday is not None and pref.weekday != mass_instance.starts_at.weekday():
                continue
            if pref.start_time and mass_instance.starts_at.time() < pref.start_time:
                continue
            if pref.end_time and mass_instance.starts_at.time() >= pref.end_time:
                continue
            total += weight
            other_score += weight
    return {
        "total": total,
        "community": community_score,
        "other": other_score,
    }


def preference_score(acolyte, mass_instance, slot, preferences):
    breakdown = preference_score_breakdown(acolyte, mass_instance, slot, preferences)
    return breakdown["total"]
```

### core\services\publishing.py
```python
from django.db import connection, transaction
from django.utils import timezone

from core.models import Assignment, AssignmentSlot, Confirmation
from core.services.audit import log_audit
from notifications.services import enqueue_notification


ASSIGNMENT_PUBLISHED = "ASSIGNMENT_PUBLISHED"
CONFIRMATION_REQUESTED = "CONFIRMATION_REQUESTED"


def publish_assignments(parish, start_date, end_date, actor=None):
    assignments = (
        Assignment.objects.filter(
            parish=parish,
            slot__mass_instance__starts_at__date__gte=start_date,
            slot__mass_instance__starts_at__date__lte=end_date,
            is_active=True,
        )
        .select_related("slot__mass_instance", "acolyte__user")
        .order_by("slot__mass_instance__starts_at")
    )

    published = 0
    for assignment in assignments:
        with transaction.atomic():
            if connection.features.has_select_for_update:
                assignment = (
                    Assignment.objects.select_for_update()
                    .select_related("slot__mass_instance", "acolyte__user")
                    .get(id=assignment.id)
                )
            updated = Assignment.objects.filter(id=assignment.id, assignment_state="proposed").update(
                assignment_state="published",
                published_at=timezone.now(),
                updated_at=timezone.now(),
            )
            if not updated:
                continue

            published += 1
            slot = assignment.slot
            if connection.features.has_select_for_update:
                slot = AssignmentSlot.objects.select_for_update().get(id=slot.id)
            if slot.status == "open":
                slot.status = "assigned"
                slot.save(update_fields=["status", "updated_at"])
            confirmation, _ = Confirmation.objects.get_or_create(parish=parish, assignment=assignment)
            if confirmation.status == "pending":
                confirmation.updated_by = actor
                confirmation.save(update_fields=["updated_by", "timestamp"])
            log_audit(parish, actor, "Assignment", assignment.id, "publish", {"assignment_id": assignment.id})
            if assignment.acolyte.user:
                enqueue_notification(
                    parish,
                    assignment.acolyte.user,
                    ASSIGNMENT_PUBLISHED,
                    {"assignment_id": assignment.id},
                    idempotency_key=f"publish:{assignment.id}",
                )
                enqueue_notification(
                    parish,
                    assignment.acolyte.user,
                    CONFIRMATION_REQUESTED,
                    {"assignment_id": assignment.id},
                    idempotency_key=f"confirm:{assignment.id}",
                )
    return published
```

### core\services\recommendations.py
```python
from collections import defaultdict
from datetime import timedelta

from django.utils import timezone
from django.db.models import F, Q

from core.models import (
    AcolyteAvailabilityRule,
    AcolytePreference,
    AcolyteQualification,
    AcolyteStats,
    Assignment,
    MassInterest,
)
from core.services.availability import group_rules_by_acolyte, is_acolyte_available_with_rules
from core.services.preferences import preference_score_breakdown


DEFAULT_WEIGHTS = {
    "home_community_bonus": 40,
    "community_recent_penalty": 6,
    "community_recent_window_days": 30,
    "scarcity_bonus": 15,
    "event_series_community_factor": 0.4,
    "single_mass_community_policy": "recurring",
    "interested_pool_fallback": "relax_to_all",
    "interest_deadline_hours": 48,
    "rotation_days": 60,
    "rotation_penalty": 3,
}


def _get_weight(weights, key, default=None):
    if weights and key in weights:
        return weights.get(key)
    if default is not None:
        return default
    return DEFAULT_WEIGHTS.get(key)


def rotation_key_for_mass(instance):
    if instance.event_series_id:
        return ("series", instance.event_series_id)
    if instance.template_id:
        return ("template", instance.template_id)
    return ("community", instance.community_id)


def get_mass_context(mass_instance, weights, interest_map=None, now=None):
    now = now or timezone.now()
    candidate_pool = "all"
    if mass_instance.event_series_id and mass_instance.event_series:
        candidate_pool = getattr(mass_instance.event_series, "candidate_pool", "all")

    pool_ids = set()
    if interest_map is not None:
        pool_ids = set(interest_map.get(mass_instance.id, set()))

    interest_deadline_at = None
    if mass_instance.event_series_id and getattr(mass_instance.event_series, "interest_deadline_at", None):
        interest_deadline_at = mass_instance.event_series.interest_deadline_at
        if timezone.is_naive(interest_deadline_at):
            interest_deadline_at = timezone.make_aware(interest_deadline_at, timezone.get_current_timezone())
    if not interest_deadline_at:
        interest_deadline_hours = int(_get_weight(weights, "interest_deadline_hours", 48) or 0)
        interest_deadline_at = mass_instance.starts_at - timedelta(hours=interest_deadline_hours)
    interest_closed = now >= interest_deadline_at
    fallback = _get_weight(weights, "interested_pool_fallback", "relax_to_all")

    pool_mode = "all"
    if candidate_pool == "interested_only":
        if pool_ids:
            pool_mode = "interested_only"
        else:
            if not interest_closed:
                pool_mode = "empty"
            elif fallback == "relax_to_preferred":
                pool_mode = "preferred_only"
            elif fallback == "strict":
                pool_mode = "empty"
            else:
                pool_mode = "all"

    community_factor = 1.0
    single_policy = _get_weight(weights, "single_mass_community_policy", "recurring")
    if candidate_pool == "interested_only":
        community_factor = 0.0
    elif mass_instance.event_series_id:
        community_factor = float(_get_weight(weights, "event_series_community_factor", 0.4) or 0)
    elif not mass_instance.template_id and single_policy == "special":
        community_factor = float(_get_weight(weights, "event_series_community_factor", 0.4) or 0)

    return {
        "candidate_pool": candidate_pool,
        "pool_ids": pool_ids,
        "pool_mode": pool_mode,
        "interest_closed": interest_closed,
        "interest_deadline_at": interest_deadline_at,
        "community_factor": community_factor,
        "rotation_key": rotation_key_for_mass(mass_instance),
        "is_recurring": bool(mass_instance.template_id),
        "is_special": bool(mass_instance.event_series_id),
        "is_single": not mass_instance.template_id and not mass_instance.event_series_id,
    }


def build_recommendation_cache(parish, slots=None, acolytes=None, now=None):
    now = now or timezone.now()
    weights = parish.schedule_weights or {}
    rotation_days = int(_get_weight(weights, "rotation_days", 60) or 0)
    community_recent_window_days = int(_get_weight(weights, "community_recent_window_days", 30) or 0)

    if acolytes is None:
        acolytes = list(
            parish.acolytes.filter(active=True).select_related("community_of_origin", "family_group")
        )
    else:
        acolytes = list(acolytes)
    acolyte_ids = [acolyte.id for acolyte in acolytes]

    position_type_ids = set()
    mass_instance_ids = set()
    if slots:
        for slot in slots:
            position_type_ids.add(slot.position_type_id)
            mass_instance_ids.add(slot.mass_instance_id)

    qualifications = AcolyteQualification.objects.filter(parish=parish, qualified=True)
    if position_type_ids:
        qualifications = qualifications.filter(position_type_id__in=position_type_ids)

    qualified_by_position = defaultdict(set)
    qualified_pairs = {}
    for qual in qualifications:
        qualified_by_position[qual.position_type_id].add(qual.acolyte_id)
        qualified_pairs[(qual.acolyte_id, qual.position_type_id)] = True

    preferences = AcolytePreference.objects.filter(parish=parish, acolyte_id__in=acolyte_ids)
    pref_by_acolyte = defaultdict(list)
    avoid_communities = defaultdict(set)
    preferred_communities = defaultdict(set)
    for pref in preferences:
        pref_by_acolyte[pref.acolyte_id].append(pref)
        if pref.preference_type == "avoid_community" and pref.target_community_id:
            avoid_communities[pref.acolyte_id].add(pref.target_community_id)
        if pref.preference_type == "preferred_community" and pref.target_community_id:
            preferred_communities[pref.acolyte_id].add(pref.target_community_id)

    stats_map = {stat.acolyte_id: stat for stat in AcolyteStats.objects.filter(parish=parish)}
    availability_rules = AcolyteAvailabilityRule.objects.filter(parish=parish, acolyte_id__in=acolyte_ids)
    rules_by_acolyte = group_rules_by_acolyte(availability_rules)

    interest_map = defaultdict(set)
    if mass_instance_ids:
        for interest in MassInterest.objects.filter(parish=parish, interested=True, mass_instance_id__in=mass_instance_ids):
            interest_map[interest.mass_instance_id].add(interest.acolyte_id)

    starts = [slot.mass_instance.starts_at for slot in slots] if slots else []
    if starts:
        min_start = min(starts)
        max_start = max(starts)
    else:
        min_start = now
        max_start = now + timedelta(days=getattr(parish, "horizon_days", 60))

    buffer_days = max(rotation_days, community_recent_window_days, 60)
    window_start = min_start - timedelta(days=buffer_days)
    window_end = max_start + timedelta(days=buffer_days)

    assignments = (
        Assignment.objects.filter(
            parish=parish,
            is_active=True,
            assignment_state__in=["proposed", "published", "locked"],
            slot__mass_instance__starts_at__gte=window_start,
            slot__mass_instance__starts_at__lte=window_end,
            slot__mass_instance__status="scheduled",
        )
        .select_related("slot__mass_instance")
    )

    assignments_by_acolyte = defaultdict(list)
    weekly_counts_by_acolyte = defaultdict(lambda: defaultdict(int))
    weekend_dates_by_acolyte = defaultdict(set)
    rotation_assignment_times = defaultdict(list)
    community_assignment_times = defaultdict(list)

    for assignment in assignments:
        start = assignment.slot.mass_instance.starts_at
        acolyte_id = assignment.acolyte_id
        assignments_by_acolyte[acolyte_id].append(start)

        week_key = start.isocalendar()[:2]
        weekly_counts_by_acolyte[acolyte_id][week_key] += 1

        weekday = start.weekday()
        if weekday in (5, 6):
            weekend_date = start.date()
            if weekday == 6:
                weekend_date = weekend_date - timedelta(days=1)
            weekend_dates_by_acolyte[acolyte_id].add(weekend_date)

        rotation_key = rotation_key_for_mass(assignment.slot.mass_instance)
        rotation_assignment_times[(acolyte_id, rotation_key)].append(start)
        community_assignment_times[(acolyte_id, assignment.slot.mass_instance.community_id)].append(start)

    for key, times in rotation_assignment_times.items():
        times.sort()
    for key, times in community_assignment_times.items():
        times.sort()
    for acolyte_id, times in assignments_by_acolyte.items():
        times.sort()

    return {
        "acolytes": acolytes,
        "qualified_by_position": qualified_by_position,
        "qualified_pairs": qualified_pairs,
        "pref_by_acolyte": pref_by_acolyte,
        "avoid_communities": avoid_communities,
        "preferred_communities": preferred_communities,
        "stats_map": stats_map,
        "rules_by_acolyte": rules_by_acolyte,
        "interest_map": interest_map,
        "assignments_by_acolyte": assignments_by_acolyte,
        "weekly_counts_by_acolyte": weekly_counts_by_acolyte,
        "weekend_dates_by_acolyte": weekend_dates_by_acolyte,
        "rotation_assignment_times": rotation_assignment_times,
        "community_assignment_times": community_assignment_times,
        "now": now,
        "weights": weights,
    }


def _count_within_window(times, window_start, window_end):
    if not times:
        return 0
    count = 0
    for ts in times:
        if ts < window_start:
            continue
        if ts > window_end:
            break
        count += 1
    return count


def _has_recent_rotation(times, window_start, window_end):
    if not times:
        return False
    for ts in times:
        if ts < window_start:
            continue
        if ts > window_end:
            break
        return True
    return False


def _would_exceed_consecutive_weekends(existing_weekends, weekend_date, max_consecutive):
    if not weekend_date or not max_consecutive:
        return False
    if weekend_date in existing_weekends:
        return False
    count = 1
    step = 1
    while step <= max_consecutive:
        prev_date = weekend_date - timedelta(days=7 * step)
        if prev_date in existing_weekends:
            count += 1
            step += 1
        else:
            break
    step = 1
    while step <= max_consecutive:
        next_date = weekend_date + timedelta(days=7 * step)
        if next_date in existing_weekends:
            count += 1
            step += 1
        else:
            break
    return count > max_consecutive


def is_candidate_eligible_static(acolyte, slot, context, cache, exclude_acolyte_ids=None):
    if exclude_acolyte_ids and acolyte.id in exclude_acolyte_ids:
        return False
    if not cache["qualified_pairs"].get((acolyte.id, slot.position_type_id)):
        return False
    if not is_acolyte_available_with_rules(cache["rules_by_acolyte"].get(acolyte.id, []), slot.mass_instance):
        return False

    pool_mode = context.get("pool_mode")
    if pool_mode == "interested_only":
        if acolyte.id not in context.get("pool_ids", set()):
            return False
    elif pool_mode == "preferred_only":
        preferred = cache["preferred_communities"].get(acolyte.id, set())
        if slot.mass_instance.community_id not in preferred:
            return False
    elif pool_mode == "empty":
        return False
    return True


def is_candidate_eligible_dynamic(acolyte, slot, cache):
    weights = cache["weights"] or {}
    starts_at = slot.mass_instance.starts_at
    max_services_per_week = weights.get("max_services_per_week")
    max_consecutive_weekends = weights.get("max_consecutive_weekends")
    min_rest_minutes = getattr(slot.mass_instance.parish, "min_rest_minutes_between_masses", 0)
    mass_duration = getattr(slot.mass_instance.parish, "default_mass_duration_minutes", 60)
    min_gap = (int(min_rest_minutes) + int(mass_duration)) * 60

    assigned_times = cache["assignments_by_acolyte"].get(acolyte.id, [])
    if min_gap and assigned_times:
        for ts in assigned_times:
            if abs((ts - starts_at).total_seconds()) < min_gap:
                return False

    if max_services_per_week:
        week_key = starts_at.isocalendar()[:2]
        current_count = cache["weekly_counts_by_acolyte"].get(acolyte.id, {}).get(week_key, 0)
        if current_count + 1 > int(max_services_per_week):
            return False

    if max_consecutive_weekends:
        weekday = starts_at.weekday()
        weekend_date = None
        if weekday in (5, 6):
            weekend_date = starts_at.date()
            if weekday == 6:
                weekend_date = weekend_date - timedelta(days=1)
        if weekend_date:
            existing_weekends = cache["weekend_dates_by_acolyte"].get(acolyte.id, set())
            if _would_exceed_consecutive_weekends(existing_weekends, weekend_date, int(max_consecutive_weekends)):
                return False

    return True


def score_candidate(acolyte, slot, context, cache, local_eligible_count=0):
    weights = cache["weights"] or {}
    stats = cache["stats_map"].get(acolyte.id)
    preferences = cache["pref_by_acolyte"].get(acolyte.id, [])
    reliability_score = int(stats.reliability_score) if stats else 100
    services_last_30 = int(stats.services_last_30_days) if stats else 0
    credit_balance = int(stats.credit_balance or 0) if stats else 0

    breakdown = preference_score_breakdown(acolyte, slot.mass_instance, slot, preferences)
    community_factor = context.get("community_factor", 1.0)
    community_score = breakdown["community"] * community_factor
    base_score = breakdown["other"] + community_score

    home_bonus = int(_get_weight(weights, "home_community_bonus", 40) or 0)
    if acolyte.community_of_origin_id == slot.mass_instance.community_id:
        if slot.mass_instance.community_id not in cache["avoid_communities"].get(acolyte.id, set()):
            base_score += int(home_bonus * community_factor)

    scarcity_bonus = int(_get_weight(weights, "scarcity_bonus", 15) or 0)
    if local_eligible_count and local_eligible_count <= 2:
        if acolyte.community_of_origin_id == slot.mass_instance.community_id:
            if local_eligible_count == 1:
                base_score += scarcity_bonus
            else:
                base_score += int(round(scarcity_bonus / 2))

    community_recent_penalty = int(_get_weight(weights, "community_recent_penalty", 6) or 0)
    recent_window = int(_get_weight(weights, "community_recent_window_days", 30) or 0)
    if community_recent_penalty and recent_window > 0:
        window_start = slot.mass_instance.starts_at - timedelta(days=recent_window)
        window_end = slot.mass_instance.starts_at
        times = cache["community_assignment_times"].get((acolyte.id, slot.mass_instance.community_id), [])
        recent_count = _count_within_window(times, window_start, window_end)
        base_score -= community_recent_penalty * recent_count

    rotation_days = int(_get_weight(weights, "rotation_days", 60) or 0)
    rotation_penalty = int(_get_weight(weights, "rotation_penalty", 3) or 0)
    if rotation_days > 0 and rotation_penalty:
        window_start = slot.mass_instance.starts_at - timedelta(days=rotation_days)
        window_end = slot.mass_instance.starts_at
        rotation_times = cache["rotation_assignment_times"].get((acolyte.id, context.get("rotation_key")), [])
        if _has_recent_rotation(rotation_times, window_start, window_end):
            base_score -= rotation_penalty

    reserve_penalty = int(_get_weight(weights, "reserve_penalty", 1000) or 0)
    if acolyte.scheduling_mode == "reserve":
        base_score -= reserve_penalty

    credit_weight = int(_get_weight(weights, "credit_weight", 1) or 0)
    credit_cap = int(_get_weight(weights, "credit_cap", 10) or 10)
    if credit_weight:
        credit_bonus = min(max(credit_balance, 0), credit_cap)
        base_score += credit_weight * credit_bonus

    reliability_penalty = int(_get_weight(weights, "reliability_penalty", 0) or 0)
    if reliability_penalty:
        penalty = int(reliability_penalty * (100 - reliability_score) / 100)
        base_score -= penalty
    else:
        base_score += int(reliability_score / 25)

    base_score += max(0, 10 - int(services_last_30 / 2))

    return base_score


def rank_candidates(
    slot,
    parish,
    max_candidates=None,
    exclude_acolyte_ids=None,
    query=None,
    cache=None,
    include_meta=False,
    enforce_dynamic=True,
):
    exclude_acolyte_ids = exclude_acolyte_ids or set()
    cache = cache or build_recommendation_cache(parish, slots=[slot])
    context = get_mass_context(slot.mass_instance, cache["weights"], cache.get("interest_map"), cache["now"])

    eligible_acolytes = []
    for acolyte in cache["acolytes"]:
        if query and query.lower() not in acolyte.display_name.lower():
            continue
        if not is_candidate_eligible_static(acolyte, slot, context, cache, exclude_acolyte_ids=exclude_acolyte_ids):
            continue
        if enforce_dynamic and not is_candidate_eligible_dynamic(acolyte, slot, cache):
            continue
        eligible_acolytes.append(acolyte)

    local_eligible = [
        acolyte
        for acolyte in eligible_acolytes
        if acolyte.community_of_origin_id == slot.mass_instance.community_id
        and slot.mass_instance.community_id not in cache["avoid_communities"].get(acolyte.id, set())
    ]
    local_eligible_count = len(local_eligible)

    scored = []
    for acolyte in eligible_acolytes:
        score = score_candidate(acolyte, slot, context, cache, local_eligible_count=local_eligible_count)
        scored.append((score, acolyte))

    scored.sort(key=lambda item: item[0], reverse=True)
    if max_candidates:
        scored = scored[: int(max_candidates)]

    if not include_meta:
        return [acolyte for _score, acolyte in scored]

    results = []
    for score, acolyte in scored:
        reason = None
        if acolyte.community_of_origin_id == slot.mass_instance.community_id and context.get("community_factor", 1.0) > 0:
            reason = "Comunidade de origem"
        elif slot.mass_instance.community_id in cache["preferred_communities"].get(acolyte.id, set()):
            reason = "Preferencia por comunidade"
        elif acolyte.scheduling_mode == "reserve":
            reason = "Reserva tecnica"
        results.append({
            "acolyte": acolyte,
            "score": score,
            "reason": reason,
        })
    return results


def build_candidate_map(slots, parish, cache=None):
    cache = cache or build_recommendation_cache(parish, slots=slots)
    candidates = {}
    deferred = []
    for slot in slots:
        context = get_mass_context(slot.mass_instance, cache["weights"], cache.get("interest_map"), cache["now"])
        if context.get("pool_mode") == "empty" and context.get("candidate_pool") == "interested_only":
            deferred.append(slot)
            continue
        slot_candidates = []
        for acolyte in cache["acolytes"]:
            if not is_candidate_eligible_static(acolyte, slot, context, cache):
                continue
            slot_candidates.append(acolyte)
        candidates[slot.id] = slot_candidates
    return candidates, deferred, cache
```

### core\services\replacements.py
```python
from datetime import timedelta

from django.db import connection, transaction
from django.db.models import Prefetch
from django.utils import timezone

from core.models import (
    AcolyteQualification,
    Assignment,
    AssignmentSlot,
    Confirmation,
    MassOverride,
    MassInstance,
    ReplacementRequest,
)
from core.services.assignments import (
    ConcurrentUpdateError,
    _assign_acolyte_to_slot_locked,
    _lock_slot,
    _validate_no_conflict_in_mass,
    deactivate_assignment,
)
from core.services.audit import log_audit
from core.services.availability import is_acolyte_available


def create_replacement_request(parish, slot, actor=None, proposed_acolyte=None, notes=""):
    request = (
        ReplacementRequest.objects.filter(parish=parish, slot=slot, status="pending").first()
    )
    if request:
        return request
    request = ReplacementRequest.objects.create(
        parish=parish,
        slot=slot,
        requested_by=actor,
        proposed_acolyte=proposed_acolyte,
        status="pending",
        notes=notes or "",
    )
    log_audit(parish, actor, "ReplacementRequest", request.id, "create", {"slot_id": slot.id})
    return request


def _interest_deadline_at(parish, mass_instance):
    interest_deadline_at = None
    if mass_instance.event_series_id and getattr(mass_instance.event_series, "interest_deadline_at", None):
        interest_deadline_at = mass_instance.event_series.interest_deadline_at
        if timezone.is_naive(interest_deadline_at):
            interest_deadline_at = timezone.make_aware(interest_deadline_at, timezone.get_current_timezone())
    if not interest_deadline_at:
        weights = parish.schedule_weights or {}
        interest_deadline_hours = int(weights.get("interest_deadline_hours", 48) or 0)
        interest_deadline_at = mass_instance.starts_at - timedelta(hours=interest_deadline_hours)
    return interest_deadline_at


def should_create_replacement(parish, slot, now=None):
    if not parish or not slot:
        return False
    now = now or timezone.now()
    instance = slot.mass_instance
    if instance.status != "scheduled":
        return False
    consolidation_limit = now + timedelta(days=parish.consolidation_days)
    if not (slot.is_locked or instance.starts_at <= consolidation_limit):
        return False
    if instance.event_series_id and instance.event_series:
        if instance.event_series.candidate_pool == "interested_only":
            deadline = _interest_deadline_at(parish, instance)
            if deadline and now < deadline:
                return False
    return True


def reconcile_pending_replacements(parish, actor=None, now=None):
    now = now or timezone.now()
    pending = (
        ReplacementRequest.objects.filter(parish=parish, status="pending")
        .select_related("slot__mass_instance")
        .prefetch_related(
            Prefetch(
                "slot__assignments",
                queryset=Assignment.objects.filter(is_active=True).select_related("acolyte"),
                to_attr="active_assignments",
            )
        )
    )
    resolved_ids = []
    assigned_ids = []

    for request in pending:
        slot = request.slot
        instance = slot.mass_instance
        if instance.status == "canceled":
            request.status = "resolved"
            request.resolved_reason = "mass_canceled"
            request.resolved_notes = "Auto-resolvido: missa cancelada."
            request.resolved_at = now
            request.save(
                update_fields=[
                    "status",
                    "resolved_reason",
                    "resolved_notes",
                    "resolved_at",
                    "updated_at",
                ]
            )
            log_audit(parish, actor, "ReplacementRequest", request.id, "update", {"status": "resolved"})
            resolved_ids.append(request.id)
            continue
        if not slot.required:
            request.status = "resolved"
            request.resolved_reason = "slot_not_required"
            request.resolved_notes = "Auto-resolvido: funcao nao necessaria."
            request.resolved_at = now
            request.save(
                update_fields=[
                    "status",
                    "resolved_reason",
                    "resolved_notes",
                    "resolved_at",
                    "updated_at",
                ]
            )
            log_audit(parish, actor, "ReplacementRequest", request.id, "update", {"status": "resolved"})
            resolved_ids.append(request.id)
            continue
        if slot.externally_covered:
            request.status = "resolved"
            request.resolved_reason = "covered_externally"
            request.resolved_notes = "Auto-resolvido: coberto externamente."
            request.resolved_at = now
            request.save(
                update_fields=[
                    "status",
                    "resolved_reason",
                    "resolved_notes",
                    "resolved_at",
                    "updated_at",
                ]
            )
            log_audit(parish, actor, "ReplacementRequest", request.id, "update", {"status": "resolved"})
            resolved_ids.append(request.id)
            continue
        if slot.get_active_assignment():
            if mark_replacement_assigned(parish, slot, actor=actor):
                assigned_ids.append(request.id)
            continue
        if instance.starts_at < now:
            request.status = "resolved"
            request.resolved_reason = "other"
            request.resolved_notes = "Auto-resolvido: missa ja ocorreu."
            request.resolved_at = now
            request.save(
                update_fields=[
                    "status",
                    "resolved_reason",
                    "resolved_notes",
                    "resolved_at",
                    "updated_at",
                ]
            )
            log_audit(parish, actor, "ReplacementRequest", request.id, "update", {"status": "resolved"})
            resolved_ids.append(request.id)

    return {"resolved_ids": resolved_ids, "assigned_ids": assigned_ids}


def mark_replacement_assigned(parish, slot, actor=None):
    request = ReplacementRequest.objects.filter(parish=parish, slot=slot, status="pending").first()
    if request:
        request.status = "assigned"
        request.save(update_fields=["status", "updated_at"])
        log_audit(parish, actor, "ReplacementRequest", request.id, "update", {"status": "assigned"})
        return request
    return None


def assign_replacement(parish, slot, acolyte, actor=None):
    if not AcolyteQualification.objects.filter(
        parish=parish, acolyte=acolyte, position_type=slot.position_type, qualified=True
    ).exists():
        return None
    if not is_acolyte_available(acolyte, slot.mass_instance):
        return None
    with transaction.atomic():
        locked_slot = _lock_slot(slot.id)
        try:
            _validate_no_conflict_in_mass(locked_slot, acolyte)
        except ValueError:
            return None
        assignment_state = "locked" if locked_slot.is_locked else "published"
        new_assignment = _assign_acolyte_to_slot_locked(
            locked_slot,
            acolyte,
            actor=actor,
            assignment_state=assignment_state,
            end_reason="replaced",
            create_confirmation=True,
        )
        confirmation = Confirmation.objects.get(parish=parish, assignment=new_assignment)
        confirmation.status = "pending"
        confirmation.updated_by = actor
        confirmation.timestamp = timezone.now()
        confirmation.save(update_fields=["status", "updated_by", "timestamp"])
        request = mark_replacement_assigned(parish, locked_slot, actor=actor)
        locked_slot.status = "finalized" if locked_slot.is_locked else "assigned"
        locked_slot.save(update_fields=["status", "updated_at"])
        if request:
            log_audit(parish, actor, "ReplacementRequest", request.id, "assign", {"acolyte_id": acolyte.id})
        else:
            log_audit(parish, actor, "Assignment", new_assignment.id, "assign", {"acolyte_id": acolyte.id})
        return new_assignment


def assign_replacement_request(parish, replacement_request_id, acolyte, actor=None):
    with transaction.atomic():
        qs = ReplacementRequest.objects
        if connection.features.has_select_for_update:
            qs = qs.select_for_update()
        replacement = qs.select_related("slot__mass_instance").get(
            parish=parish, id=replacement_request_id
        )
        if replacement.status != "pending":
            raise ConcurrentUpdateError("Substituicao ja tratada.")
        locked_slot = _lock_slot(replacement.slot_id)
        if locked_slot.parish_id != parish.id or acolyte.parish_id != parish.id:
            raise ValueError("Paroquia invalida para substituicao.")
        try:
            _validate_no_conflict_in_mass(locked_slot, acolyte)
        except ValueError:
            return None
        if not AcolyteQualification.objects.filter(
            parish=parish, acolyte=acolyte, position_type=locked_slot.position_type, qualified=True
        ).exists():
            return None
        if not is_acolyte_available(acolyte, locked_slot.mass_instance):
            return None
        assignment_state = "locked" if locked_slot.is_locked else "published"
        new_assignment = _assign_acolyte_to_slot_locked(
            locked_slot,
            acolyte,
            actor=actor,
            assignment_state=assignment_state,
            end_reason="replaced",
            create_confirmation=True,
        )
        confirmation = Confirmation.objects.get(parish=parish, assignment=new_assignment)
        confirmation.status = "pending"
        confirmation.updated_by = actor
        confirmation.timestamp = timezone.now()
        confirmation.save(update_fields=["status", "updated_by", "timestamp"])
        replacement.status = "assigned"
        replacement.save(update_fields=["status", "updated_at"])
        locked_slot.status = "finalized" if locked_slot.is_locked else "assigned"
        locked_slot.save(update_fields=["status", "updated_at"])
        log_audit(
            parish,
            actor,
            "ReplacementRequest",
            replacement.id,
            "assign",
            {"acolyte_id": acolyte.id},
        )
        return new_assignment


def cancel_mass_and_resolve_dependents(parish, instance, actor=None, notes="", reason_code="replacement_resolve"):
    with transaction.atomic():
        if connection.features.has_select_for_update:
            instance = MassInstance.objects.select_for_update().get(id=instance.id)
        if instance.status != "canceled":
            instance.status = "canceled"
            instance.save(update_fields=["status", "updated_at"])
            MassOverride.objects.create(
                parish=parish,
                instance=instance,
                override_type="cancel_instance",
                payload={"reason": reason_code, "notes": notes},
                created_by=actor,
            )
            log_audit(parish, actor, "MassInstance", instance.id, "cancel", {"reason": reason_code})

        slots_qs = AssignmentSlot.objects.filter(parish=parish, mass_instance=instance)
        if connection.features.has_select_for_update:
            slots_qs = slots_qs.select_for_update()
        slots = (
            slots_qs.prefetch_related(
                Prefetch("assignments", queryset=Assignment.objects.filter(is_active=True), to_attr="active_assignments")
            )
            .select_related("mass_instance")
        )
        for slot in slots:
            assignment = slot.get_active_assignment()
            if assignment:
                deactivate_assignment(assignment, "canceled", actor=actor)
            slot.required = False
            slot.externally_covered = False
            slot.external_coverage_notes = ""
            slot.status = "finalized"
            slot.save(
                update_fields=[
                    "required",
                    "externally_covered",
                    "external_coverage_notes",
                    "status",
                    "updated_at",
                ]
            )

        now = timezone.now()
        replacements = ReplacementRequest.objects.filter(
            parish=parish, slot__mass_instance=instance, status__in=["pending", "assigned"]
        )
        for replacement in replacements:
            replacement.status = "resolved"
            replacement.resolved_reason = "mass_canceled"
            replacement.resolved_notes = notes
            replacement.resolved_at = now
            replacement.save(update_fields=["status", "resolved_reason", "resolved_notes", "resolved_at", "updated_at"])
            log_audit(parish, actor, "ReplacementRequest", replacement.id, "update", {"status": "resolved"})
```

### core\services\slots.py
```python
from core.models import AssignmentSlot
from core.services.assignments import deactivate_assignment


def sync_slots_for_instance(instance):
    if not instance.requirement_profile:
        slots = AssignmentSlot.objects.filter(mass_instance=instance)
        for slot in slots:
            assignment = slot.get_active_assignment()
            if assignment:
                deactivate_assignment(assignment, "manual_unassign")
            slot.required = False
            slot.externally_covered = False
            slot.external_coverage_notes = ""
            slot.status = "finalized"
            slot.save(
                update_fields=[
                    "required",
                    "externally_covered",
                    "external_coverage_notes",
                    "status",
                    "updated_at",
                ]
            )
        return []

    desired = set()
    created = []
    for position in instance.requirement_profile.positions.select_related("position_type").all():
        for idx in range(1, position.quantity + 1):
            desired.add((position.position_type_id, idx))
            slot, was_created = AssignmentSlot.objects.get_or_create(
                parish=instance.parish,
                mass_instance=instance,
                position_type=position.position_type,
                slot_index=idx,
                defaults={"required": True, "status": "open"},
            )
            if was_created:
                created.append(slot)
            elif not slot.required:
                assignment = slot.get_active_assignment()
                slot.required = True
                slot.externally_covered = False
                slot.external_coverage_notes = ""
                if assignment:
                    slot.status = "finalized" if slot.is_locked else "assigned"
                else:
                    slot.status = "open"
                slot.save(
                    update_fields=[
                        "required",
                        "externally_covered",
                        "external_coverage_notes",
                        "status",
                        "updated_at",
                    ]
                )

    for slot in AssignmentSlot.objects.filter(mass_instance=instance):
        if (slot.position_type_id, slot.slot_index) not in desired and slot.required:
            assignment = slot.get_active_assignment()
            if assignment:
                deactivate_assignment(assignment, "manual_unassign")
            slot.required = False
            slot.externally_covered = False
            slot.external_coverage_notes = ""
            slot.status = "finalized"
            slot.save(
                update_fields=[
                    "required",
                    "externally_covered",
                    "external_coverage_notes",
                    "status",
                    "updated_at",
                ]
            )
    return created


def sync_slots_for_parish(parish, start_date, end_date):
    from core.models import MassInstance

    instances = MassInstance.objects.filter(
        parish=parish,
        starts_at__date__gte=start_date,
        starts_at__date__lte=end_date,
    ).select_related("requirement_profile")
    for instance in instances:
        sync_slots_for_instance(instance)
    return instances.count()
```

### core\services\stats.py
```python
from datetime import timedelta

from django.db import models
from django.db.models import F, Q
from django.utils import timezone

from core.models import AcolyteCreditLedger, AcolyteProfile, AcolyteStats, Assignment, Confirmation


def recompute_stats(parish):
    now = timezone.now()
    start_30 = now - timedelta(days=30)
    start_90 = now - timedelta(days=90)
    assignments = Assignment.objects.filter(parish=parish, assignment_state__in=["published", "locked"])
    active_at_service = assignments.filter(
        created_at__lte=F("slot__mass_instance__starts_at")
    ).filter(
        Q(ended_at__isnull=True) | Q(ended_at__gte=F("slot__mass_instance__starts_at"))
    )
    acolyte_ids = list(
        AcolyteProfile.objects.filter(parish=parish, active=True).values_list("id", flat=True)
    )
    for acolyte_id in acolyte_ids:
        recent_30 = active_at_service.filter(
            acolyte_id=acolyte_id, slot__mass_instance__starts_at__gte=start_30, slot__mass_instance__starts_at__lte=now
        ).count()
        recent_90 = active_at_service.filter(
            acolyte_id=acolyte_id, slot__mass_instance__starts_at__gte=start_90, slot__mass_instance__starts_at__lte=now
        ).count()
        confirmations = Confirmation.objects.filter(
            parish=parish,
            assignment__acolyte_id=acolyte_id,
            assignment__assignment_state__in=["published", "locked"],
            assignment__slot__mass_instance__starts_at__gte=start_90,
            assignment__slot__mass_instance__starts_at__lte=now,
        )
        total_confirmations = confirmations.count()
        confirmed = confirmations.filter(status="confirmed").count()
        canceled = confirmations.filter(status__in=["declined", "canceled_by_acolyte"]).count()
        no_show = confirmations.filter(status="no_show").count()
        confirmation_rate = (confirmed / total_confirmations) if total_confirmations else 0.0
        cancellations_rate = (canceled / total_confirmations) if total_confirmations else 0.0
        credit_balance = (
            AcolyteCreditLedger.objects.filter(parish=parish, acolyte_id=acolyte_id)
            .aggregate(total=models.Sum("delta"))
            .get("total")
            or 0
        )
        reliability_score = max(0.0, 100.0 - (cancellations_rate * 50.0) - (no_show * 5.0))
        AcolyteStats.objects.update_or_create(
            parish=parish,
            acolyte_id=acolyte_id,
            defaults={
                "services_last_30_days": recent_30,
                "services_last_90_days": recent_90,
                "confirmation_rate": confirmation_rate,
                "cancellations_rate": cancellations_rate,
                "no_show_count": no_show,
                "credit_balance": credit_balance,
                "reliability_score": reliability_score,
                "last_served_at": active_at_service.filter(acolyte_id=acolyte_id)
                .order_by("-slot__mass_instance__starts_at")
                .values_list("slot__mass_instance__starts_at", flat=True)
                .first(),
            },
        )
    return True
```

### core\services\swaps.py
```python
from django.db import connection, transaction

from core.models import AcolyteQualification, AssignmentSlot, Confirmation
from core.services.assignments import _assign_acolyte_to_slot_locked, _lock_slot, deactivate_assignment
from core.services.audit import log_audit
from core.services.availability import is_acolyte_available


def _is_qualified(parish, acolyte, position_type):
    return AcolyteQualification.objects.filter(
        parish=parish, acolyte=acolyte, position_type=position_type, qualified=True
    ).exists()


def _lock_slots(parish, slot_ids):
    qs = AssignmentSlot.objects.filter(parish=parish, id__in=slot_ids)
    if connection.features.has_select_for_update:
        qs = qs.select_for_update()
    slots = qs.select_related("mass_instance", "position_type")
    return {slot.id: slot for slot in slots}


def apply_swap_request(swap, actor=None):
    parish = swap.parish
    if swap.swap_type == "acolyte_swap":
        if not swap.target_acolyte or not swap.from_slot:
            return False
        if swap.target_acolyte.parish_id != parish.id or swap.from_slot.parish_id != parish.id:
            return False
        with transaction.atomic():
            locked_slot = _lock_slot(swap.from_slot_id)
            assignment = locked_slot.get_active_assignment()
            if not assignment:
                return False
            target = swap.target_acolyte
            if not _is_qualified(parish, target, locked_slot.position_type):
                return False
            if not is_acolyte_available(target, swap.mass_instance):
                return False
            deactivate_assignment(assignment, "swap", actor=actor)
            assignment = _assign_acolyte_to_slot_locked(
                locked_slot,
                target,
                actor=actor,
                assignment_state=assignment.assignment_state,
                end_reason="swap",
            )
            confirmation, _ = Confirmation.objects.get_or_create(parish=parish, assignment=assignment)
            confirmation.status = "pending"
            confirmation.updated_by = actor
            confirmation.save(update_fields=["status", "updated_by", "timestamp"])
            log_audit(parish, actor, "SwapRequest", swap.id, "apply", {"assignment_id": assignment.id})
            return True

    if swap.swap_type == "role_swap":
        if not swap.from_slot or not swap.to_slot:
            return False
        if swap.from_slot.parish_id != parish.id or swap.to_slot.parish_id != parish.id:
            return False
        with transaction.atomic():
            slot_ids = sorted({swap.from_slot_id, swap.to_slot_id})
            slots = _lock_slots(parish, slot_ids)
            from_slot = slots.get(swap.from_slot_id)
            to_slot = slots.get(swap.to_slot_id)
            if not from_slot or not to_slot:
                return False
            from_assignment = from_slot.get_active_assignment()
            to_assignment = to_slot.get_active_assignment()
            if not from_assignment or not to_assignment:
                return False
            if not _is_qualified(parish, from_assignment.acolyte, to_slot.position_type):
                return False
            if not _is_qualified(parish, to_assignment.acolyte, from_slot.position_type):
                return False
            if not is_acolyte_available(from_assignment.acolyte, swap.mass_instance):
                return False
            if not is_acolyte_available(to_assignment.acolyte, swap.mass_instance):
                return False
            deactivate_assignment(from_assignment, "swap", actor=actor)
            deactivate_assignment(to_assignment, "swap", actor=actor)
            new_from = _assign_acolyte_to_slot_locked(
                from_slot,
                to_assignment.acolyte,
                actor=actor,
                assignment_state=from_assignment.assignment_state,
                end_reason="swap",
            )
            new_to = _assign_acolyte_to_slot_locked(
                to_slot,
                from_assignment.acolyte,
                actor=actor,
                assignment_state=to_assignment.assignment_state,
                end_reason="swap",
            )
            for assignment in (new_from, new_to):
                confirmation, _ = Confirmation.objects.get_or_create(parish=parish, assignment=assignment)
                confirmation.status = "pending"
                confirmation.updated_by = actor
                confirmation.save(update_fields=["status", "updated_by", "timestamp"])
            log_audit(
                parish,
                actor,
                "SwapRequest",
                swap.id,
                "apply",
                {"from_slot": swap.from_slot_id, "to_slot": swap.to_slot_id},
            )
            return True
    return False
```

### core\services\time_windows.py
```python
from django.utils import timezone


def filter_upcoming(queryset, now=None, field="slot__mass_instance__starts_at"):
    now = now or timezone.now()
    return queryset.filter(**{f"{field}__gte": now})


def filter_past(queryset, now=None, field="slot__mass_instance__starts_at"):
    now = now or timezone.now()
    return queryset.filter(**{f"{field}__lt": now})
```

### core\tests\test_assignments_service.py
```python
from django.test import TestCase
from django.utils import timezone

from core.models import AcolyteProfile, Assignment, AssignmentSlot, Community, MassInstance, Parish, PositionType
from core.services.assignments import assign_manual


class AssignmentServiceTests(TestCase):
    def test_assign_manual_idempotent_for_same_acolyte(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="open",
        )

        first = assign_manual(slot, acolyte)
        second = assign_manual(slot, acolyte)

        self.assertEqual(first.id, second.id)
        self.assertEqual(Assignment.objects.filter(slot=slot, is_active=True).count(), 1)
```

### core\tests\test_availability.py
```python
from datetime import datetime, time, timedelta

from django.test import TestCase
from django.utils import timezone

from core.models import AcolyteAvailabilityRule, AcolyteProfile, Community, MassInstance, Parish
from core.services.availability import is_acolyte_available


class AvailabilityRuleTests(TestCase):
    def setUp(self):
        self.parish = Parish.objects.create(name="Parish")
        self.community_a = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.community_b = Community.objects.create(parish=self.parish, code="STM", name="Comunidade")
        self.acolyte = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito")
        self.tz = timezone.get_current_timezone()
        self.monday = datetime(2026, 2, 9, 10, 0, tzinfo=self.tz)
        self.tuesday = datetime(2026, 2, 10, 10, 0, tzinfo=self.tz)

    def _instance_at(self, when, community):
        return MassInstance.objects.create(
            parish=self.parish,
            community=community,
            starts_at=when,
            status="scheduled",
        )

    def test_no_rules_defaults_to_available(self):
        instance = self._instance_at(self.monday, self.community_a)
        self.assertTrue(is_acolyte_available(self.acolyte, instance))

    def test_unavailable_blocks(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="unavailable",
            day_of_week=self.monday.weekday(),
        )
        instance = self._instance_at(self.monday, self.community_a)
        self.assertFalse(is_acolyte_available(self.acolyte, instance))

    def test_available_only_requires_match(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            day_of_week=self.monday.weekday(),
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        instance = self._instance_at(self.tuesday, self.community_a)
        self.assertFalse(is_acolyte_available(self.acolyte, instance))

    def test_available_only_allows_match(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            day_of_week=self.monday.weekday(),
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        instance = self._instance_at(self.monday, self.community_a)
        self.assertTrue(is_acolyte_available(self.acolyte, instance))

    def test_available_only_end_time_exclusive(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            day_of_week=self.monday.weekday(),
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        boundary = datetime(2026, 2, 9, 11, 0, tzinfo=self.tz)
        instance = self._instance_at(boundary, self.community_a)
        self.assertFalse(is_acolyte_available(self.acolyte, instance))

    def test_available_only_end_only_exclusive(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            end_time=time(10, 0),
        )
        boundary = datetime(2026, 2, 9, 10, 0, tzinfo=self.tz)
        instance = self._instance_at(boundary, self.community_a)
        self.assertFalse(is_acolyte_available(self.acolyte, instance))

    def test_unavailable_overrides_available_only(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            day_of_week=self.monday.weekday(),
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="unavailable",
            day_of_week=self.monday.weekday(),
            start_time=time(9, 30),
            end_time=time(10, 30),
        )
        instance = self._instance_at(self.monday, self.community_a)
        self.assertFalse(is_acolyte_available(self.acolyte, instance))

    def test_invalid_available_only_does_not_restrict(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            start_time=time(11, 0),
            end_time=time(10, 0),
        )
        instance = self._instance_at(self.monday, self.community_a)
        self.assertTrue(is_acolyte_available(self.acolyte, instance))

    def test_available_only_respects_date_window(self):
        rule_start = self.monday.date()
        rule_end = rule_start + timedelta(days=2)
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            day_of_week=self.monday.weekday(),
            start_time=time(10, 0),
            end_time=time(12, 0),
            start_date=rule_start,
            end_date=rule_end,
        )

        outside_date = rule_end + timedelta(days=5)
        outside_instance = self._instance_at(datetime.combine(outside_date, time(10, 30), tzinfo=self.tz), self.community_a)
        self.assertFalse(is_acolyte_available(self.acolyte, outside_instance))

        inside_instance = self._instance_at(datetime.combine(rule_start, time(10, 30), tzinfo=self.tz), self.community_a)
        self.assertTrue(is_acolyte_available(self.acolyte, inside_instance))

    def test_available_only_respects_community(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            community=self.community_a,
        )
        instance = self._instance_at(self.monday, self.community_b)
        self.assertFalse(is_acolyte_available(self.acolyte, instance))

    def test_available_only_any_day_applies(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="available_only",
            start_time=time(9, 0),
            end_time=time(11, 0),
            day_of_week=None,
        )
        instance = self._instance_at(self.tuesday, self.community_a)
        self.assertTrue(is_acolyte_available(self.acolyte, instance))

    def test_unavailable_any_day_blocks(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="unavailable",
            start_time=time(9, 0),
            end_time=time(11, 0),
            day_of_week=None,
        )
        instance = self._instance_at(self.tuesday, self.community_a)
        self.assertFalse(is_acolyte_available(self.acolyte, instance))
```

### core\tests\test_calendar.py
```python
from datetime import date, time, timedelta

from django.test import TestCase
from django.utils import timezone

from core.models import Community, MassTemplate, Parish, RequirementProfile
from core.services.calendar_generation import generate_instances_for_parish


class CalendarGenerationTests(TestCase):
    def test_generate_instances(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        profile = RequirementProfile.objects.create(parish=parish, name="Simple")
        MassTemplate.objects.create(
            parish=parish,
            title="Saturday Mass",
            community=community,
            weekday=5,
            time=time(17, 0),
            default_requirement_profile=profile,
        )
        start = date.today()
        end = start + timedelta(days=7)
        created = generate_instances_for_parish(parish, start, end)
        self.assertTrue(created)
```

### core\tests\test_consolidation.py
```python
from datetime import timedelta

from django.core.management import call_command
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    Parish,
    PositionType,
)


class ConsolidationLockTests(TestCase):
    def test_lock_consolidation_window_sets_flags(self):
        parish = Parish.objects.create(name="Parish", consolidation_days=14)
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, assignment_state="published")

        call_command("lock_consolidation_window", parish_id=parish.id)

        slot.refresh_from_db()
        assignment.refresh_from_db()
        self.assertTrue(slot.is_locked)
        self.assertEqual(slot.status, "finalized")
        self.assertEqual(assignment.assignment_state, "locked")

    def test_lock_consolidation_window_with_open_slot(self):
        parish = Parish.objects.create(name="Parish", consolidation_days=14)
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="open",
        )

        call_command("lock_consolidation_window", parish_id=parish.id)

        slot.refresh_from_db()
        self.assertTrue(slot.is_locked)
        self.assertEqual(slot.status, "open")
```

### core\tests\test_event_series.py
```python
from datetime import date, datetime, time

from django.test import TestCase
from django.utils import timezone

from core.models import Community, EventSeries, MassInstance, Parish, RequirementProfile
from core.services.event_series import apply_event_occurrences


class EventSeriesConflictTests(TestCase):
    def setUp(self):
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.profile = RequirementProfile.objects.create(parish=self.parish, name="Simple")
        self.series = EventSeries.objects.create(
            parish=self.parish,
            series_type="novena",
            title="Novena",
            start_date=date.today(),
            end_date=date.today(),
            default_community=self.community,
        )

    def test_keep_conflict_does_not_duplicate(self):
        starts_at = timezone.make_aware(datetime.combine(date.today(), time(19, 0)))
        existing = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=starts_at,
            status="scheduled",
        )
        apply_event_occurrences(
            self.series,
            [
                {
                    "date": date.today(),
                    "time": time(19, 0),
                    "community_id": self.community.id,
                    "requirement_profile_id": self.profile.id,
                    "label": "Novena",
                    "conflict_action": "keep",
                }
            ],
        )
        self.assertEqual(MassInstance.objects.filter(parish=self.parish).count(), 1)
        existing.refresh_from_db()
        self.assertEqual(existing.event_series_id, self.series.id)

    def test_cancel_existing_creates_new(self):
        starts_at = timezone.make_aware(datetime.combine(date.today(), time(19, 0)))
        existing = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=starts_at,
            status="scheduled",
        )
        apply_event_occurrences(
            self.series,
            [
                {
                    "date": date.today(),
                    "time": time(19, 0),
                    "community_id": self.community.id,
                    "requirement_profile_id": self.profile.id,
                    "label": "Novena",
                    "conflict_action": "cancel_existing",
                }
            ],
        )
        existing.refresh_from_db()
        self.assertEqual(existing.status, "canceled")
        self.assertEqual(MassInstance.objects.filter(parish=self.parish).count(), 2)

    def test_skip_does_not_create(self):
        apply_event_occurrences(
            self.series,
            [
                {
                    "date": date.today(),
                    "time": time(19, 0),
                    "community_id": self.community.id,
                    "requirement_profile_id": self.profile.id,
                    "label": "Novena",
                    "conflict_action": "skip",
                }
            ],
        )
        self.assertEqual(MassInstance.objects.filter(parish=self.parish).count(), 0)

    def test_blank_label_defaults_to_series_title(self):
        apply_event_occurrences(
            self.series,
            [
                {
                    "date": date.today(),
                    "time": time(19, 0),
                    "community_id": self.community.id,
                    "requirement_profile_id": self.profile.id,
                    "label": "",
                    "conflict_action": "keep",
                }
            ],
        )
        instance = MassInstance.objects.get(parish=self.parish)
        self.assertEqual(instance.liturgy_label, self.series.title)

    def test_move_existing_creates_new_and_moves_original(self):
        starts_at = timezone.make_aware(datetime.combine(date.today(), time(19, 0)))
        move_to_date = date.today()
        existing = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=starts_at,
            status="scheduled",
        )
        apply_event_occurrences(
            self.series,
            [
                {
                    "date": date.today(),
                    "time": time(19, 0),
                    "community_id": self.community.id,
                    "requirement_profile_id": self.profile.id,
                    "label": "Novena",
                    "conflict_action": "move_existing",
                    "move_to_date": move_to_date,
                    "move_to_time": time(20, 0),
                    "move_to_community_id": self.community.id,
                }
            ],
        )
        self.assertEqual(MassInstance.objects.filter(parish=self.parish).count(), 2)
        existing.refresh_from_db()
        self.assertEqual(existing.starts_at, timezone.make_aware(datetime.combine(move_to_date, time(20, 0))))
```

### core\tests\test_event_series_archive_command.py
```python
from datetime import date, timedelta

from django.core.management import call_command
from django.test import TestCase

from core.models import Community, EventSeries, Parish


class ArchiveEventSeriesCommandTests(TestCase):
    def test_archives_past_series_only(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        past = EventSeries.objects.create(
            parish=parish,
            series_type="Festa",
            title="Past",
            start_date=date.today() - timedelta(days=3),
            end_date=date.today() - timedelta(days=1),
            default_community=community,
            candidate_pool="all",
            is_active=True,
        )
        future = EventSeries.objects.create(
            parish=parish,
            series_type="Festa",
            title="Future",
            start_date=date.today(),
            end_date=date.today() + timedelta(days=1),
            default_community=community,
            candidate_pool="all",
            is_active=True,
        )

        call_command("archive_event_series")

        past.refresh_from_db()
        future.refresh_from_db()
        self.assertFalse(past.is_active)
        self.assertTrue(future.is_active)
```

### core\tests\test_permissions.py
```python
from datetime import timedelta
import base64

from django.contrib.auth import get_user_model
from django.test import TestCase

from django.utils import timezone
from rest_framework.test import APIClient

from core.models import Community, MassInstance, Parish, ParishMembership


class ParishIsolationTests(TestCase):
    def setUp(self):
        self.user = get_user_model().objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish1 = Parish.objects.create(name="Parish 1")
        self.parish2 = Parish.objects.create(name="Parish 2")
        self.community1 = Community.objects.create(parish=self.parish1, code="A", name="A")
        self.community2 = Community.objects.create(parish=self.parish2, code="B", name="B")
        ParishMembership.objects.create(parish=self.parish1, user=self.user)

        MassInstance.objects.create(
            parish=self.parish1,
            community=self.community1,
            starts_at=timezone.now() + timedelta(days=1),
            status="scheduled",
        )
        MassInstance.objects.create(
            parish=self.parish2,
            community=self.community2,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )

    def test_api_is_scoped_by_active_parish(self):
        client = APIClient()
        client.login(email="user@example.com", password="pass")
        session = client.session
        session["active_parish_id"] = self.parish1.id
        session.save()
        response = client.get("/api/masses/")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.json()), 1)

    def test_api_parish_header_scopes_results(self):
        client = APIClient()
        credentials = base64.b64encode(b"user@example.com:pass").decode("utf-8")
        client.credentials(HTTP_AUTHORIZATION=f"Basic {credentials}", HTTP_X_PARISH_ID=str(self.parish1.id))
        response = client.get("/api/masses/")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.json()), 1)

    def test_api_parish_header_blocks_other_parish(self):
        client = APIClient()
        credentials = base64.b64encode(b"user@example.com:pass").decode("utf-8")
        client.credentials(HTTP_AUTHORIZATION=f"Basic {credentials}", HTTP_X_PARISH_ID=str(self.parish2.id))
        response = client.get("/api/masses/")
        self.assertEqual(response.status_code, 403)

    def test_api_requires_parish_header_when_missing(self):
        client = APIClient()
        credentials = base64.b64encode(b"user@example.com:pass").decode("utf-8")
        client.credentials(HTTP_AUTHORIZATION=f"Basic {credentials}")
        response = client.get("/api/masses/")
        self.assertEqual(response.status_code, 400)
        self.assertIn("X-Parish-ID", response.content.decode("utf-8"))
```

### core\tests\test_preferences.py
```python
from datetime import datetime, time

from django.test import TestCase
from django.utils import timezone

from core.models import AcolytePreference, AcolyteProfile, AssignmentSlot, Community, MassInstance, Parish, PositionType
from core.services.preferences import preference_score


class PreferenceScoreTests(TestCase):
    def test_preferred_timeslot_end_exclusive(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        tz = timezone.get_current_timezone()
        starts_at_inside = datetime(2026, 2, 9, 10, 59, tzinfo=tz)
        weekday = starts_at_inside.weekday()
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")

        pref = AcolytePreference.objects.create(
            parish=parish,
            acolyte=acolyte,
            preference_type="preferred_timeslot",
            weekday=weekday,
            start_time=time(9, 0),
            end_time=time(11, 0),
            weight=50,
        )

        inside_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=starts_at_inside,
            status="scheduled",
        )
        boundary_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=datetime(2026, 2, 9, 11, 0, tzinfo=tz),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(parish=parish, mass_instance=inside_instance, position_type=position)

        score_inside = preference_score(None, inside_instance, slot, [pref])
        score_boundary = preference_score(None, boundary_instance, slot, [pref])

        self.assertEqual(score_inside, 50)
        self.assertEqual(score_boundary, 0)

    def test_preferred_timeslot_end_only_exclusive(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        tz = timezone.get_current_timezone()

        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        pref = AcolytePreference.objects.create(
            parish=parish,
            acolyte=acolyte,
            preference_type="preferred_timeslot",
            end_time=time(10, 0),
            weight=40,
        )

        inside_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=datetime(2026, 2, 9, 9, 59, tzinfo=tz),
            status="scheduled",
        )
        boundary_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=datetime(2026, 2, 9, 10, 0, tzinfo=tz),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(parish=parish, mass_instance=inside_instance, position_type=position)

        score_inside = preference_score(None, inside_instance, slot, [pref])
        score_boundary = preference_score(None, boundary_instance, slot, [pref])

        self.assertEqual(score_inside, 40)
        self.assertEqual(score_boundary, 0)
```

### core\tests\test_publishing.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    Parish,
    PositionType,
)
from core.services.publishing import publish_assignments
from notifications.models import Notification


class PublishingTests(TestCase):
    def test_publish_creates_confirmations_and_notifications(self):
        User = get_user_model()
        user = User.objects.create_user(email="acolyte@example.com", full_name="Acolito", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, user=user, display_name="Acolito")

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="open",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, assignment_state="proposed")

        published = publish_assignments(parish, instance.starts_at.date(), instance.starts_at.date(), actor=user)
        self.assertEqual(published, 1)

        assignment.refresh_from_db()
        self.assertEqual(assignment.assignment_state, "published")
        self.assertIsNotNone(assignment.published_at)
        self.assertEqual(assignment.confirmation.status, "pending")
        self.assertEqual(Notification.objects.filter(user=user, parish=parish).count(), 2)

    def test_publish_is_idempotent(self):
        User = get_user_model()
        user = User.objects.create_user(email="acolyte2@example.com", full_name="Acolito", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, user=user, display_name="Acolito")

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="open",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, assignment_state="proposed")

        first = publish_assignments(parish, instance.starts_at.date(), instance.starts_at.date(), actor=user)
        second = publish_assignments(parish, instance.starts_at.date(), instance.starts_at.date(), actor=user)

        assignment.refresh_from_db()
        self.assertEqual(first, 1)
        self.assertEqual(second, 0)
        self.assertEqual(assignment.assignment_state, "published")
        self.assertEqual(Notification.objects.filter(user=user, parish=parish).count(), 2)
```

### core\tests\test_recommendations.py
```python
from datetime import timedelta

from django.test import TestCase
from django.utils import timezone

from core.models import Community, EventSeries, MassInstance, Parish
from core.services.recommendations import get_mass_context


class RecommendationContextTests(TestCase):
    def setUp(self):
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        today = timezone.now().date()
        self.series = EventSeries.objects.create(
            parish=self.parish,
            series_type="Novena",
            title="Serie",
            start_date=today,
            end_date=today,
            default_community=self.community,
            candidate_pool="interested_only",
        )

    def _create_instance(self):
        return MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            event_series=self.series,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )

    def test_interested_only_pool_before_deadline(self):
        instance = self._create_instance()
        now = instance.starts_at - timedelta(hours=60)
        context = get_mass_context(
            instance,
            {"interest_deadline_hours": 48, "interested_pool_fallback": "relax_to_all"},
            interest_map={},
            now=now,
        )
        self.assertEqual(context["pool_mode"], "empty")

    def test_interested_only_pool_after_deadline_relaxes(self):
        instance = self._create_instance()
        now = instance.starts_at - timedelta(hours=10)
        context = get_mass_context(
            instance,
            {"interest_deadline_hours": 48, "interested_pool_fallback": "relax_to_all"},
            interest_map={},
            now=now,
        )
        self.assertEqual(context["pool_mode"], "all")

    def test_interested_only_pool_after_deadline_strict(self):
        instance = self._create_instance()
        now = instance.starts_at - timedelta(hours=10)
        context = get_mass_context(
            instance,
            {"interest_deadline_hours": 48, "interested_pool_fallback": "strict"},
            interest_map={},
            now=now,
        )
        self.assertEqual(context["pool_mode"], "empty")

    def test_series_deadline_overrides_hours(self):
        instance = self._create_instance()
        deadline = instance.starts_at - timedelta(hours=12)
        self.series.interest_deadline_at = deadline
        self.series.save(update_fields=["interest_deadline_at", "updated_at"])

        context = get_mass_context(
            instance,
            {"interest_deadline_hours": 48},
            interest_map={},
            now=instance.starts_at - timedelta(hours=20),
        )
        self.assertEqual(context["interest_deadline_at"], deadline)
```

### core\tests\test_replacements.py
```python
from datetime import timedelta

from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    AcolyteQualification,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    Parish,
    PositionType,
    ReplacementRequest,
)
from core.services.assignments import ConcurrentUpdateError
from core.services.replacements import assign_replacement_request, create_replacement_request


class ReplacementServiceTests(TestCase):
    def test_assign_replacement_creates_new_assignment(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=parish, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=parish, display_name="Acolito B")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_a, position_type=position, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_b, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte_a)
        replacement = create_replacement_request(parish, slot)

        new_assignment = assign_replacement_request(parish, replacement.id, acolyte_b)

        assignment.refresh_from_db()
        slot.refresh_from_db()
        self.assertFalse(assignment.is_active)
        self.assertTrue(new_assignment.is_active)
        self.assertEqual(new_assignment.acolyte_id, acolyte_b.id)
        self.assertEqual(ReplacementRequest.objects.filter(parish=parish, slot=slot, status="assigned").count(), 1)

    def test_assign_replacement_request_is_exclusive(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=parish, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=parish, display_name="Acolito B")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_a, position_type=position, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_b, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte_a)
        replacement = create_replacement_request(parish, slot)

        assign_replacement_request(parish, replacement.id, acolyte_b)
        with self.assertRaises(ConcurrentUpdateError):
            assign_replacement_request(parish, replacement.id, acolyte_b)

        self.assertEqual(
            Assignment.objects.filter(parish=parish, slot=slot, is_active=True).count(),
            1,
        )

    def test_assign_replacement_rejects_foreign_parish(self):
        parish = Parish.objects.create(name="Parish")
        other_parish = Parish.objects.create(name="Other")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=parish, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=other_parish, display_name="Acolito B")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_a, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte_a)
        replacement = create_replacement_request(parish, slot)

        with self.assertRaises(ValueError):
            assign_replacement_request(parish, replacement.id, acolyte_b)
```

### core\tests\test_slots.py
```python
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    Community,
    MassInstance,
    Parish,
    PositionType,
    RequirementProfile,
    RequirementProfilePosition,
)
from core.services.slots import sync_slots_for_instance


class SlotSyncTests(TestCase):
    def test_sync_slots_creates_required_positions(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile = RequirementProfile.objects.create(parish=parish, name="Dominical")
        RequirementProfilePosition.objects.create(profile=profile, position_type=position, quantity=2)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            requirement_profile=profile,
            status="scheduled",
        )

        created = sync_slots_for_instance(instance)
        self.assertEqual(len(created), 2)
        self.assertEqual(instance.slots.count(), 2)

    def test_sync_slots_finalizes_removed_positions(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile_a = RequirementProfile.objects.create(parish=parish, name="Dominical")
        profile_b = RequirementProfile.objects.create(parish=parish, name="Simples")
        RequirementProfilePosition.objects.create(profile=profile_a, position_type=position, quantity=2)
        RequirementProfilePosition.objects.create(profile=profile_b, position_type=position, quantity=1)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            requirement_profile=profile_a,
            status="scheduled",
        )

        sync_slots_for_instance(instance)

        instance.requirement_profile = profile_b
        instance.save(update_fields=["requirement_profile", "updated_at"])
        sync_slots_for_instance(instance)

        removed_slot = instance.slots.get(slot_index=2)
        self.assertFalse(removed_slot.required)
        self.assertEqual(removed_slot.status, "finalized")

    def test_sync_slots_handles_missing_profile(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile = RequirementProfile.objects.create(parish=parish, name="Dominical")
        RequirementProfilePosition.objects.create(profile=profile, position_type=position, quantity=1)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            requirement_profile=profile,
            status="scheduled",
        )

        sync_slots_for_instance(instance)

        instance.requirement_profile = None
        instance.save(update_fields=["requirement_profile", "updated_at"])
        sync_slots_for_instance(instance)

        slot = instance.slots.get(slot_index=1)
        self.assertFalse(slot.required)
        self.assertEqual(slot.status, "finalized")

    def test_sync_slots_reactivates_slot_status(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile_a = RequirementProfile.objects.create(parish=parish, name="Dominical")
        profile_b = RequirementProfile.objects.create(parish=parish, name="Simples")
        RequirementProfilePosition.objects.create(profile=profile_a, position_type=position, quantity=2)
        RequirementProfilePosition.objects.create(profile=profile_b, position_type=position, quantity=1)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            requirement_profile=profile_a,
            status="scheduled",
        )
        sync_slots_for_instance(instance)

        instance.requirement_profile = profile_b
        instance.save(update_fields=["requirement_profile", "updated_at"])
        sync_slots_for_instance(instance)

        instance.requirement_profile = profile_a
        instance.save(update_fields=["requirement_profile", "updated_at"])
        sync_slots_for_instance(instance)

        slot = instance.slots.get(slot_index=2)
        self.assertTrue(slot.required)
        self.assertEqual(slot.status, "open")

    def test_sync_slots_clears_external_coverage_on_removal(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile_a = RequirementProfile.objects.create(parish=parish, name="Dominical")
        profile_b = RequirementProfile.objects.create(parish=parish, name="Simples")
        RequirementProfilePosition.objects.create(profile=profile_a, position_type=position, quantity=2)
        RequirementProfilePosition.objects.create(profile=profile_b, position_type=position, quantity=1)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            requirement_profile=profile_a,
            status="scheduled",
        )
        sync_slots_for_instance(instance)

        slot = instance.slots.get(slot_index=2)
        slot.externally_covered = True
        slot.external_coverage_notes = "Coberto"
        slot.save(update_fields=["externally_covered", "external_coverage_notes", "updated_at"])

        instance.requirement_profile = profile_b
        instance.save(update_fields=["requirement_profile", "updated_at"])
        sync_slots_for_instance(instance)

        slot.refresh_from_db()
        self.assertFalse(slot.externally_covered)
        self.assertEqual(slot.external_coverage_notes, "")

    def test_sync_slots_deactivates_assignment_on_removal(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile_a = RequirementProfile.objects.create(parish=parish, name="Dominical")
        profile_b = RequirementProfile.objects.create(parish=parish, name="Simples")
        RequirementProfilePosition.objects.create(profile=profile_a, position_type=position, quantity=2)
        RequirementProfilePosition.objects.create(profile=profile_b, position_type=position, quantity=1)
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            requirement_profile=profile_a,
            status="scheduled",
        )
        sync_slots_for_instance(instance)
        slot = instance.slots.get(slot_index=2)
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, assignment_state="published")

        instance.requirement_profile = profile_b
        instance.save(update_fields=["requirement_profile", "updated_at"])
        sync_slots_for_instance(instance)

        assignment.refresh_from_db()
        self.assertFalse(assignment.is_active)
```

### core\tests\test_stats.py
```python
from datetime import timedelta

from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    AcolyteCreditLedger,
    AcolyteStats,
    Assignment,
    AssignmentSlot,
    Community,
    Confirmation,
    MassInstance,
    Parish,
    PositionType,
)
from core.services.stats import recompute_stats


class StatsRecomputeTests(TestCase):
    def test_recompute_stats_scopes_by_parish(self):
        parish_a = Parish.objects.create(name="Parish A")
        parish_b = Parish.objects.create(name="Parish B")
        community_a = Community.objects.create(parish=parish_a, code="MAT", name="Matriz")
        community_b = Community.objects.create(parish=parish_b, code="STM", name="Comunidade")
        position_a = PositionType.objects.create(parish=parish_a, code="LIB", name="Libriferario")
        position_b = PositionType.objects.create(parish=parish_b, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=parish_a, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=parish_b, display_name="Acolito B")

        instance_a = MassInstance.objects.create(
            parish=parish_a,
            community=community_a,
            starts_at=timezone.now() - timedelta(days=1),
            status="scheduled",
        )
        slot_a = AssignmentSlot.objects.create(
            parish=parish_a,
            mass_instance=instance_a,
            position_type=position_a,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment_a = Assignment.objects.create(
            parish=parish_a,
            slot=slot_a,
            acolyte=acolyte_a,
            assignment_state="published",
        )
        Confirmation.objects.create(parish=parish_a, assignment=assignment_a, status="confirmed")

        instance_b = MassInstance.objects.create(
            parish=parish_b,
            community=community_b,
            starts_at=timezone.now() - timedelta(days=1),
            status="scheduled",
        )
        slot_b = AssignmentSlot.objects.create(
            parish=parish_b,
            mass_instance=instance_b,
            position_type=position_b,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment_b = Assignment.objects.create(
            parish=parish_b,
            slot=slot_b,
            acolyte=acolyte_b,
            assignment_state="published",
        )
        Confirmation.objects.create(parish=parish_b, assignment=assignment_b, status="declined")

        recompute_stats(parish_a)

        stats = AcolyteStats.objects.get(parish=parish_a, acolyte=acolyte_a)
        self.assertEqual(stats.confirmation_rate, 1.0)
        self.assertEqual(stats.cancellations_rate, 0.0)

    def test_credit_balance_scopes_by_parish(self):
        parish_a = Parish.objects.create(name="Parish A")
        parish_b = Parish.objects.create(name="Parish B")
        community_a = Community.objects.create(parish=parish_a, code="MAT", name="Matriz")
        position_a = PositionType.objects.create(parish=parish_a, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=parish_a, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=parish_b, display_name="Acolito B")

        instance_a = MassInstance.objects.create(
            parish=parish_a,
            community=community_a,
            starts_at=timezone.now() - timedelta(days=1),
            status="scheduled",
        )
        slot_a = AssignmentSlot.objects.create(
            parish=parish_a,
            mass_instance=instance_a,
            position_type=position_a,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(
            parish=parish_a,
            slot=slot_a,
            acolyte=acolyte_a,
            assignment_state="published",
        )

        AcolyteCreditLedger.objects.create(
            parish=parish_a,
            acolyte=acolyte_a,
            delta=5,
            reason_code="served_unpopular_slot",
        )
        AcolyteCreditLedger.objects.create(
            parish=parish_b,
            acolyte=acolyte_b,
            delta=100,
            reason_code="served_unpopular_slot",
        )

        recompute_stats(parish_a)

        stats = AcolyteStats.objects.get(parish=parish_a, acolyte=acolyte_a)
        self.assertEqual(stats.credit_balance, 5)
```

### core\admin.py
```python
from django.contrib import admin

from . import models

admin.site.register(models.Parish)
admin.site.register(models.Community)
admin.site.register(models.MembershipRole)
admin.site.register(models.ParishMembership)
admin.site.register(models.FamilyGroup)
admin.site.register(models.AcolyteProfile)
admin.site.register(models.AcolyteIntent)
admin.site.register(models.AcolyteAvailabilityRule)
admin.site.register(models.FunctionType)
admin.site.register(models.PositionType)
admin.site.register(models.PositionTypeFunction)
admin.site.register(models.AcolyteQualification)
admin.site.register(models.AcolytePreference)
admin.site.register(models.RequirementProfile)
admin.site.register(models.RequirementProfilePosition)
admin.site.register(models.MassTemplate)
admin.site.register(models.EventSeries)
admin.site.register(models.EventOccurrence)
admin.site.register(models.EventInterest)
admin.site.register(models.MassInterest)
admin.site.register(models.MassInstance)
admin.site.register(models.MassOverride)
admin.site.register(models.AssignmentSlot)
admin.site.register(models.Assignment)
admin.site.register(models.Confirmation)
admin.site.register(models.SwapRequest)
admin.site.register(models.ReplacementRequest)
admin.site.register(models.AcolyteCreditLedger)
admin.site.register(models.AcolyteStats)
admin.site.register(models.AuditEvent)
admin.site.register(models.CalendarFeedToken)
```

### core\apps.py
```python
from django.apps import AppConfig


class CoreConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "core"
```

### core\context_processors.py
```python
from types import SimpleNamespace

from core.models import Parish, ParishMembership
from core.services.permissions import ADMIN_ROLE_CODES, request_has_role


def active_parish(request):
    active = getattr(request, "active_parish", None)
    memberships = []
    no_parishes = False
    if request.user.is_authenticated:
        if request.user.is_system_admin:
            parishes = list(Parish.objects.all())
            memberships = [
                SimpleNamespace(parish=parish_obj, parish_id=parish_obj.id)
                for parish_obj in parishes
            ]
            if not parishes:
                no_parishes = True
        else:
            memberships = ParishMembership.objects.filter(user=request.user, active=True).select_related("parish")
    return {
        "active_parish": active,
        "parish_memberships": memberships,
        "can_manage_parish": request.user.is_authenticated
        and active is not None
        and request_has_role(request, ADMIN_ROLE_CODES),
        "no_parishes": no_parishes,
    }


def back_url(request):
    """Provide back_url for navigation."""
    back_url_value = request.session.get("back_url")
    current_url = request.build_absolute_uri()
    if back_url_value == current_url:
        back_url_value = None
    return {
        "back_url": back_url_value,
    }
```

### core\middleware.py
```python
from django.http import HttpResponseBadRequest, HttpResponseForbidden
from rest_framework.authentication import BasicAuthentication
from rest_framework.exceptions import AuthenticationFailed

from core.models import Parish, ParishMembership


class BackUrlMiddleware:
    """Middleware to track the last navigable URL for back navigation."""
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        response = self.get_response(request)

        # Only save GET requests that are navigable and successful
        if (request.method == "GET" and
            response.status_code < 400 and
            not request.headers.get("HX-Request") and  # Ignore HTMX requests
            not request.path.startswith(("/static/", "/media/", "/api/", "/admin/", "/logout/")) and
            not any(ext in request.path for ext in [".css", ".js", ".png", ".jpg", ".jpeg", ".gif", ".svg", ".ico", ".woff", ".woff2"])):
            current_url = request.build_absolute_uri()
            last_url = request.session.get("last_url")
            if current_url != last_url:
                if last_url:
                    request.session["back_url"] = last_url
                request.session["last_url"] = current_url

        return response


class ActiveParishMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        request.active_parish = None
        if request.user.is_authenticated:
            parish_id = request.session.get("active_parish_id")
            if parish_id:
                if request.user.is_system_admin:
                    request.active_parish = Parish.objects.filter(id=parish_id).first()
                else:
                    membership = ParishMembership.objects.filter(user=request.user, parish_id=parish_id, active=True).select_related("parish").first()
                    if membership:
                        request.active_parish = membership.parish
            if request.active_parish is None:
                membership = ParishMembership.objects.filter(user=request.user, active=True).select_related("parish").first()
                if membership:
                    request.active_parish = membership.parish
                    request.session["active_parish_id"] = membership.parish_id
            if request.active_parish is None and request.user.is_system_admin:
                request.active_parish = Parish.objects.first()
                if request.active_parish:
                    request.session["active_parish_id"] = request.active_parish.id
        return self.get_response(request)


class ApiParishHeaderMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response
        self.basic_auth = BasicAuthentication()

    def __call__(self, request):
        if request.path.startswith("/api/"):
            if not request.user.is_authenticated and request.META.get("HTTP_AUTHORIZATION"):
                try:
                    auth_result = self.basic_auth.authenticate(request)
                except AuthenticationFailed:
                    return HttpResponseForbidden("Paroquia invalida.")
                if auth_result:
                    request.user, request.auth = auth_result

            parish_id = request.headers.get("X-Parish-ID") or request.GET.get("parish_id")
            if parish_id:
                if not request.user.is_authenticated:
                    return HttpResponseForbidden("Paroquia invalida.")
                try:
                    parish_id = int(parish_id)
                except (TypeError, ValueError):
                    return HttpResponseForbidden("Paroquia invalida.")
                if request.user.is_system_admin:
                    parish = Parish.objects.filter(id=parish_id).first()
                else:
                    membership = ParishMembership.objects.filter(
                        user=request.user, parish_id=parish_id, active=True
                    ).select_related("parish").first()
                    parish = membership.parish if membership else None
                if parish is None:
                    return HttpResponseForbidden("Paroquia invalida.")
                request.active_parish = parish
            if request.active_parish is None:
                return HttpResponseBadRequest("Informe X-Parish-ID ou parish_id.")

        return self.get_response(request)
```

### core\models.py
```python
from django.conf import settings
from django.db import models
from django.db.models import Q


class TimeStampedModel(models.Model):
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        abstract = True


class Parish(TimeStampedModel):
    name = models.CharField(max_length=200)
    city = models.CharField(max_length=100, blank=True)
    state = models.CharField(max_length=50, blank=True)
    timezone = models.CharField(max_length=64, default="America/Sao_Paulo")
    contact_email = models.EmailField(blank=True)
    contact_phone = models.CharField(max_length=30, blank=True)
    consolidation_days = models.PositiveIntegerField(default=14)
    horizon_days = models.PositiveIntegerField(default=60)
    default_mass_duration_minutes = models.PositiveIntegerField(default=60)
    min_rest_minutes_between_masses = models.PositiveIntegerField(default=0)
    schedule_weights = models.JSONField(default=dict, blank=True)
    swap_requires_approval = models.BooleanField(default=True)
    notify_on_cancellation = models.BooleanField(default=True)
    auto_assign_on_decline = models.BooleanField(default=False)
    claim_auto_approve_enabled = models.BooleanField(default=False)
    claim_auto_approve_hours = models.PositiveIntegerField(default=48)
    claim_require_coordination = models.BooleanField(default=False)

    def __str__(self):
        return self.name


class Community(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    code = models.CharField(max_length=10)
    name = models.CharField(max_length=200)
    address = models.TextField(blank=True)
    active = models.BooleanField(default=True)

    class Meta:
        unique_together = ("parish", "code")

    def __str__(self):
        return f"{self.code} - {self.name}"


class MembershipRole(models.Model):
    code = models.CharField(max_length=40, unique=True)
    name = models.CharField(max_length=100)

    def __str__(self):
        return self.name


class ParishMembership(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    roles = models.ManyToManyField(MembershipRole, blank=True)
    active = models.BooleanField(default=True)

    class Meta:
        unique_together = ("parish", "user")

    def __str__(self):
        return f"{self.user} @ {self.parish}"

    def has_role(self, role_code):
        return self.roles.filter(code=role_code).exists()


class FamilyGroup(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    name = models.CharField(max_length=120)
    notes = models.TextField(blank=True)

    def __str__(self):
        return self.name


class AcolyteProfile(TimeStampedModel):
    EXPERIENCE_CHOICES = [
        ("beginner", "Iniciante"),
        ("intermediate", "Intermediario"),
        ("senior", "Senior"),
    ]
    SCHEDULING_MODE_CHOICES = [
        ("normal", "Normal"),
        ("reserve", "Reserva tecnica"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE, related_name="acolytes")
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    display_name = models.CharField(max_length=200)
    community_of_origin = models.ForeignKey(Community, on_delete=models.SET_NULL, null=True, blank=True)
    family_group = models.ForeignKey(FamilyGroup, on_delete=models.SET_NULL, null=True, blank=True)
    notes = models.TextField(blank=True)
    active = models.BooleanField(default=True)
    experience_level = models.CharField(max_length=20, choices=EXPERIENCE_CHOICES, default="intermediate")
    scheduling_mode = models.CharField(max_length=20, choices=SCHEDULING_MODE_CHOICES, default="normal")

    class Meta:
        constraints = [
            models.UniqueConstraint(
                fields=["parish", "user"],
                condition=Q(user__isnull=False),
                name="unique_acolyte_user_per_parish",
            )
        ]

    def __str__(self):
        return self.display_name


class AcolyteIntent(TimeStampedModel):
    WILLINGNESS_CHOICES = [
        ("low", "Baixo"),
        ("normal", "Normal"),
        ("high", "Alto"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    acolyte = models.OneToOneField(AcolyteProfile, on_delete=models.CASCADE)
    desired_frequency_per_month = models.PositiveIntegerField(null=True, blank=True)
    willingness_level = models.CharField(max_length=10, choices=WILLINGNESS_CHOICES, default="normal")


class AcolyteAvailabilityRule(TimeStampedModel):
    RULE_CHOICES = [
        ("unavailable", "Indisponivel"),
        ("available_only", "Disponivel apenas"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.CASCADE)
    rule_type = models.CharField(max_length=20, choices=RULE_CHOICES)
    day_of_week = models.PositiveSmallIntegerField(null=True, blank=True)
    start_time = models.TimeField(null=True, blank=True)
    end_time = models.TimeField(null=True, blank=True)
    community = models.ForeignKey(Community, on_delete=models.SET_NULL, null=True, blank=True)
    start_date = models.DateField(null=True, blank=True)
    end_date = models.DateField(null=True, blank=True)
    notes = models.TextField(blank=True)


class FunctionType(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    code = models.CharField(max_length=10)
    name = models.CharField(max_length=100)
    description = models.TextField(blank=True)
    active = models.BooleanField(default=True)

    class Meta:
        unique_together = ("parish", "code")

    def __str__(self):
        return self.name


class PositionType(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    code = models.CharField(max_length=20)
    name = models.CharField(max_length=100)
    active = models.BooleanField(default=True)
    functions = models.ManyToManyField(FunctionType, through="PositionTypeFunction", blank=True)

    class Meta:
        unique_together = ("parish", "code")

    def __str__(self):
        return self.name


class PositionTypeFunction(models.Model):
    position_type = models.ForeignKey(PositionType, on_delete=models.CASCADE)
    function_type = models.ForeignKey(FunctionType, on_delete=models.CASCADE)

    class Meta:
        unique_together = ("position_type", "function_type")


class AcolyteQualification(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.CASCADE)
    position_type = models.ForeignKey(PositionType, on_delete=models.CASCADE)
    qualified = models.BooleanField(default=True)

    class Meta:
        unique_together = ("parish", "acolyte", "position_type")


class AcolytePreference(TimeStampedModel):
    PREFERENCE_CHOICES = [
        ("preferred_community", "Preferir comunidade"),
        ("avoid_community", "Evitar comunidade"),
        ("preferred_timeslot", "Preferir horario"),
        ("preferred_mass_template", "Preferir modelo"),
        ("preferred_position", "Preferir funcao"),
        ("avoid_position", "Evitar funcao"),
        ("preferred_function", "Preferir funcao base"),
        ("avoid_function", "Evitar funcao base"),
        ("preferred_partner", "Preferir parceiro"),
        ("avoid_partner", "Evitar parceiro"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.CASCADE)
    preference_type = models.CharField(max_length=40, choices=PREFERENCE_CHOICES)
    target_community = models.ForeignKey(Community, on_delete=models.SET_NULL, null=True, blank=True)
    target_position = models.ForeignKey(PositionType, on_delete=models.SET_NULL, null=True, blank=True)
    target_function = models.ForeignKey(FunctionType, on_delete=models.SET_NULL, null=True, blank=True)
    target_template = models.ForeignKey("MassTemplate", on_delete=models.SET_NULL, null=True, blank=True)
    target_acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.SET_NULL, null=True, blank=True, related_name="preferred_by")
    weekday = models.PositiveSmallIntegerField(null=True, blank=True)
    start_time = models.TimeField(null=True, blank=True)
    end_time = models.TimeField(null=True, blank=True)
    weight = models.PositiveIntegerField(default=50)


class RequirementProfile(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    name = models.CharField(max_length=150)
    notes = models.TextField(blank=True)
    active = models.BooleanField(default=True)
    min_senior_per_mass = models.PositiveSmallIntegerField(default=0)

    def __str__(self):
        return self.name


class RequirementProfilePosition(models.Model):
    profile = models.ForeignKey(RequirementProfile, on_delete=models.CASCADE, related_name="positions")
    position_type = models.ForeignKey(PositionType, on_delete=models.CASCADE)
    quantity = models.PositiveSmallIntegerField(default=1)

    class Meta:
        unique_together = ("profile", "position_type")


class MassTemplate(TimeStampedModel):
    WEEKDAY_CHOICES = [
        (0, "Mon"),
        (1, "Tue"),
        (2, "Wed"),
        (3, "Thu"),
        (4, "Fri"),
        (5, "Sat"),
        (6, "Sun"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    title = models.CharField(max_length=200)
    community = models.ForeignKey(Community, on_delete=models.CASCADE)
    weekday = models.PositiveSmallIntegerField(choices=WEEKDAY_CHOICES)
    time = models.TimeField()
    rrule_text = models.TextField(blank=True)
    active = models.BooleanField(default=True)
    default_requirement_profile = models.ForeignKey(RequirementProfile, on_delete=models.SET_NULL, null=True, blank=True)
    notes = models.TextField(blank=True)

    def __str__(self):
        return self.title


class EventSeries(TimeStampedModel):
    CANDIDATE_POOL_CHOICES = [
        ("all", "Todos"),
        ("interested_only", "Somente interessados"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    series_type = models.CharField(max_length=40)
    title = models.CharField(max_length=200)
    start_date = models.DateField()
    end_date = models.DateField()
    default_community = models.ForeignKey(Community, on_delete=models.SET_NULL, null=True, blank=True)
    ruleset_json = models.JSONField(default=dict, blank=True)
    candidate_pool = models.CharField(max_length=20, choices=CANDIDATE_POOL_CHOICES, default="all")
    interest_deadline_at = models.DateTimeField(null=True, blank=True)
    created_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True, related_name="eventseries_created")
    updated_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True, related_name="eventseries_updated")
    is_active = models.BooleanField(default=True)


class EventOccurrence(TimeStampedModel):
    CONFLICT_CHOICES = [
        ("keep", "Manter existente"),
        ("cancel_existing", "Cancelar existente"),
        ("move_existing", "Mover existente"),
        ("skip", "Ignorar"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    event_series = models.ForeignKey(EventSeries, on_delete=models.CASCADE, related_name="occurrences")
    date = models.DateField()
    time = models.TimeField()
    community = models.ForeignKey(Community, on_delete=models.CASCADE)
    requirement_profile = models.ForeignKey(RequirementProfile, on_delete=models.SET_NULL, null=True, blank=True)
    label = models.CharField(max_length=200, blank=True)
    conflict_action = models.CharField(max_length=20, choices=CONFLICT_CHOICES, default="keep")
    move_to_date = models.DateField(null=True, blank=True)
    move_to_time = models.TimeField(null=True, blank=True)
    move_to_community = models.ForeignKey(Community, on_delete=models.SET_NULL, null=True, blank=True, related_name="moved_occurrences")


class EventInterest(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    event_series = models.ForeignKey(EventSeries, on_delete=models.CASCADE)
    acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.CASCADE)
    interested = models.BooleanField(default=True)
    notes = models.TextField(blank=True)

    class Meta:
        unique_together = ("event_series", "acolyte")


class MassInstance(TimeStampedModel):
    STATUS_CHOICES = [
        ("scheduled", "Agendada"),
        ("canceled", "Cancelada"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    template = models.ForeignKey(MassTemplate, on_delete=models.SET_NULL, null=True, blank=True)
    event_series = models.ForeignKey(EventSeries, on_delete=models.SET_NULL, null=True, blank=True)
    community = models.ForeignKey(Community, on_delete=models.CASCADE)
    starts_at = models.DateTimeField()
    liturgy_label = models.CharField(max_length=200, blank=True)
    requirement_profile = models.ForeignKey(RequirementProfile, on_delete=models.SET_NULL, null=True, blank=True)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default="scheduled")
    created_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True, related_name="mass_created")
    updated_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True, related_name="mass_updated")

    class Meta:
        constraints = [
            models.UniqueConstraint(
                fields=["parish", "starts_at", "community"],
                condition=Q(status="scheduled"),
                name="unique_scheduled_mass_per_slot",
            )
        ]

    def __str__(self):
        return f"{self.community.code} - {self.starts_at}"


class MassInterest(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    mass_instance = models.ForeignKey(MassInstance, on_delete=models.CASCADE)
    acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.CASCADE)
    interested = models.BooleanField(default=True)
    notes = models.TextField(blank=True)

    class Meta:
        unique_together = ("mass_instance", "acolyte")


class MassOverride(TimeStampedModel):
    OVERRIDE_CHOICES = [
        ("cancel_instance", "Cancelar missa"),
        ("move_instance", "Mover missa"),
        ("change_requirements", "Alterar requisitos"),
        ("change_display_fields", "Alterar exibicao"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    instance = models.ForeignKey(MassInstance, on_delete=models.CASCADE)
    override_type = models.CharField(max_length=40, choices=OVERRIDE_CHOICES)
    payload = models.JSONField(default=dict, blank=True)
    created_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)


class AssignmentSlot(TimeStampedModel):
    STATUS_CHOICES = [
        ("open", "Aberta"),
        ("assigned", "Atribuida"),
        ("finalized", "Finalizada"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    mass_instance = models.ForeignKey(MassInstance, on_delete=models.CASCADE, related_name="slots")
    position_type = models.ForeignKey(PositionType, on_delete=models.CASCADE)
    slot_index = models.PositiveSmallIntegerField(default=1)
    required = models.BooleanField(default=True)
    externally_covered = models.BooleanField(default=False)
    external_coverage_notes = models.TextField(blank=True)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default="open")
    is_locked = models.BooleanField(default=False)
    locked_at = models.DateTimeField(null=True, blank=True)

    class Meta:
        unique_together = ("mass_instance", "position_type", "slot_index")

    def get_active_assignment(self):
        if hasattr(self, "active_assignments"):
            return self.active_assignments[0] if self.active_assignments else None
        return self.assignments.filter(is_active=True).first()

    @property
    def active_assignment(self):
        return self.get_active_assignment()


class Assignment(TimeStampedModel):
    END_REASON_CHOICES = [
        ("declined", "Recusado"),
        ("canceled", "Cancelado"),
        ("replaced", "Substituido"),
        ("replaced_by_solver", "Substituido pelo sistema"),
        ("manual_unassign", "Removido manualmente"),
        ("moved_to_another_slot", "Movido para outra posicao"),
        ("swap", "Trocado"),
        ("claim_transfer", "Transferido por solicitacao"),
    ]
    STATE_CHOICES = [
        ("proposed", "Proposta"),
        ("published", "Publicada"),
        ("locked", "Consolidada"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    slot = models.ForeignKey(AssignmentSlot, on_delete=models.CASCADE, related_name="assignments")
    acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.PROTECT)
    assigned_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    assigned_at = models.DateTimeField(auto_now_add=True)
    assignment_state = models.CharField(max_length=20, choices=STATE_CHOICES, default="proposed")
    published_at = models.DateTimeField(null=True, blank=True)
    is_active = models.BooleanField(default=True)
    ended_at = models.DateTimeField(null=True, blank=True)
    end_reason = models.CharField(max_length=30, choices=END_REASON_CHOICES, blank=True)

    class Meta:
        constraints = [
            models.UniqueConstraint(
                fields=["slot"],
                condition=Q(is_active=True),
                name="unique_active_assignment_per_slot",
            )
        ]

    @property
    def confirmation_status(self):
        try:
            confirmation = self.confirmation
        except Confirmation.DoesNotExist:
            confirmation = None
        if confirmation:
            return confirmation.status
        return "pending"

    def get_confirmation_status_display(self):
        mapping = dict(Confirmation.STATUS_CHOICES)
        return mapping.get(self.confirmation_status, self.confirmation_status)


class Confirmation(TimeStampedModel):
    STATUS_CHOICES = [
        ("pending", "Pendente"),
        ("confirmed", "Confirmada"),
        ("declined", "Recusada"),
        ("canceled_by_acolyte", "Cancelada"),
        ("replaced", "Substituida"),
        ("no_show", "Nao compareceu"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    assignment = models.OneToOneField(Assignment, on_delete=models.CASCADE, related_name="confirmation")
    status = models.CharField(max_length=30, choices=STATUS_CHOICES, default="pending")
    notes = models.TextField(blank=True)
    updated_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    timestamp = models.DateTimeField(auto_now=True)


class SwapRequest(TimeStampedModel):
    STATUS_CHOICES = [
        ("pending", "Pendente"),
        ("awaiting_approval", "Aguardando aprovacao"),
        ("accepted", "Aceita"),
        ("rejected", "Recusada"),
        ("canceled", "Cancelada"),
    ]
    TYPE_CHOICES = [
        ("acolyte_swap", "Troca de acolito"),
        ("role_swap", "Troca de funcao"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    swap_type = models.CharField(max_length=20, choices=TYPE_CHOICES)
    requestor_acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.CASCADE, related_name="swap_requests")
    target_acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.SET_NULL, null=True, blank=True, related_name="swap_targets")
    mass_instance = models.ForeignKey(MassInstance, on_delete=models.CASCADE)
    from_slot = models.ForeignKey(AssignmentSlot, on_delete=models.SET_NULL, null=True, blank=True, related_name="swap_from")
    to_slot = models.ForeignKey(AssignmentSlot, on_delete=models.SET_NULL, null=True, blank=True, related_name="swap_to")
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default="pending")
    notes = models.TextField(blank=True)
    open_to_admin = models.BooleanField(default=False)
    group_id = models.UUIDField(null=True, blank=True, db_index=True)


class PositionClaimRequest(TimeStampedModel):
    STATUS_CHOICES = [
        ("pending_target", "Aguardando titular"),
        ("pending_coordination", "Aguardando coordenacao"),
        ("scheduled_auto_approve", "Aguardando prazo"),
        ("approved", "Aprovada"),
        ("rejected", "Recusada"),
        ("expired", "Expirada"),
    ]
    APPROVAL_CHOICES = [
        ("target", "Titular"),
        ("coordination", "Coordenacao"),
        ("auto", "Automatica"),
    ]
    RESOLUTION_CHOICES = [
        ("holder_approved", "Titular aprovou"),
        ("holder_confirmed", "Titular confirmou"),
        ("holder_rejected", "Titular recusou"),
        ("holder_selected_other", "Outro solicitante escolhido"),
        ("coordination_approved", "Aprovada pela coordenacao"),
        ("coordination_rejected", "Recusada pela coordenacao"),
        ("auto_approved", "Aprovada pelo prazo"),
        ("auto_expired", "Expirada pelo prazo"),
        ("requestor_canceled", "Cancelada pelo solicitante"),
        ("assignment_changed", "Escala alterada"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    slot = models.ForeignKey(AssignmentSlot, on_delete=models.CASCADE, related_name="position_claims")
    requestor_acolyte = models.ForeignKey(
        AcolyteProfile, on_delete=models.CASCADE, related_name="position_claim_requests"
    )
    target_assignment = models.ForeignKey(
        Assignment, on_delete=models.SET_NULL, null=True, blank=True, related_name="position_claims"
    )
    status = models.CharField(max_length=30, choices=STATUS_CHOICES, default="pending_target")
    approval_mode = models.CharField(max_length=30, choices=APPROVAL_CHOICES, blank=True)
    resolution_reason = models.CharField(max_length=40, choices=RESOLUTION_CHOICES, blank=True)
    auto_approve_at = models.DateTimeField(null=True, blank=True)
    resolved_at = models.DateTimeField(null=True, blank=True)
    approved_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)

    class Meta:
        indexes = [
            models.Index(fields=["slot", "status"]),
            models.Index(fields=["requestor_acolyte", "status"]),
        ]


class ReplacementRequest(TimeStampedModel):
    STATUS_CHOICES = [
        ("pending", "Pendente"),
        ("assigned", "Atribuida"),
        ("canceled", "Cancelada"),
        ("resolved", "Resolvida"),
    ]
    RESOLUTION_CHOICES = [
        ("mass_canceled", "Missa cancelada"),
        ("slot_not_required", "Funcao nao necessaria"),
        ("covered_externally", "Coberto externamente"),
        ("other", "Outro"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    slot = models.ForeignKey(AssignmentSlot, on_delete=models.CASCADE)
    requested_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    proposed_acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.SET_NULL, null=True, blank=True)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default="pending")
    notes = models.TextField(blank=True)
    resolved_reason = models.CharField(max_length=30, choices=RESOLUTION_CHOICES, blank=True)
    resolved_notes = models.TextField(blank=True)
    resolved_at = models.DateTimeField(null=True, blank=True)


class AcolyteCreditLedger(TimeStampedModel):
    REASON_CHOICES = [
        ("served_unpopular_slot", "Serviu em horario pouco procurado"),
        ("accepted_last_minute_substitution", "Aceitou substituicao de ultima hora"),
        ("high_attendance_streak", "Boa sequencia de presencas"),
        ("received_high_demand_assignment", "Recebeu funcao disputada"),
        ("manual_adjustment", "Ajuste manual"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    acolyte = models.ForeignKey(AcolyteProfile, on_delete=models.CASCADE)
    delta = models.IntegerField()
    reason_code = models.CharField(max_length=40, choices=REASON_CHOICES)
    related_assignment = models.ForeignKey(Assignment, on_delete=models.SET_NULL, null=True, blank=True)
    notes = models.TextField(blank=True)
    created_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)


class AcolyteStats(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    acolyte = models.OneToOneField(AcolyteProfile, on_delete=models.CASCADE)
    services_last_30_days = models.PositiveIntegerField(default=0)
    services_last_90_days = models.PositiveIntegerField(default=0)
    confirmation_rate = models.FloatField(default=0.0)
    cancellations_rate = models.FloatField(default=0.0)
    no_show_count = models.PositiveIntegerField(default=0)
    last_served_at = models.DateTimeField(null=True, blank=True)
    reliability_score = models.FloatField(default=0.0)
    credit_balance = models.IntegerField(default=0)


class CalendarFeedToken(TimeStampedModel):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    token = models.CharField(max_length=64, unique=True)
    rotated_at = models.DateTimeField(null=True, blank=True)

    class Meta:
        unique_together = ("parish", "user")


class AuditEvent(models.Model):
    parish = models.ForeignKey(Parish, on_delete=models.SET_NULL, null=True, blank=True)
    actor_user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    entity_type = models.CharField(max_length=100)
    entity_id = models.CharField(max_length=100)
    action_type = models.CharField(max_length=50)
    diff_json = models.JSONField(default=dict, blank=True)
    timestamp = models.DateTimeField(auto_now_add=True)

    class Meta:
        indexes = [
            models.Index(fields=["entity_type", "entity_id"]),
            models.Index(fields=["parish", "timestamp"]),
        ]
```

### fixtures\seed_parish.json
```json
[
  {
    "model": "core.parish",
    "pk": 1,
    "fields": {
      "name": "Paroquia Nossa Senhora Medianeira de Todas as Gracas",
      "city": "Sorocaba",
      "state": "SP",
      "timezone": "America/Sao_Paulo",
      "contact_email": "",
      "contact_phone": "",
      "consolidation_days": 14,
      "horizon_days": 60,
      "default_mass_duration_minutes": 60,
      "min_rest_minutes_between_masses": 0,
      "schedule_weights": {
        "fairness_penalty": 1,
        "stability_penalty": 10
      },
      "swap_requires_approval": true,
      "notify_on_cancellation": true,
      "auto_assign_on_decline": false,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.membershiprole",
    "pk": 2,
    "fields": {
      "code": "PARISH_ADMIN",
      "name": "Parish admin"
    }
  },
  {
    "model": "core.membershiprole",
    "pk": 3,
    "fields": {
      "code": "ACOLYTE_COORDINATOR",
      "name": "Acolyte coordinator"
    }
  },
  {
    "model": "core.membershiprole",
    "pk": 4,
    "fields": {
      "code": "PASTOR",
      "name": "Pastor"
    }
  },
  {
    "model": "core.membershiprole",
    "pk": 5,
    "fields": {
      "code": "SECRETARY",
      "name": "Secretary"
    }
  },
  {
    "model": "core.membershiprole",
    "pk": 6,
    "fields": {
      "code": "ACOLYTE",
      "name": "Acolyte"
    }
  },
  {
    "model": "core.community",
    "pk": 1,
    "fields": {
      "parish": 1,
      "code": "MAT",
      "name": "Matriz",
      "address": "Rua Araraquara, 27 - Jardim Leocadia - Sorocaba/SP",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.community",
    "pk": 2,
    "fields": {
      "parish": 1,
      "code": "STM",
      "name": "Sao Tiago Maior",
      "address": "Av. Padre Livio Emilio Calliari - Parque Ibiti Reserva - Sorocaba/SP",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.community",
    "pk": 3,
    "fields": {
      "parish": 1,
      "code": "SJT",
      "name": "Sao Judas Tadeu",
      "address": "Rua Henrique Emilio Colo, 28 - Jardim Sao Judas Tadeu - Sorocaba/SP",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.community",
    "pk": 4,
    "fields": {
      "parish": 1,
      "code": "SJB",
      "name": "Sao Joao Batista",
      "address": "Rua Pedro Wurschig, 400 - Retiro Sao Joao - Sorocaba/SP",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.community",
    "pk": 5,
    "fields": {
      "parish": 1,
      "code": "DES",
      "name": "Divino Espirito Santo",
      "address": "Praca dos Sorocabanos, 93 - Jardim Saira - Sorocaba/SP",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.community",
    "pk": 6,
    "fields": {
      "parish": 1,
      "code": "NSL",
      "name": "Nossa Senhora de Lourdes",
      "address": "Av. Eng. Carlos Reinaldo Mendes, 1009 - Alem Ponte - Sorocaba/SP",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.functiontype",
    "pk": 1,
    "fields": {
      "parish": 1,
      "code": "LIB",
      "name": "Libriferario",
      "description": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.functiontype",
    "pk": 2,
    "fields": {
      "parish": 1,
      "code": "CRU",
      "name": "Cruciferario",
      "description": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.functiontype",
    "pk": 4,
    "fields": {
      "parish": 1,
      "code": "TUR",
      "name": "Turiferario",
      "description": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.functiontype",
    "pk": 5,
    "fields": {
      "parish": 1,
      "code": "NAV",
      "name": "Naveteiro",
      "description": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.functiontype",
    "pk": 6,
    "fields": {
      "parish": 1,
      "code": "MIC",
      "name": "Microfone",
      "description": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.functiontype",
    "pk": 7,
    "fields": {
      "parish": 1,
      "code": "CER",
      "name": "Ceroferario",
      "description": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.positiontype",
    "pk": 1,
    "fields": {
      "parish": 1,
      "code": "LIB",
      "name": "Libriferario",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.positiontype",
    "pk": 2,
    "fields": {
      "parish": 1,
      "code": "CRU_MIC",
      "name": "Cruciferario + Microfone",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.positiontype",
    "pk": 3,
    "fields": {
      "parish": 1,
      "code": "TUR",
      "name": "Turiferario",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.positiontype",
    "pk": 4,
    "fields": {
      "parish": 1,
      "code": "NAV",
      "name": "Naveteiro",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.positiontype",
    "pk": 5,
    "fields": {
      "parish": 1,
      "code": "CER",
      "name": "Ceroferario",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.positiontype",
    "pk": 6,
    "fields": {
      "parish": 1,
      "code": "CRU",
      "name": "Cruciferario",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.positiontypefunction",
    "pk": 1,
    "fields": {
      "position_type": 1,
      "function_type": 1
    }
  },
  {
    "model": "core.positiontypefunction",
    "pk": 2,
    "fields": {
      "position_type": 2,
      "function_type": 2
    }
  },
  {
    "model": "core.positiontypefunction",
    "pk": 3,
    "fields": {
      "position_type": 2,
      "function_type": 6
    }
  },
  {
    "model": "core.positiontypefunction",
    "pk": 4,
    "fields": {
      "position_type": 3,
      "function_type": 4
    }
  },
  {
    "model": "core.positiontypefunction",
    "pk": 5,
    "fields": {
      "position_type": 4,
      "function_type": 5
    }
  },
  {
    "model": "core.positiontypefunction",
    "pk": 6,
    "fields": {
      "position_type": 5,
      "function_type": 7
    }
  },
  {
    "model": "core.positiontypefunction",
    "pk": 7,
    "fields": {
      "position_type": 6,
      "function_type": 2
    }
  },
  {
    "model": "core.requirementprofile",
    "pk": 1,
    "fields": {
      "parish": 1,
      "name": "Dominical Simples (1)",
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.requirementprofile",
    "pk": 2,
    "fields": {
      "parish": 1,
      "name": "Dominical (2)",
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.requirementprofile",
    "pk": 3,
    "fields": {
      "parish": 1,
      "name": "Solenidade Incenso (4)",
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.requirementprofileposition",
    "pk": 1,
    "fields": {
      "profile": 1,
      "position_type": 1,
      "quantity": 1
    }
  },
  {
    "model": "core.requirementprofileposition",
    "pk": 2,
    "fields": {
      "profile": 2,
      "position_type": 1,
      "quantity": 1
    }
  },
  {
    "model": "core.requirementprofileposition",
    "pk": 3,
    "fields": {
      "profile": 2,
      "position_type": 2,
      "quantity": 1
    }
  },
  {
    "model": "core.requirementprofileposition",
    "pk": 4,
    "fields": {
      "profile": 3,
      "position_type": 1,
      "quantity": 1
    }
  },
  {
    "model": "core.requirementprofileposition",
    "pk": 5,
    "fields": {
      "profile": 3,
      "position_type": 2,
      "quantity": 1
    }
  },
  {
    "model": "core.requirementprofileposition",
    "pk": 6,
    "fields": {
      "profile": 3,
      "position_type": 3,
      "quantity": 1
    }
  },
  {
    "model": "core.requirementprofileposition",
    "pk": 7,
    "fields": {
      "profile": 3,
      "position_type": 4,
      "quantity": 1
    }
  },
  {
    "model": "core.masstemplate",
    "pk": 1,
    "fields": {
      "parish": 1,
      "title": "SJB Sabado 17:00",
      "community": 4,
      "weekday": 5,
      "time": "17:00",
      "rrule_text": "",
      "active": true,
      "default_requirement_profile": 1,
      "notes": "",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.masstemplate",
    "pk": 2,
    "fields": {
      "parish": 1,
      "title": "STM Sabado 18:30",
      "community": 2,
      "weekday": 5,
      "time": "18:30",
      "rrule_text": "",
      "active": true,
      "default_requirement_profile": 1,
      "notes": "",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.masstemplate",
    "pk": 3,
    "fields": {
      "parish": 1,
      "title": "SJT Sabado 19:45",
      "community": 3,
      "weekday": 5,
      "time": "19:45",
      "rrule_text": "",
      "active": true,
      "default_requirement_profile": 1,
      "notes": "",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.masstemplate",
    "pk": 4,
    "fields": {
      "parish": 1,
      "title": "MAT Domingo 07:00",
      "community": 1,
      "weekday": 6,
      "time": "07:00",
      "rrule_text": "",
      "active": true,
      "default_requirement_profile": 1,
      "notes": "",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.masstemplate",
    "pk": 5,
    "fields": {
      "parish": 1,
      "title": "NSL Domingo 08:15",
      "community": 6,
      "weekday": 6,
      "time": "08:15",
      "rrule_text": "",
      "active": true,
      "default_requirement_profile": 1,
      "notes": "",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.masstemplate",
    "pk": 6,
    "fields": {
      "parish": 1,
      "title": "DES Domingo 09:30",
      "community": 5,
      "weekday": 6,
      "time": "09:30",
      "rrule_text": "",
      "active": true,
      "default_requirement_profile": 1,
      "notes": "",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.masstemplate",
    "pk": 7,
    "fields": {
      "parish": 1,
      "title": "MAT Domingo 19:00",
      "community": 1,
      "weekday": 6,
      "time": "19:00",
      "rrule_text": "",
      "active": true,
      "default_requirement_profile": 1,
      "notes": "",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 1,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Fábio Miguel",
      "community_of_origin": 2,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 2,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Maria Fernanda",
      "community_of_origin": 2,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 3,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Pedro Miguel",
      "community_of_origin": 2,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 4,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Melissa Martins",
      "community_of_origin": 2,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 5,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Nuno",
      "community_of_origin": 2,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 6,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Melissa Paes",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 7,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Heloa",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 8,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Mariana",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 9,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Sara",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 10,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Kalynda",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 11,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Manuela",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 12,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Heloisa",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 13,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Lucca",
      "community_of_origin": 1,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 14,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Luiz Fernando",
      "community_of_origin": 3,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 15,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Leandro",
      "community_of_origin": 3,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 16,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Pedro",
      "community_of_origin": 6,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 17,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Emanuelly",
      "community_of_origin": 6,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 18,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Davi",
      "community_of_origin": 5,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 19,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Eloa",
      "community_of_origin": 5,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 20,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Maria Clara",
      "community_of_origin": 4,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  },
  {
    "model": "core.acolyteprofile",
    "pk": 21,
    "fields": {
      "parish": 1,
      "user": null,
      "display_name": "Mickael Enzo",
      "community_of_origin": 4,
      "notes": "",
      "active": true,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  }
]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\acolytecreditledger.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\confirmation.json
```json
[{"model": "core.confirmation", "pk": 1, "fields": {"created_at": "2026-01-20T06:43:20.224Z", "updated_at": "2026-01-20T06:43:20.224Z", "parish": 1, "assignment": 57, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-20T06:43:20.224Z"}}, {"model": "core.confirmation", "pk": 2, "fields": {"created_at": "2026-01-20T06:43:23.061Z", "updated_at": "2026-01-20T06:43:23.061Z", "parish": 1, "assignment": 58, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-20T06:43:23.061Z"}}, {"model": "core.confirmation", "pk": 3, "fields": {"created_at": "2026-01-20T06:43:25.361Z", "updated_at": "2026-01-20T06:43:25.361Z", "parish": 1, "assignment": 59, "status": "canceled_by_acolyte", "notes": "", "updated_by": 1, "timestamp": "2026-01-20T06:46:54.732Z"}}, {"model": "core.confirmation", "pk": 4, "fields": {"created_at": "2026-01-20T06:45:43.861Z", "updated_at": "2026-01-20T06:45:43.861Z", "parish": 1, "assignment": 117, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-20T06:45:43.861Z"}}, {"model": "core.confirmation", "pk": 5, "fields": {"created_at": "2026-01-20T06:45:52.486Z", "updated_at": "2026-01-20T06:45:52.486Z", "parish": 1, "assignment": 118, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-20T06:45:52.486Z"}}, {"model": "core.confirmation", "pk": 6, "fields": {"created_at": "2026-01-20T07:49:48.828Z", "updated_at": "2026-01-20T07:49:48.828Z", "parish": 1, "assignment": 177, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-24T10:00:43.275Z"}}, {"model": "core.confirmation", "pk": 7, "fields": {"created_at": "2026-01-21T03:50:15.299Z", "updated_at": "2026-01-21T03:50:15.299Z", "parish": 1, "assignment": 234, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-21T03:50:15.309Z"}}, {"model": "core.confirmation", "pk": 8, "fields": {"created_at": "2026-01-21T03:50:19.161Z", "updated_at": "2026-01-21T03:50:19.161Z", "parish": 1, "assignment": 235, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-21T03:50:19.168Z"}}, {"model": "core.confirmation", "pk": 43, "fields": {"created_at": "2026-01-23T10:47:32.191Z", "updated_at": "2026-01-23T10:47:32.201Z", "parish": 1, "assignment": 237, "status": "confirmed", "notes": "Confirmado pelo admin Fábio Miguel Denda Pacheco", "updated_by": 1, "timestamp": "2026-01-23T10:47:32.201Z"}}, {"model": "core.confirmation", "pk": 40, "fields": {"created_at": "2026-01-23T10:45:10.214Z", "updated_at": "2026-01-23T10:45:10.226Z", "parish": 1, "assignment": 243, "status": "confirmed", "notes": "Confirmado pelo admin Fábio Miguel Denda Pacheco", "updated_by": 1, "timestamp": "2026-01-23T10:45:10.226Z"}}, {"model": "core.confirmation", "pk": 45, "fields": {"created_at": "2026-01-23T10:50:46.367Z", "updated_at": "2026-01-23T10:50:46.381Z", "parish": 1, "assignment": 244, "status": "confirmed", "notes": "Confirmado pelo admin Fábio Miguel Denda Pacheco", "updated_by": 1, "timestamp": "2026-01-23T10:50:46.381Z"}}, {"model": "core.confirmation", "pk": 47, "fields": {"created_at": "2026-01-23T11:28:01.989Z", "updated_at": "2026-01-23T11:28:02.002Z", "parish": 1, "assignment": 250, "status": "confirmed", "notes": "Confirmado pelo admin Fábio Miguel Denda Pacheco", "updated_by": 1, "timestamp": "2026-01-23T11:28:02.002Z"}}, {"model": "core.confirmation", "pk": 48, "fields": {"created_at": "2026-01-23T12:54:07.752Z", "updated_at": "2026-01-23T12:54:07.752Z", "parish": 1, "assignment": 257, "status": "declined", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T18:10:45.131Z"}}, {"model": "core.confirmation", "pk": 57, "fields": {"created_at": "2026-01-24T10:11:16.279Z", "updated_at": "2026-01-24T10:11:16.279Z", "parish": 1, "assignment": 263, "status": "declined", "notes": "", "updated_by": 3, "timestamp": "2026-01-24T10:11:29.913Z"}}, {"model": "core.confirmation", "pk": 41, "fields": {"created_at": "2026-01-23T10:47:16.429Z", "updated_at": "2026-01-23T10:47:16.438Z", "parish": 1, "assignment": 270, "status": "confirmed", "notes": "Confirmado pelo admin Fábio Miguel Denda Pacheco", "updated_by": 1, "timestamp": "2026-01-23T10:47:16.439Z"}}, {"model": "core.confirmation", "pk": 67, "fields": {"created_at": "2026-01-24T11:22:43.986Z", "updated_at": "2026-01-24T11:22:43.986Z", "parish": 1, "assignment": 271, "status": "declined", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T18:09:03.902Z"}}, {"model": "core.confirmation", "pk": 66, "fields": {"created_at": "2026-01-24T11:22:41.570Z", "updated_at": "2026-01-24T11:22:41.570Z", "parish": 1, "assignment": 282, "status": "declined", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T18:08:53.392Z"}}, {"model": "core.confirmation", "pk": 10, "fields": {"created_at": "2026-01-21T07:22:38.011Z", "updated_at": "2026-01-21T07:22:38.011Z", "parish": 1, "assignment": 296, "status": "canceled_by_acolyte", "notes": "", "updated_by": 1, "timestamp": "2026-01-23T11:28:57.019Z"}}, {"model": "core.confirmation", "pk": 11, "fields": {"created_at": "2026-01-21T13:37:50.053Z", "updated_at": "2026-01-21T13:37:50.053Z", "parish": 1, "assignment": 314, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-21T21:38:01.736Z"}}, {"model": "core.confirmation", "pk": 12, "fields": {"created_at": "2026-01-21T13:38:03.174Z", "updated_at": "2026-01-21T13:38:03.174Z", "parish": 1, "assignment": 315, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-21T13:38:03.174Z"}}, {"model": "core.confirmation", "pk": 13, "fields": {"created_at": "2026-01-22T12:21:36.668Z", "updated_at": "2026-01-22T12:21:36.668Z", "parish": 1, "assignment": 316, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-22T12:41:52.138Z"}}, {"model": "core.confirmation", "pk": 14, "fields": {"created_at": "2026-01-22T12:21:47.279Z", "updated_at": "2026-01-22T12:21:47.279Z", "parish": 1, "assignment": 317, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-22T12:41:54.325Z"}}, {"model": "core.confirmation", "pk": 15, "fields": {"created_at": "2026-01-23T06:36:29.420Z", "updated_at": "2026-01-23T06:36:29.420Z", "parish": 1, "assignment": 318, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:36:29.420Z"}}, {"model": "core.confirmation", "pk": 16, "fields": {"created_at": "2026-01-23T06:36:32.371Z", "updated_at": "2026-01-23T06:36:32.371Z", "parish": 1, "assignment": 319, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:36:32.371Z"}}, {"model": "core.confirmation", "pk": 17, "fields": {"created_at": "2026-01-23T06:53:01.319Z", "updated_at": "2026-01-23T06:53:01.319Z", "parish": 1, "assignment": 320, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:53:01.319Z"}}, {"model": "core.confirmation", "pk": 18, "fields": {"created_at": "2026-01-23T06:53:41.535Z", "updated_at": "2026-01-23T06:53:41.535Z", "parish": 1, "assignment": 321, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:53:41.535Z"}}, {"model": "core.confirmation", "pk": 19, "fields": {"created_at": "2026-01-23T06:54:20.063Z", "updated_at": "2026-01-23T06:54:20.063Z", "parish": 1, "assignment": 322, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:54:20.063Z"}}, {"model": "core.confirmation", "pk": 20, "fields": {"created_at": "2026-01-23T06:54:43.924Z", "updated_at": "2026-01-23T06:54:43.924Z", "parish": 1, "assignment": 323, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:54:43.924Z"}}, {"model": "core.confirmation", "pk": 21, "fields": {"created_at": "2026-01-23T06:58:39.336Z", "updated_at": "2026-01-23T06:58:39.336Z", "parish": 1, "assignment": 324, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:58:39.336Z"}}, {"model": "core.confirmation", "pk": 22, "fields": {"created_at": "2026-01-23T06:58:43.234Z", "updated_at": "2026-01-23T06:58:43.234Z", "parish": 1, "assignment": 325, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T06:58:43.234Z"}}, {"model": "core.confirmation", "pk": 23, "fields": {"created_at": "2026-01-23T06:58:48.699Z", "updated_at": "2026-01-23T11:05:30.702Z", "parish": 1, "assignment": 326, "status": "canceled_by_acolyte", "notes": "Confirmado pelo admin Fábio Miguel Denda Pacheco", "updated_by": 1, "timestamp": "2026-01-23T11:41:55.834Z"}}, {"model": "core.confirmation", "pk": 24, "fields": {"created_at": "2026-01-23T07:19:00.686Z", "updated_at": "2026-01-23T07:19:00.686Z", "parish": 1, "assignment": 327, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:19:00.686Z"}}, {"model": "core.confirmation", "pk": 25, "fields": {"created_at": "2026-01-23T07:20:46.446Z", "updated_at": "2026-01-23T07:20:46.446Z", "parish": 1, "assignment": 328, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:20:46.446Z"}}, {"model": "core.confirmation", "pk": 26, "fields": {"created_at": "2026-01-23T07:21:47.997Z", "updated_at": "2026-01-23T07:21:47.997Z", "parish": 1, "assignment": 329, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:21:47.997Z"}}, {"model": "core.confirmation", "pk": 27, "fields": {"created_at": "2026-01-23T07:23:51.929Z", "updated_at": "2026-01-23T07:23:51.929Z", "parish": 1, "assignment": 330, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:23:51.929Z"}}, {"model": "core.confirmation", "pk": 28, "fields": {"created_at": "2026-01-23T07:23:57.439Z", "updated_at": "2026-01-23T07:23:57.439Z", "parish": 1, "assignment": 331, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:23:57.439Z"}}, {"model": "core.confirmation", "pk": 29, "fields": {"created_at": "2026-01-23T07:24:01.481Z", "updated_at": "2026-01-23T07:24:01.481Z", "parish": 1, "assignment": 332, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:24:01.481Z"}}, {"model": "core.confirmation", "pk": 30, "fields": {"created_at": "2026-01-23T07:33:05.459Z", "updated_at": "2026-01-23T07:33:05.459Z", "parish": 1, "assignment": 333, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:05.459Z"}}, {"model": "core.confirmation", "pk": 31, "fields": {"created_at": "2026-01-23T07:33:06.822Z", "updated_at": "2026-01-23T07:33:06.822Z", "parish": 1, "assignment": 334, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:06.822Z"}}, {"model": "core.confirmation", "pk": 32, "fields": {"created_at": "2026-01-23T07:33:12.586Z", "updated_at": "2026-01-23T07:33:12.586Z", "parish": 1, "assignment": 335, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:12.586Z"}}, {"model": "core.confirmation", "pk": 33, "fields": {"created_at": "2026-01-23T07:33:14.442Z", "updated_at": "2026-01-23T07:33:14.442Z", "parish": 1, "assignment": 336, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:14.442Z"}}, {"model": "core.confirmation", "pk": 34, "fields": {"created_at": "2026-01-23T07:33:15.266Z", "updated_at": "2026-01-23T07:33:15.266Z", "parish": 1, "assignment": 337, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:15.266Z"}}, {"model": "core.confirmation", "pk": 35, "fields": {"created_at": "2026-01-23T07:33:16.615Z", "updated_at": "2026-01-23T07:33:16.615Z", "parish": 1, "assignment": 338, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:16.615Z"}}, {"model": "core.confirmation", "pk": 36, "fields": {"created_at": "2026-01-23T07:33:17.333Z", "updated_at": "2026-01-23T07:33:17.333Z", "parish": 1, "assignment": 339, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:17.333Z"}}, {"model": "core.confirmation", "pk": 37, "fields": {"created_at": "2026-01-23T07:33:18.638Z", "updated_at": "2026-01-23T07:33:18.638Z", "parish": 1, "assignment": 340, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:18.638Z"}}, {"model": "core.confirmation", "pk": 38, "fields": {"created_at": "2026-01-23T07:33:19.274Z", "updated_at": "2026-01-23T07:33:19.274Z", "parish": 1, "assignment": 341, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:19.274Z"}}, {"model": "core.confirmation", "pk": 39, "fields": {"created_at": "2026-01-23T07:33:20.715Z", "updated_at": "2026-01-23T07:33:20.715Z", "parish": 1, "assignment": 342, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-23T07:33:20.715Z"}}, {"model": "core.confirmation", "pk": 42, "fields": {"created_at": "2026-01-23T10:47:23.862Z", "updated_at": "2026-01-23T10:47:23.871Z", "parish": 1, "assignment": 343, "status": "confirmed", "notes": "Confirmado pelo admin Fábio Miguel Denda Pacheco", "updated_by": 1, "timestamp": "2026-01-23T10:47:23.871Z"}}, {"model": "core.confirmation", "pk": 44, "fields": {"created_at": "2026-01-23T10:48:12.880Z", "updated_at": "2026-01-23T10:48:12.880Z", "parish": 1, "assignment": 348, "status": "canceled_by_acolyte", "notes": "", "updated_by": 1, "timestamp": "2026-01-23T11:40:58.063Z"}}, {"model": "core.confirmation", "pk": 46, "fields": {"created_at": "2026-01-23T11:03:56.475Z", "updated_at": "2026-01-23T11:03:56.475Z", "parish": 1, "assignment": 349, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-23T11:26:09.229Z"}}, {"model": "core.confirmation", "pk": 49, "fields": {"created_at": "2026-01-24T09:03:29.610Z", "updated_at": "2026-01-24T09:03:29.610Z", "parish": 1, "assignment": 350, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:03:35.549Z"}}, {"model": "core.confirmation", "pk": 65, "fields": {"created_at": "2026-01-24T11:22:28.055Z", "updated_at": "2026-01-24T11:22:28.055Z", "parish": 1, "assignment": 353, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T11:22:28.063Z"}}, {"model": "core.confirmation", "pk": 50, "fields": {"created_at": "2026-01-24T09:14:35.045Z", "updated_at": "2026-01-24T09:14:35.045Z", "parish": 1, "assignment": 356, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:14:35.056Z"}}, {"model": "core.confirmation", "pk": 51, "fields": {"created_at": "2026-01-24T09:14:36.208Z", "updated_at": "2026-01-24T09:14:36.208Z", "parish": 1, "assignment": 357, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:14:36.218Z"}}, {"model": "core.confirmation", "pk": 52, "fields": {"created_at": "2026-01-24T09:14:37.346Z", "updated_at": "2026-01-24T09:14:37.346Z", "parish": 1, "assignment": 358, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:14:37.359Z"}}, {"model": "core.confirmation", "pk": 53, "fields": {"created_at": "2026-01-24T09:14:38.578Z", "updated_at": "2026-01-24T09:14:38.578Z", "parish": 1, "assignment": 359, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:14:38.589Z"}}, {"model": "core.confirmation", "pk": 54, "fields": {"created_at": "2026-01-24T09:14:39.966Z", "updated_at": "2026-01-24T09:14:39.966Z", "parish": 1, "assignment": 360, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:14:39.975Z"}}, {"model": "core.confirmation", "pk": 55, "fields": {"created_at": "2026-01-24T09:14:40.867Z", "updated_at": "2026-01-24T09:14:40.867Z", "parish": 1, "assignment": 361, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:14:40.878Z"}}, {"model": "core.confirmation", "pk": 56, "fields": {"created_at": "2026-01-24T09:14:42.332Z", "updated_at": "2026-01-24T09:14:42.332Z", "parish": 1, "assignment": 362, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T09:14:42.345Z"}}, {"model": "core.confirmation", "pk": 58, "fields": {"created_at": "2026-01-24T10:11:29.999Z", "updated_at": "2026-01-24T10:11:29.999Z", "parish": 1, "assignment": 363, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T11:22:37.279Z"}}, {"model": "core.confirmation", "pk": 59, "fields": {"created_at": "2026-01-24T10:13:05.010Z", "updated_at": "2026-01-24T10:13:05.010Z", "parish": 1, "assignment": 364, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-24T10:13:05.010Z"}}, {"model": "core.confirmation", "pk": 60, "fields": {"created_at": "2026-01-24T10:13:32.082Z", "updated_at": "2026-01-24T10:13:32.082Z", "parish": 1, "assignment": 365, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-24T10:13:32.082Z"}}, {"model": "core.confirmation", "pk": 61, "fields": {"created_at": "2026-01-24T10:31:25.191Z", "updated_at": "2026-01-24T10:31:25.191Z", "parish": 1, "assignment": 366, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T10:31:25.192Z"}}, {"model": "core.confirmation", "pk": 62, "fields": {"created_at": "2026-01-24T10:31:25.192Z", "updated_at": "2026-01-24T10:31:25.192Z", "parish": 1, "assignment": 367, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T10:31:25.193Z"}}, {"model": "core.confirmation", "pk": 63, "fields": {"created_at": "2026-01-24T11:00:32.247Z", "updated_at": "2026-01-24T11:00:32.248Z", "parish": 1, "assignment": 368, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T11:22:35.865Z"}}, {"model": "core.confirmation", "pk": 64, "fields": {"created_at": "2026-01-24T11:00:32.249Z", "updated_at": "2026-01-24T11:00:32.249Z", "parish": 1, "assignment": 369, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-24T13:22:56.214Z"}}, {"model": "core.confirmation", "pk": 68, "fields": {"created_at": "2026-01-24T13:08:51.212Z", "updated_at": "2026-01-24T13:08:51.212Z", "parish": 1, "assignment": 370, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-24T13:08:51.212Z"}}, {"model": "core.confirmation", "pk": 69, "fields": {"created_at": "2026-01-24T13:10:34.182Z", "updated_at": "2026-01-24T13:10:34.182Z", "parish": 1, "assignment": 371, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-24T13:10:34.182Z"}}, {"model": "core.confirmation", "pk": 70, "fields": {"created_at": "2026-01-24T13:10:36.256Z", "updated_at": "2026-01-24T13:10:36.256Z", "parish": 1, "assignment": 372, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-24T13:10:36.256Z"}}, {"model": "core.confirmation", "pk": 71, "fields": {"created_at": "2026-01-24T13:18:47.942Z", "updated_at": "2026-01-24T13:18:47.942Z", "parish": 1, "assignment": 373, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-24T13:18:47.943Z"}}, {"model": "core.confirmation", "pk": 72, "fields": {"created_at": "2026-01-24T13:25:12.875Z", "updated_at": "2026-01-24T13:25:12.875Z", "parish": 1, "assignment": 374, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-24T13:25:39.838Z"}}, {"model": "core.confirmation", "pk": 73, "fields": {"created_at": "2026-01-24T14:27:16.627Z", "updated_at": "2026-01-24T14:27:16.627Z", "parish": 1, "assignment": 375, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-24T14:28:53.764Z"}}, {"model": "core.confirmation", "pk": 74, "fields": {"created_at": "2026-01-24T14:27:51.118Z", "updated_at": "2026-01-24T14:27:51.118Z", "parish": 1, "assignment": 376, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-24T14:28:39.135Z"}}, {"model": "core.confirmation", "pk": 75, "fields": {"created_at": "2026-01-24T14:36:46.868Z", "updated_at": "2026-01-24T14:36:46.868Z", "parish": 1, "assignment": 377, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T14:36:46.869Z"}}, {"model": "core.confirmation", "pk": 76, "fields": {"created_at": "2026-01-24T14:36:46.869Z", "updated_at": "2026-01-24T14:36:46.869Z", "parish": 1, "assignment": 378, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-24T14:36:46.870Z"}}, {"model": "core.confirmation", "pk": 77, "fields": {"created_at": "2026-01-25T17:55:35.321Z", "updated_at": "2026-01-25T17:55:35.321Z", "parish": 1, "assignment": 379, "status": "declined", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T18:10:50.418Z"}}, {"model": "core.confirmation", "pk": 78, "fields": {"created_at": "2026-01-25T18:08:53.517Z", "updated_at": "2026-01-25T18:08:53.517Z", "parish": 1, "assignment": 380, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T18:10:47.183Z"}}, {"model": "core.confirmation", "pk": 79, "fields": {"created_at": "2026-01-25T18:09:04.008Z", "updated_at": "2026-01-25T18:09:04.008Z", "parish": 1, "assignment": 381, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T18:10:55.268Z"}}, {"model": "core.confirmation", "pk": 80, "fields": {"created_at": "2026-01-25T18:10:45.227Z", "updated_at": "2026-01-25T18:10:45.227Z", "parish": 1, "assignment": 382, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T18:10:45.228Z"}}, {"model": "core.confirmation", "pk": 81, "fields": {"created_at": "2026-01-25T18:10:50.515Z", "updated_at": "2026-01-25T18:10:50.515Z", "parish": 1, "assignment": 383, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T19:01:57.254Z"}}, {"model": "core.confirmation", "pk": 82, "fields": {"created_at": "2026-01-25T20:53:17.937Z", "updated_at": "2026-01-25T20:53:17.937Z", "parish": 1, "assignment": 384, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:50:57.906Z"}}, {"model": "core.confirmation", "pk": 83, "fields": {"created_at": "2026-01-25T21:12:42.166Z", "updated_at": "2026-01-25T21:12:42.166Z", "parish": 1, "assignment": 385, "status": "declined", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:52:46.664Z"}}, {"model": "core.confirmation", "pk": 84, "fields": {"created_at": "2026-01-25T21:13:03.838Z", "updated_at": "2026-01-25T21:13:03.838Z", "parish": 1, "assignment": 386, "status": "declined", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:56:36.927Z"}}, {"model": "core.confirmation", "pk": 85, "fields": {"created_at": "2026-01-25T21:13:20.953Z", "updated_at": "2026-01-25T21:13:20.953Z", "parish": 1, "assignment": 387, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-25T21:31:57.251Z"}}, {"model": "core.confirmation", "pk": 86, "fields": {"created_at": "2026-01-25T21:14:09.413Z", "updated_at": "2026-01-25T21:14:09.413Z", "parish": 1, "assignment": 388, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-25T21:14:33.384Z"}}, {"model": "core.confirmation", "pk": 87, "fields": {"created_at": "2026-01-25T21:14:19.643Z", "updated_at": "2026-01-25T21:14:19.643Z", "parish": 1, "assignment": 389, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-25T21:31:53.415Z"}}, {"model": "core.confirmation", "pk": 88, "fields": {"created_at": "2026-01-26T03:52:30.539Z", "updated_at": "2026-01-26T03:52:30.539Z", "parish": 1, "assignment": 390, "status": "declined", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:55:01.403Z"}}, {"model": "core.confirmation", "pk": 89, "fields": {"created_at": "2026-01-26T03:52:46.774Z", "updated_at": "2026-01-26T03:52:46.774Z", "parish": 1, "assignment": 391, "status": "pending", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:52:46.776Z"}}, {"model": "core.confirmation", "pk": 90, "fields": {"created_at": "2026-01-26T03:55:01.523Z", "updated_at": "2026-01-26T03:55:01.523Z", "parish": 1, "assignment": 392, "status": "pending", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:55:01.525Z"}}, {"model": "core.confirmation", "pk": 91, "fields": {"created_at": "2026-01-26T03:55:55.857Z", "updated_at": "2026-01-26T03:55:55.857Z", "parish": 1, "assignment": 393, "status": "declined", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:56:22.124Z"}}, {"model": "core.confirmation", "pk": 92, "fields": {"created_at": "2026-01-26T03:56:22.335Z", "updated_at": "2026-01-26T03:56:22.335Z", "parish": 1, "assignment": 394, "status": "pending", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:56:22.338Z"}}, {"model": "core.confirmation", "pk": 93, "fields": {"created_at": "2026-01-26T03:56:37.046Z", "updated_at": "2026-01-26T03:56:37.046Z", "parish": 1, "assignment": 395, "status": "confirmed", "notes": "", "updated_by": 1, "timestamp": "2026-01-26T04:18:55.835Z"}}, {"model": "core.confirmation", "pk": 94, "fields": {"created_at": "2026-01-26T03:57:17.388Z", "updated_at": "2026-01-26T03:57:17.388Z", "parish": 1, "assignment": 396, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T03:57:17.388Z"}}, {"model": "core.confirmation", "pk": 95, "fields": {"created_at": "2026-01-26T03:57:18.512Z", "updated_at": "2026-01-26T03:57:18.512Z", "parish": 1, "assignment": 397, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T03:57:48.862Z"}}, {"model": "core.confirmation", "pk": 96, "fields": {"created_at": "2026-01-26T03:59:31.465Z", "updated_at": "2026-01-26T03:59:31.465Z", "parish": 1, "assignment": 398, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T03:59:31.465Z"}}, {"model": "core.confirmation", "pk": 97, "fields": {"created_at": "2026-01-26T03:59:32.095Z", "updated_at": "2026-01-26T03:59:32.095Z", "parish": 1, "assignment": 399, "status": "confirmed", "notes": "", "updated_by": 3, "timestamp": "2026-01-26T04:00:29.855Z"}}, {"model": "core.confirmation", "pk": 98, "fields": {"created_at": "2026-01-26T06:10:14.628Z", "updated_at": "2026-01-26T06:10:14.628Z", "parish": 1, "assignment": 400, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:10:14.628Z"}}, {"model": "core.confirmation", "pk": 99, "fields": {"created_at": "2026-01-26T06:13:32.400Z", "updated_at": "2026-01-26T06:13:32.400Z", "parish": 1, "assignment": 401, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:13:32.400Z"}}, {"model": "core.confirmation", "pk": 100, "fields": {"created_at": "2026-01-26T06:13:45.259Z", "updated_at": "2026-01-26T06:13:45.259Z", "parish": 1, "assignment": 402, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:13:45.259Z"}}, {"model": "core.confirmation", "pk": 101, "fields": {"created_at": "2026-01-26T06:14:36.498Z", "updated_at": "2026-01-26T06:14:36.498Z", "parish": 1, "assignment": 403, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:14:36.498Z"}}, {"model": "core.confirmation", "pk": 102, "fields": {"created_at": "2026-01-26T06:14:43.341Z", "updated_at": "2026-01-26T06:14:43.341Z", "parish": 1, "assignment": 404, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:14:43.341Z"}}, {"model": "core.confirmation", "pk": 103, "fields": {"created_at": "2026-01-26T06:14:45.402Z", "updated_at": "2026-01-26T06:14:45.402Z", "parish": 1, "assignment": 405, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:14:45.403Z"}}, {"model": "core.confirmation", "pk": 104, "fields": {"created_at": "2026-01-26T06:14:46.740Z", "updated_at": "2026-01-26T06:14:46.740Z", "parish": 1, "assignment": 406, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:14:46.740Z"}}, {"model": "core.confirmation", "pk": 105, "fields": {"created_at": "2026-01-26T06:14:47.830Z", "updated_at": "2026-01-26T06:14:47.830Z", "parish": 1, "assignment": 407, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:14:47.830Z"}}, {"model": "core.confirmation", "pk": 106, "fields": {"created_at": "2026-01-26T06:14:50.049Z", "updated_at": "2026-01-26T06:14:50.049Z", "parish": 1, "assignment": 408, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-26T06:14:50.049Z"}}, {"model": "core.confirmation", "pk": 107, "fields": {"created_at": "2026-01-27T07:51:16.398Z", "updated_at": "2026-01-27T07:51:16.398Z", "parish": 1, "assignment": 409, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-27T07:51:16.399Z"}}, {"model": "core.confirmation", "pk": 108, "fields": {"created_at": "2026-01-27T07:51:16.400Z", "updated_at": "2026-01-27T07:51:16.400Z", "parish": 1, "assignment": 410, "status": "pending", "notes": "", "updated_by": 1, "timestamp": "2026-01-27T07:51:16.401Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\massinterest.json
```json
[{"model": "core.massinterest", "pk": 1, "fields": {"created_at": "2026-01-24T04:31:38.266Z", "updated_at": "2026-01-24T04:31:38.266Z", "parish": 1, "mass_instance": 60, "acolyte": 1, "interested": true, "notes": ""}}, {"model": "core.massinterest", "pk": 2, "fields": {"created_at": "2026-01-24T04:31:38.266Z", "updated_at": "2026-01-24T04:31:38.266Z", "parish": 1, "mass_instance": 62, "acolyte": 1, "interested": true, "notes": ""}}, {"model": "core.massinterest", "pk": 6, "fields": {"created_at": "2026-01-24T09:22:24.477Z", "updated_at": "2026-01-24T09:22:24.477Z", "parish": 1, "mass_instance": 62, "acolyte": 3, "interested": true, "notes": ""}}, {"model": "core.massinterest", "pk": 7, "fields": {"created_at": "2026-01-24T09:22:24.489Z", "updated_at": "2026-01-24T09:22:24.489Z", "parish": 1, "mass_instance": 70, "acolyte": 3, "interested": true, "notes": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\massoverride.json
```json
[{"model": "core.massoverride", "pk": 1, "fields": {"created_at": "2026-01-21T07:05:53.210Z", "updated_at": "2026-01-21T07:05:53.210Z", "parish": 1, "instance": 60, "override_type": "cancel_instance", "payload": {"reason": "manual_cancel", "notes": "Teste"}, "created_by": 1}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\past_assignment.json
```json
[{"model": "core.assignment", "pk": 1, "fields": {"created_at": "2026-01-20T06:42:41.821Z", "updated_at": "2026-01-20T06:44:56.191Z", "parish": 1, "slot": 1, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-20T06:42:41.821Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:56.191Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 60, "fields": {"created_at": "2026-01-20T06:44:56.205Z", "updated_at": "2026-01-20T07:46:28.186Z", "parish": 1, "slot": 1, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-20T06:44:56.205Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.185Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 119, "fields": {"created_at": "2026-01-20T07:46:28.204Z", "updated_at": "2026-01-21T07:11:31.885Z", "parish": 1, "slot": 1, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-20T07:46:28.204Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:31.885Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 237, "fields": {"created_at": "2026-01-21T07:11:31.892Z", "updated_at": "2026-01-24T13:25:12.864Z", "parish": 1, "slot": 1, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-21T07:11:31.892Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:25:12.864Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 374, "fields": {"created_at": "2026-01-24T13:25:12.872Z", "updated_at": "2026-01-24T13:25:12.872Z", "parish": 1, "slot": 1, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T13:25:12.872Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 9, "fields": {"created_at": "2026-01-20T06:42:42.001Z", "updated_at": "2026-01-20T06:43:20.190Z", "parish": 1, "slot": 10, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-20T06:42:42.001Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:43:20.189Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 57, "fields": {"created_at": "2026-01-20T06:43:20.207Z", "updated_at": "2026-01-20T06:43:23.020Z", "parish": 1, "slot": 10, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-20T06:43:20.207Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:43:23.020Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 58, "fields": {"created_at": "2026-01-20T06:43:23.043Z", "updated_at": "2026-01-20T06:43:25.327Z", "parish": 1, "slot": 10, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-20T06:43:23.043Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:43:25.327Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 59, "fields": {"created_at": "2026-01-20T06:43:25.347Z", "updated_at": "2026-01-20T06:46:54.743Z", "parish": 1, "slot": 10, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-20T06:43:25.347Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:46:54.743Z", "end_reason": "canceled"}}, {"model": "core.assignment", "pk": 127, "fields": {"created_at": "2026-01-20T07:46:28.453Z", "updated_at": "2026-01-20T07:49:48.773Z", "parish": 1, "slot": 10, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-20T07:46:28.453Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:49:48.773Z", "end_reason": "replaced"}}, {"model": "core.assignment", "pk": 177, "fields": {"created_at": "2026-01-20T07:49:48.805Z", "updated_at": "2026-01-20T07:49:48.805Z", "parish": 1, "slot": 10, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-20T07:49:48.805Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 17, "fields": {"created_at": "2026-01-20T06:42:42.146Z", "updated_at": "2026-01-20T06:44:56.621Z", "parish": 1, "slot": 19, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-20T06:42:42.146Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:56.621Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 75, "fields": {"created_at": "2026-01-20T06:44:56.632Z", "updated_at": "2026-01-20T07:46:28.722Z", "parish": 1, "slot": 19, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-20T06:44:56.632Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.722Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 134, "fields": {"created_at": "2026-01-20T07:46:28.738Z", "updated_at": "2026-01-20T07:50:30.774Z", "parish": 1, "slot": 19, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-20T07:46:28.739Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:30.774Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 191, "fields": {"created_at": "2026-01-20T07:50:30.784Z", "updated_at": "2026-01-21T07:11:32.177Z", "parish": 1, "slot": 19, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-20T07:50:30.784Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.177Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 253, "fields": {"created_at": "2026-01-21T07:11:32.182Z", "updated_at": "2026-01-23T09:26:19.305Z", "parish": 1, "slot": 19, "acolyte": 13, "assigned_by": null, "assigned_at": "2026-01-21T07:11:32.182Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T09:26:19.305Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 349, "fields": {"created_at": "2026-01-23T11:03:56.471Z", "updated_at": "2026-01-23T11:03:56.471Z", "parish": 1, "slot": 19, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-23T11:03:56.471Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 25, "fields": {"created_at": "2026-01-20T06:42:42.297Z", "updated_at": "2026-01-20T06:44:56.841Z", "parish": 1, "slot": 28, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-20T06:42:42.297Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:56.841Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 83, "fields": {"created_at": "2026-01-20T06:44:56.853Z", "updated_at": "2026-01-20T07:46:28.944Z", "parish": 1, "slot": 28, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-20T06:44:56.853Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.944Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 141, "fields": {"created_at": "2026-01-20T07:46:28.956Z", "updated_at": "2026-01-20T07:50:30.983Z", "parish": 1, "slot": 28, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-20T07:46:28.956Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:30.983Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 199, "fields": {"created_at": "2026-01-20T07:50:30.995Z", "updated_at": "2026-01-21T07:11:32.316Z", "parish": 1, "slot": 28, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-20T07:50:30.995Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.316Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 262, "fields": {"created_at": "2026-01-21T07:11:32.320Z", "updated_at": "2026-01-21T07:11:32.320Z", "parish": 1, "slot": 28, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-21T07:11:32.320Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 33, "fields": {"created_at": "2026-01-20T06:42:42.449Z", "updated_at": "2026-01-20T06:44:57.142Z", "parish": 1, "slot": 36, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-20T06:42:42.449Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:57.142Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 96, "fields": {"created_at": "2026-01-20T06:44:57.157Z", "updated_at": "2026-01-20T07:46:29.281Z", "parish": 1, "slot": 36, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-20T06:44:57.157Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.281Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 153, "fields": {"created_at": "2026-01-20T07:46:29.293Z", "updated_at": "2026-01-20T07:50:31.318Z", "parish": 1, "slot": 36, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-20T07:46:29.293Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.318Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 211, "fields": {"created_at": "2026-01-20T07:50:31.329Z", "updated_at": "2026-01-21T07:11:32.486Z", "parish": 1, "slot": 36, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-20T07:50:31.329Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.486Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 273, "fields": {"created_at": "2026-01-21T07:11:32.490Z", "updated_at": "2026-01-21T07:11:32.490Z", "parish": 1, "slot": 36, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-21T07:11:32.490Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 41, "fields": {"created_at": "2026-01-20T06:42:42.588Z", "updated_at": "2026-01-20T06:44:57.378Z", "parish": 1, "slot": 44, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-20T06:42:42.588Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:57.378Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 104, "fields": {"created_at": "2026-01-20T06:44:57.390Z", "updated_at": "2026-01-20T07:46:29.495Z", "parish": 1, "slot": 44, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-20T06:44:57.390Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.495Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 161, "fields": {"created_at": "2026-01-20T07:46:29.506Z", "updated_at": "2026-01-20T07:50:31.538Z", "parish": 1, "slot": 44, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-20T07:46:29.506Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.538Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 219, "fields": {"created_at": "2026-01-20T07:50:31.550Z", "updated_at": "2026-01-21T07:11:32.605Z", "parish": 1, "slot": 44, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-20T07:50:31.550Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.605Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 281, "fields": {"created_at": "2026-01-21T07:11:32.609Z", "updated_at": "2026-01-21T07:11:32.609Z", "parish": 1, "slot": 44, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-21T07:11:32.609Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 49, "fields": {"created_at": "2026-01-20T06:42:42.753Z", "updated_at": "2026-01-20T06:44:57.570Z", "parish": 1, "slot": 52, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-20T06:42:42.753Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:57.570Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 111, "fields": {"created_at": "2026-01-20T06:44:57.583Z", "updated_at": "2026-01-20T07:46:29.724Z", "parish": 1, "slot": 52, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-20T06:44:57.583Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.723Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 169, "fields": {"created_at": "2026-01-20T07:46:29.736Z", "updated_at": "2026-01-20T07:50:31.759Z", "parish": 1, "slot": 52, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-20T07:46:29.736Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.759Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 227, "fields": {"created_at": "2026-01-20T07:50:31.771Z", "updated_at": "2026-01-21T07:11:32.711Z", "parish": 1, "slot": 52, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-20T07:50:31.771Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.711Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 289, "fields": {"created_at": "2026-01-21T07:11:32.715Z", "updated_at": "2026-01-25T17:55:35.315Z", "parish": 1, "slot": 52, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-21T07:11:32.715Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-25T17:55:35.315Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 379, "fields": {"created_at": "2026-01-25T17:55:35.320Z", "updated_at": "2026-01-25T18:10:50.429Z", "parish": 1, "slot": 52, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-25T17:55:35.320Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-25T18:10:50.428Z", "end_reason": "declined"}}, {"model": "core.assignment", "pk": 383, "fields": {"created_at": "2026-01-25T18:10:50.512Z", "updated_at": "2026-01-25T18:10:50.512Z", "parish": 1, "slot": 52, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-25T18:10:50.512Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 84, "fields": {"created_at": "2026-01-20T06:44:56.870Z", "updated_at": "2026-01-20T06:45:43.817Z", "parish": 1, "slot": 60, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-20T06:44:56.870Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:45:43.817Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 117, "fields": {"created_at": "2026-01-20T06:45:43.845Z", "updated_at": "2026-01-20T06:45:52.450Z", "parish": 1, "slot": 60, "acolyte": 14, "assigned_by": 1, "assigned_at": "2026-01-20T06:45:43.845Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:45:52.450Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 118, "fields": {"created_at": "2026-01-20T06:45:52.470Z", "updated_at": "2026-01-20T06:45:52.470Z", "parish": 1, "slot": 60, "acolyte": 2, "assigned_by": 1, "assigned_at": "2026-01-20T06:45:52.470Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 85, "fields": {"created_at": "2026-01-20T06:44:56.885Z", "updated_at": "2026-01-20T07:46:28.974Z", "parish": 1, "slot": 61, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-20T06:44:56.885Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.974Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 142, "fields": {"created_at": "2026-01-20T07:46:28.985Z", "updated_at": "2026-01-20T07:50:31.014Z", "parish": 1, "slot": 61, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-20T07:46:28.985Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.014Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 200, "fields": {"created_at": "2026-01-20T07:50:31.025Z", "updated_at": "2026-01-21T07:11:32.331Z", "parish": 1, "slot": 61, "acolyte": 13, "assigned_by": null, "assigned_at": "2026-01-20T07:50:31.025Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.331Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 263, "fields": {"created_at": "2026-01-21T07:11:32.338Z", "updated_at": "2026-01-24T10:11:29.923Z", "parish": 1, "slot": 61, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-21T07:11:32.338Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:11:29.923Z", "end_reason": "declined"}}, {"model": "core.assignment", "pk": 363, "fields": {"created_at": "2026-01-24T10:11:29.995Z", "updated_at": "2026-01-24T13:10:24.818Z", "parish": 1, "slot": 61, "acolyte": 1, "assigned_by": 3, "assigned_at": "2026-01-24T10:11:29.995Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:10:24.817Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 372, "fields": {"created_at": "2026-01-24T13:10:36.247Z", "updated_at": "2026-01-24T13:10:36.247Z", "parish": 1, "slot": 61, "acolyte": 4, "assigned_by": 1, "assigned_at": "2026-01-24T13:10:36.247Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 86, "fields": {"created_at": "2026-01-20T06:44:56.900Z", "updated_at": "2026-01-20T07:46:29.003Z", "parish": 1, "slot": 62, "acolyte": 13, "assigned_by": null, "assigned_at": "2026-01-20T06:44:56.900Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.003Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 143, "fields": {"created_at": "2026-01-20T07:46:29.015Z", "updated_at": "2026-01-20T07:50:31.040Z", "parish": 1, "slot": 62, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-20T07:46:29.016Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.040Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 201, "fields": {"created_at": "2026-01-20T07:50:31.052Z", "updated_at": "2026-01-21T07:11:32.348Z", "parish": 1, "slot": 62, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-20T07:50:31.053Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.348Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 264, "fields": {"created_at": "2026-01-21T07:11:32.353Z", "updated_at": "2026-01-21T07:11:32.353Z", "parish": 1, "slot": 62, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-21T07:11:32.353Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 296, "fields": {"created_at": "2026-01-21T07:22:38.006Z", "updated_at": "2026-01-23T11:28:57.031Z", "parish": 1, "slot": 72, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-21T07:22:38.006Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-23T11:28:57.031Z", "end_reason": "canceled"}}, {"model": "core.assignment", "pk": 297, "fields": {"created_at": "2026-01-21T07:35:24.648Z", "updated_at": "2026-01-21T13:37:01.629Z", "parish": 1, "slot": 73, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-21T07:35:24.648Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.629Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 305, "fields": {"created_at": "2026-01-21T13:37:01.634Z", "updated_at": "2026-01-21T13:37:30.563Z", "parish": 1, "slot": 73, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-21T13:37:01.634Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.563Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 309, "fields": {"created_at": "2026-01-21T13:37:30.568Z", "updated_at": "2026-01-23T10:33:34.639Z", "parish": 1, "slot": 73, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-21T13:37:30.568Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.639Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 343, "fields": {"created_at": "2026-01-23T10:33:34.643Z", "updated_at": "2026-01-24T09:09:41.375Z", "parish": 1, "slot": 73, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-23T10:33:34.643Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.375Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 351, "fields": {"created_at": "2026-01-24T09:09:41.381Z", "updated_at": "2026-01-26T06:10:14.615Z", "parish": 1, "slot": 73, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.381Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-26T06:10:14.615Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 400, "fields": {"created_at": "2026-01-26T06:10:14.625Z", "updated_at": "2026-01-26T06:10:14.625Z", "parish": 1, "slot": 73, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-26T06:10:14.625Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 298, "fields": {"created_at": "2026-01-21T07:35:24.660Z", "updated_at": "2026-01-21T13:37:30.580Z", "parish": 1, "slot": 74, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-21T07:35:24.660Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.580Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 310, "fields": {"created_at": "2026-01-21T13:37:30.585Z", "updated_at": "2026-01-23T10:33:34.654Z", "parish": 1, "slot": 74, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-21T13:37:30.585Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.654Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 344, "fields": {"created_at": "2026-01-23T10:33:34.658Z", "updated_at": "2026-01-24T08:51:47.463Z", "parish": 1, "slot": 74, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-23T10:33:34.658Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T08:51:47.462Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 350, "fields": {"created_at": "2026-01-24T09:03:29.605Z", "updated_at": "2026-01-24T09:09:41.394Z", "parish": 1, "slot": 74, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-24T09:03:29.605Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.394Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 352, "fields": {"created_at": "2026-01-24T09:09:41.399Z", "updated_at": "2026-01-24T09:09:41.399Z", "parish": 1, "slot": 74, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.399Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 299, "fields": {"created_at": "2026-01-21T07:35:24.670Z", "updated_at": "2026-01-21T13:37:01.647Z", "parish": 1, "slot": 75, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-21T07:35:24.670Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.647Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 306, "fields": {"created_at": "2026-01-21T13:37:01.651Z", "updated_at": "2026-01-21T13:37:30.596Z", "parish": 1, "slot": 75, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-21T13:37:01.651Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.596Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 311, "fields": {"created_at": "2026-01-21T13:37:30.600Z", "updated_at": "2026-01-23T10:33:34.668Z", "parish": 1, "slot": 75, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-21T13:37:30.600Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.668Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 345, "fields": {"created_at": "2026-01-23T10:33:34.673Z", "updated_at": "2026-01-24T09:09:41.408Z", "parish": 1, "slot": 75, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-23T10:33:34.673Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.408Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 353, "fields": {"created_at": "2026-01-24T09:09:41.414Z", "updated_at": "2026-01-24T14:27:16.623Z", "parish": 1, "slot": 75, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.414Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:27:16.623Z", "end_reason": "claim_transfer"}}, {"model": "core.assignment", "pk": 375, "fields": {"created_at": "2026-01-24T14:27:16.626Z", "updated_at": "2026-01-24T14:27:16.626Z", "parish": 1, "slot": 75, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T14:27:16.626Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 300, "fields": {"created_at": "2026-01-21T07:35:24.680Z", "updated_at": "2026-01-21T13:37:01.661Z", "parish": 1, "slot": 76, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-21T07:35:24.680Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.661Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 307, "fields": {"created_at": "2026-01-21T13:37:01.666Z", "updated_at": "2026-01-21T13:37:30.614Z", "parish": 1, "slot": 76, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-21T13:37:01.666Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.614Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 312, "fields": {"created_at": "2026-01-21T13:37:30.619Z", "updated_at": "2026-01-23T10:33:34.682Z", "parish": 1, "slot": 76, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-21T13:37:30.619Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.682Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 346, "fields": {"created_at": "2026-01-23T10:33:34.687Z", "updated_at": "2026-01-24T09:09:41.425Z", "parish": 1, "slot": 76, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-23T10:33:34.687Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.425Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 354, "fields": {"created_at": "2026-01-24T09:09:41.430Z", "updated_at": "2026-01-24T09:09:41.430Z", "parish": 1, "slot": 76, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.430Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 314, "fields": {"created_at": "2026-01-21T13:37:50.047Z", "updated_at": "2026-01-24T13:08:51.201Z", "parish": 1, "slot": 101, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-21T13:37:50.047Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:08:51.201Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 370, "fields": {"created_at": "2026-01-24T13:08:51.209Z", "updated_at": "2026-01-24T13:18:47.933Z", "parish": 1, "slot": 101, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T13:08:51.209Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:18:47.933Z", "end_reason": "claim_transfer"}}, {"model": "core.assignment", "pk": 373, "fields": {"created_at": "2026-01-24T13:18:47.940Z", "updated_at": "2026-01-24T14:27:51.110Z", "parish": 1, "slot": 101, "acolyte": 1, "assigned_by": 3, "assigned_at": "2026-01-24T13:18:47.940Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:27:51.110Z", "end_reason": "claim_transfer"}}, {"model": "core.assignment", "pk": 376, "fields": {"created_at": "2026-01-24T14:27:51.117Z", "updated_at": "2026-01-24T14:27:51.117Z", "parish": 1, "slot": 101, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T14:27:51.117Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 315, "fields": {"created_at": "2026-01-21T13:38:03.168Z", "updated_at": "2026-01-24T09:09:09.044Z", "parish": 1, "slot": 102, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-21T13:38:03.168Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:09.044Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 371, "fields": {"created_at": "2026-01-24T13:10:34.178Z", "updated_at": "2026-01-24T13:10:34.178Z", "parish": 1, "slot": 102, "acolyte": 18, "assigned_by": 1, "assigned_at": "2026-01-24T13:10:34.178Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 303, "fields": {"created_at": "2026-01-21T13:36:24.446Z", "updated_at": "2026-01-21T13:37:01.675Z", "parish": 1, "slot": 105, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-21T13:36:24.446Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.675Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 308, "fields": {"created_at": "2026-01-21T13:37:01.682Z", "updated_at": "2026-01-21T13:37:30.629Z", "parish": 1, "slot": 105, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-21T13:37:01.682Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.629Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 313, "fields": {"created_at": "2026-01-21T13:37:30.633Z", "updated_at": "2026-01-23T10:33:34.696Z", "parish": 1, "slot": 105, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-21T13:37:30.633Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.696Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 347, "fields": {"created_at": "2026-01-23T10:33:34.701Z", "updated_at": "2026-01-24T09:09:41.442Z", "parish": 1, "slot": 105, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-23T10:33:34.701Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.442Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 355, "fields": {"created_at": "2026-01-24T09:09:41.447Z", "updated_at": "2026-01-24T09:09:41.447Z", "parish": 1, "slot": 105, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.447Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 304, "fields": {"created_at": "2026-01-21T13:36:24.458Z", "updated_at": "2026-01-21T13:36:24.458Z", "parish": 1, "slot": 106, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-21T13:36:24.458Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 356, "fields": {"created_at": "2026-01-24T09:09:41.461Z", "updated_at": "2026-01-24T09:09:41.461Z", "parish": 1, "slot": 113, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.461Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 357, "fields": {"created_at": "2026-01-24T09:09:41.476Z", "updated_at": "2026-01-24T10:13:04.998Z", "parish": 1, "slot": 114, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.476Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:13:04.998Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 364, "fields": {"created_at": "2026-01-24T10:13:05.006Z", "updated_at": "2026-01-24T10:13:23.473Z", "parish": 1, "slot": 114, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T10:13:05.006Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:13:23.472Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 365, "fields": {"created_at": "2026-01-24T10:13:32.077Z", "updated_at": "2026-01-24T10:31:25.179Z", "parish": 1, "slot": 114, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T10:13:32.077Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:31:25.179Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 366, "fields": {"created_at": "2026-01-24T10:31:25.188Z", "updated_at": "2026-01-24T11:00:32.239Z", "parish": 1, "slot": 114, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-24T10:31:25.188Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T11:00:32.239Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 369, "fields": {"created_at": "2026-01-24T11:00:32.246Z", "updated_at": "2026-01-24T14:36:46.858Z", "parish": 1, "slot": 114, "acolyte": 3, "assigned_by": 4, "assigned_at": "2026-01-24T11:00:32.246Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:36:46.857Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 377, "fields": {"created_at": "2026-01-24T14:36:46.866Z", "updated_at": "2026-01-24T14:36:46.866Z", "parish": 1, "slot": 114, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-24T14:36:46.866Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 358, "fields": {"created_at": "2026-01-24T09:09:41.488Z", "updated_at": "2026-01-24T09:09:41.488Z", "parish": 1, "slot": 115, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.488Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 359, "fields": {"created_at": "2026-01-24T09:09:41.502Z", "updated_at": "2026-01-24T09:09:41.502Z", "parish": 1, "slot": 116, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.502Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 360, "fields": {"created_at": "2026-01-24T09:09:41.513Z", "updated_at": "2026-01-24T10:31:25.183Z", "parish": 1, "slot": 117, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.513Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:31:25.183Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 367, "fields": {"created_at": "2026-01-24T10:31:25.190Z", "updated_at": "2026-01-24T11:00:32.235Z", "parish": 1, "slot": 117, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T10:31:25.190Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T11:00:32.235Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 368, "fields": {"created_at": "2026-01-24T11:00:32.242Z", "updated_at": "2026-01-24T14:36:46.864Z", "parish": 1, "slot": 117, "acolyte": 1, "assigned_by": 4, "assigned_at": "2026-01-24T11:00:32.242Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:36:46.864Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 378, "fields": {"created_at": "2026-01-24T14:36:46.867Z", "updated_at": "2026-01-24T14:36:46.867Z", "parish": 1, "slot": 117, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-24T14:36:46.867Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 361, "fields": {"created_at": "2026-01-24T09:09:41.545Z", "updated_at": "2026-01-24T09:09:41.545Z", "parish": 1, "slot": 118, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.545Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 362, "fields": {"created_at": "2026-01-24T09:09:41.570Z", "updated_at": "2026-01-24T09:09:41.570Z", "parish": 1, "slot": 119, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-24T09:09:41.570Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\past_assignmentslot.json
```json
[{"model": "core.assignmentslot", "pk": 1, "fields": {"created_at": "2026-01-20T04:43:09.920Z", "updated_at": "2026-01-24T13:25:12.876Z", "parish": 1, "mass_instance": 1, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 10, "fields": {"created_at": "2026-01-20T04:43:10.205Z", "updated_at": "2026-01-20T07:49:48.870Z", "parish": 1, "mass_instance": 10, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 19, "fields": {"created_at": "2026-01-20T04:43:10.463Z", "updated_at": "2026-01-23T11:03:56.476Z", "parish": 1, "mass_instance": 19, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 28, "fields": {"created_at": "2026-01-20T04:43:10.707Z", "updated_at": "2026-01-21T07:11:32.321Z", "parish": 1, "mass_instance": 28, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 60, "fields": {"created_at": "2026-01-20T06:44:25.454Z", "updated_at": "2026-01-20T06:45:52.494Z", "parish": 1, "mass_instance": 28, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 61, "fields": {"created_at": "2026-01-20T06:44:25.463Z", "updated_at": "2026-01-24T13:10:36.257Z", "parish": 1, "mass_instance": 28, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 62, "fields": {"created_at": "2026-01-20T06:44:25.471Z", "updated_at": "2026-01-21T07:11:32.355Z", "parish": 1, "mass_instance": 28, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 101, "fields": {"created_at": "2026-01-21T13:25:01.728Z", "updated_at": "2026-01-24T13:08:51.213Z", "parish": 1, "mass_instance": 28, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 102, "fields": {"created_at": "2026-01-21T13:25:01.738Z", "updated_at": "2026-01-24T13:10:34.183Z", "parish": 1, "mass_instance": 28, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 36, "fields": {"created_at": "2026-01-20T04:43:10.956Z", "updated_at": "2026-01-21T07:11:32.491Z", "parish": 1, "mass_instance": 36, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 44, "fields": {"created_at": "2026-01-20T04:43:11.277Z", "updated_at": "2026-01-21T07:11:32.610Z", "parish": 1, "mass_instance": 44, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 52, "fields": {"created_at": "2026-01-20T04:43:11.522Z", "updated_at": "2026-01-25T18:10:50.517Z", "parish": 1, "mass_instance": 52, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 65, "fields": {"created_at": "2026-01-20T07:48:37.794Z", "updated_at": "2026-01-21T07:05:53.245Z", "parish": 1, "mass_instance": 60, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 66, "fields": {"created_at": "2026-01-20T07:48:37.802Z", "updated_at": "2026-01-21T07:05:53.254Z", "parish": 1, "mass_instance": 60, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 67, "fields": {"created_at": "2026-01-20T07:48:37.809Z", "updated_at": "2026-01-21T07:05:53.264Z", "parish": 1, "mass_instance": 60, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 68, "fields": {"created_at": "2026-01-20T07:48:37.816Z", "updated_at": "2026-01-21T07:05:53.277Z", "parish": 1, "mass_instance": 60, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 103, "fields": {"created_at": "2026-01-21T13:32:06.365Z", "updated_at": "2026-01-21T13:32:06.365Z", "parish": 1, "mass_instance": 60, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 104, "fields": {"created_at": "2026-01-21T13:32:06.367Z", "updated_at": "2026-01-21T13:32:06.367Z", "parish": 1, "mass_instance": 60, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 71, "fields": {"created_at": "2026-01-21T07:22:11.368Z", "updated_at": "2026-01-21T07:22:11.368Z", "parish": 1, "mass_instance": 61, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 72, "fields": {"created_at": "2026-01-21T07:22:11.379Z", "updated_at": "2026-01-23T11:28:57.054Z", "parish": 1, "mass_instance": 61, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 73, "fields": {"created_at": "2026-01-21T07:28:56.199Z", "updated_at": "2026-01-26T06:10:14.629Z", "parish": 1, "mass_instance": 62, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 74, "fields": {"created_at": "2026-01-21T07:28:56.211Z", "updated_at": "2026-01-24T09:09:41.399Z", "parish": 1, "mass_instance": 62, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 75, "fields": {"created_at": "2026-01-21T07:28:56.223Z", "updated_at": "2026-01-24T09:09:41.414Z", "parish": 1, "mass_instance": 62, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 76, "fields": {"created_at": "2026-01-21T07:28:56.233Z", "updated_at": "2026-01-24T09:09:41.432Z", "parish": 1, "mass_instance": 62, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 105, "fields": {"created_at": "2026-01-21T13:32:06.375Z", "updated_at": "2026-01-24T09:09:41.447Z", "parish": 1, "mass_instance": 62, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 106, "fields": {"created_at": "2026-01-21T13:32:06.376Z", "updated_at": "2026-01-21T13:36:24.460Z", "parish": 1, "mass_instance": 62, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 113, "fields": {"created_at": "2026-01-24T08:14:21.054Z", "updated_at": "2026-01-24T09:09:41.464Z", "parish": 1, "mass_instance": 70, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 114, "fields": {"created_at": "2026-01-24T08:14:21.062Z", "updated_at": "2026-01-24T10:13:32.083Z", "parish": 1, "mass_instance": 70, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 115, "fields": {"created_at": "2026-01-24T08:14:21.070Z", "updated_at": "2026-01-24T09:09:41.491Z", "parish": 1, "mass_instance": 70, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 116, "fields": {"created_at": "2026-01-24T08:14:21.077Z", "updated_at": "2026-01-24T09:09:41.505Z", "parish": 1, "mass_instance": 70, "position_type": 7, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 117, "fields": {"created_at": "2026-01-24T08:14:21.084Z", "updated_at": "2026-01-24T09:09:41.516Z", "parish": 1, "mass_instance": 70, "position_type": 8, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 118, "fields": {"created_at": "2026-01-24T08:14:21.093Z", "updated_at": "2026-01-24T09:09:41.559Z", "parish": 1, "mass_instance": 70, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 119, "fields": {"created_at": "2026-01-24T08:14:21.101Z", "updated_at": "2026-01-24T09:09:41.585Z", "parish": 1, "mass_instance": 70, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\past_massinstance.json
```json
[{"model": "core.massinstance", "pk": 1, "fields": {"created_at": "2026-01-20T04:43:09.889Z", "updated_at": "2026-01-20T04:43:09.889Z", "parish": 1, "template": 1, "event_series": null, "community": 4, "starts_at": "2026-01-24T20:00:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 10, "fields": {"created_at": "2026-01-20T04:43:10.186Z", "updated_at": "2026-01-20T04:43:10.187Z", "parish": 1, "template": 2, "event_series": null, "community": 2, "starts_at": "2026-01-24T21:30:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 19, "fields": {"created_at": "2026-01-20T04:43:10.446Z", "updated_at": "2026-01-20T04:43:10.446Z", "parish": 1, "template": 3, "event_series": null, "community": 3, "starts_at": "2026-01-24T22:45:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 28, "fields": {"created_at": "2026-01-20T04:43:10.691Z", "updated_at": "2026-01-20T06:44:25.425Z", "parish": 1, "template": 4, "event_series": null, "community": 1, "starts_at": "2026-01-25T10:00:00Z", "liturgy_label": "", "requirement_profile": 4, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 36, "fields": {"created_at": "2026-01-20T04:43:10.938Z", "updated_at": "2026-01-20T04:43:10.938Z", "parish": 1, "template": 5, "event_series": null, "community": 6, "starts_at": "2026-01-25T11:15:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 44, "fields": {"created_at": "2026-01-20T04:43:11.256Z", "updated_at": "2026-01-20T04:43:11.256Z", "parish": 1, "template": 6, "event_series": null, "community": 5, "starts_at": "2026-01-25T12:30:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 52, "fields": {"created_at": "2026-01-20T04:43:11.502Z", "updated_at": "2026-01-20T04:43:11.502Z", "parish": 1, "template": 7, "event_series": null, "community": 1, "starts_at": "2026-01-25T22:00:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 60, "fields": {"created_at": "2026-01-20T07:48:37.776Z", "updated_at": "2026-01-21T07:23:15.725Z", "parish": 1, "template": null, "event_series": 1, "community": 1, "starts_at": "2026-01-23T22:00:00Z", "liturgy_label": "Missa", "requirement_profile": 4, "status": "canceled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 61, "fields": {"created_at": "2026-01-21T07:22:11.340Z", "updated_at": "2026-01-21T07:22:11.340Z", "parish": 1, "template": null, "event_series": 2, "community": 1, "starts_at": "2026-01-21T22:00:00Z", "liturgy_label": "", "requirement_profile": 2, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 62, "fields": {"created_at": "2026-01-21T07:28:56.176Z", "updated_at": "2026-01-21T07:31:01.612Z", "parish": 1, "template": null, "event_series": 3, "community": 1, "starts_at": "2026-01-24T22:00:00Z", "liturgy_label": "Memória de São Francisco de Sales, bispo e doutor da Igreja", "requirement_profile": 4, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 70, "fields": {"created_at": "2026-01-24T08:14:21.035Z", "updated_at": "2026-01-24T08:14:21.035Z", "parish": 1, "template": null, "event_series": 5, "community": 1, "starts_at": "2026-01-24T18:00:00Z", "liturgy_label": "Solenidade de teste", "requirement_profile": 5, "status": "scheduled", "created_by": 1, "updated_by": 1}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\positionclaimrequest.json
```json
[{"model": "core.positionclaimrequest", "pk": 8, "fields": {"created_at": "2026-01-26T06:13:52.739Z", "updated_at": "2026-01-27T08:16:48.744Z", "parish": 1, "slot": 3, "requestor_acolyte": 3, "target_assignment": 402, "status": "expired", "approval_mode": "", "resolution_reason": "assignment_changed", "auto_approve_at": "2026-02-05T20:00:00Z", "resolved_at": "2026-01-27T08:16:48.744Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 5, "fields": {"created_at": "2026-01-25T21:13:54.694Z", "updated_at": "2026-01-25T21:31:57.274Z", "parish": 1, "slot": 12, "requestor_acolyte": 1, "target_assignment": 387, "status": "expired", "approval_mode": "coordination", "resolution_reason": "holder_confirmed", "auto_approve_at": null, "resolved_at": "2026-01-25T21:31:57.274Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 6, "fields": {"created_at": "2026-01-26T06:10:28.258Z", "updated_at": "2026-01-26T06:10:28.258Z", "parish": 1, "slot": 44, "requestor_acolyte": 1, "target_assignment": 281, "status": "scheduled_auto_approve", "approval_mode": "", "resolution_reason": "", "auto_approve_at": "2026-01-26T06:10:28.257Z", "resolved_at": null, "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 7, "fields": {"created_at": "2026-01-26T06:10:48.362Z", "updated_at": "2026-01-26T06:10:48.362Z", "parish": 1, "slot": 52, "requestor_acolyte": 3, "target_assignment": 383, "status": "pending_target", "approval_mode": "", "resolution_reason": "", "auto_approve_at": null, "resolved_at": null, "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 4, "fields": {"created_at": "2026-01-24T14:26:08.140Z", "updated_at": "2026-01-24T14:27:16.628Z", "parish": 1, "slot": 75, "requestor_acolyte": 3, "target_assignment": 353, "status": "approved", "approval_mode": "coordination", "resolution_reason": "coordination_approved", "auto_approve_at": null, "resolved_at": "2026-01-24T14:27:16.628Z", "approved_by": 1}}, {"model": "core.positionclaimrequest", "pk": 1, "fields": {"created_at": "2026-01-24T13:10:47.591Z", "updated_at": "2026-01-24T13:18:47.943Z", "parish": 1, "slot": 101, "requestor_acolyte": 1, "target_assignment": 370, "status": "approved", "approval_mode": "target", "resolution_reason": "holder_approved", "auto_approve_at": null, "resolved_at": "2026-01-24T13:18:47.943Z", "approved_by": 3}}, {"model": "core.positionclaimrequest", "pk": 2, "fields": {"created_at": "2026-01-24T13:18:22.002Z", "updated_at": "2026-01-24T13:18:47.944Z", "parish": 1, "slot": 101, "requestor_acolyte": 14, "target_assignment": 370, "status": "rejected", "approval_mode": "", "resolution_reason": "holder_selected_other", "auto_approve_at": null, "resolved_at": "2026-01-24T13:18:47.944Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 3, "fields": {"created_at": "2026-01-24T13:27:42.175Z", "updated_at": "2026-01-24T14:27:51.118Z", "parish": 1, "slot": 101, "requestor_acolyte": 3, "target_assignment": 373, "status": "approved", "approval_mode": "coordination", "resolution_reason": "coordination_approved", "auto_approve_at": null, "resolved_at": "2026-01-24T14:27:51.118Z", "approved_by": 1}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\replacementrequest.json
```json
[{"model": "core.replacementrequest", "pk": 11, "fields": {"created_at": "2026-01-26T03:52:46.710Z", "updated_at": "2026-01-26T03:52:46.776Z", "parish": 1, "slot": 2, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 1, "fields": {"created_at": "2026-01-20T06:46:54.773Z", "updated_at": "2026-01-20T07:49:48.852Z", "parish": 1, "slot": 10, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 12, "fields": {"created_at": "2026-01-26T03:55:01.453Z", "updated_at": "2026-01-26T03:55:01.526Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 13, "fields": {"created_at": "2026-01-26T03:56:22.179Z", "updated_at": "2026-01-26T03:56:22.339Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 16, "fields": {"created_at": "2026-01-27T03:38:03.289Z", "updated_at": "2026-01-27T03:38:03.289Z", "parish": 1, "slot": 17, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 2, "fields": {"created_at": "2026-01-23T09:26:19.338Z", "updated_at": "2026-01-23T11:03:56.476Z", "parish": 1, "slot": 19, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 14, "fields": {"created_at": "2026-01-26T03:56:36.974Z", "updated_at": "2026-01-26T03:56:37.048Z", "parish": 1, "slot": 20, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 9, "fields": {"created_at": "2026-01-25T18:10:45.171Z", "updated_at": "2026-01-25T18:10:45.229Z", "parish": 1, "slot": 23, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 15, "fields": {"created_at": "2026-01-27T03:38:03.253Z", "updated_at": "2026-01-27T03:38:03.253Z", "parish": 1, "slot": 29, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 8, "fields": {"created_at": "2026-01-25T18:09:03.950Z", "updated_at": "2026-01-25T18:09:04.009Z", "parish": 1, "slot": 34, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 17, "fields": {"created_at": "2026-01-27T03:38:03.326Z", "updated_at": "2026-01-27T03:38:03.326Z", "parish": 1, "slot": 35, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 7, "fields": {"created_at": "2026-01-25T18:08:53.446Z", "updated_at": "2026-01-25T18:08:53.518Z", "parish": 1, "slot": 45, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 4, "fields": {"created_at": "2026-01-23T11:40:58.132Z", "updated_at": "2026-01-23T11:40:58.133Z", "parish": 1, "slot": 51, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 10, "fields": {"created_at": "2026-01-25T18:10:50.465Z", "updated_at": "2026-01-25T18:10:50.517Z", "parish": 1, "slot": 52, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 6, "fields": {"created_at": "2026-01-24T10:11:29.956Z", "updated_at": "2026-01-24T10:11:30.000Z", "parish": 1, "slot": 61, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 3, "fields": {"created_at": "2026-01-23T11:28:57.076Z", "updated_at": "2026-01-23T11:28:57.076Z", "parish": 1, "slot": 72, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 5, "fields": {"created_at": "2026-01-23T11:41:55.885Z", "updated_at": "2026-01-23T11:41:55.885Z", "parish": 1, "slot": 107, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\serializers\swaprequest.json
```json
[{"model": "core.swaprequest", "pk": 5, "fields": {"created_at": "2026-01-23T12:27:26.336Z", "updated_at": "2026-01-23T12:46:24.242Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 20, "mass_instance": 28, "from_slot": 101, "to_slot": 62, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": null}}, {"model": "core.swaprequest", "pk": 6, "fields": {"created_at": "2026-01-23T13:04:22.746Z", "updated_at": "2026-01-23T13:10:28.594Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 2, "mass_instance": 28, "from_slot": 101, "to_slot": 60, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": null}}, {"model": "core.swaprequest", "pk": 7, "fields": {"created_at": "2026-01-23T13:10:47.522Z", "updated_at": "2026-01-23T13:29:20.164Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 15, "mass_instance": 28, "from_slot": 101, "to_slot": 28, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "c281d43b-7dca-4536-8b56-bb08cfd70261"}}, {"model": "core.swaprequest", "pk": 8, "fields": {"created_at": "2026-01-23T13:10:47.546Z", "updated_at": "2026-01-23T13:29:18.420Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 2, "mass_instance": 28, "from_slot": 101, "to_slot": 60, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "c281d43b-7dca-4536-8b56-bb08cfd70261"}}, {"model": "core.swaprequest", "pk": 9, "fields": {"created_at": "2026-01-23T13:10:47.566Z", "updated_at": "2026-01-23T13:28:53.476Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 20, "mass_instance": 28, "from_slot": 101, "to_slot": 62, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "c281d43b-7dca-4536-8b56-bb08cfd70261"}}, {"model": "core.swaprequest", "pk": 10, "fields": {"created_at": "2026-01-23T13:29:29.832Z", "updated_at": "2026-01-24T03:46:08.632Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 15, "mass_instance": 28, "from_slot": 101, "to_slot": 28, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "aa7b699a-19af-4bf2-a67f-34a541486772"}}, {"model": "core.swaprequest", "pk": 11, "fields": {"created_at": "2026-01-23T13:29:29.853Z", "updated_at": "2026-01-24T03:46:07.195Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 2, "mass_instance": 28, "from_slot": 101, "to_slot": 60, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "aa7b699a-19af-4bf2-a67f-34a541486772"}}, {"model": "core.swaprequest", "pk": 12, "fields": {"created_at": "2026-01-23T13:29:29.872Z", "updated_at": "2026-01-24T03:46:10.248Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 20, "mass_instance": 28, "from_slot": 101, "to_slot": 62, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "aa7b699a-19af-4bf2-a67f-34a541486772"}}, {"model": "core.swaprequest", "pk": 13, "fields": {"created_at": "2026-01-24T03:48:29.684Z", "updated_at": "2026-01-24T03:48:29.684Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 15, "mass_instance": 28, "from_slot": 101, "to_slot": 28, "status": "pending", "notes": "", "open_to_admin": false, "group_id": "ba991f1a-5f3c-436e-bea7-e510973d486c"}}, {"model": "core.swaprequest", "pk": 14, "fields": {"created_at": "2026-01-24T03:48:29.707Z", "updated_at": "2026-01-24T03:48:29.707Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 2, "mass_instance": 28, "from_slot": 101, "to_slot": 60, "status": "pending", "notes": "", "open_to_admin": false, "group_id": "ba991f1a-5f3c-436e-bea7-e510973d486c"}}, {"model": "core.swaprequest", "pk": 15, "fields": {"created_at": "2026-01-24T03:48:29.723Z", "updated_at": "2026-01-24T03:48:29.723Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 20, "mass_instance": 28, "from_slot": 101, "to_slot": 62, "status": "pending", "notes": "", "open_to_admin": false, "group_id": "ba991f1a-5f3c-436e-bea7-e510973d486c"}}, {"model": "core.swaprequest", "pk": 16, "fields": {"created_at": "2026-01-24T09:41:20.630Z", "updated_at": "2026-01-24T10:11:09.158Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 15, "mass_instance": 28, "from_slot": 61, "to_slot": 28, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "688bae81-2b00-4e0b-9626-94b9e4e6dd20"}}, {"model": "core.swaprequest", "pk": 17, "fields": {"created_at": "2026-01-24T09:41:20.654Z", "updated_at": "2026-01-24T10:11:07.908Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 20, "mass_instance": 28, "from_slot": 61, "to_slot": 62, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "688bae81-2b00-4e0b-9626-94b9e4e6dd20"}}, {"model": "core.swaprequest", "pk": 18, "fields": {"created_at": "2026-01-24T09:41:20.672Z", "updated_at": "2026-01-24T10:11:06.579Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 1, "mass_instance": 28, "from_slot": 61, "to_slot": 101, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "688bae81-2b00-4e0b-9626-94b9e4e6dd20"}}, {"model": "core.swaprequest", "pk": 22, "fields": {"created_at": "2026-01-24T10:19:01.240Z", "updated_at": "2026-01-24T10:19:01.240Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 8, "mass_instance": 62, "from_slot": 75, "to_slot": 73, "status": "pending", "notes": "", "open_to_admin": false, "group_id": "b3829741-5d27-4d32-b594-97e7da58a098"}}, {"model": "core.swaprequest", "pk": 23, "fields": {"created_at": "2026-01-24T10:19:01.261Z", "updated_at": "2026-01-24T10:19:01.261Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 18, "mass_instance": 62, "from_slot": 75, "to_slot": 76, "status": "pending", "notes": "", "open_to_admin": false, "group_id": "b3829741-5d27-4d32-b594-97e7da58a098"}}, {"model": "core.swaprequest", "pk": 24, "fields": {"created_at": "2026-01-24T10:19:01.278Z", "updated_at": "2026-01-24T10:19:01.278Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 1, "target_acolyte": 19, "mass_instance": 62, "from_slot": 75, "to_slot": 105, "status": "pending", "notes": "", "open_to_admin": false, "group_id": "b3829741-5d27-4d32-b594-97e7da58a098"}}, {"model": "core.swaprequest", "pk": 19, "fields": {"created_at": "2026-01-24T10:15:28.884Z", "updated_at": "2026-01-24T10:15:28.884Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 14, "mass_instance": 70, "from_slot": 114, "to_slot": 113, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "e10f8690-a0dd-4e5b-9424-1c8ccce35fdd"}}, {"model": "core.swaprequest", "pk": 20, "fields": {"created_at": "2026-01-24T10:15:28.908Z", "updated_at": "2026-01-24T10:15:28.908Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 16, "mass_instance": 70, "from_slot": 114, "to_slot": 115, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "e10f8690-a0dd-4e5b-9424-1c8ccce35fdd"}}, {"model": "core.swaprequest", "pk": 21, "fields": {"created_at": "2026-01-24T10:15:28.927Z", "updated_at": "2026-01-24T10:31:25.201Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 1, "mass_instance": 70, "from_slot": 114, "to_slot": 117, "status": "accepted", "notes": "", "open_to_admin": false, "group_id": "e10f8690-a0dd-4e5b-9424-1c8ccce35fdd"}}, {"model": "core.swaprequest", "pk": 25, "fields": {"created_at": "2026-01-24T10:56:06.095Z", "updated_at": "2026-01-24T11:00:32.261Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 1, "mass_instance": 70, "from_slot": 117, "to_slot": 114, "status": "accepted", "notes": "", "open_to_admin": false, "group_id": "f90df91a-82d5-4ae2-aa7e-0981f45b9fdc"}}, {"model": "core.swaprequest", "pk": 26, "fields": {"created_at": "2026-01-24T10:56:06.127Z", "updated_at": "2026-01-24T10:56:06.127Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 16, "mass_instance": 70, "from_slot": 117, "to_slot": 115, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "f90df91a-82d5-4ae2-aa7e-0981f45b9fdc"}}, {"model": "core.swaprequest", "pk": 27, "fields": {"created_at": "2026-01-24T10:56:06.145Z", "updated_at": "2026-01-24T10:56:06.145Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 18, "mass_instance": 70, "from_slot": 117, "to_slot": 116, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "f90df91a-82d5-4ae2-aa7e-0981f45b9fdc"}}, {"model": "core.swaprequest", "pk": 28, "fields": {"created_at": "2026-01-24T13:23:06.178Z", "updated_at": "2026-01-24T14:18:42.540Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 14, "mass_instance": 70, "from_slot": 114, "to_slot": 113, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": null}}, {"model": "core.swaprequest", "pk": 29, "fields": {"created_at": "2026-01-24T14:36:06.620Z", "updated_at": "2026-01-24T14:36:06.620Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 14, "mass_instance": 70, "from_slot": 114, "to_slot": 113, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "b32a5406-b554-43f8-8362-bd6f7e6cd81a"}}, {"model": "core.swaprequest", "pk": 30, "fields": {"created_at": "2026-01-24T14:36:06.654Z", "updated_at": "2026-01-24T14:36:06.654Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 16, "mass_instance": 70, "from_slot": 114, "to_slot": 115, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "b32a5406-b554-43f8-8362-bd6f7e6cd81a"}}, {"model": "core.swaprequest", "pk": 31, "fields": {"created_at": "2026-01-24T14:36:06.672Z", "updated_at": "2026-01-24T14:36:06.672Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 18, "mass_instance": 70, "from_slot": 114, "to_slot": 116, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "b32a5406-b554-43f8-8362-bd6f7e6cd81a"}}, {"model": "core.swaprequest", "pk": 32, "fields": {"created_at": "2026-01-24T14:36:06.690Z", "updated_at": "2026-01-24T14:36:46.878Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 1, "mass_instance": 70, "from_slot": 114, "to_slot": 117, "status": "accepted", "notes": "", "open_to_admin": false, "group_id": "b32a5406-b554-43f8-8362-bd6f7e6cd81a"}}, {"model": "core.swaprequest", "pk": 33, "fields": {"created_at": "2026-01-24T14:36:06.718Z", "updated_at": "2026-01-24T14:36:06.718Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 17, "mass_instance": 70, "from_slot": 114, "to_slot": 118, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "b32a5406-b554-43f8-8362-bd6f7e6cd81a"}}, {"model": "core.swaprequest", "pk": 34, "fields": {"created_at": "2026-01-24T14:36:06.736Z", "updated_at": "2026-01-24T14:36:06.736Z", "parish": 1, "swap_type": "role_swap", "requestor_acolyte": 3, "target_acolyte": 20, "mass_instance": 70, "from_slot": 114, "to_slot": 119, "status": "canceled", "notes": "", "open_to_admin": false, "group_id": "b32a5406-b554-43f8-8362-bd6f7e6cd81a"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T053859\meta.json
```json
{
  "created_at": "2026-01-27T05:38:59.356511-03:00",
  "cutoff_date": "2026-01-27",
  "counts": {
    "past_masses": 11,
    "past_slots": 33,
    "past_assignments": 102,
    "future_assignments_total": 351,
    "confirmations": 107,
    "claims": 8,
    "replacement_requests": 17,
    "swap_requests": 30,
    "mass_interest": 4,
    "mass_override": 1,
    "ledger_rows": 0,
    "audit_events": 895
  },
  "models_included": [
    "core.MassInstance",
    "core.AssignmentSlot",
    "core.Assignment",
    "core.Confirmation",
    "core.PositionClaimRequest",
    "core.ReplacementRequest",
    "core.SwapRequest",
    "core.MassInterest",
    "core.MassOverride",
    "core.AcolyteCreditLedger",
    "core.AuditEvent"
  ]
}
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\acolytecreditledger.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\auditevent.json
```json
[{"model": "core.auditevent", "pk": 1, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "1", "action_type": "create", "diff_json": {"template_id": 1}, "timestamp": "2026-01-20T04:43:09.903Z"}}, {"model": "core.auditevent", "pk": 10, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "10", "action_type": "create", "diff_json": {"template_id": 2}, "timestamp": "2026-01-20T04:43:10.196Z"}}, {"model": "core.auditevent", "pk": 19, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "19", "action_type": "create", "diff_json": {"template_id": 3}, "timestamp": "2026-01-20T04:43:10.454Z"}}, {"model": "core.auditevent", "pk": 28, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "28", "action_type": "create", "diff_json": {"template_id": 4}, "timestamp": "2026-01-20T04:43:10.698Z"}}, {"model": "core.auditevent", "pk": 126, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "28", "action_type": "update", "diff_json": {"from": {"liturgy_label": "", "requirement_profile_id": 4}, "to": {"liturgy_label": "", "requirement_profile_id": 4}}, "timestamp": "2026-01-20T06:44:25.438Z"}}, {"model": "core.auditevent", "pk": 36, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "36", "action_type": "create", "diff_json": {"template_id": 5}, "timestamp": "2026-01-20T04:43:10.947Z"}}, {"model": "core.auditevent", "pk": 44, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "44", "action_type": "create", "diff_json": {"template_id": 6}, "timestamp": "2026-01-20T04:43:11.265Z"}}, {"model": "core.auditevent", "pk": 52, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "52", "action_type": "create", "diff_json": {"template_id": 7}, "timestamp": "2026-01-20T04:43:11.511Z"}}, {"model": "core.auditevent", "pk": 362, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "60", "action_type": "create", "diff_json": {"event_series_id": 1}, "timestamp": "2026-01-20T07:48:37.784Z"}}, {"model": "core.auditevent", "pk": 489, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "60", "action_type": "update", "diff_json": {"from": {"liturgy_label": "lilili teste", "requirement_profile_id": 4}, "to": {"liturgy_label": "lilili teste", "requirement_profile_id": 4}}, "timestamp": "2026-01-21T07:05:45.234Z"}}, {"model": "core.auditevent", "pk": 490, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "60", "action_type": "cancel", "diff_json": {"reason": "manual_cancel"}, "timestamp": "2026-01-21T07:05:53.213Z"}}, {"model": "core.auditevent", "pk": 610, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "60", "action_type": "update", "diff_json": {"from": {"liturgy_label": "Missa", "requirement_profile_id": 4}, "to": {"liturgy_label": "Missa", "requirement_profile_id": 4}}, "timestamp": "2026-01-21T07:23:15.738Z"}}, {"model": "core.auditevent", "pk": 607, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "61", "action_type": "create", "diff_json": {"event_series_id": 2}, "timestamp": "2026-01-21T07:22:11.353Z"}}, {"model": "core.auditevent", "pk": 611, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "62", "action_type": "create", "diff_json": {"event_series_id": 3}, "timestamp": "2026-01-21T07:28:56.185Z"}}, {"model": "core.auditevent", "pk": 612, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "62", "action_type": "update", "diff_json": {"from": {"liturgy_label": "Memória de São Francisco de Sales, bispo e doutor da Igreja", "requirement_profile_id": 4}, "to": {"liturgy_label": "Memória de São Francisco de Sales, bispo e doutor da Igreja", "requirement_profile_id": 4}}, "timestamp": "2026-01-21T07:31:01.622Z"}}, {"model": "core.auditevent", "pk": 827, "fields": {"parish": 1, "actor_user": 1, "entity_type": "MassInstance", "entity_id": "70", "action_type": "create", "diff_json": {"event_series_id": 5}, "timestamp": "2026-01-24T08:14:21.042Z"}}, {"model": "core.auditevent", "pk": 60, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "1", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 1}, "timestamp": "2026-01-20T06:42:41.830Z"}}, {"model": "core.auditevent", "pk": 127, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "1", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 1}, "timestamp": "2026-01-20T06:44:56.198Z"}}, {"model": "core.auditevent", "pk": 211, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "104", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 44}, "timestamp": "2026-01-20T06:44:57.396Z"}}, {"model": "core.auditevent", "pk": 329, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "104", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 44}, "timestamp": "2026-01-20T07:46:29.501Z"}}, {"model": "core.auditevent", "pk": 225, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "111", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 52}, "timestamp": "2026-01-20T06:44:57.590Z"}}, {"model": "core.auditevent", "pk": 345, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "111", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 52}, "timestamp": "2026-01-20T07:46:29.729Z"}}, {"model": "core.auditevent", "pk": 237, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "117", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 60}, "timestamp": "2026-01-20T06:45:43.852Z"}}, {"model": "core.auditevent", "pk": 238, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "117", "action_type": "manual_assign", "diff_json": {"slot_id": 60, "acolyte_id": 14}, "timestamp": "2026-01-20T06:45:43.875Z"}}, {"model": "core.auditevent", "pk": 239, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "117", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 60}, "timestamp": "2026-01-20T06:45:52.461Z"}}, {"model": "core.auditevent", "pk": 240, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "118", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 60}, "timestamp": "2026-01-20T06:45:52.478Z"}}, {"model": "core.auditevent", "pk": 241, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "118", "action_type": "manual_assign", "diff_json": {"slot_id": 60, "acolyte_id": 2}, "timestamp": "2026-01-20T06:45:52.501Z"}}, {"model": "core.auditevent", "pk": 247, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "119", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 1}, "timestamp": "2026-01-20T07:46:28.213Z"}}, {"model": "core.auditevent", "pk": 492, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "119", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 1}, "timestamp": "2026-01-21T07:11:31.889Z"}}, {"model": "core.auditevent", "pk": 262, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "127", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 10}, "timestamp": "2026-01-20T07:46:28.458Z"}}, {"model": "core.auditevent", "pk": 363, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "127", "action_type": "deactivate", "diff_json": {"reason": "replaced", "slot_id": 10}, "timestamp": "2026-01-20T07:49:48.790Z"}}, {"model": "core.auditevent", "pk": 276, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "134", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 19}, "timestamp": "2026-01-20T07:46:28.744Z"}}, {"model": "core.auditevent", "pk": 393, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "134", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 19}, "timestamp": "2026-01-20T07:50:30.779Z"}}, {"model": "core.auditevent", "pk": 290, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "141", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 28}, "timestamp": "2026-01-20T07:46:28.962Z"}}, {"model": "core.auditevent", "pk": 409, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "141", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 28}, "timestamp": "2026-01-20T07:50:30.989Z"}}, {"model": "core.auditevent", "pk": 292, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "142", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 61}, "timestamp": "2026-01-20T07:46:28.992Z"}}, {"model": "core.auditevent", "pk": 411, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "142", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 61}, "timestamp": "2026-01-20T07:50:31.019Z"}}, {"model": "core.auditevent", "pk": 294, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "143", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 62}, "timestamp": "2026-01-20T07:46:29.023Z"}}, {"model": "core.auditevent", "pk": 413, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "143", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 62}, "timestamp": "2026-01-20T07:50:31.046Z"}}, {"model": "core.auditevent", "pk": 314, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "153", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 36}, "timestamp": "2026-01-20T07:46:29.299Z"}}, {"model": "core.auditevent", "pk": 433, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "153", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 36}, "timestamp": "2026-01-20T07:50:31.323Z"}}, {"model": "core.auditevent", "pk": 330, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "161", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 44}, "timestamp": "2026-01-20T07:46:29.511Z"}}, {"model": "core.auditevent", "pk": 449, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "161", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 44}, "timestamp": "2026-01-20T07:50:31.544Z"}}, {"model": "core.auditevent", "pk": 346, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "169", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 52}, "timestamp": "2026-01-20T07:46:29.741Z"}}, {"model": "core.auditevent", "pk": 465, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "169", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 52}, "timestamp": "2026-01-20T07:50:31.765Z"}}, {"model": "core.auditevent", "pk": 76, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "17", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 19}, "timestamp": "2026-01-20T06:42:42.153Z"}}, {"model": "core.auditevent", "pk": 157, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "17", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 19}, "timestamp": "2026-01-20T06:44:56.627Z"}}, {"model": "core.auditevent", "pk": 364, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "177", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 10}, "timestamp": "2026-01-20T07:49:48.817Z"}}, {"model": "core.auditevent", "pk": 394, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "191", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 19}, "timestamp": "2026-01-20T07:50:30.791Z"}}, {"model": "core.auditevent", "pk": 522, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "191", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 19}, "timestamp": "2026-01-21T07:11:32.179Z"}}, {"model": "core.auditevent", "pk": 410, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "199", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 28}, "timestamp": "2026-01-20T07:50:31.002Z"}}, {"model": "core.auditevent", "pk": 539, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "199", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 28}, "timestamp": "2026-01-21T07:11:32.318Z"}}, {"model": "core.auditevent", "pk": 412, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "200", "action_type": "create", "diff_json": {"acolyte_id": 13, "slot_id": 61}, "timestamp": "2026-01-20T07:50:31.030Z"}}, {"model": "core.auditevent", "pk": 541, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "200", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 61}, "timestamp": "2026-01-21T07:11:32.334Z"}}, {"model": "core.auditevent", "pk": 414, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "201", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 62}, "timestamp": "2026-01-20T07:50:31.058Z"}}, {"model": "core.auditevent", "pk": 543, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "201", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 62}, "timestamp": "2026-01-21T07:11:32.351Z"}}, {"model": "core.auditevent", "pk": 434, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "211", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 36}, "timestamp": "2026-01-20T07:50:31.335Z"}}, {"model": "core.auditevent", "pk": 561, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "211", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 36}, "timestamp": "2026-01-21T07:11:32.488Z"}}, {"model": "core.auditevent", "pk": 450, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "219", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 44}, "timestamp": "2026-01-20T07:50:31.557Z"}}, {"model": "core.auditevent", "pk": 577, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "219", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 44}, "timestamp": "2026-01-21T07:11:32.607Z"}}, {"model": "core.auditevent", "pk": 466, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "227", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 52}, "timestamp": "2026-01-20T07:50:31.776Z"}}, {"model": "core.auditevent", "pk": 593, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "227", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 52}, "timestamp": "2026-01-21T07:11:32.713Z"}}, {"model": "core.auditevent", "pk": 493, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "237", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 1}, "timestamp": "2026-01-21T07:11:31.893Z"}}, {"model": "core.auditevent", "pk": 919, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "237", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 1}, "timestamp": "2026-01-24T13:25:12.869Z"}}, {"model": "core.auditevent", "pk": 84, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "25", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 28}, "timestamp": "2026-01-20T06:42:42.304Z"}}, {"model": "core.auditevent", "pk": 173, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "25", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 28}, "timestamp": "2026-01-20T06:44:56.848Z"}}, {"model": "core.auditevent", "pk": 523, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "253", "action_type": "create", "diff_json": {"acolyte_id": 13, "slot_id": 19}, "timestamp": "2026-01-21T07:11:32.183Z"}}, {"model": "core.auditevent", "pk": 764, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "253", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 19}, "timestamp": "2026-01-23T09:26:19.315Z"}}, {"model": "core.auditevent", "pk": 540, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "262", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 28}, "timestamp": "2026-01-21T07:11:32.320Z"}}, {"model": "core.auditevent", "pk": 542, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "263", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 61}, "timestamp": "2026-01-21T07:11:32.339Z"}}, {"model": "core.auditevent", "pk": 865, "fields": {"parish": 1, "actor_user": 3, "entity_type": "Assignment", "entity_id": "263", "action_type": "deactivate", "diff_json": {"reason": "declined", "slot_id": 61}, "timestamp": "2026-01-24T10:11:29.933Z"}}, {"model": "core.auditevent", "pk": 544, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "264", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 62}, "timestamp": "2026-01-21T07:11:32.354Z"}}, {"model": "core.auditevent", "pk": 562, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "273", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 36}, "timestamp": "2026-01-21T07:11:32.491Z"}}, {"model": "core.auditevent", "pk": 578, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "281", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 44}, "timestamp": "2026-01-21T07:11:32.610Z"}}, {"model": "core.auditevent", "pk": 594, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "289", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 52}, "timestamp": "2026-01-21T07:11:32.716Z"}}, {"model": "core.auditevent", "pk": 947, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "289", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 52}, "timestamp": "2026-01-25T17:55:35.317Z"}}, {"model": "core.auditevent", "pk": 608, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "296", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 72}, "timestamp": "2026-01-21T07:22:38.010Z"}}, {"model": "core.auditevent", "pk": 609, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "296", "action_type": "manual_assign", "diff_json": {"slot_id": 72, "acolyte_id": 1}, "timestamp": "2026-01-21T07:22:38.016Z"}}, {"model": "core.auditevent", "pk": 791, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "296", "action_type": "deactivate", "diff_json": {"reason": "canceled", "slot_id": 72}, "timestamp": "2026-01-23T11:28:57.044Z"}}, {"model": "core.auditevent", "pk": 616, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "297", "action_type": "create", "diff_json": {"acolyte_id": 17, "slot_id": 73}, "timestamp": "2026-01-21T07:35:24.650Z"}}, {"model": "core.auditevent", "pk": 648, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "297", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 73}, "timestamp": "2026-01-21T13:37:01.632Z"}}, {"model": "core.auditevent", "pk": 617, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "298", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 74}, "timestamp": "2026-01-21T07:35:24.662Z"}}, {"model": "core.auditevent", "pk": 658, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "298", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 74}, "timestamp": "2026-01-21T13:37:30.583Z"}}, {"model": "core.auditevent", "pk": 618, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "299", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 75}, "timestamp": "2026-01-21T07:35:24.672Z"}}, {"model": "core.auditevent", "pk": 650, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "299", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 75}, "timestamp": "2026-01-21T13:37:01.649Z"}}, {"model": "core.auditevent", "pk": 619, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "300", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 76}, "timestamp": "2026-01-21T07:35:24.681Z"}}, {"model": "core.auditevent", "pk": 652, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "300", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 76}, "timestamp": "2026-01-21T13:37:01.664Z"}}, {"model": "core.auditevent", "pk": 646, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "303", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 105}, "timestamp": "2026-01-21T13:36:24.448Z"}}, {"model": "core.auditevent", "pk": 654, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "303", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 105}, "timestamp": "2026-01-21T13:37:01.679Z"}}, {"model": "core.auditevent", "pk": 647, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "304", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 106}, "timestamp": "2026-01-21T13:36:24.459Z"}}, {"model": "core.auditevent", "pk": 649, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "305", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 73}, "timestamp": "2026-01-21T13:37:01.635Z"}}, {"model": "core.auditevent", "pk": 656, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "305", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 73}, "timestamp": "2026-01-21T13:37:30.566Z"}}, {"model": "core.auditevent", "pk": 651, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "306", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 75}, "timestamp": "2026-01-21T13:37:01.651Z"}}, {"model": "core.auditevent", "pk": 660, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "306", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 75}, "timestamp": "2026-01-21T13:37:30.598Z"}}, {"model": "core.auditevent", "pk": 653, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "307", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 76}, "timestamp": "2026-01-21T13:37:01.666Z"}}, {"model": "core.auditevent", "pk": 662, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "307", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 76}, "timestamp": "2026-01-21T13:37:30.617Z"}}, {"model": "core.auditevent", "pk": 655, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "308", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 105}, "timestamp": "2026-01-21T13:37:01.682Z"}}, {"model": "core.auditevent", "pk": 664, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "308", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 105}, "timestamp": "2026-01-21T13:37:30.631Z"}}, {"model": "core.auditevent", "pk": 657, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "309", "action_type": "create", "diff_json": {"acolyte_id": 17, "slot_id": 73}, "timestamp": "2026-01-21T13:37:30.569Z"}}, {"model": "core.auditevent", "pk": 768, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "309", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 73}, "timestamp": "2026-01-23T10:33:34.641Z"}}, {"model": "core.auditevent", "pk": 659, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "310", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 74}, "timestamp": "2026-01-21T13:37:30.585Z"}}, {"model": "core.auditevent", "pk": 770, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "310", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 74}, "timestamp": "2026-01-23T10:33:34.656Z"}}, {"model": "core.auditevent", "pk": 661, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "311", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 75}, "timestamp": "2026-01-21T13:37:30.601Z"}}, {"model": "core.auditevent", "pk": 772, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "311", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 75}, "timestamp": "2026-01-23T10:33:34.671Z"}}, {"model": "core.auditevent", "pk": 663, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "312", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 76}, "timestamp": "2026-01-21T13:37:30.620Z"}}, {"model": "core.auditevent", "pk": 774, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "312", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 76}, "timestamp": "2026-01-23T10:33:34.684Z"}}, {"model": "core.auditevent", "pk": 665, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "313", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 105}, "timestamp": "2026-01-21T13:37:30.633Z"}}, {"model": "core.auditevent", "pk": 776, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "313", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 105}, "timestamp": "2026-01-23T10:33:34.698Z"}}, {"model": "core.auditevent", "pk": 666, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "314", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 101}, "timestamp": "2026-01-21T13:37:50.051Z"}}, {"model": "core.auditevent", "pk": 667, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "314", "action_type": "manual_assign", "diff_json": {"slot_id": 101, "acolyte_id": 1}, "timestamp": "2026-01-21T13:37:50.054Z"}}, {"model": "core.auditevent", "pk": 902, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "314", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 101}, "timestamp": "2026-01-24T13:08:51.205Z"}}, {"model": "core.auditevent", "pk": 668, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "315", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 102}, "timestamp": "2026-01-21T13:38:03.173Z"}}, {"model": "core.auditevent", "pk": 669, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "315", "action_type": "manual_assign", "diff_json": {"slot_id": 102, "acolyte_id": 3}, "timestamp": "2026-01-21T13:38:03.175Z"}}, {"model": "core.auditevent", "pk": 832, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "315", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 102}, "timestamp": "2026-01-24T09:09:09.055Z"}}, {"model": "core.auditevent", "pk": 92, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "33", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 36}, "timestamp": "2026-01-20T06:42:42.455Z"}}, {"model": "core.auditevent", "pk": 194, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "33", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 36}, "timestamp": "2026-01-20T06:44:57.150Z"}}, {"model": "core.auditevent", "pk": 769, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "343", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 73}, "timestamp": "2026-01-23T10:33:34.644Z"}}, {"model": "core.auditevent", "pk": 833, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "343", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 73}, "timestamp": "2026-01-24T09:09:41.378Z"}}, {"model": "core.auditevent", "pk": 771, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "344", "action_type": "create", "diff_json": {"acolyte_id": 17, "slot_id": 74}, "timestamp": "2026-01-23T10:33:34.658Z"}}, {"model": "core.auditevent", "pk": 828, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "344", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 74}, "timestamp": "2026-01-24T08:51:47.474Z"}}, {"model": "core.auditevent", "pk": 773, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "345", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 75}, "timestamp": "2026-01-23T10:33:34.674Z"}}, {"model": "core.auditevent", "pk": 837, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "345", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 75}, "timestamp": "2026-01-24T09:09:41.411Z"}}, {"model": "core.auditevent", "pk": 775, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "346", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 76}, "timestamp": "2026-01-23T10:33:34.688Z"}}, {"model": "core.auditevent", "pk": 839, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "346", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 76}, "timestamp": "2026-01-24T09:09:41.428Z"}}, {"model": "core.auditevent", "pk": 777, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "347", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 105}, "timestamp": "2026-01-23T10:33:34.701Z"}}, {"model": "core.auditevent", "pk": 841, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "347", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 105}, "timestamp": "2026-01-24T09:09:41.445Z"}}, {"model": "core.auditevent", "pk": 785, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "349", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 19}, "timestamp": "2026-01-23T11:03:56.474Z"}}, {"model": "core.auditevent", "pk": 829, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "350", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 74}, "timestamp": "2026-01-24T09:03:29.608Z"}}, {"model": "core.auditevent", "pk": 830, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "350", "action_type": "manual_assign", "diff_json": {"slot_id": 74, "acolyte_id": 1}, "timestamp": "2026-01-24T09:03:29.611Z"}}, {"model": "core.auditevent", "pk": 835, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "350", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 74}, "timestamp": "2026-01-24T09:09:41.397Z"}}, {"model": "core.auditevent", "pk": 834, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "351", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 73}, "timestamp": "2026-01-24T09:09:41.382Z"}}, {"model": "core.auditevent", "pk": 1040, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "351", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 73}, "timestamp": "2026-01-26T06:10:14.618Z"}}, {"model": "core.auditevent", "pk": 836, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "352", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 74}, "timestamp": "2026-01-24T09:09:41.399Z"}}, {"model": "core.auditevent", "pk": 838, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "353", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 75}, "timestamp": "2026-01-24T09:09:41.414Z"}}, {"model": "core.auditevent", "pk": 928, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "353", "action_type": "deactivate", "diff_json": {"reason": "claim_transfer", "slot_id": 75}, "timestamp": "2026-01-24T14:27:16.625Z"}}, {"model": "core.auditevent", "pk": 840, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "354", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 76}, "timestamp": "2026-01-24T09:09:41.431Z"}}, {"model": "core.auditevent", "pk": 842, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "355", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 105}, "timestamp": "2026-01-24T09:09:41.447Z"}}, {"model": "core.auditevent", "pk": 843, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "356", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 113}, "timestamp": "2026-01-24T09:09:41.464Z"}}, {"model": "core.auditevent", "pk": 844, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "357", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 114}, "timestamp": "2026-01-24T09:09:41.478Z"}}, {"model": "core.auditevent", "pk": 870, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "357", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 114}, "timestamp": "2026-01-24T10:13:05.003Z"}}, {"model": "core.auditevent", "pk": 845, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "358", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 115}, "timestamp": "2026-01-24T09:09:41.491Z"}}, {"model": "core.auditevent", "pk": 846, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "359", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 116}, "timestamp": "2026-01-24T09:09:41.504Z"}}, {"model": "core.auditevent", "pk": 847, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "360", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 117}, "timestamp": "2026-01-24T09:09:41.516Z"}}, {"model": "core.auditevent", "pk": 883, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "360", "action_type": "deactivate", "diff_json": {"reason": "swap", "slot_id": 117}, "timestamp": "2026-01-24T10:31:25.185Z"}}, {"model": "core.auditevent", "pk": 848, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "361", "action_type": "create", "diff_json": {"acolyte_id": 17, "slot_id": 118}, "timestamp": "2026-01-24T09:09:41.559Z"}}, {"model": "core.auditevent", "pk": 849, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "362", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 119}, "timestamp": "2026-01-24T09:09:41.584Z"}}, {"model": "core.auditevent", "pk": 868, "fields": {"parish": 1, "actor_user": 3, "entity_type": "Assignment", "entity_id": "363", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 61}, "timestamp": "2026-01-24T10:11:29.997Z"}}, {"model": "core.auditevent", "pk": 905, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "363", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 61}, "timestamp": "2026-01-24T13:10:24.830Z"}}, {"model": "core.auditevent", "pk": 871, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "364", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 114}, "timestamp": "2026-01-24T10:13:05.008Z"}}, {"model": "core.auditevent", "pk": 872, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "364", "action_type": "manual_assign", "diff_json": {"slot_id": 114, "acolyte_id": 3}, "timestamp": "2026-01-24T10:13:05.011Z"}}, {"model": "core.auditevent", "pk": 873, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "364", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 114}, "timestamp": "2026-01-24T10:13:23.485Z"}}, {"model": "core.auditevent", "pk": 874, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "365", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 114}, "timestamp": "2026-01-24T10:13:32.081Z"}}, {"model": "core.auditevent", "pk": 875, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "365", "action_type": "manual_assign", "diff_json": {"slot_id": 114, "acolyte_id": 3}, "timestamp": "2026-01-24T10:13:32.084Z"}}, {"model": "core.auditevent", "pk": 882, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "365", "action_type": "deactivate", "diff_json": {"reason": "swap", "slot_id": 114}, "timestamp": "2026-01-24T10:31:25.182Z"}}, {"model": "core.auditevent", "pk": 884, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "366", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 114}, "timestamp": "2026-01-24T10:31:25.188Z"}}, {"model": "core.auditevent", "pk": 893, "fields": {"parish": 1, "actor_user": 4, "entity_type": "Assignment", "entity_id": "366", "action_type": "deactivate", "diff_json": {"reason": "swap", "slot_id": 114}, "timestamp": "2026-01-24T11:00:32.240Z"}}, {"model": "core.auditevent", "pk": 885, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "367", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 117}, "timestamp": "2026-01-24T10:31:25.190Z"}}, {"model": "core.auditevent", "pk": 892, "fields": {"parish": 1, "actor_user": 4, "entity_type": "Assignment", "entity_id": "367", "action_type": "deactivate", "diff_json": {"reason": "swap", "slot_id": 117}, "timestamp": "2026-01-24T11:00:32.238Z"}}, {"model": "core.auditevent", "pk": 894, "fields": {"parish": 1, "actor_user": 4, "entity_type": "Assignment", "entity_id": "368", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 117}, "timestamp": "2026-01-24T11:00:32.243Z"}}, {"model": "core.auditevent", "pk": 943, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "368", "action_type": "deactivate", "diff_json": {"reason": "swap", "slot_id": 117}, "timestamp": "2026-01-24T14:36:46.865Z"}}, {"model": "core.auditevent", "pk": 895, "fields": {"parish": 1, "actor_user": 4, "entity_type": "Assignment", "entity_id": "369", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 114}, "timestamp": "2026-01-24T11:00:32.246Z"}}, {"model": "core.auditevent", "pk": 942, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "369", "action_type": "deactivate", "diff_json": {"reason": "swap", "slot_id": 114}, "timestamp": "2026-01-24T14:36:46.863Z"}}, {"model": "core.auditevent", "pk": 903, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "370", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 101}, "timestamp": "2026-01-24T13:08:51.210Z"}}, {"model": "core.auditevent", "pk": 904, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "370", "action_type": "manual_assign", "diff_json": {"slot_id": 101, "acolyte_id": 3}, "timestamp": "2026-01-24T13:08:51.214Z"}}, {"model": "core.auditevent", "pk": 912, "fields": {"parish": 1, "actor_user": 3, "entity_type": "Assignment", "entity_id": "370", "action_type": "deactivate", "diff_json": {"reason": "claim_transfer", "slot_id": 101}, "timestamp": "2026-01-24T13:18:47.939Z"}}, {"model": "core.auditevent", "pk": 906, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "371", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 102}, "timestamp": "2026-01-24T13:10:34.181Z"}}, {"model": "core.auditevent", "pk": 907, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "371", "action_type": "manual_assign", "diff_json": {"slot_id": 102, "acolyte_id": 18}, "timestamp": "2026-01-24T13:10:34.183Z"}}, {"model": "core.auditevent", "pk": 908, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "372", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 61}, "timestamp": "2026-01-24T13:10:36.254Z"}}, {"model": "core.auditevent", "pk": 909, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "372", "action_type": "manual_assign", "diff_json": {"slot_id": 61, "acolyte_id": 4}, "timestamp": "2026-01-24T13:10:36.257Z"}}, {"model": "core.auditevent", "pk": 913, "fields": {"parish": 1, "actor_user": 3, "entity_type": "Assignment", "entity_id": "373", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 101}, "timestamp": "2026-01-24T13:18:47.941Z"}}, {"model": "core.auditevent", "pk": 931, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "373", "action_type": "deactivate", "diff_json": {"reason": "claim_transfer", "slot_id": 101}, "timestamp": "2026-01-24T14:27:51.115Z"}}, {"model": "core.auditevent", "pk": 920, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "374", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 1}, "timestamp": "2026-01-24T13:25:12.873Z"}}, {"model": "core.auditevent", "pk": 921, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "374", "action_type": "manual_assign", "diff_json": {"slot_id": 1, "acolyte_id": 3}, "timestamp": "2026-01-24T13:25:12.877Z"}}, {"model": "core.auditevent", "pk": 929, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "375", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 75}, "timestamp": "2026-01-24T14:27:16.627Z"}}, {"model": "core.auditevent", "pk": 932, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "376", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 101}, "timestamp": "2026-01-24T14:27:51.117Z"}}, {"model": "core.auditevent", "pk": 944, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "377", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 114}, "timestamp": "2026-01-24T14:36:46.866Z"}}, {"model": "core.auditevent", "pk": 945, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "378", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 117}, "timestamp": "2026-01-24T14:36:46.868Z"}}, {"model": "core.auditevent", "pk": 948, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "379", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 52}, "timestamp": "2026-01-25T17:55:35.320Z"}}, {"model": "core.auditevent", "pk": 949, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "379", "action_type": "manual_assign", "diff_json": {"slot_id": 52, "acolyte_id": 1}, "timestamp": "2026-01-25T17:55:35.322Z"}}, {"model": "core.auditevent", "pk": 966, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "379", "action_type": "deactivate", "diff_json": {"reason": "declined", "slot_id": 52}, "timestamp": "2026-01-25T18:10:50.438Z"}}, {"model": "core.auditevent", "pk": 969, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "383", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 52}, "timestamp": "2026-01-25T18:10:50.514Z"}}, {"model": "core.auditevent", "pk": 1041, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "400", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 73}, "timestamp": "2026-01-26T06:10:14.626Z"}}, {"model": "core.auditevent", "pk": 1042, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "400", "action_type": "manual_assign", "diff_json": {"slot_id": 73, "acolyte_id": 1}, "timestamp": "2026-01-26T06:10:14.629Z"}}, {"model": "core.auditevent", "pk": 100, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "41", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 44}, "timestamp": "2026-01-20T06:42:42.598Z"}}, {"model": "core.auditevent", "pk": 210, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "41", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 44}, "timestamp": "2026-01-20T06:44:57.384Z"}}, {"model": "core.auditevent", "pk": 1177, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "465", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 2}, "timestamp": "2026-01-27T08:39:32.863Z"}}, {"model": "core.auditevent", "pk": 1178, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "466", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 3}, "timestamp": "2026-01-27T08:39:32.878Z"}}, {"model": "core.auditevent", "pk": 1179, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "467", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 4}, "timestamp": "2026-01-27T08:39:32.897Z"}}, {"model": "core.auditevent", "pk": 1180, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "468", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 5}, "timestamp": "2026-01-27T08:39:32.916Z"}}, {"model": "core.auditevent", "pk": 1181, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "469", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 6}, "timestamp": "2026-01-27T08:39:32.935Z"}}, {"model": "core.auditevent", "pk": 1182, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "470", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 7}, "timestamp": "2026-01-27T08:39:32.953Z"}}, {"model": "core.auditevent", "pk": 1183, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "471", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 8}, "timestamp": "2026-01-27T08:39:32.971Z"}}, {"model": "core.auditevent", "pk": 1184, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "472", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 9}, "timestamp": "2026-01-27T08:39:32.986Z"}}, {"model": "core.auditevent", "pk": 1185, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "473", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 11}, "timestamp": "2026-01-27T08:39:33.001Z"}}, {"model": "core.auditevent", "pk": 1233, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "473", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 11}, "timestamp": "2026-01-27T08:42:06.786Z"}}, {"model": "core.auditevent", "pk": 1186, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "474", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 12}, "timestamp": "2026-01-27T08:39:33.016Z"}}, {"model": "core.auditevent", "pk": 1187, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "475", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 13}, "timestamp": "2026-01-27T08:39:33.035Z"}}, {"model": "core.auditevent", "pk": 1188, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "476", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 14}, "timestamp": "2026-01-27T08:39:33.055Z"}}, {"model": "core.auditevent", "pk": 1189, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "477", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 15}, "timestamp": "2026-01-27T08:39:33.071Z"}}, {"model": "core.auditevent", "pk": 1190, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "478", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 16}, "timestamp": "2026-01-27T08:39:33.092Z"}}, {"model": "core.auditevent", "pk": 1191, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "479", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 17}, "timestamp": "2026-01-27T08:39:33.113Z"}}, {"model": "core.auditevent", "pk": 1192, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "480", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 18}, "timestamp": "2026-01-27T08:39:33.129Z"}}, {"model": "core.auditevent", "pk": 1193, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "481", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 20}, "timestamp": "2026-01-27T08:39:33.150Z"}}, {"model": "core.auditevent", "pk": 1194, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "482", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 21}, "timestamp": "2026-01-27T08:39:33.172Z"}}, {"model": "core.auditevent", "pk": 1195, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "483", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 22}, "timestamp": "2026-01-27T08:39:33.192Z"}}, {"model": "core.auditevent", "pk": 1196, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "484", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 23}, "timestamp": "2026-01-27T08:39:33.212Z"}}, {"model": "core.auditevent", "pk": 1197, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "485", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 24}, "timestamp": "2026-01-27T08:39:33.233Z"}}, {"model": "core.auditevent", "pk": 1198, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "486", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 25}, "timestamp": "2026-01-27T08:39:33.253Z"}}, {"model": "core.auditevent", "pk": 1199, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "487", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 26}, "timestamp": "2026-01-27T08:39:33.274Z"}}, {"model": "core.auditevent", "pk": 1200, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "488", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 27}, "timestamp": "2026-01-27T08:39:33.293Z"}}, {"model": "core.auditevent", "pk": 1201, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "489", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 29}, "timestamp": "2026-01-27T08:39:33.314Z"}}, {"model": "core.auditevent", "pk": 108, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "49", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 52}, "timestamp": "2026-01-20T06:42:42.760Z"}}, {"model": "core.auditevent", "pk": 224, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "49", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 52}, "timestamp": "2026-01-20T06:44:57.576Z"}}, {"model": "core.auditevent", "pk": 1202, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "490", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 30}, "timestamp": "2026-01-27T08:39:33.332Z"}}, {"model": "core.auditevent", "pk": 1203, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "491", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 31}, "timestamp": "2026-01-27T08:39:33.352Z"}}, {"model": "core.auditevent", "pk": 1204, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "492", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 32}, "timestamp": "2026-01-27T08:39:33.368Z"}}, {"model": "core.auditevent", "pk": 1205, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "493", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 33}, "timestamp": "2026-01-27T08:39:33.388Z"}}, {"model": "core.auditevent", "pk": 1206, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "494", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 34}, "timestamp": "2026-01-27T08:39:33.409Z"}}, {"model": "core.auditevent", "pk": 1207, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "495", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 35}, "timestamp": "2026-01-27T08:39:33.427Z"}}, {"model": "core.auditevent", "pk": 1208, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "496", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 37}, "timestamp": "2026-01-27T08:39:33.444Z"}}, {"model": "core.auditevent", "pk": 1209, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "497", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 38}, "timestamp": "2026-01-27T08:39:33.463Z"}}, {"model": "core.auditevent", "pk": 1210, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "498", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 39}, "timestamp": "2026-01-27T08:39:33.482Z"}}, {"model": "core.auditevent", "pk": 1211, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "499", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 40}, "timestamp": "2026-01-27T08:39:33.498Z"}}, {"model": "core.auditevent", "pk": 1212, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "500", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 41}, "timestamp": "2026-01-27T08:39:33.517Z"}}, {"model": "core.auditevent", "pk": 1213, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "501", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 42}, "timestamp": "2026-01-27T08:39:33.536Z"}}, {"model": "core.auditevent", "pk": 1214, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "502", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 43}, "timestamp": "2026-01-27T08:39:33.554Z"}}, {"model": "core.auditevent", "pk": 1215, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "503", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 45}, "timestamp": "2026-01-27T08:39:33.572Z"}}, {"model": "core.auditevent", "pk": 1216, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "504", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 46}, "timestamp": "2026-01-27T08:39:33.590Z"}}, {"model": "core.auditevent", "pk": 1217, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "505", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 47}, "timestamp": "2026-01-27T08:39:33.607Z"}}, {"model": "core.auditevent", "pk": 1218, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "506", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 48}, "timestamp": "2026-01-27T08:39:33.625Z"}}, {"model": "core.auditevent", "pk": 1219, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "507", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 49}, "timestamp": "2026-01-27T08:39:33.642Z"}}, {"model": "core.auditevent", "pk": 1220, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "508", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 50}, "timestamp": "2026-01-27T08:39:33.659Z"}}, {"model": "core.auditevent", "pk": 1221, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "509", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 51}, "timestamp": "2026-01-27T08:39:33.674Z"}}, {"model": "core.auditevent", "pk": 1222, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "510", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 53}, "timestamp": "2026-01-27T08:39:33.689Z"}}, {"model": "core.auditevent", "pk": 1223, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "511", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 54}, "timestamp": "2026-01-27T08:39:33.705Z"}}, {"model": "core.auditevent", "pk": 1224, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "512", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 55}, "timestamp": "2026-01-27T08:39:33.721Z"}}, {"model": "core.auditevent", "pk": 1225, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "513", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 56}, "timestamp": "2026-01-27T08:39:33.737Z"}}, {"model": "core.auditevent", "pk": 1226, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "514", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 57}, "timestamp": "2026-01-27T08:39:33.754Z"}}, {"model": "core.auditevent", "pk": 1227, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "515", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 58}, "timestamp": "2026-01-27T08:39:33.770Z"}}, {"model": "core.auditevent", "pk": 1228, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "516", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 59}, "timestamp": "2026-01-27T08:39:33.785Z"}}, {"model": "core.auditevent", "pk": 1229, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "517", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 97}, "timestamp": "2026-01-27T08:39:33.801Z"}}, {"model": "core.auditevent", "pk": 1230, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "518", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 98}, "timestamp": "2026-01-27T08:39:33.817Z"}}, {"model": "core.auditevent", "pk": 1231, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "519", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 99}, "timestamp": "2026-01-27T08:39:33.833Z"}}, {"model": "core.auditevent", "pk": 1232, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "520", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 100}, "timestamp": "2026-01-27T08:39:33.850Z"}}, {"model": "core.auditevent", "pk": 1234, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "521", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 11}, "timestamp": "2026-01-27T08:42:06.790Z"}}, {"model": "core.auditevent", "pk": 1235, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "521", "action_type": "manual_assign", "diff_json": {"slot_id": 11, "acolyte_id": 3}, "timestamp": "2026-01-27T08:42:06.793Z"}}, {"model": "core.auditevent", "pk": 1236, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "521", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 11}, "timestamp": "2026-01-27T08:42:14.634Z"}}, {"model": "core.auditevent", "pk": 1237, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "522", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 11}, "timestamp": "2026-01-27T08:42:14.636Z"}}, {"model": "core.auditevent", "pk": 1238, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "522", "action_type": "manual_assign", "diff_json": {"slot_id": 11, "acolyte_id": 1}, "timestamp": "2026-01-27T08:42:14.639Z"}}, {"model": "core.auditevent", "pk": 118, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "57", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 10}, "timestamp": "2026-01-20T06:43:20.216Z"}}, {"model": "core.auditevent", "pk": 119, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "57", "action_type": "manual_assign", "diff_json": {"slot_id": 10, "acolyte_id": 1}, "timestamp": "2026-01-20T06:43:20.239Z"}}, {"model": "core.auditevent", "pk": 120, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "57", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 10}, "timestamp": "2026-01-20T06:43:23.031Z"}}, {"model": "core.auditevent", "pk": 121, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "58", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 10}, "timestamp": "2026-01-20T06:43:23.052Z"}}, {"model": "core.auditevent", "pk": 122, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "58", "action_type": "manual_assign", "diff_json": {"slot_id": 10, "acolyte_id": 3}, "timestamp": "2026-01-20T06:43:23.079Z"}}, {"model": "core.auditevent", "pk": 123, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "58", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 10}, "timestamp": "2026-01-20T06:43:25.338Z"}}, {"model": "core.auditevent", "pk": 124, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "59", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 10}, "timestamp": "2026-01-20T06:43:25.353Z"}}, {"model": "core.auditevent", "pk": 125, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "59", "action_type": "manual_assign", "diff_json": {"slot_id": 10, "acolyte_id": 1}, "timestamp": "2026-01-20T06:43:25.374Z"}}, {"model": "core.auditevent", "pk": 243, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "59", "action_type": "deactivate", "diff_json": {"reason": "canceled", "slot_id": 10}, "timestamp": "2026-01-20T06:46:54.751Z"}}, {"model": "core.auditevent", "pk": 128, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "60", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 1}, "timestamp": "2026-01-20T06:44:56.214Z"}}, {"model": "core.auditevent", "pk": 246, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "60", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 1}, "timestamp": "2026-01-20T07:46:28.196Z"}}, {"model": "core.auditevent", "pk": 158, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "75", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 19}, "timestamp": "2026-01-20T06:44:56.638Z"}}, {"model": "core.auditevent", "pk": 275, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "75", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 19}, "timestamp": "2026-01-20T07:46:28.730Z"}}, {"model": "core.auditevent", "pk": 174, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "83", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 28}, "timestamp": "2026-01-20T06:44:56.859Z"}}, {"model": "core.auditevent", "pk": 289, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "83", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 28}, "timestamp": "2026-01-20T07:46:28.950Z"}}, {"model": "core.auditevent", "pk": 175, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "84", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 60}, "timestamp": "2026-01-20T06:44:56.875Z"}}, {"model": "core.auditevent", "pk": 236, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "84", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 60}, "timestamp": "2026-01-20T06:45:43.834Z"}}, {"model": "core.auditevent", "pk": 176, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "85", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 61}, "timestamp": "2026-01-20T06:44:56.890Z"}}, {"model": "core.auditevent", "pk": 291, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "85", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 61}, "timestamp": "2026-01-20T07:46:28.979Z"}}, {"model": "core.auditevent", "pk": 177, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "86", "action_type": "create", "diff_json": {"acolyte_id": 13, "slot_id": 62}, "timestamp": "2026-01-20T06:44:56.905Z"}}, {"model": "core.auditevent", "pk": 293, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "86", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 62}, "timestamp": "2026-01-20T07:46:29.008Z"}}, {"model": "core.auditevent", "pk": 68, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "9", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 10}, "timestamp": "2026-01-20T06:42:42.006Z"}}, {"model": "core.auditevent", "pk": 117, "fields": {"parish": 1, "actor_user": 1, "entity_type": "Assignment", "entity_id": "9", "action_type": "deactivate", "diff_json": {"reason": "manual_unassign", "slot_id": 10}, "timestamp": "2026-01-20T06:43:20.200Z"}}, {"model": "core.auditevent", "pk": 195, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "96", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 36}, "timestamp": "2026-01-20T06:44:57.165Z"}}, {"model": "core.auditevent", "pk": 313, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "96", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 36}, "timestamp": "2026-01-20T07:46:29.287Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\confirmation.json
```json
[{"model": "core.confirmation", "pk": 109, "fields": {"created_at": "2026-01-27T08:42:06.792Z", "updated_at": "2026-01-27T08:42:06.792Z", "parish": 1, "assignment": 521, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-27T08:42:06.792Z"}}, {"model": "core.confirmation", "pk": 110, "fields": {"created_at": "2026-01-27T08:42:14.637Z", "updated_at": "2026-01-27T08:42:14.637Z", "parish": 1, "assignment": 522, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-27T08:42:14.637Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\future_assignment_active.json
```json
[{"model": "core.assignment", "pk": 465, "fields": {"created_at": "2026-01-27T08:39:32.859Z", "updated_at": "2026-01-27T08:39:32.859Z", "parish": 1, "slot": 2, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.859Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 466, "fields": {"created_at": "2026-01-27T08:39:32.876Z", "updated_at": "2026-01-27T08:39:32.876Z", "parish": 1, "slot": 3, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.876Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 467, "fields": {"created_at": "2026-01-27T08:39:32.893Z", "updated_at": "2026-01-27T08:39:32.893Z", "parish": 1, "slot": 4, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.893Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 468, "fields": {"created_at": "2026-01-27T08:39:32.914Z", "updated_at": "2026-01-27T08:39:32.914Z", "parish": 1, "slot": 5, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.914Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 469, "fields": {"created_at": "2026-01-27T08:39:32.933Z", "updated_at": "2026-01-27T08:39:32.933Z", "parish": 1, "slot": 6, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.933Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 470, "fields": {"created_at": "2026-01-27T08:39:32.949Z", "updated_at": "2026-01-27T08:39:32.949Z", "parish": 1, "slot": 7, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.950Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 471, "fields": {"created_at": "2026-01-27T08:39:32.968Z", "updated_at": "2026-01-27T08:39:32.968Z", "parish": 1, "slot": 8, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.968Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 472, "fields": {"created_at": "2026-01-27T08:39:32.983Z", "updated_at": "2026-01-27T08:39:32.984Z", "parish": 1, "slot": 9, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.984Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 473, "fields": {"created_at": "2026-01-27T08:39:32.998Z", "updated_at": "2026-01-27T08:42:06.783Z", "parish": 1, "slot": 11, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:32.998Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T08:42:06.783Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 521, "fields": {"created_at": "2026-01-27T08:42:06.789Z", "updated_at": "2026-01-27T08:42:14.630Z", "parish": 1, "slot": 11, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T08:42:06.789Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-27T08:42:14.630Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 522, "fields": {"created_at": "2026-01-27T08:42:14.636Z", "updated_at": "2026-01-27T08:42:14.636Z", "parish": 1, "slot": 11, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T08:42:14.636Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 474, "fields": {"created_at": "2026-01-27T08:39:33.014Z", "updated_at": "2026-01-27T08:39:33.014Z", "parish": 1, "slot": 12, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.014Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 475, "fields": {"created_at": "2026-01-27T08:39:33.031Z", "updated_at": "2026-01-27T08:39:33.031Z", "parish": 1, "slot": 13, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.031Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 476, "fields": {"created_at": "2026-01-27T08:39:33.052Z", "updated_at": "2026-01-27T08:39:33.052Z", "parish": 1, "slot": 14, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.052Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 477, "fields": {"created_at": "2026-01-27T08:39:33.068Z", "updated_at": "2026-01-27T08:39:33.068Z", "parish": 1, "slot": 15, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.069Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 478, "fields": {"created_at": "2026-01-27T08:39:33.088Z", "updated_at": "2026-01-27T08:39:33.088Z", "parish": 1, "slot": 16, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.088Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 479, "fields": {"created_at": "2026-01-27T08:39:33.109Z", "updated_at": "2026-01-27T08:39:33.109Z", "parish": 1, "slot": 17, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.109Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 480, "fields": {"created_at": "2026-01-27T08:39:33.126Z", "updated_at": "2026-01-27T08:39:33.126Z", "parish": 1, "slot": 18, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.126Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 481, "fields": {"created_at": "2026-01-27T08:39:33.147Z", "updated_at": "2026-01-27T08:39:33.147Z", "parish": 1, "slot": 20, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.147Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 482, "fields": {"created_at": "2026-01-27T08:39:33.168Z", "updated_at": "2026-01-27T08:39:33.168Z", "parish": 1, "slot": 21, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.168Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 483, "fields": {"created_at": "2026-01-27T08:39:33.189Z", "updated_at": "2026-01-27T08:39:33.189Z", "parish": 1, "slot": 22, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.189Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 484, "fields": {"created_at": "2026-01-27T08:39:33.208Z", "updated_at": "2026-01-27T08:39:33.208Z", "parish": 1, "slot": 23, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.208Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 485, "fields": {"created_at": "2026-01-27T08:39:33.229Z", "updated_at": "2026-01-27T08:39:33.229Z", "parish": 1, "slot": 24, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.229Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 486, "fields": {"created_at": "2026-01-27T08:39:33.249Z", "updated_at": "2026-01-27T08:39:33.249Z", "parish": 1, "slot": 25, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.249Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 487, "fields": {"created_at": "2026-01-27T08:39:33.270Z", "updated_at": "2026-01-27T08:39:33.270Z", "parish": 1, "slot": 26, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.270Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 488, "fields": {"created_at": "2026-01-27T08:39:33.290Z", "updated_at": "2026-01-27T08:39:33.290Z", "parish": 1, "slot": 27, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.290Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 489, "fields": {"created_at": "2026-01-27T08:39:33.310Z", "updated_at": "2026-01-27T08:39:33.310Z", "parish": 1, "slot": 29, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.310Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 490, "fields": {"created_at": "2026-01-27T08:39:33.328Z", "updated_at": "2026-01-27T08:39:33.328Z", "parish": 1, "slot": 30, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.328Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 491, "fields": {"created_at": "2026-01-27T08:39:33.349Z", "updated_at": "2026-01-27T08:39:33.349Z", "parish": 1, "slot": 31, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.349Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 492, "fields": {"created_at": "2026-01-27T08:39:33.365Z", "updated_at": "2026-01-27T08:39:33.365Z", "parish": 1, "slot": 32, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.365Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 493, "fields": {"created_at": "2026-01-27T08:39:33.384Z", "updated_at": "2026-01-27T08:39:33.384Z", "parish": 1, "slot": 33, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.384Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 494, "fields": {"created_at": "2026-01-27T08:39:33.405Z", "updated_at": "2026-01-27T08:39:33.405Z", "parish": 1, "slot": 34, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.405Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 495, "fields": {"created_at": "2026-01-27T08:39:33.425Z", "updated_at": "2026-01-27T08:39:33.425Z", "parish": 1, "slot": 35, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.425Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 496, "fields": {"created_at": "2026-01-27T08:39:33.441Z", "updated_at": "2026-01-27T08:39:33.441Z", "parish": 1, "slot": 37, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.441Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 497, "fields": {"created_at": "2026-01-27T08:39:33.459Z", "updated_at": "2026-01-27T08:39:33.459Z", "parish": 1, "slot": 38, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.459Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 498, "fields": {"created_at": "2026-01-27T08:39:33.478Z", "updated_at": "2026-01-27T08:39:33.478Z", "parish": 1, "slot": 39, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.478Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 499, "fields": {"created_at": "2026-01-27T08:39:33.495Z", "updated_at": "2026-01-27T08:39:33.495Z", "parish": 1, "slot": 40, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.495Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 500, "fields": {"created_at": "2026-01-27T08:39:33.513Z", "updated_at": "2026-01-27T08:39:33.513Z", "parish": 1, "slot": 41, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.513Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 501, "fields": {"created_at": "2026-01-27T08:39:33.532Z", "updated_at": "2026-01-27T08:39:33.532Z", "parish": 1, "slot": 42, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.532Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 502, "fields": {"created_at": "2026-01-27T08:39:33.550Z", "updated_at": "2026-01-27T08:39:33.550Z", "parish": 1, "slot": 43, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.551Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 503, "fields": {"created_at": "2026-01-27T08:39:33.569Z", "updated_at": "2026-01-27T08:39:33.569Z", "parish": 1, "slot": 45, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.569Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 504, "fields": {"created_at": "2026-01-27T08:39:33.586Z", "updated_at": "2026-01-27T08:39:33.586Z", "parish": 1, "slot": 46, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.586Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 505, "fields": {"created_at": "2026-01-27T08:39:33.604Z", "updated_at": "2026-01-27T08:39:33.604Z", "parish": 1, "slot": 47, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.604Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 506, "fields": {"created_at": "2026-01-27T08:39:33.621Z", "updated_at": "2026-01-27T08:39:33.621Z", "parish": 1, "slot": 48, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.621Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 507, "fields": {"created_at": "2026-01-27T08:39:33.639Z", "updated_at": "2026-01-27T08:39:33.639Z", "parish": 1, "slot": 49, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.639Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 508, "fields": {"created_at": "2026-01-27T08:39:33.656Z", "updated_at": "2026-01-27T08:39:33.656Z", "parish": 1, "slot": 50, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.656Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 509, "fields": {"created_at": "2026-01-27T08:39:33.672Z", "updated_at": "2026-01-27T08:39:33.672Z", "parish": 1, "slot": 51, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.672Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 510, "fields": {"created_at": "2026-01-27T08:39:33.687Z", "updated_at": "2026-01-27T08:39:33.687Z", "parish": 1, "slot": 53, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.687Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 511, "fields": {"created_at": "2026-01-27T08:39:33.702Z", "updated_at": "2026-01-27T08:39:33.702Z", "parish": 1, "slot": 54, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.702Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 512, "fields": {"created_at": "2026-01-27T08:39:33.717Z", "updated_at": "2026-01-27T08:39:33.717Z", "parish": 1, "slot": 55, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.717Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 513, "fields": {"created_at": "2026-01-27T08:39:33.734Z", "updated_at": "2026-01-27T08:39:33.734Z", "parish": 1, "slot": 56, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.734Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 514, "fields": {"created_at": "2026-01-27T08:39:33.751Z", "updated_at": "2026-01-27T08:39:33.751Z", "parish": 1, "slot": 57, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.751Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 515, "fields": {"created_at": "2026-01-27T08:39:33.767Z", "updated_at": "2026-01-27T08:39:33.767Z", "parish": 1, "slot": 58, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.767Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 516, "fields": {"created_at": "2026-01-27T08:39:33.783Z", "updated_at": "2026-01-27T08:39:33.783Z", "parish": 1, "slot": 59, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.783Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 517, "fields": {"created_at": "2026-01-27T08:39:33.798Z", "updated_at": "2026-01-27T08:39:33.798Z", "parish": 1, "slot": 97, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.798Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 518, "fields": {"created_at": "2026-01-27T08:39:33.814Z", "updated_at": "2026-01-27T08:39:33.814Z", "parish": 1, "slot": 98, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.814Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 519, "fields": {"created_at": "2026-01-27T08:39:33.830Z", "updated_at": "2026-01-27T08:39:33.830Z", "parish": 1, "slot": 99, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.830Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 520, "fields": {"created_at": "2026-01-27T08:39:33.847Z", "updated_at": "2026-01-27T08:39:33.847Z", "parish": 1, "slot": 100, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T08:39:33.847Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\massinterest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\massoverride.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\past_assignment.json
```json
[{"model": "core.assignment", "pk": 1, "fields": {"created_at": "2026-01-27T09:22:57.290Z", "updated_at": "2026-01-27T09:22:57.290Z", "parish": 1, "slot": 1, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.290Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:56.191Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 60, "fields": {"created_at": "2026-01-27T09:22:57.292Z", "updated_at": "2026-01-27T09:22:57.292Z", "parish": 1, "slot": 1, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.292Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.185Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 119, "fields": {"created_at": "2026-01-27T09:22:57.292Z", "updated_at": "2026-01-27T09:22:57.292Z", "parish": 1, "slot": 1, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.292Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:31.885Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 237, "fields": {"created_at": "2026-01-27T09:22:57.292Z", "updated_at": "2026-01-27T09:22:57.292Z", "parish": 1, "slot": 1, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.292Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:25:12.864Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 374, "fields": {"created_at": "2026-01-27T09:22:57.292Z", "updated_at": "2026-01-27T09:22:57.292Z", "parish": 1, "slot": 1, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.292Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 9, "fields": {"created_at": "2026-01-27T09:22:57.293Z", "updated_at": "2026-01-27T09:22:57.293Z", "parish": 1, "slot": 10, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.293Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:43:20.189Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 57, "fields": {"created_at": "2026-01-27T09:22:57.293Z", "updated_at": "2026-01-27T09:22:57.293Z", "parish": 1, "slot": 10, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.293Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:43:23.020Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 58, "fields": {"created_at": "2026-01-27T09:22:57.293Z", "updated_at": "2026-01-27T09:22:57.293Z", "parish": 1, "slot": 10, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.293Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:43:25.327Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 59, "fields": {"created_at": "2026-01-27T09:22:57.293Z", "updated_at": "2026-01-27T09:22:57.293Z", "parish": 1, "slot": 10, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.293Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:46:54.743Z", "end_reason": "canceled"}}, {"model": "core.assignment", "pk": 127, "fields": {"created_at": "2026-01-27T09:22:57.293Z", "updated_at": "2026-01-27T09:22:57.293Z", "parish": 1, "slot": 10, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.293Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:49:48.773Z", "end_reason": "replaced"}}, {"model": "core.assignment", "pk": 177, "fields": {"created_at": "2026-01-27T09:22:57.293Z", "updated_at": "2026-01-27T09:22:57.293Z", "parish": 1, "slot": 10, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.293Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 17, "fields": {"created_at": "2026-01-27T09:22:57.294Z", "updated_at": "2026-01-27T09:22:57.294Z", "parish": 1, "slot": 19, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.294Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:56.621Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 75, "fields": {"created_at": "2026-01-27T09:22:57.294Z", "updated_at": "2026-01-27T09:22:57.294Z", "parish": 1, "slot": 19, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.294Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.722Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 134, "fields": {"created_at": "2026-01-27T09:22:57.294Z", "updated_at": "2026-01-27T09:22:57.294Z", "parish": 1, "slot": 19, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.294Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:30.774Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 191, "fields": {"created_at": "2026-01-27T09:22:57.294Z", "updated_at": "2026-01-27T09:22:57.294Z", "parish": 1, "slot": 19, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.294Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.177Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 253, "fields": {"created_at": "2026-01-27T09:22:57.294Z", "updated_at": "2026-01-27T09:22:57.294Z", "parish": 1, "slot": 19, "acolyte": 13, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.294Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T09:26:19.305Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 349, "fields": {"created_at": "2026-01-27T09:22:57.294Z", "updated_at": "2026-01-27T09:22:57.294Z", "parish": 1, "slot": 19, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.294Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 25, "fields": {"created_at": "2026-01-27T09:22:57.294Z", "updated_at": "2026-01-27T09:22:57.294Z", "parish": 1, "slot": 28, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.294Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:56.841Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 83, "fields": {"created_at": "2026-01-27T09:22:57.295Z", "updated_at": "2026-01-27T09:22:57.295Z", "parish": 1, "slot": 28, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.295Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.944Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 141, "fields": {"created_at": "2026-01-27T09:22:57.295Z", "updated_at": "2026-01-27T09:22:57.295Z", "parish": 1, "slot": 28, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.295Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:30.983Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 199, "fields": {"created_at": "2026-01-27T09:22:57.295Z", "updated_at": "2026-01-27T09:22:57.295Z", "parish": 1, "slot": 28, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.295Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.316Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 262, "fields": {"created_at": "2026-01-27T09:22:57.295Z", "updated_at": "2026-01-27T09:22:57.295Z", "parish": 1, "slot": 28, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.295Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 33, "fields": {"created_at": "2026-01-27T09:22:57.295Z", "updated_at": "2026-01-27T09:22:57.295Z", "parish": 1, "slot": 36, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.295Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:57.142Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 96, "fields": {"created_at": "2026-01-27T09:22:57.296Z", "updated_at": "2026-01-27T09:22:57.296Z", "parish": 1, "slot": 36, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.296Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.281Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 153, "fields": {"created_at": "2026-01-27T09:22:57.296Z", "updated_at": "2026-01-27T09:22:57.296Z", "parish": 1, "slot": 36, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.296Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.318Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 211, "fields": {"created_at": "2026-01-27T09:22:57.296Z", "updated_at": "2026-01-27T09:22:57.296Z", "parish": 1, "slot": 36, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.296Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.486Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 273, "fields": {"created_at": "2026-01-27T09:22:57.296Z", "updated_at": "2026-01-27T09:22:57.296Z", "parish": 1, "slot": 36, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.296Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 41, "fields": {"created_at": "2026-01-27T09:22:57.297Z", "updated_at": "2026-01-27T09:22:57.297Z", "parish": 1, "slot": 44, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.297Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:57.378Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 104, "fields": {"created_at": "2026-01-27T09:22:57.297Z", "updated_at": "2026-01-27T09:22:57.297Z", "parish": 1, "slot": 44, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.297Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.495Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 161, "fields": {"created_at": "2026-01-27T09:22:57.297Z", "updated_at": "2026-01-27T09:22:57.297Z", "parish": 1, "slot": 44, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.297Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.538Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 219, "fields": {"created_at": "2026-01-27T09:22:57.297Z", "updated_at": "2026-01-27T09:22:57.297Z", "parish": 1, "slot": 44, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.297Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.605Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 281, "fields": {"created_at": "2026-01-27T09:22:57.297Z", "updated_at": "2026-01-27T09:22:57.297Z", "parish": 1, "slot": 44, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.297Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 49, "fields": {"created_at": "2026-01-27T09:22:57.298Z", "updated_at": "2026-01-27T09:22:57.298Z", "parish": 1, "slot": 52, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.298Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:44:57.570Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 111, "fields": {"created_at": "2026-01-27T09:22:57.298Z", "updated_at": "2026-01-27T09:22:57.298Z", "parish": 1, "slot": 52, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.298Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.723Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 169, "fields": {"created_at": "2026-01-27T09:22:57.298Z", "updated_at": "2026-01-27T09:22:57.298Z", "parish": 1, "slot": 52, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.298Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.759Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 227, "fields": {"created_at": "2026-01-27T09:22:57.298Z", "updated_at": "2026-01-27T09:22:57.298Z", "parish": 1, "slot": 52, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.298Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.711Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 289, "fields": {"created_at": "2026-01-27T09:22:57.298Z", "updated_at": "2026-01-27T09:22:57.298Z", "parish": 1, "slot": 52, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.298Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-25T17:55:35.315Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 379, "fields": {"created_at": "2026-01-27T09:22:57.299Z", "updated_at": "2026-01-27T09:22:57.299Z", "parish": 1, "slot": 52, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.299Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-25T18:10:50.428Z", "end_reason": "declined"}}, {"model": "core.assignment", "pk": 383, "fields": {"created_at": "2026-01-27T09:22:57.299Z", "updated_at": "2026-01-27T09:22:57.299Z", "parish": 1, "slot": 52, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.299Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 84, "fields": {"created_at": "2026-01-27T09:22:57.299Z", "updated_at": "2026-01-27T09:22:57.299Z", "parish": 1, "slot": 60, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.299Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:45:43.817Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 117, "fields": {"created_at": "2026-01-27T09:22:57.299Z", "updated_at": "2026-01-27T09:22:57.299Z", "parish": 1, "slot": 60, "acolyte": 14, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.299Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-20T06:45:52.450Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 118, "fields": {"created_at": "2026-01-27T09:22:57.299Z", "updated_at": "2026-01-27T09:22:57.299Z", "parish": 1, "slot": 60, "acolyte": 2, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.299Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 85, "fields": {"created_at": "2026-01-27T09:22:57.299Z", "updated_at": "2026-01-27T09:22:57.299Z", "parish": 1, "slot": 61, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.299Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:28.974Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 142, "fields": {"created_at": "2026-01-27T09:22:57.299Z", "updated_at": "2026-01-27T09:22:57.299Z", "parish": 1, "slot": 61, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.299Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.014Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 200, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 61, "acolyte": 13, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.331Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 263, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 61, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:11:29.923Z", "end_reason": "declined"}}, {"model": "core.assignment", "pk": 363, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 61, "acolyte": 1, "assigned_by": 3, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:10:24.817Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 372, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 61, "acolyte": 4, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 86, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 62, "acolyte": 13, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:46:29.003Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 143, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 62, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-20T07:50:31.040Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 201, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 62, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T07:11:32.348Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 264, "fields": {"created_at": "2026-01-27T09:22:57.300Z", "updated_at": "2026-01-27T09:22:57.300Z", "parish": 1, "slot": 62, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.300Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 296, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 72, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-23T11:28:57.031Z", "end_reason": "canceled"}}, {"model": "core.assignment", "pk": 297, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 73, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.629Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 305, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 73, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.563Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 309, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 73, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.639Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 343, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 73, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.375Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 351, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 73, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-26T06:10:14.615Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 400, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 73, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 298, "fields": {"created_at": "2026-01-27T09:22:57.301Z", "updated_at": "2026-01-27T09:22:57.301Z", "parish": 1, "slot": 74, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.301Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.580Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 310, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 74, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.302Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.654Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 344, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 74, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.302Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T08:51:47.462Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 350, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 74, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.302Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.394Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 352, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 74, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.302Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 299, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 75, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.302Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.647Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 306, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 75, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.302Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.596Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 311, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 75, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.302Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.668Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 345, "fields": {"created_at": "2026-01-27T09:22:57.302Z", "updated_at": "2026-01-27T09:22:57.302Z", "parish": 1, "slot": 75, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.408Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 353, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 75, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:27:16.623Z", "end_reason": "claim_transfer"}}, {"model": "core.assignment", "pk": 375, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 75, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 300, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 76, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.661Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 307, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 76, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.614Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 312, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 76, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.682Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 346, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 76, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.425Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 354, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 76, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.303Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 314, "fields": {"created_at": "2026-01-27T09:22:57.303Z", "updated_at": "2026-01-27T09:22:57.303Z", "parish": 1, "slot": 101, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:08:51.201Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 370, "fields": {"created_at": "2026-01-27T09:22:57.304Z", "updated_at": "2026-01-27T09:22:57.304Z", "parish": 1, "slot": 101, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T13:18:47.933Z", "end_reason": "claim_transfer"}}, {"model": "core.assignment", "pk": 373, "fields": {"created_at": "2026-01-27T09:22:57.304Z", "updated_at": "2026-01-27T09:22:57.304Z", "parish": 1, "slot": 101, "acolyte": 1, "assigned_by": 3, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:27:51.110Z", "end_reason": "claim_transfer"}}, {"model": "core.assignment", "pk": 376, "fields": {"created_at": "2026-01-27T09:22:57.304Z", "updated_at": "2026-01-27T09:22:57.304Z", "parish": 1, "slot": 101, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 315, "fields": {"created_at": "2026-01-27T09:22:57.304Z", "updated_at": "2026-01-27T09:22:57.304Z", "parish": 1, "slot": 102, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:09.044Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 371, "fields": {"created_at": "2026-01-27T09:22:57.304Z", "updated_at": "2026-01-27T09:22:57.304Z", "parish": 1, "slot": 102, "acolyte": 18, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 303, "fields": {"created_at": "2026-01-27T09:22:57.304Z", "updated_at": "2026-01-27T09:22:57.304Z", "parish": 1, "slot": 105, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:01.675Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 308, "fields": {"created_at": "2026-01-27T09:22:57.304Z", "updated_at": "2026-01-27T09:22:57.304Z", "parish": 1, "slot": 105, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.304Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-21T13:37:30.629Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 313, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 105, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-23T10:33:34.696Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 347, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 105, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T09:09:41.442Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 355, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 105, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 304, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 106, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 356, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 113, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 357, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 114, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:13:04.998Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 364, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 114, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:13:23.472Z", "end_reason": "manual_unassign"}}, {"model": "core.assignment", "pk": 365, "fields": {"created_at": "2026-01-27T09:22:57.305Z", "updated_at": "2026-01-27T09:22:57.305Z", "parish": 1, "slot": 114, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.305Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:31:25.179Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 366, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 114, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T11:00:32.239Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 369, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 114, "acolyte": 3, "assigned_by": 4, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "published", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:36:46.857Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 377, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 114, "acolyte": 1, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 358, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 115, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 359, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 116, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 360, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 117, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T10:31:25.183Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 367, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 117, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T11:00:32.235Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 368, "fields": {"created_at": "2026-01-27T09:22:57.306Z", "updated_at": "2026-01-27T09:22:57.306Z", "parish": 1, "slot": 117, "acolyte": 1, "assigned_by": 4, "assigned_at": "2026-01-27T09:22:57.306Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-24T14:36:46.864Z", "end_reason": "swap"}}, {"model": "core.assignment", "pk": 378, "fields": {"created_at": "2026-01-27T09:22:57.307Z", "updated_at": "2026-01-27T09:22:57.307Z", "parish": 1, "slot": 117, "acolyte": 3, "assigned_by": 1, "assigned_at": "2026-01-27T09:22:57.307Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 361, "fields": {"created_at": "2026-01-27T09:22:57.307Z", "updated_at": "2026-01-27T09:22:57.307Z", "parish": 1, "slot": 118, "acolyte": 17, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.307Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 362, "fields": {"created_at": "2026-01-27T09:22:57.307Z", "updated_at": "2026-01-27T09:22:57.307Z", "parish": 1, "slot": 119, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:22:57.307Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\past_assignmentslot.json
```json
[{"model": "core.assignmentslot", "pk": 1, "fields": {"created_at": "2026-01-27T09:22:57.276Z", "updated_at": "2026-01-27T09:22:57.276Z", "parish": 1, "mass_instance": 1, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 10, "fields": {"created_at": "2026-01-27T09:22:57.278Z", "updated_at": "2026-01-27T09:22:57.278Z", "parish": 1, "mass_instance": 10, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 19, "fields": {"created_at": "2026-01-27T09:22:57.278Z", "updated_at": "2026-01-27T09:22:57.278Z", "parish": 1, "mass_instance": 19, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 28, "fields": {"created_at": "2026-01-27T09:22:57.278Z", "updated_at": "2026-01-27T09:22:57.278Z", "parish": 1, "mass_instance": 28, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 60, "fields": {"created_at": "2026-01-27T09:22:57.278Z", "updated_at": "2026-01-27T09:22:57.278Z", "parish": 1, "mass_instance": 28, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 61, "fields": {"created_at": "2026-01-27T09:22:57.279Z", "updated_at": "2026-01-27T09:22:57.279Z", "parish": 1, "mass_instance": 28, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 62, "fields": {"created_at": "2026-01-27T09:22:57.279Z", "updated_at": "2026-01-27T09:22:57.279Z", "parish": 1, "mass_instance": 28, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 101, "fields": {"created_at": "2026-01-27T09:22:57.279Z", "updated_at": "2026-01-27T09:22:57.279Z", "parish": 1, "mass_instance": 28, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 102, "fields": {"created_at": "2026-01-27T09:22:57.279Z", "updated_at": "2026-01-27T09:22:57.279Z", "parish": 1, "mass_instance": 28, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 36, "fields": {"created_at": "2026-01-27T09:22:57.279Z", "updated_at": "2026-01-27T09:22:57.279Z", "parish": 1, "mass_instance": 36, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 44, "fields": {"created_at": "2026-01-27T09:22:57.280Z", "updated_at": "2026-01-27T09:22:57.280Z", "parish": 1, "mass_instance": 44, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 52, "fields": {"created_at": "2026-01-27T09:22:57.280Z", "updated_at": "2026-01-27T09:22:57.280Z", "parish": 1, "mass_instance": 52, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 65, "fields": {"created_at": "2026-01-27T09:22:57.280Z", "updated_at": "2026-01-27T09:22:57.280Z", "parish": 1, "mass_instance": 60, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 66, "fields": {"created_at": "2026-01-27T09:22:57.280Z", "updated_at": "2026-01-27T09:22:57.280Z", "parish": 1, "mass_instance": 60, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 67, "fields": {"created_at": "2026-01-27T09:22:57.280Z", "updated_at": "2026-01-27T09:22:57.280Z", "parish": 1, "mass_instance": 60, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 68, "fields": {"created_at": "2026-01-27T09:22:57.280Z", "updated_at": "2026-01-27T09:22:57.280Z", "parish": 1, "mass_instance": 60, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 103, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 60, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 104, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 60, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 71, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 61, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 72, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 61, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "open", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 73, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 62, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 74, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 62, "position_type": 2, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 75, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 62, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 76, "fields": {"created_at": "2026-01-27T09:22:57.281Z", "updated_at": "2026-01-27T09:22:57.281Z", "parish": 1, "mass_instance": 62, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 105, "fields": {"created_at": "2026-01-27T09:22:57.282Z", "updated_at": "2026-01-27T09:22:57.282Z", "parish": 1, "mass_instance": 62, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 106, "fields": {"created_at": "2026-01-27T09:22:57.282Z", "updated_at": "2026-01-27T09:22:57.282Z", "parish": 1, "mass_instance": 62, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 113, "fields": {"created_at": "2026-01-27T09:22:57.282Z", "updated_at": "2026-01-27T09:22:57.282Z", "parish": 1, "mass_instance": 70, "position_type": 1, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 114, "fields": {"created_at": "2026-01-27T09:22:57.282Z", "updated_at": "2026-01-27T09:22:57.282Z", "parish": 1, "mass_instance": 70, "position_type": 3, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 115, "fields": {"created_at": "2026-01-27T09:22:57.282Z", "updated_at": "2026-01-27T09:22:57.282Z", "parish": 1, "mass_instance": 70, "position_type": 4, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 116, "fields": {"created_at": "2026-01-27T09:22:57.282Z", "updated_at": "2026-01-27T09:22:57.282Z", "parish": 1, "mass_instance": 70, "position_type": 7, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 117, "fields": {"created_at": "2026-01-27T09:22:57.283Z", "updated_at": "2026-01-27T09:22:57.283Z", "parish": 1, "mass_instance": 70, "position_type": 8, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 118, "fields": {"created_at": "2026-01-27T09:22:57.283Z", "updated_at": "2026-01-27T09:22:57.283Z", "parish": 1, "mass_instance": 70, "position_type": 9, "slot_index": 1, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}, {"model": "core.assignmentslot", "pk": 119, "fields": {"created_at": "2026-01-27T09:22:57.283Z", "updated_at": "2026-01-27T09:22:57.283Z", "parish": 1, "mass_instance": 70, "position_type": 9, "slot_index": 2, "required": true, "externally_covered": false, "external_coverage_notes": "", "status": "assigned", "is_locked": false, "locked_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\past_massinstance.json
```json
[{"model": "core.massinstance", "pk": 1, "fields": {"created_at": "2026-01-27T09:22:57.268Z", "updated_at": "2026-01-27T09:22:57.268Z", "parish": 1, "template": 1, "event_series": null, "community": 4, "starts_at": "2026-01-24T20:00:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 10, "fields": {"created_at": "2026-01-27T09:22:57.270Z", "updated_at": "2026-01-27T09:22:57.270Z", "parish": 1, "template": 2, "event_series": null, "community": 2, "starts_at": "2026-01-24T21:30:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 19, "fields": {"created_at": "2026-01-27T09:22:57.270Z", "updated_at": "2026-01-27T09:22:57.270Z", "parish": 1, "template": 3, "event_series": null, "community": 3, "starts_at": "2026-01-24T22:45:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 28, "fields": {"created_at": "2026-01-27T09:22:57.270Z", "updated_at": "2026-01-27T09:22:57.270Z", "parish": 1, "template": 4, "event_series": null, "community": 1, "starts_at": "2026-01-25T10:00:00Z", "liturgy_label": "", "requirement_profile": 4, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 36, "fields": {"created_at": "2026-01-27T09:22:57.270Z", "updated_at": "2026-01-27T09:22:57.270Z", "parish": 1, "template": 5, "event_series": null, "community": 6, "starts_at": "2026-01-25T11:15:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 44, "fields": {"created_at": "2026-01-27T09:22:57.270Z", "updated_at": "2026-01-27T09:22:57.270Z", "parish": 1, "template": 6, "event_series": null, "community": 5, "starts_at": "2026-01-25T12:30:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 52, "fields": {"created_at": "2026-01-27T09:22:57.271Z", "updated_at": "2026-01-27T09:22:57.271Z", "parish": 1, "template": 7, "event_series": null, "community": 1, "starts_at": "2026-01-25T22:00:00Z", "liturgy_label": "", "requirement_profile": 1, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 60, "fields": {"created_at": "2026-01-27T09:22:57.271Z", "updated_at": "2026-01-27T09:22:57.271Z", "parish": 1, "template": null, "event_series": 1, "community": 1, "starts_at": "2026-01-23T22:00:00Z", "liturgy_label": "Missa", "requirement_profile": 4, "status": "canceled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 61, "fields": {"created_at": "2026-01-27T09:22:57.271Z", "updated_at": "2026-01-27T09:22:57.271Z", "parish": 1, "template": null, "event_series": 2, "community": 1, "starts_at": "2026-01-21T22:00:00Z", "liturgy_label": "", "requirement_profile": 2, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 62, "fields": {"created_at": "2026-01-27T09:22:57.271Z", "updated_at": "2026-01-27T09:22:57.271Z", "parish": 1, "template": null, "event_series": 3, "community": 1, "starts_at": "2026-01-24T22:00:00Z", "liturgy_label": "Memória de São Francisco de Sales, bispo e doutor da Igreja", "requirement_profile": 4, "status": "scheduled", "created_by": 1, "updated_by": 1}}, {"model": "core.massinstance", "pk": 70, "fields": {"created_at": "2026-01-27T09:22:57.271Z", "updated_at": "2026-01-27T09:22:57.271Z", "parish": 1, "template": null, "event_series": 5, "community": 1, "starts_at": "2026-01-24T18:00:00Z", "liturgy_label": "Solenidade de teste", "requirement_profile": 5, "status": "scheduled", "created_by": 1, "updated_by": 1}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\positionclaimrequest.json
```json
[{"model": "core.positionclaimrequest", "pk": 8, "fields": {"created_at": "2026-01-26T06:13:52.739Z", "updated_at": "2026-01-27T08:16:48.744Z", "parish": 1, "slot": 3, "requestor_acolyte": 3, "target_assignment": null, "status": "expired", "approval_mode": "", "resolution_reason": "assignment_changed", "auto_approve_at": "2026-02-05T20:00:00Z", "resolved_at": "2026-01-27T08:16:48.744Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 5, "fields": {"created_at": "2026-01-25T21:13:54.694Z", "updated_at": "2026-01-25T21:31:57.274Z", "parish": 1, "slot": 12, "requestor_acolyte": 1, "target_assignment": null, "status": "expired", "approval_mode": "coordination", "resolution_reason": "holder_confirmed", "auto_approve_at": null, "resolved_at": "2026-01-25T21:31:57.274Z", "approved_by": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\replacementrequest.json
```json
[{"model": "core.replacementrequest", "pk": 11, "fields": {"created_at": "2026-01-26T03:52:46.710Z", "updated_at": "2026-01-26T03:52:46.776Z", "parish": 1, "slot": 2, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 12, "fields": {"created_at": "2026-01-26T03:55:01.453Z", "updated_at": "2026-01-26T03:55:01.526Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 13, "fields": {"created_at": "2026-01-26T03:56:22.179Z", "updated_at": "2026-01-26T03:56:22.339Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 16, "fields": {"created_at": "2026-01-27T03:38:03.289Z", "updated_at": "2026-01-27T03:38:03.289Z", "parish": 1, "slot": 17, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 14, "fields": {"created_at": "2026-01-26T03:56:36.974Z", "updated_at": "2026-01-26T03:56:37.048Z", "parish": 1, "slot": 20, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 9, "fields": {"created_at": "2026-01-25T18:10:45.171Z", "updated_at": "2026-01-25T18:10:45.229Z", "parish": 1, "slot": 23, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 15, "fields": {"created_at": "2026-01-27T03:38:03.253Z", "updated_at": "2026-01-27T03:38:03.253Z", "parish": 1, "slot": 29, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 8, "fields": {"created_at": "2026-01-25T18:09:03.950Z", "updated_at": "2026-01-25T18:09:04.009Z", "parish": 1, "slot": 34, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 17, "fields": {"created_at": "2026-01-27T03:38:03.326Z", "updated_at": "2026-01-27T03:38:03.326Z", "parish": 1, "slot": 35, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 7, "fields": {"created_at": "2026-01-25T18:08:53.446Z", "updated_at": "2026-01-25T18:08:53.518Z", "parish": 1, "slot": 45, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 4, "fields": {"created_at": "2026-01-23T11:40:58.132Z", "updated_at": "2026-01-23T11:40:58.133Z", "parish": 1, "slot": 51, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 5, "fields": {"created_at": "2026-01-23T11:41:55.885Z", "updated_at": "2026-01-23T11:41:55.885Z", "parish": 1, "slot": 107, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\serializers\swaprequest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T062401\meta.json
```json
{
  "created_at": "2026-01-27T06:24:01.782948-03:00",
  "cutoff_date": "2026-01-27",
  "counts": {
    "past_masses": 11,
    "past_slots": 33,
    "past_assignments": 102,
    "future_assignments_total": 58,
    "confirmations": 2,
    "claims": 2,
    "replacement_requests": 12,
    "swap_requests": 0,
    "mass_interest": 0,
    "mass_override": 0,
    "ledger_rows": 0,
    "audit_events": 274
  },
  "models_included": [
    "core.MassInstance",
    "core.AssignmentSlot",
    "core.Assignment",
    "core.Confirmation",
    "core.PositionClaimRequest",
    "core.ReplacementRequest",
    "core.SwapRequest",
    "core.MassInterest",
    "core.MassOverride",
    "core.AcolyteCreditLedger",
    "core.AuditEvent"
  ]
}
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\acolytecreditledger.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\auditevent.json
```json
[{"model": "core.auditevent", "pk": 1239, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "523", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 2}, "timestamp": "2026-01-27T09:24:24.475Z"}}, {"model": "core.auditevent", "pk": 1295, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "523", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 2}, "timestamp": "2026-01-27T09:24:25.262Z"}}, {"model": "core.auditevent", "pk": 1240, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "524", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 3}, "timestamp": "2026-01-27T09:24:24.485Z"}}, {"model": "core.auditevent", "pk": 1241, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "525", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 4}, "timestamp": "2026-01-27T09:24:24.495Z"}}, {"model": "core.auditevent", "pk": 1297, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "525", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 4}, "timestamp": "2026-01-27T09:24:25.276Z"}}, {"model": "core.auditevent", "pk": 1242, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "526", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 5}, "timestamp": "2026-01-27T09:24:24.506Z"}}, {"model": "core.auditevent", "pk": 1299, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "526", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 5}, "timestamp": "2026-01-27T09:24:25.286Z"}}, {"model": "core.auditevent", "pk": 1243, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "527", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 6}, "timestamp": "2026-01-27T09:24:24.516Z"}}, {"model": "core.auditevent", "pk": 1244, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "528", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 7}, "timestamp": "2026-01-27T09:24:24.526Z"}}, {"model": "core.auditevent", "pk": 1301, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "528", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 7}, "timestamp": "2026-01-27T09:24:25.299Z"}}, {"model": "core.auditevent", "pk": 1245, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "529", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 8}, "timestamp": "2026-01-27T09:24:24.535Z"}}, {"model": "core.auditevent", "pk": 1303, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "529", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 8}, "timestamp": "2026-01-27T09:24:25.311Z"}}, {"model": "core.auditevent", "pk": 1246, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "530", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 9}, "timestamp": "2026-01-27T09:24:24.547Z"}}, {"model": "core.auditevent", "pk": 1247, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "531", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 11}, "timestamp": "2026-01-27T09:24:24.557Z"}}, {"model": "core.auditevent", "pk": 1248, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "532", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 12}, "timestamp": "2026-01-27T09:24:24.566Z"}}, {"model": "core.auditevent", "pk": 1249, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "533", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 13}, "timestamp": "2026-01-27T09:24:24.576Z"}}, {"model": "core.auditevent", "pk": 1305, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "533", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 13}, "timestamp": "2026-01-27T09:24:25.325Z"}}, {"model": "core.auditevent", "pk": 1250, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "534", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 14}, "timestamp": "2026-01-27T09:24:24.586Z"}}, {"model": "core.auditevent", "pk": 1307, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "534", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 14}, "timestamp": "2026-01-27T09:24:25.337Z"}}, {"model": "core.auditevent", "pk": 1251, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "535", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 15}, "timestamp": "2026-01-27T09:24:24.596Z"}}, {"model": "core.auditevent", "pk": 1309, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "535", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 15}, "timestamp": "2026-01-27T09:24:25.349Z"}}, {"model": "core.auditevent", "pk": 1252, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "536", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 16}, "timestamp": "2026-01-27T09:24:24.606Z"}}, {"model": "core.auditevent", "pk": 1311, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "536", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 16}, "timestamp": "2026-01-27T09:24:25.359Z"}}, {"model": "core.auditevent", "pk": 1253, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "537", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 17}, "timestamp": "2026-01-27T09:24:24.615Z"}}, {"model": "core.auditevent", "pk": 1313, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "537", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 17}, "timestamp": "2026-01-27T09:24:25.369Z"}}, {"model": "core.auditevent", "pk": 1254, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "538", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 18}, "timestamp": "2026-01-27T09:24:24.625Z"}}, {"model": "core.auditevent", "pk": 1315, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "538", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 18}, "timestamp": "2026-01-27T09:24:25.380Z"}}, {"model": "core.auditevent", "pk": 1255, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "539", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 20}, "timestamp": "2026-01-27T09:24:24.635Z"}}, {"model": "core.auditevent", "pk": 1317, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "539", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 20}, "timestamp": "2026-01-27T09:24:25.390Z"}}, {"model": "core.auditevent", "pk": 1256, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "540", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 21}, "timestamp": "2026-01-27T09:24:24.646Z"}}, {"model": "core.auditevent", "pk": 1319, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "540", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 21}, "timestamp": "2026-01-27T09:24:25.402Z"}}, {"model": "core.auditevent", "pk": 1257, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "541", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 22}, "timestamp": "2026-01-27T09:24:24.656Z"}}, {"model": "core.auditevent", "pk": 1258, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "542", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 23}, "timestamp": "2026-01-27T09:24:24.665Z"}}, {"model": "core.auditevent", "pk": 1321, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "542", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 23}, "timestamp": "2026-01-27T09:24:25.419Z"}}, {"model": "core.auditevent", "pk": 1259, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "543", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 24}, "timestamp": "2026-01-27T09:24:24.674Z"}}, {"model": "core.auditevent", "pk": 1260, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "544", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 25}, "timestamp": "2026-01-27T09:24:24.683Z"}}, {"model": "core.auditevent", "pk": 1323, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "544", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 25}, "timestamp": "2026-01-27T09:24:25.435Z"}}, {"model": "core.auditevent", "pk": 1261, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "545", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 26}, "timestamp": "2026-01-27T09:24:24.692Z"}}, {"model": "core.auditevent", "pk": 1262, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "546", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 27}, "timestamp": "2026-01-27T09:24:24.700Z"}}, {"model": "core.auditevent", "pk": 1325, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "546", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 27}, "timestamp": "2026-01-27T09:24:25.451Z"}}, {"model": "core.auditevent", "pk": 1263, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "547", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 29}, "timestamp": "2026-01-27T09:24:24.708Z"}}, {"model": "core.auditevent", "pk": 1327, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "547", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 29}, "timestamp": "2026-01-27T09:24:25.465Z"}}, {"model": "core.auditevent", "pk": 1264, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "548", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 30}, "timestamp": "2026-01-27T09:24:24.716Z"}}, {"model": "core.auditevent", "pk": 1329, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "548", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 30}, "timestamp": "2026-01-27T09:24:25.479Z"}}, {"model": "core.auditevent", "pk": 1265, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "549", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 31}, "timestamp": "2026-01-27T09:24:24.724Z"}}, {"model": "core.auditevent", "pk": 1331, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "549", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 31}, "timestamp": "2026-01-27T09:24:25.492Z"}}, {"model": "core.auditevent", "pk": 1266, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "550", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 32}, "timestamp": "2026-01-27T09:24:24.733Z"}}, {"model": "core.auditevent", "pk": 1333, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "550", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 32}, "timestamp": "2026-01-27T09:24:25.503Z"}}, {"model": "core.auditevent", "pk": 1267, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "551", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 33}, "timestamp": "2026-01-27T09:24:24.740Z"}}, {"model": "core.auditevent", "pk": 1335, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "551", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 33}, "timestamp": "2026-01-27T09:24:25.515Z"}}, {"model": "core.auditevent", "pk": 1268, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "552", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 34}, "timestamp": "2026-01-27T09:24:24.749Z"}}, {"model": "core.auditevent", "pk": 1337, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "552", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 34}, "timestamp": "2026-01-27T09:24:25.525Z"}}, {"model": "core.auditevent", "pk": 1269, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "553", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 35}, "timestamp": "2026-01-27T09:24:24.757Z"}}, {"model": "core.auditevent", "pk": 1339, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "553", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 35}, "timestamp": "2026-01-27T09:24:25.538Z"}}, {"model": "core.auditevent", "pk": 1270, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "554", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 37}, "timestamp": "2026-01-27T09:24:24.766Z"}}, {"model": "core.auditevent", "pk": 1271, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "555", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 38}, "timestamp": "2026-01-27T09:24:24.775Z"}}, {"model": "core.auditevent", "pk": 1272, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "556", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 39}, "timestamp": "2026-01-27T09:24:24.785Z"}}, {"model": "core.auditevent", "pk": 1273, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "557", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 40}, "timestamp": "2026-01-27T09:24:24.794Z"}}, {"model": "core.auditevent", "pk": 1274, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "558", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 41}, "timestamp": "2026-01-27T09:24:24.803Z"}}, {"model": "core.auditevent", "pk": 1275, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "559", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 42}, "timestamp": "2026-01-27T09:24:24.810Z"}}, {"model": "core.auditevent", "pk": 1276, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "560", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 43}, "timestamp": "2026-01-27T09:24:24.818Z"}}, {"model": "core.auditevent", "pk": 1277, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "561", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 45}, "timestamp": "2026-01-27T09:24:24.827Z"}}, {"model": "core.auditevent", "pk": 1278, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "562", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 46}, "timestamp": "2026-01-27T09:24:24.836Z"}}, {"model": "core.auditevent", "pk": 1279, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "563", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 47}, "timestamp": "2026-01-27T09:24:24.845Z"}}, {"model": "core.auditevent", "pk": 1280, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "564", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 48}, "timestamp": "2026-01-27T09:24:24.853Z"}}, {"model": "core.auditevent", "pk": 1341, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "564", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 48}, "timestamp": "2026-01-27T09:24:25.561Z"}}, {"model": "core.auditevent", "pk": 1281, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "565", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 49}, "timestamp": "2026-01-27T09:24:24.861Z"}}, {"model": "core.auditevent", "pk": 1343, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "565", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 49}, "timestamp": "2026-01-27T09:24:25.575Z"}}, {"model": "core.auditevent", "pk": 1282, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "566", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 50}, "timestamp": "2026-01-27T09:24:24.870Z"}}, {"model": "core.auditevent", "pk": 1345, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "566", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 50}, "timestamp": "2026-01-27T09:24:25.585Z"}}, {"model": "core.auditevent", "pk": 1283, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "567", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 51}, "timestamp": "2026-01-27T09:24:24.878Z"}}, {"model": "core.auditevent", "pk": 1347, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "567", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 51}, "timestamp": "2026-01-27T09:24:25.595Z"}}, {"model": "core.auditevent", "pk": 1284, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "568", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 53}, "timestamp": "2026-01-27T09:24:24.887Z"}}, {"model": "core.auditevent", "pk": 1349, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "568", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 53}, "timestamp": "2026-01-27T09:24:25.606Z"}}, {"model": "core.auditevent", "pk": 1285, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "569", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 54}, "timestamp": "2026-01-27T09:24:24.895Z"}}, {"model": "core.auditevent", "pk": 1351, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "569", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 54}, "timestamp": "2026-01-27T09:24:25.619Z"}}, {"model": "core.auditevent", "pk": 1286, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "570", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 55}, "timestamp": "2026-01-27T09:24:24.903Z"}}, {"model": "core.auditevent", "pk": 1353, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "570", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 55}, "timestamp": "2026-01-27T09:24:25.633Z"}}, {"model": "core.auditevent", "pk": 1287, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "571", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 56}, "timestamp": "2026-01-27T09:24:24.912Z"}}, {"model": "core.auditevent", "pk": 1355, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "571", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 56}, "timestamp": "2026-01-27T09:24:25.646Z"}}, {"model": "core.auditevent", "pk": 1288, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "572", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 57}, "timestamp": "2026-01-27T09:24:24.919Z"}}, {"model": "core.auditevent", "pk": 1357, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "572", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 57}, "timestamp": "2026-01-27T09:24:25.659Z"}}, {"model": "core.auditevent", "pk": 1289, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "573", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 58}, "timestamp": "2026-01-27T09:24:24.928Z"}}, {"model": "core.auditevent", "pk": 1359, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "573", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 58}, "timestamp": "2026-01-27T09:24:25.672Z"}}, {"model": "core.auditevent", "pk": 1290, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "574", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 59}, "timestamp": "2026-01-27T09:24:24.935Z"}}, {"model": "core.auditevent", "pk": 1361, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "574", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 59}, "timestamp": "2026-01-27T09:24:25.685Z"}}, {"model": "core.auditevent", "pk": 1291, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "575", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 97}, "timestamp": "2026-01-27T09:24:24.943Z"}}, {"model": "core.auditevent", "pk": 1363, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "575", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 97}, "timestamp": "2026-01-27T09:24:25.697Z"}}, {"model": "core.auditevent", "pk": 1292, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "576", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 98}, "timestamp": "2026-01-27T09:24:24.952Z"}}, {"model": "core.auditevent", "pk": 1365, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "576", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 98}, "timestamp": "2026-01-27T09:24:25.710Z"}}, {"model": "core.auditevent", "pk": 1293, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "577", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 99}, "timestamp": "2026-01-27T09:24:24.959Z"}}, {"model": "core.auditevent", "pk": 1367, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "577", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 99}, "timestamp": "2026-01-27T09:24:25.723Z"}}, {"model": "core.auditevent", "pk": 1294, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "578", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 100}, "timestamp": "2026-01-27T09:24:24.968Z"}}, {"model": "core.auditevent", "pk": 1369, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "578", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 100}, "timestamp": "2026-01-27T09:24:25.735Z"}}, {"model": "core.auditevent", "pk": 1296, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "579", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 2}, "timestamp": "2026-01-27T09:24:25.264Z"}}, {"model": "core.auditevent", "pk": 1298, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "580", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 4}, "timestamp": "2026-01-27T09:24:25.278Z"}}, {"model": "core.auditevent", "pk": 1300, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "581", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 5}, "timestamp": "2026-01-27T09:24:25.288Z"}}, {"model": "core.auditevent", "pk": 1302, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "582", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 7}, "timestamp": "2026-01-27T09:24:25.302Z"}}, {"model": "core.auditevent", "pk": 1304, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "583", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 8}, "timestamp": "2026-01-27T09:24:25.313Z"}}, {"model": "core.auditevent", "pk": 1306, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "584", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 13}, "timestamp": "2026-01-27T09:24:25.327Z"}}, {"model": "core.auditevent", "pk": 1308, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "585", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 14}, "timestamp": "2026-01-27T09:24:25.340Z"}}, {"model": "core.auditevent", "pk": 1310, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "586", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 15}, "timestamp": "2026-01-27T09:24:25.351Z"}}, {"model": "core.auditevent", "pk": 1312, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "587", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 16}, "timestamp": "2026-01-27T09:24:25.361Z"}}, {"model": "core.auditevent", "pk": 1314, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "588", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 17}, "timestamp": "2026-01-27T09:24:25.371Z"}}, {"model": "core.auditevent", "pk": 1316, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "589", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 18}, "timestamp": "2026-01-27T09:24:25.382Z"}}, {"model": "core.auditevent", "pk": 1318, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "590", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 20}, "timestamp": "2026-01-27T09:24:25.392Z"}}, {"model": "core.auditevent", "pk": 1320, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "591", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 21}, "timestamp": "2026-01-27T09:24:25.406Z"}}, {"model": "core.auditevent", "pk": 1322, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "592", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 23}, "timestamp": "2026-01-27T09:24:25.422Z"}}, {"model": "core.auditevent", "pk": 1324, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "593", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 25}, "timestamp": "2026-01-27T09:24:25.438Z"}}, {"model": "core.auditevent", "pk": 1326, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "594", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 27}, "timestamp": "2026-01-27T09:24:25.454Z"}}, {"model": "core.auditevent", "pk": 1328, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "595", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 29}, "timestamp": "2026-01-27T09:24:25.468Z"}}, {"model": "core.auditevent", "pk": 1330, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "596", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 30}, "timestamp": "2026-01-27T09:24:25.482Z"}}, {"model": "core.auditevent", "pk": 1332, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "597", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 31}, "timestamp": "2026-01-27T09:24:25.495Z"}}, {"model": "core.auditevent", "pk": 1334, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "598", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 32}, "timestamp": "2026-01-27T09:24:25.505Z"}}, {"model": "core.auditevent", "pk": 1336, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "599", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 33}, "timestamp": "2026-01-27T09:24:25.517Z"}}, {"model": "core.auditevent", "pk": 1338, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "600", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 34}, "timestamp": "2026-01-27T09:24:25.527Z"}}, {"model": "core.auditevent", "pk": 1340, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "601", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 35}, "timestamp": "2026-01-27T09:24:25.541Z"}}, {"model": "core.auditevent", "pk": 1342, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "602", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 48}, "timestamp": "2026-01-27T09:24:25.562Z"}}, {"model": "core.auditevent", "pk": 1344, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "603", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 49}, "timestamp": "2026-01-27T09:24:25.577Z"}}, {"model": "core.auditevent", "pk": 1346, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "604", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 50}, "timestamp": "2026-01-27T09:24:25.588Z"}}, {"model": "core.auditevent", "pk": 1348, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "605", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 51}, "timestamp": "2026-01-27T09:24:25.598Z"}}, {"model": "core.auditevent", "pk": 1350, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "606", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 53}, "timestamp": "2026-01-27T09:24:25.609Z"}}, {"model": "core.auditevent", "pk": 1352, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "607", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 54}, "timestamp": "2026-01-27T09:24:25.622Z"}}, {"model": "core.auditevent", "pk": 1354, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "608", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 55}, "timestamp": "2026-01-27T09:24:25.636Z"}}, {"model": "core.auditevent", "pk": 1356, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "609", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 56}, "timestamp": "2026-01-27T09:24:25.649Z"}}, {"model": "core.auditevent", "pk": 1358, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "610", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 57}, "timestamp": "2026-01-27T09:24:25.661Z"}}, {"model": "core.auditevent", "pk": 1360, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "611", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 58}, "timestamp": "2026-01-27T09:24:25.676Z"}}, {"model": "core.auditevent", "pk": 1362, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "612", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 59}, "timestamp": "2026-01-27T09:24:25.688Z"}}, {"model": "core.auditevent", "pk": 1364, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "613", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 97}, "timestamp": "2026-01-27T09:24:25.701Z"}}, {"model": "core.auditevent", "pk": 1366, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "614", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 98}, "timestamp": "2026-01-27T09:24:25.713Z"}}, {"model": "core.auditevent", "pk": 1368, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "615", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 99}, "timestamp": "2026-01-27T09:24:25.727Z"}}, {"model": "core.auditevent", "pk": 1370, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "616", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 100}, "timestamp": "2026-01-27T09:24:25.737Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\confirmation.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\future_assignment_active.json
```json
[{"model": "core.assignment", "pk": 523, "fields": {"created_at": "2026-01-27T09:24:24.471Z", "updated_at": "2026-01-27T09:24:25.260Z", "parish": 1, "slot": 2, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.471Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.260Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 579, "fields": {"created_at": "2026-01-27T09:24:25.264Z", "updated_at": "2026-01-27T09:24:25.264Z", "parish": 1, "slot": 2, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.264Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 524, "fields": {"created_at": "2026-01-27T09:24:24.483Z", "updated_at": "2026-01-27T09:24:24.483Z", "parish": 1, "slot": 3, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.483Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 525, "fields": {"created_at": "2026-01-27T09:24:24.493Z", "updated_at": "2026-01-27T09:24:25.274Z", "parish": 1, "slot": 4, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.493Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.274Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 580, "fields": {"created_at": "2026-01-27T09:24:25.277Z", "updated_at": "2026-01-27T09:24:25.277Z", "parish": 1, "slot": 4, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.278Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 526, "fields": {"created_at": "2026-01-27T09:24:24.504Z", "updated_at": "2026-01-27T09:24:25.285Z", "parish": 1, "slot": 5, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.504Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.285Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 581, "fields": {"created_at": "2026-01-27T09:24:25.288Z", "updated_at": "2026-01-27T09:24:25.288Z", "parish": 1, "slot": 5, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.288Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 527, "fields": {"created_at": "2026-01-27T09:24:24.515Z", "updated_at": "2026-01-27T09:24:24.515Z", "parish": 1, "slot": 6, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.515Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 528, "fields": {"created_at": "2026-01-27T09:24:24.524Z", "updated_at": "2026-01-27T09:24:25.298Z", "parish": 1, "slot": 7, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.525Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.298Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 582, "fields": {"created_at": "2026-01-27T09:24:25.301Z", "updated_at": "2026-01-27T09:24:25.301Z", "parish": 1, "slot": 7, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.301Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 529, "fields": {"created_at": "2026-01-27T09:24:24.534Z", "updated_at": "2026-01-27T09:24:25.309Z", "parish": 1, "slot": 8, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.534Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.309Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 583, "fields": {"created_at": "2026-01-27T09:24:25.313Z", "updated_at": "2026-01-27T09:24:25.313Z", "parish": 1, "slot": 8, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.313Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 530, "fields": {"created_at": "2026-01-27T09:24:24.546Z", "updated_at": "2026-01-27T09:24:24.546Z", "parish": 1, "slot": 9, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.546Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 531, "fields": {"created_at": "2026-01-27T09:24:24.556Z", "updated_at": "2026-01-27T09:24:24.556Z", "parish": 1, "slot": 11, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.556Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 532, "fields": {"created_at": "2026-01-27T09:24:24.565Z", "updated_at": "2026-01-27T09:24:24.565Z", "parish": 1, "slot": 12, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.565Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 533, "fields": {"created_at": "2026-01-27T09:24:24.574Z", "updated_at": "2026-01-27T09:24:25.324Z", "parish": 1, "slot": 13, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.574Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.324Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 584, "fields": {"created_at": "2026-01-27T09:24:25.327Z", "updated_at": "2026-01-27T09:24:25.327Z", "parish": 1, "slot": 13, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.327Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 534, "fields": {"created_at": "2026-01-27T09:24:24.584Z", "updated_at": "2026-01-27T09:24:25.335Z", "parish": 1, "slot": 14, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.584Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.335Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 585, "fields": {"created_at": "2026-01-27T09:24:25.339Z", "updated_at": "2026-01-27T09:24:25.339Z", "parish": 1, "slot": 14, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.339Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 535, "fields": {"created_at": "2026-01-27T09:24:24.595Z", "updated_at": "2026-01-27T09:24:25.347Z", "parish": 1, "slot": 15, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.595Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.347Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 586, "fields": {"created_at": "2026-01-27T09:24:25.350Z", "updated_at": "2026-01-27T09:24:25.350Z", "parish": 1, "slot": 15, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.350Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 536, "fields": {"created_at": "2026-01-27T09:24:24.604Z", "updated_at": "2026-01-27T09:24:25.357Z", "parish": 1, "slot": 16, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.604Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.357Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 587, "fields": {"created_at": "2026-01-27T09:24:25.361Z", "updated_at": "2026-01-27T09:24:25.361Z", "parish": 1, "slot": 16, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.361Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 537, "fields": {"created_at": "2026-01-27T09:24:24.614Z", "updated_at": "2026-01-27T09:24:25.368Z", "parish": 1, "slot": 17, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.614Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.368Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 588, "fields": {"created_at": "2026-01-27T09:24:25.371Z", "updated_at": "2026-01-27T09:24:25.371Z", "parish": 1, "slot": 17, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.371Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 538, "fields": {"created_at": "2026-01-27T09:24:24.624Z", "updated_at": "2026-01-27T09:24:25.378Z", "parish": 1, "slot": 18, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.624Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.378Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 589, "fields": {"created_at": "2026-01-27T09:24:25.382Z", "updated_at": "2026-01-27T09:24:25.382Z", "parish": 1, "slot": 18, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.382Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 539, "fields": {"created_at": "2026-01-27T09:24:24.634Z", "updated_at": "2026-01-27T09:24:25.388Z", "parish": 1, "slot": 20, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.634Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.388Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 590, "fields": {"created_at": "2026-01-27T09:24:25.392Z", "updated_at": "2026-01-27T09:24:25.392Z", "parish": 1, "slot": 20, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.392Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 540, "fields": {"created_at": "2026-01-27T09:24:24.645Z", "updated_at": "2026-01-27T09:24:25.400Z", "parish": 1, "slot": 21, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.645Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.400Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 591, "fields": {"created_at": "2026-01-27T09:24:25.404Z", "updated_at": "2026-01-27T09:24:25.404Z", "parish": 1, "slot": 21, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.405Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 541, "fields": {"created_at": "2026-01-27T09:24:24.654Z", "updated_at": "2026-01-27T09:24:24.654Z", "parish": 1, "slot": 22, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.654Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 542, "fields": {"created_at": "2026-01-27T09:24:24.664Z", "updated_at": "2026-01-27T09:24:25.416Z", "parish": 1, "slot": 23, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.664Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.416Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 592, "fields": {"created_at": "2026-01-27T09:24:25.422Z", "updated_at": "2026-01-27T09:24:25.422Z", "parish": 1, "slot": 23, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.422Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 543, "fields": {"created_at": "2026-01-27T09:24:24.672Z", "updated_at": "2026-01-27T09:24:24.672Z", "parish": 1, "slot": 24, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.672Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 544, "fields": {"created_at": "2026-01-27T09:24:24.682Z", "updated_at": "2026-01-27T09:24:25.432Z", "parish": 1, "slot": 25, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.682Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.432Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 593, "fields": {"created_at": "2026-01-27T09:24:25.437Z", "updated_at": "2026-01-27T09:24:25.438Z", "parish": 1, "slot": 25, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.438Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 545, "fields": {"created_at": "2026-01-27T09:24:24.691Z", "updated_at": "2026-01-27T09:24:24.691Z", "parish": 1, "slot": 26, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.691Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 546, "fields": {"created_at": "2026-01-27T09:24:24.699Z", "updated_at": "2026-01-27T09:24:25.448Z", "parish": 1, "slot": 27, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.699Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.448Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 594, "fields": {"created_at": "2026-01-27T09:24:25.454Z", "updated_at": "2026-01-27T09:24:25.454Z", "parish": 1, "slot": 27, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.454Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 547, "fields": {"created_at": "2026-01-27T09:24:24.706Z", "updated_at": "2026-01-27T09:24:25.462Z", "parish": 1, "slot": 29, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.706Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.462Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 595, "fields": {"created_at": "2026-01-27T09:24:25.467Z", "updated_at": "2026-01-27T09:24:25.467Z", "parish": 1, "slot": 29, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.467Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 548, "fields": {"created_at": "2026-01-27T09:24:24.715Z", "updated_at": "2026-01-27T09:24:25.476Z", "parish": 1, "slot": 30, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.715Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.476Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 596, "fields": {"created_at": "2026-01-27T09:24:25.481Z", "updated_at": "2026-01-27T09:24:25.481Z", "parish": 1, "slot": 30, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.482Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 549, "fields": {"created_at": "2026-01-27T09:24:24.723Z", "updated_at": "2026-01-27T09:24:25.490Z", "parish": 1, "slot": 31, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.723Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.490Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 597, "fields": {"created_at": "2026-01-27T09:24:25.495Z", "updated_at": "2026-01-27T09:24:25.495Z", "parish": 1, "slot": 31, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.495Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 550, "fields": {"created_at": "2026-01-27T09:24:24.732Z", "updated_at": "2026-01-27T09:24:25.502Z", "parish": 1, "slot": 32, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.732Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.502Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 598, "fields": {"created_at": "2026-01-27T09:24:25.505Z", "updated_at": "2026-01-27T09:24:25.505Z", "parish": 1, "slot": 32, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.505Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 551, "fields": {"created_at": "2026-01-27T09:24:24.739Z", "updated_at": "2026-01-27T09:24:25.513Z", "parish": 1, "slot": 33, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.739Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.513Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 599, "fields": {"created_at": "2026-01-27T09:24:25.516Z", "updated_at": "2026-01-27T09:24:25.516Z", "parish": 1, "slot": 33, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.516Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 552, "fields": {"created_at": "2026-01-27T09:24:24.748Z", "updated_at": "2026-01-27T09:24:25.523Z", "parish": 1, "slot": 34, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.748Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.523Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 600, "fields": {"created_at": "2026-01-27T09:24:25.527Z", "updated_at": "2026-01-27T09:24:25.527Z", "parish": 1, "slot": 34, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.527Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 553, "fields": {"created_at": "2026-01-27T09:24:24.756Z", "updated_at": "2026-01-27T09:24:25.535Z", "parish": 1, "slot": 35, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.756Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.535Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 601, "fields": {"created_at": "2026-01-27T09:24:25.540Z", "updated_at": "2026-01-27T09:24:25.540Z", "parish": 1, "slot": 35, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.540Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 554, "fields": {"created_at": "2026-01-27T09:24:24.765Z", "updated_at": "2026-01-27T09:24:24.765Z", "parish": 1, "slot": 37, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.765Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 555, "fields": {"created_at": "2026-01-27T09:24:24.774Z", "updated_at": "2026-01-27T09:24:24.774Z", "parish": 1, "slot": 38, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.774Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 556, "fields": {"created_at": "2026-01-27T09:24:24.783Z", "updated_at": "2026-01-27T09:24:24.783Z", "parish": 1, "slot": 39, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.783Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 557, "fields": {"created_at": "2026-01-27T09:24:24.792Z", "updated_at": "2026-01-27T09:24:24.792Z", "parish": 1, "slot": 40, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.792Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 558, "fields": {"created_at": "2026-01-27T09:24:24.802Z", "updated_at": "2026-01-27T09:24:24.802Z", "parish": 1, "slot": 41, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.802Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 559, "fields": {"created_at": "2026-01-27T09:24:24.809Z", "updated_at": "2026-01-27T09:24:24.809Z", "parish": 1, "slot": 42, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.809Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 560, "fields": {"created_at": "2026-01-27T09:24:24.816Z", "updated_at": "2026-01-27T09:24:24.817Z", "parish": 1, "slot": 43, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.817Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 561, "fields": {"created_at": "2026-01-27T09:24:24.825Z", "updated_at": "2026-01-27T09:24:24.825Z", "parish": 1, "slot": 45, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.825Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 562, "fields": {"created_at": "2026-01-27T09:24:24.834Z", "updated_at": "2026-01-27T09:24:24.834Z", "parish": 1, "slot": 46, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.834Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 563, "fields": {"created_at": "2026-01-27T09:24:24.844Z", "updated_at": "2026-01-27T09:24:24.844Z", "parish": 1, "slot": 47, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.844Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 564, "fields": {"created_at": "2026-01-27T09:24:24.852Z", "updated_at": "2026-01-27T09:24:25.559Z", "parish": 1, "slot": 48, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.852Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.559Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 602, "fields": {"created_at": "2026-01-27T09:24:25.562Z", "updated_at": "2026-01-27T09:24:25.562Z", "parish": 1, "slot": 48, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.562Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 565, "fields": {"created_at": "2026-01-27T09:24:24.859Z", "updated_at": "2026-01-27T09:24:25.573Z", "parish": 1, "slot": 49, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.859Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.572Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 603, "fields": {"created_at": "2026-01-27T09:24:25.576Z", "updated_at": "2026-01-27T09:24:25.576Z", "parish": 1, "slot": 49, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.577Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 566, "fields": {"created_at": "2026-01-27T09:24:24.869Z", "updated_at": "2026-01-27T09:24:25.583Z", "parish": 1, "slot": 50, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.869Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.583Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 604, "fields": {"created_at": "2026-01-27T09:24:25.588Z", "updated_at": "2026-01-27T09:24:25.588Z", "parish": 1, "slot": 50, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.588Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 567, "fields": {"created_at": "2026-01-27T09:24:24.877Z", "updated_at": "2026-01-27T09:24:25.594Z", "parish": 1, "slot": 51, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.877Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.594Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 605, "fields": {"created_at": "2026-01-27T09:24:25.597Z", "updated_at": "2026-01-27T09:24:25.597Z", "parish": 1, "slot": 51, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.597Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 568, "fields": {"created_at": "2026-01-27T09:24:24.886Z", "updated_at": "2026-01-27T09:24:25.604Z", "parish": 1, "slot": 53, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.886Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.604Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 606, "fields": {"created_at": "2026-01-27T09:24:25.609Z", "updated_at": "2026-01-27T09:24:25.609Z", "parish": 1, "slot": 53, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.609Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 569, "fields": {"created_at": "2026-01-27T09:24:24.894Z", "updated_at": "2026-01-27T09:24:25.617Z", "parish": 1, "slot": 54, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.894Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.617Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 607, "fields": {"created_at": "2026-01-27T09:24:25.622Z", "updated_at": "2026-01-27T09:24:25.622Z", "parish": 1, "slot": 54, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.622Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 570, "fields": {"created_at": "2026-01-27T09:24:24.902Z", "updated_at": "2026-01-27T09:24:25.631Z", "parish": 1, "slot": 55, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.902Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.631Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 608, "fields": {"created_at": "2026-01-27T09:24:25.636Z", "updated_at": "2026-01-27T09:24:25.636Z", "parish": 1, "slot": 55, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.636Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 571, "fields": {"created_at": "2026-01-27T09:24:24.910Z", "updated_at": "2026-01-27T09:24:25.644Z", "parish": 1, "slot": 56, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.911Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.644Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 609, "fields": {"created_at": "2026-01-27T09:24:25.649Z", "updated_at": "2026-01-27T09:24:25.649Z", "parish": 1, "slot": 56, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.649Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 572, "fields": {"created_at": "2026-01-27T09:24:24.918Z", "updated_at": "2026-01-27T09:24:25.656Z", "parish": 1, "slot": 57, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.918Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.656Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 610, "fields": {"created_at": "2026-01-27T09:24:25.661Z", "updated_at": "2026-01-27T09:24:25.661Z", "parish": 1, "slot": 57, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.661Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 573, "fields": {"created_at": "2026-01-27T09:24:24.926Z", "updated_at": "2026-01-27T09:24:25.670Z", "parish": 1, "slot": 58, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.926Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.670Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 611, "fields": {"created_at": "2026-01-27T09:24:25.675Z", "updated_at": "2026-01-27T09:24:25.675Z", "parish": 1, "slot": 58, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.675Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 574, "fields": {"created_at": "2026-01-27T09:24:24.934Z", "updated_at": "2026-01-27T09:24:25.683Z", "parish": 1, "slot": 59, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.934Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.683Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 612, "fields": {"created_at": "2026-01-27T09:24:25.687Z", "updated_at": "2026-01-27T09:24:25.687Z", "parish": 1, "slot": 59, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.687Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 575, "fields": {"created_at": "2026-01-27T09:24:24.941Z", "updated_at": "2026-01-27T09:24:25.695Z", "parish": 1, "slot": 97, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.941Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.695Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 613, "fields": {"created_at": "2026-01-27T09:24:25.700Z", "updated_at": "2026-01-27T09:24:25.700Z", "parish": 1, "slot": 97, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.700Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 576, "fields": {"created_at": "2026-01-27T09:24:24.950Z", "updated_at": "2026-01-27T09:24:25.708Z", "parish": 1, "slot": 98, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.950Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.708Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 614, "fields": {"created_at": "2026-01-27T09:24:25.712Z", "updated_at": "2026-01-27T09:24:25.712Z", "parish": 1, "slot": 98, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.713Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 577, "fields": {"created_at": "2026-01-27T09:24:24.958Z", "updated_at": "2026-01-27T09:24:25.720Z", "parish": 1, "slot": 99, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.958Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.720Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 615, "fields": {"created_at": "2026-01-27T09:24:25.726Z", "updated_at": "2026-01-27T09:24:25.726Z", "parish": 1, "slot": 99, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.726Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 578, "fields": {"created_at": "2026-01-27T09:24:24.966Z", "updated_at": "2026-01-27T09:24:25.733Z", "parish": 1, "slot": 100, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T09:24:24.966Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T09:24:25.733Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 616, "fields": {"created_at": "2026-01-27T09:24:25.736Z", "updated_at": "2026-01-27T09:24:25.736Z", "parish": 1, "slot": 100, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T09:24:25.736Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\massinterest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\massoverride.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\past_assignment.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\past_assignmentslot.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\past_massinstance.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\positionclaimrequest.json
```json
[{"model": "core.positionclaimrequest", "pk": 8, "fields": {"created_at": "2026-01-26T06:13:52.739Z", "updated_at": "2026-01-27T08:16:48.744Z", "parish": 1, "slot": 3, "requestor_acolyte": 3, "target_assignment": null, "status": "expired", "approval_mode": "", "resolution_reason": "assignment_changed", "auto_approve_at": "2026-02-05T20:00:00Z", "resolved_at": "2026-01-27T08:16:48.744Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 5, "fields": {"created_at": "2026-01-25T21:13:54.694Z", "updated_at": "2026-01-25T21:31:57.274Z", "parish": 1, "slot": 12, "requestor_acolyte": 1, "target_assignment": null, "status": "expired", "approval_mode": "coordination", "resolution_reason": "holder_confirmed", "auto_approve_at": null, "resolved_at": "2026-01-25T21:31:57.274Z", "approved_by": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\replacementrequest.json
```json
[{"model": "core.replacementrequest", "pk": 11, "fields": {"created_at": "2026-01-26T03:52:46.710Z", "updated_at": "2026-01-26T03:52:46.776Z", "parish": 1, "slot": 2, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 12, "fields": {"created_at": "2026-01-26T03:55:01.453Z", "updated_at": "2026-01-26T03:55:01.526Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 13, "fields": {"created_at": "2026-01-26T03:56:22.179Z", "updated_at": "2026-01-26T03:56:22.339Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 16, "fields": {"created_at": "2026-01-27T03:38:03.289Z", "updated_at": "2026-01-27T03:38:03.289Z", "parish": 1, "slot": 17, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 14, "fields": {"created_at": "2026-01-26T03:56:36.974Z", "updated_at": "2026-01-26T03:56:37.048Z", "parish": 1, "slot": 20, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 9, "fields": {"created_at": "2026-01-25T18:10:45.171Z", "updated_at": "2026-01-25T18:10:45.229Z", "parish": 1, "slot": 23, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 15, "fields": {"created_at": "2026-01-27T03:38:03.253Z", "updated_at": "2026-01-27T03:38:03.253Z", "parish": 1, "slot": 29, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 8, "fields": {"created_at": "2026-01-25T18:09:03.950Z", "updated_at": "2026-01-25T18:09:04.009Z", "parish": 1, "slot": 34, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 17, "fields": {"created_at": "2026-01-27T03:38:03.326Z", "updated_at": "2026-01-27T03:38:03.326Z", "parish": 1, "slot": 35, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 7, "fields": {"created_at": "2026-01-25T18:08:53.446Z", "updated_at": "2026-01-25T18:08:53.518Z", "parish": 1, "slot": 45, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 4, "fields": {"created_at": "2026-01-23T11:40:58.132Z", "updated_at": "2026-01-23T11:40:58.133Z", "parish": 1, "slot": 51, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 5, "fields": {"created_at": "2026-01-23T11:41:55.885Z", "updated_at": "2026-01-23T11:41:55.885Z", "parish": 1, "slot": 107, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\serializers\swaprequest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T081444\meta.json
```json
{
  "created_at": "2026-01-27T08:14:44.938114-03:00",
  "cutoff_date": "2026-01-27",
  "counts": {
    "past_masses": 0,
    "past_slots": 0,
    "past_assignments": 0,
    "future_assignments_total": 94,
    "confirmations": 0,
    "claims": 2,
    "replacement_requests": 12,
    "swap_requests": 0,
    "mass_interest": 0,
    "mass_override": 0,
    "ledger_rows": 0,
    "audit_events": 132
  },
  "models_included": [
    "core.MassInstance",
    "core.AssignmentSlot",
    "core.Assignment",
    "core.Confirmation",
    "core.PositionClaimRequest",
    "core.ReplacementRequest",
    "core.SwapRequest",
    "core.MassInterest",
    "core.MassOverride",
    "core.AcolyteCreditLedger",
    "core.AuditEvent"
  ]
}
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\acolytecreditledger.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\auditevent.json
```json
[{"model": "core.auditevent", "pk": 1392, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "617", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 120}, "timestamp": "2026-01-27T11:15:02.374Z"}}, {"model": "core.auditevent", "pk": 1410, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "617", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 120}, "timestamp": "2026-01-27T11:17:23.637Z"}}, {"model": "core.auditevent", "pk": 1393, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "618", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 121}, "timestamp": "2026-01-27T11:15:02.385Z"}}, {"model": "core.auditevent", "pk": 1412, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "618", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 121}, "timestamp": "2026-01-27T11:17:23.647Z"}}, {"model": "core.auditevent", "pk": 1394, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "619", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 122}, "timestamp": "2026-01-27T11:15:02.395Z"}}, {"model": "core.auditevent", "pk": 1414, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "619", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 122}, "timestamp": "2026-01-27T11:17:23.657Z"}}, {"model": "core.auditevent", "pk": 1395, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "620", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 123}, "timestamp": "2026-01-27T11:15:02.406Z"}}, {"model": "core.auditevent", "pk": 1416, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "620", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 123}, "timestamp": "2026-01-27T11:17:23.667Z"}}, {"model": "core.auditevent", "pk": 1396, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "621", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 124}, "timestamp": "2026-01-27T11:15:02.416Z"}}, {"model": "core.auditevent", "pk": 1418, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "621", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 124}, "timestamp": "2026-01-27T11:17:23.677Z"}}, {"model": "core.auditevent", "pk": 1397, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "622", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 125}, "timestamp": "2026-01-27T11:15:02.427Z"}}, {"model": "core.auditevent", "pk": 1420, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "622", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 125}, "timestamp": "2026-01-27T11:17:23.687Z"}}, {"model": "core.auditevent", "pk": 1398, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "623", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 126}, "timestamp": "2026-01-27T11:15:02.436Z"}}, {"model": "core.auditevent", "pk": 1422, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "623", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 126}, "timestamp": "2026-01-27T11:17:23.698Z"}}, {"model": "core.auditevent", "pk": 1399, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "624", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 127}, "timestamp": "2026-01-27T11:15:02.446Z"}}, {"model": "core.auditevent", "pk": 1424, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "624", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 127}, "timestamp": "2026-01-27T11:17:23.708Z"}}, {"model": "core.auditevent", "pk": 1400, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "625", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 128}, "timestamp": "2026-01-27T11:15:02.455Z"}}, {"model": "core.auditevent", "pk": 1426, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "625", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 128}, "timestamp": "2026-01-27T11:17:23.718Z"}}, {"model": "core.auditevent", "pk": 1401, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "626", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 129}, "timestamp": "2026-01-27T11:15:02.464Z"}}, {"model": "core.auditevent", "pk": 1428, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "626", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 129}, "timestamp": "2026-01-27T11:17:23.731Z"}}, {"model": "core.auditevent", "pk": 1402, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "627", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 130}, "timestamp": "2026-01-27T11:15:02.475Z"}}, {"model": "core.auditevent", "pk": 1430, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "627", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 130}, "timestamp": "2026-01-27T11:17:23.742Z"}}, {"model": "core.auditevent", "pk": 1403, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "628", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 131}, "timestamp": "2026-01-27T11:15:02.485Z"}}, {"model": "core.auditevent", "pk": 1432, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "628", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 131}, "timestamp": "2026-01-27T11:17:23.751Z"}}, {"model": "core.auditevent", "pk": 1404, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "629", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 132}, "timestamp": "2026-01-27T11:15:02.493Z"}}, {"model": "core.auditevent", "pk": 1434, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "629", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 132}, "timestamp": "2026-01-27T11:17:23.763Z"}}, {"model": "core.auditevent", "pk": 1405, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "630", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 133}, "timestamp": "2026-01-27T11:15:02.501Z"}}, {"model": "core.auditevent", "pk": 1436, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "630", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 133}, "timestamp": "2026-01-27T11:17:23.773Z"}}, {"model": "core.auditevent", "pk": 1406, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "631", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 134}, "timestamp": "2026-01-27T11:15:02.512Z"}}, {"model": "core.auditevent", "pk": 1438, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "631", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 134}, "timestamp": "2026-01-27T11:17:23.782Z"}}, {"model": "core.auditevent", "pk": 1407, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "632", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 135}, "timestamp": "2026-01-27T11:15:02.521Z"}}, {"model": "core.auditevent", "pk": 1440, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "632", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 135}, "timestamp": "2026-01-27T11:17:23.791Z"}}, {"model": "core.auditevent", "pk": 1408, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "633", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 136}, "timestamp": "2026-01-27T11:15:02.532Z"}}, {"model": "core.auditevent", "pk": 1442, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "633", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 136}, "timestamp": "2026-01-27T11:17:23.801Z"}}, {"model": "core.auditevent", "pk": 1409, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "634", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 137}, "timestamp": "2026-01-27T11:15:02.541Z"}}, {"model": "core.auditevent", "pk": 1444, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "634", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 137}, "timestamp": "2026-01-27T11:17:23.811Z"}}, {"model": "core.auditevent", "pk": 1411, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "635", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 120}, "timestamp": "2026-01-27T11:17:23.639Z"}}, {"model": "core.auditevent", "pk": 1446, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "635", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 120}, "timestamp": "2026-01-27T11:17:23.916Z"}}, {"model": "core.auditevent", "pk": 1413, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "636", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 121}, "timestamp": "2026-01-27T11:17:23.649Z"}}, {"model": "core.auditevent", "pk": 1448, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "636", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 121}, "timestamp": "2026-01-27T11:17:23.926Z"}}, {"model": "core.auditevent", "pk": 1415, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "637", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 122}, "timestamp": "2026-01-27T11:17:23.659Z"}}, {"model": "core.auditevent", "pk": 1450, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "637", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 122}, "timestamp": "2026-01-27T11:17:23.936Z"}}, {"model": "core.auditevent", "pk": 1417, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "638", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 123}, "timestamp": "2026-01-27T11:17:23.668Z"}}, {"model": "core.auditevent", "pk": 1452, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "638", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 123}, "timestamp": "2026-01-27T11:17:23.947Z"}}, {"model": "core.auditevent", "pk": 1419, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "639", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 124}, "timestamp": "2026-01-27T11:17:23.678Z"}}, {"model": "core.auditevent", "pk": 1454, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "639", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 124}, "timestamp": "2026-01-27T11:17:23.958Z"}}, {"model": "core.auditevent", "pk": 1421, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "640", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 125}, "timestamp": "2026-01-27T11:17:23.689Z"}}, {"model": "core.auditevent", "pk": 1456, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "640", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 125}, "timestamp": "2026-01-27T11:17:23.968Z"}}, {"model": "core.auditevent", "pk": 1423, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "641", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 126}, "timestamp": "2026-01-27T11:17:23.700Z"}}, {"model": "core.auditevent", "pk": 1458, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "641", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 126}, "timestamp": "2026-01-27T11:17:23.978Z"}}, {"model": "core.auditevent", "pk": 1425, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "642", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 127}, "timestamp": "2026-01-27T11:17:23.710Z"}}, {"model": "core.auditevent", "pk": 1460, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "642", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 127}, "timestamp": "2026-01-27T11:17:23.989Z"}}, {"model": "core.auditevent", "pk": 1427, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "643", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 128}, "timestamp": "2026-01-27T11:17:23.720Z"}}, {"model": "core.auditevent", "pk": 1492, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "643", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 128}, "timestamp": "2026-01-27T11:29:48.268Z"}}, {"model": "core.auditevent", "pk": 1429, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "644", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 129}, "timestamp": "2026-01-27T11:17:23.733Z"}}, {"model": "core.auditevent", "pk": 1462, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "644", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 129}, "timestamp": "2026-01-27T11:17:24.001Z"}}, {"model": "core.auditevent", "pk": 1431, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "645", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 130}, "timestamp": "2026-01-27T11:17:23.744Z"}}, {"model": "core.auditevent", "pk": 1433, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "646", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 131}, "timestamp": "2026-01-27T11:17:23.753Z"}}, {"model": "core.auditevent", "pk": 1435, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "647", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 132}, "timestamp": "2026-01-27T11:17:23.765Z"}}, {"model": "core.auditevent", "pk": 1464, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "647", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 132}, "timestamp": "2026-01-27T11:17:24.014Z"}}, {"model": "core.auditevent", "pk": 1437, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "648", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 133}, "timestamp": "2026-01-27T11:17:23.775Z"}}, {"model": "core.auditevent", "pk": 1466, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "648", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 133}, "timestamp": "2026-01-27T11:17:24.026Z"}}, {"model": "core.auditevent", "pk": 1439, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "649", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 134}, "timestamp": "2026-01-27T11:17:23.784Z"}}, {"model": "core.auditevent", "pk": 1468, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "649", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 134}, "timestamp": "2026-01-27T11:17:24.039Z"}}, {"model": "core.auditevent", "pk": 1441, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "650", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 135}, "timestamp": "2026-01-27T11:17:23.793Z"}}, {"model": "core.auditevent", "pk": 1470, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "650", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 135}, "timestamp": "2026-01-27T11:17:24.048Z"}}, {"model": "core.auditevent", "pk": 1443, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "651", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 136}, "timestamp": "2026-01-27T11:17:23.803Z"}}, {"model": "core.auditevent", "pk": 1472, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "651", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 136}, "timestamp": "2026-01-27T11:17:24.059Z"}}, {"model": "core.auditevent", "pk": 1445, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "652", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 137}, "timestamp": "2026-01-27T11:17:23.813Z"}}, {"model": "core.auditevent", "pk": 1474, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "652", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 137}, "timestamp": "2026-01-27T11:17:24.070Z"}}, {"model": "core.auditevent", "pk": 1447, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "653", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 120}, "timestamp": "2026-01-27T11:17:23.918Z"}}, {"model": "core.auditevent", "pk": 1476, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "653", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 120}, "timestamp": "2026-01-27T11:29:48.176Z"}}, {"model": "core.auditevent", "pk": 1449, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "654", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 121}, "timestamp": "2026-01-27T11:17:23.928Z"}}, {"model": "core.auditevent", "pk": 1478, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "654", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 121}, "timestamp": "2026-01-27T11:29:48.188Z"}}, {"model": "core.auditevent", "pk": 1451, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "655", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 122}, "timestamp": "2026-01-27T11:17:23.938Z"}}, {"model": "core.auditevent", "pk": 1480, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "655", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 122}, "timestamp": "2026-01-27T11:29:48.200Z"}}, {"model": "core.auditevent", "pk": 1453, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "656", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 123}, "timestamp": "2026-01-27T11:17:23.949Z"}}, {"model": "core.auditevent", "pk": 1482, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "656", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 123}, "timestamp": "2026-01-27T11:29:48.210Z"}}, {"model": "core.auditevent", "pk": 1455, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "657", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 124}, "timestamp": "2026-01-27T11:17:23.960Z"}}, {"model": "core.auditevent", "pk": 1484, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "657", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 124}, "timestamp": "2026-01-27T11:29:48.221Z"}}, {"model": "core.auditevent", "pk": 1457, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "658", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 125}, "timestamp": "2026-01-27T11:17:23.970Z"}}, {"model": "core.auditevent", "pk": 1486, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "658", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 125}, "timestamp": "2026-01-27T11:29:48.234Z"}}, {"model": "core.auditevent", "pk": 1459, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "659", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 126}, "timestamp": "2026-01-27T11:17:23.980Z"}}, {"model": "core.auditevent", "pk": 1488, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "659", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 126}, "timestamp": "2026-01-27T11:29:48.245Z"}}, {"model": "core.auditevent", "pk": 1461, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "660", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 127}, "timestamp": "2026-01-27T11:17:23.992Z"}}, {"model": "core.auditevent", "pk": 1490, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "660", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 127}, "timestamp": "2026-01-27T11:29:48.256Z"}}, {"model": "core.auditevent", "pk": 1463, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "661", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 129}, "timestamp": "2026-01-27T11:17:24.003Z"}}, {"model": "core.auditevent", "pk": 1494, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "661", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 129}, "timestamp": "2026-01-27T11:29:48.279Z"}}, {"model": "core.auditevent", "pk": 1465, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "662", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 132}, "timestamp": "2026-01-27T11:17:24.016Z"}}, {"model": "core.auditevent", "pk": 1496, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "662", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 132}, "timestamp": "2026-01-27T11:29:48.295Z"}}, {"model": "core.auditevent", "pk": 1467, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "663", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 133}, "timestamp": "2026-01-27T11:17:24.028Z"}}, {"model": "core.auditevent", "pk": 1498, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "663", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 133}, "timestamp": "2026-01-27T11:29:48.309Z"}}, {"model": "core.auditevent", "pk": 1469, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "664", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 134}, "timestamp": "2026-01-27T11:17:24.041Z"}}, {"model": "core.auditevent", "pk": 1500, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "664", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 134}, "timestamp": "2026-01-27T11:29:48.321Z"}}, {"model": "core.auditevent", "pk": 1471, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "665", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 135}, "timestamp": "2026-01-27T11:17:24.050Z"}}, {"model": "core.auditevent", "pk": 1502, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "665", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 135}, "timestamp": "2026-01-27T11:29:48.331Z"}}, {"model": "core.auditevent", "pk": 1473, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "666", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 136}, "timestamp": "2026-01-27T11:17:24.061Z"}}, {"model": "core.auditevent", "pk": 1504, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "666", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 136}, "timestamp": "2026-01-27T11:29:48.344Z"}}, {"model": "core.auditevent", "pk": 1475, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "667", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 137}, "timestamp": "2026-01-27T11:17:24.072Z"}}, {"model": "core.auditevent", "pk": 1506, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "667", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 137}, "timestamp": "2026-01-27T11:29:48.357Z"}}, {"model": "core.auditevent", "pk": 1477, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "668", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 120}, "timestamp": "2026-01-27T11:29:48.178Z"}}, {"model": "core.auditevent", "pk": 1510, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "668", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 120}, "timestamp": "2026-01-27T11:33:49.783Z"}}, {"model": "core.auditevent", "pk": 1479, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "669", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 121}, "timestamp": "2026-01-27T11:29:48.190Z"}}, {"model": "core.auditevent", "pk": 1512, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "669", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 121}, "timestamp": "2026-01-27T11:33:49.797Z"}}, {"model": "core.auditevent", "pk": 1481, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "670", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 122}, "timestamp": "2026-01-27T11:29:48.202Z"}}, {"model": "core.auditevent", "pk": 1514, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "670", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 122}, "timestamp": "2026-01-27T11:33:49.809Z"}}, {"model": "core.auditevent", "pk": 1483, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "671", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 123}, "timestamp": "2026-01-27T11:29:48.212Z"}}, {"model": "core.auditevent", "pk": 1516, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "671", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 123}, "timestamp": "2026-01-27T11:33:49.818Z"}}, {"model": "core.auditevent", "pk": 1485, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "672", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 124}, "timestamp": "2026-01-27T11:29:48.224Z"}}, {"model": "core.auditevent", "pk": 1518, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "672", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 124}, "timestamp": "2026-01-27T11:33:49.830Z"}}, {"model": "core.auditevent", "pk": 1487, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "673", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 125}, "timestamp": "2026-01-27T11:29:48.236Z"}}, {"model": "core.auditevent", "pk": 1520, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "673", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 125}, "timestamp": "2026-01-27T11:33:49.841Z"}}, {"model": "core.auditevent", "pk": 1489, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "674", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 126}, "timestamp": "2026-01-27T11:29:48.247Z"}}, {"model": "core.auditevent", "pk": 1522, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "674", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 126}, "timestamp": "2026-01-27T11:33:49.853Z"}}, {"model": "core.auditevent", "pk": 1491, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "675", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 127}, "timestamp": "2026-01-27T11:29:48.258Z"}}, {"model": "core.auditevent", "pk": 1524, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "675", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 127}, "timestamp": "2026-01-27T11:33:49.863Z"}}, {"model": "core.auditevent", "pk": 1493, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "676", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 128}, "timestamp": "2026-01-27T11:29:48.270Z"}}, {"model": "core.auditevent", "pk": 1526, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "676", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 128}, "timestamp": "2026-01-27T11:33:49.873Z"}}, {"model": "core.auditevent", "pk": 1495, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "677", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 129}, "timestamp": "2026-01-27T11:29:48.282Z"}}, {"model": "core.auditevent", "pk": 1528, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "677", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 129}, "timestamp": "2026-01-27T11:33:49.884Z"}}, {"model": "core.auditevent", "pk": 1497, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "678", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 132}, "timestamp": "2026-01-27T11:29:48.297Z"}}, {"model": "core.auditevent", "pk": 1530, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "678", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 132}, "timestamp": "2026-01-27T11:33:49.898Z"}}, {"model": "core.auditevent", "pk": 1499, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "679", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 133}, "timestamp": "2026-01-27T11:29:48.312Z"}}, {"model": "core.auditevent", "pk": 1532, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "679", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 133}, "timestamp": "2026-01-27T11:33:49.908Z"}}, {"model": "core.auditevent", "pk": 1501, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "680", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 134}, "timestamp": "2026-01-27T11:29:48.323Z"}}, {"model": "core.auditevent", "pk": 1534, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "680", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 134}, "timestamp": "2026-01-27T11:33:49.920Z"}}, {"model": "core.auditevent", "pk": 1503, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "681", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 135}, "timestamp": "2026-01-27T11:29:48.334Z"}}, {"model": "core.auditevent", "pk": 1536, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "681", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 135}, "timestamp": "2026-01-27T11:33:49.932Z"}}, {"model": "core.auditevent", "pk": 1505, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "682", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 136}, "timestamp": "2026-01-27T11:29:48.346Z"}}, {"model": "core.auditevent", "pk": 1538, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "682", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 136}, "timestamp": "2026-01-27T11:33:49.943Z"}}, {"model": "core.auditevent", "pk": 1507, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "683", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 137}, "timestamp": "2026-01-27T11:29:48.359Z"}}, {"model": "core.auditevent", "pk": 1540, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "683", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 137}, "timestamp": "2026-01-27T11:33:49.954Z"}}, {"model": "core.auditevent", "pk": 1508, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "684", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 45}, "timestamp": "2026-01-27T11:30:15.928Z"}}, {"model": "core.auditevent", "pk": 1509, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "684", "action_type": "assign", "diff_json": {"acolyte_id": 18}, "timestamp": "2026-01-27T11:30:15.933Z"}}, {"model": "core.auditevent", "pk": 1511, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "685", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 120}, "timestamp": "2026-01-27T11:33:49.786Z"}}, {"model": "core.auditevent", "pk": 1513, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "686", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 121}, "timestamp": "2026-01-27T11:33:49.799Z"}}, {"model": "core.auditevent", "pk": 1515, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "687", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 122}, "timestamp": "2026-01-27T11:33:49.810Z"}}, {"model": "core.auditevent", "pk": 1517, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "688", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 123}, "timestamp": "2026-01-27T11:33:49.820Z"}}, {"model": "core.auditevent", "pk": 1519, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "689", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 124}, "timestamp": "2026-01-27T11:33:49.832Z"}}, {"model": "core.auditevent", "pk": 1521, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "690", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 125}, "timestamp": "2026-01-27T11:33:49.843Z"}}, {"model": "core.auditevent", "pk": 1523, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "691", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 126}, "timestamp": "2026-01-27T11:33:49.854Z"}}, {"model": "core.auditevent", "pk": 1525, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "692", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 127}, "timestamp": "2026-01-27T11:33:49.865Z"}}, {"model": "core.auditevent", "pk": 1527, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "693", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 128}, "timestamp": "2026-01-27T11:33:49.875Z"}}, {"model": "core.auditevent", "pk": 1529, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "694", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 129}, "timestamp": "2026-01-27T11:33:49.886Z"}}, {"model": "core.auditevent", "pk": 1531, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "695", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 132}, "timestamp": "2026-01-27T11:33:49.900Z"}}, {"model": "core.auditevent", "pk": 1533, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "696", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 133}, "timestamp": "2026-01-27T11:33:49.910Z"}}, {"model": "core.auditevent", "pk": 1535, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "697", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 134}, "timestamp": "2026-01-27T11:33:49.922Z"}}, {"model": "core.auditevent", "pk": 1537, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "698", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 135}, "timestamp": "2026-01-27T11:33:49.934Z"}}, {"model": "core.auditevent", "pk": 1539, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "699", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 136}, "timestamp": "2026-01-27T11:33:49.945Z"}}, {"model": "core.auditevent", "pk": 1541, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "700", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 137}, "timestamp": "2026-01-27T11:33:49.956Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\confirmation.json
```json
[{"model": "core.confirmation", "pk": 111, "fields": {"created_at": "2026-01-27T11:30:15.930Z", "updated_at": "2026-01-27T11:30:15.930Z", "parish": 1, "assignment": 684, "status": "pending", "notes": "", "updated_by": null, "timestamp": "2026-01-27T11:30:15.931Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\future_assignment_active.json
```json
[{"model": "core.assignment", "pk": 684, "fields": {"created_at": "2026-01-27T11:30:15.926Z", "updated_at": "2026-01-27T11:30:15.926Z", "parish": 1, "slot": 45, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:30:15.926Z", "assignment_state": "published", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 617, "fields": {"created_at": "2026-01-27T11:15:02.371Z", "updated_at": "2026-01-27T11:17:23.635Z", "parish": 1, "slot": 120, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.371Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.635Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 635, "fields": {"created_at": "2026-01-27T11:17:23.639Z", "updated_at": "2026-01-27T11:17:23.915Z", "parish": 1, "slot": 120, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.639Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.915Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 653, "fields": {"created_at": "2026-01-27T11:17:23.918Z", "updated_at": "2026-01-27T11:29:48.174Z", "parish": 1, "slot": 120, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.918Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.174Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 668, "fields": {"created_at": "2026-01-27T11:29:48.177Z", "updated_at": "2026-01-27T11:33:49.781Z", "parish": 1, "slot": 120, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.177Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.781Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 685, "fields": {"created_at": "2026-01-27T11:33:49.785Z", "updated_at": "2026-01-27T11:33:49.785Z", "parish": 1, "slot": 120, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.785Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 618, "fields": {"created_at": "2026-01-27T11:15:02.384Z", "updated_at": "2026-01-27T11:17:23.646Z", "parish": 1, "slot": 121, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.384Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.646Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 636, "fields": {"created_at": "2026-01-27T11:17:23.649Z", "updated_at": "2026-01-27T11:17:23.925Z", "parish": 1, "slot": 121, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.649Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.925Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 654, "fields": {"created_at": "2026-01-27T11:17:23.928Z", "updated_at": "2026-01-27T11:29:48.185Z", "parish": 1, "slot": 121, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.928Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.185Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 669, "fields": {"created_at": "2026-01-27T11:29:48.190Z", "updated_at": "2026-01-27T11:33:49.795Z", "parish": 1, "slot": 121, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.190Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.795Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 686, "fields": {"created_at": "2026-01-27T11:33:49.798Z", "updated_at": "2026-01-27T11:33:49.798Z", "parish": 1, "slot": 121, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.798Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 619, "fields": {"created_at": "2026-01-27T11:15:02.393Z", "updated_at": "2026-01-27T11:17:23.656Z", "parish": 1, "slot": 122, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.393Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.656Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 637, "fields": {"created_at": "2026-01-27T11:17:23.659Z", "updated_at": "2026-01-27T11:17:23.935Z", "parish": 1, "slot": 122, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.659Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.935Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 655, "fields": {"created_at": "2026-01-27T11:17:23.938Z", "updated_at": "2026-01-27T11:29:48.198Z", "parish": 1, "slot": 122, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.938Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.198Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 670, "fields": {"created_at": "2026-01-27T11:29:48.202Z", "updated_at": "2026-01-27T11:33:49.807Z", "parish": 1, "slot": 122, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.202Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.807Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 687, "fields": {"created_at": "2026-01-27T11:33:49.810Z", "updated_at": "2026-01-27T11:33:49.810Z", "parish": 1, "slot": 122, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.810Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 620, "fields": {"created_at": "2026-01-27T11:15:02.404Z", "updated_at": "2026-01-27T11:17:23.665Z", "parish": 1, "slot": 123, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.404Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.665Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 638, "fields": {"created_at": "2026-01-27T11:17:23.668Z", "updated_at": "2026-01-27T11:17:23.945Z", "parish": 1, "slot": 123, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.668Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.945Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 656, "fields": {"created_at": "2026-01-27T11:17:23.949Z", "updated_at": "2026-01-27T11:29:48.209Z", "parish": 1, "slot": 123, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.949Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.209Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 671, "fields": {"created_at": "2026-01-27T11:29:48.212Z", "updated_at": "2026-01-27T11:33:49.817Z", "parish": 1, "slot": 123, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.212Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.817Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 688, "fields": {"created_at": "2026-01-27T11:33:49.820Z", "updated_at": "2026-01-27T11:33:49.820Z", "parish": 1, "slot": 123, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.820Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 621, "fields": {"created_at": "2026-01-27T11:15:02.415Z", "updated_at": "2026-01-27T11:17:23.675Z", "parish": 1, "slot": 124, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.415Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.675Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 639, "fields": {"created_at": "2026-01-27T11:17:23.678Z", "updated_at": "2026-01-27T11:17:23.956Z", "parish": 1, "slot": 124, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.678Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.956Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 657, "fields": {"created_at": "2026-01-27T11:17:23.959Z", "updated_at": "2026-01-27T11:29:48.219Z", "parish": 1, "slot": 124, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.960Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.219Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 672, "fields": {"created_at": "2026-01-27T11:29:48.223Z", "updated_at": "2026-01-27T11:33:49.828Z", "parish": 1, "slot": 124, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.223Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.828Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 689, "fields": {"created_at": "2026-01-27T11:33:49.831Z", "updated_at": "2026-01-27T11:33:49.831Z", "parish": 1, "slot": 124, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.831Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 622, "fields": {"created_at": "2026-01-27T11:15:02.425Z", "updated_at": "2026-01-27T11:17:23.686Z", "parish": 1, "slot": 125, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.425Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.686Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 640, "fields": {"created_at": "2026-01-27T11:17:23.689Z", "updated_at": "2026-01-27T11:17:23.967Z", "parish": 1, "slot": 125, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.689Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.966Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 658, "fields": {"created_at": "2026-01-27T11:17:23.969Z", "updated_at": "2026-01-27T11:29:48.232Z", "parish": 1, "slot": 125, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.969Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.232Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 673, "fields": {"created_at": "2026-01-27T11:29:48.235Z", "updated_at": "2026-01-27T11:33:49.840Z", "parish": 1, "slot": 125, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.235Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.840Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 690, "fields": {"created_at": "2026-01-27T11:33:49.843Z", "updated_at": "2026-01-27T11:33:49.843Z", "parish": 1, "slot": 125, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.843Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 623, "fields": {"created_at": "2026-01-27T11:15:02.434Z", "updated_at": "2026-01-27T11:17:23.696Z", "parish": 1, "slot": 126, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.434Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.696Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 641, "fields": {"created_at": "2026-01-27T11:17:23.700Z", "updated_at": "2026-01-27T11:17:23.977Z", "parish": 1, "slot": 126, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.700Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.977Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 659, "fields": {"created_at": "2026-01-27T11:17:23.979Z", "updated_at": "2026-01-27T11:29:48.244Z", "parish": 1, "slot": 126, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.980Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.244Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 674, "fields": {"created_at": "2026-01-27T11:29:48.247Z", "updated_at": "2026-01-27T11:33:49.850Z", "parish": 1, "slot": 126, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.247Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.850Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 691, "fields": {"created_at": "2026-01-27T11:33:49.854Z", "updated_at": "2026-01-27T11:33:49.854Z", "parish": 1, "slot": 126, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.854Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 624, "fields": {"created_at": "2026-01-27T11:15:02.444Z", "updated_at": "2026-01-27T11:17:23.707Z", "parish": 1, "slot": 127, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.444Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.707Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 642, "fields": {"created_at": "2026-01-27T11:17:23.710Z", "updated_at": "2026-01-27T11:17:23.987Z", "parish": 1, "slot": 127, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.710Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.987Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 660, "fields": {"created_at": "2026-01-27T11:17:23.991Z", "updated_at": "2026-01-27T11:29:48.254Z", "parish": 1, "slot": 127, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.991Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.254Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 675, "fields": {"created_at": "2026-01-27T11:29:48.258Z", "updated_at": "2026-01-27T11:33:49.862Z", "parish": 1, "slot": 127, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.258Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.862Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 692, "fields": {"created_at": "2026-01-27T11:33:49.865Z", "updated_at": "2026-01-27T11:33:49.865Z", "parish": 1, "slot": 127, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.865Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 625, "fields": {"created_at": "2026-01-27T11:15:02.453Z", "updated_at": "2026-01-27T11:17:23.717Z", "parish": 1, "slot": 128, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.453Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.716Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 643, "fields": {"created_at": "2026-01-27T11:17:23.720Z", "updated_at": "2026-01-27T11:29:48.266Z", "parish": 1, "slot": 128, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.720Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.266Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 676, "fields": {"created_at": "2026-01-27T11:29:48.270Z", "updated_at": "2026-01-27T11:33:49.872Z", "parish": 1, "slot": 128, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.270Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.872Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 693, "fields": {"created_at": "2026-01-27T11:33:49.875Z", "updated_at": "2026-01-27T11:33:49.875Z", "parish": 1, "slot": 128, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.875Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 626, "fields": {"created_at": "2026-01-27T11:15:02.463Z", "updated_at": "2026-01-27T11:17:23.730Z", "parish": 1, "slot": 129, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.463Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.730Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 644, "fields": {"created_at": "2026-01-27T11:17:23.733Z", "updated_at": "2026-01-27T11:17:23.999Z", "parish": 1, "slot": 129, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.733Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.999Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 661, "fields": {"created_at": "2026-01-27T11:17:24.002Z", "updated_at": "2026-01-27T11:29:48.277Z", "parish": 1, "slot": 129, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:17:24.002Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.277Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 677, "fields": {"created_at": "2026-01-27T11:29:48.282Z", "updated_at": "2026-01-27T11:33:49.882Z", "parish": 1, "slot": 129, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.282Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.882Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 694, "fields": {"created_at": "2026-01-27T11:33:49.886Z", "updated_at": "2026-01-27T11:33:49.886Z", "parish": 1, "slot": 129, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.886Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 627, "fields": {"created_at": "2026-01-27T11:15:02.474Z", "updated_at": "2026-01-27T11:17:23.740Z", "parish": 1, "slot": 130, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.474Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.740Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 645, "fields": {"created_at": "2026-01-27T11:17:23.743Z", "updated_at": "2026-01-27T11:17:23.743Z", "parish": 1, "slot": 130, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.743Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 628, "fields": {"created_at": "2026-01-27T11:15:02.483Z", "updated_at": "2026-01-27T11:17:23.750Z", "parish": 1, "slot": 131, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.483Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.750Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 646, "fields": {"created_at": "2026-01-27T11:17:23.753Z", "updated_at": "2026-01-27T11:17:23.753Z", "parish": 1, "slot": 131, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.753Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 629, "fields": {"created_at": "2026-01-27T11:15:02.492Z", "updated_at": "2026-01-27T11:17:23.762Z", "parish": 1, "slot": 132, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.492Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.762Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 647, "fields": {"created_at": "2026-01-27T11:17:23.765Z", "updated_at": "2026-01-27T11:17:24.012Z", "parish": 1, "slot": 132, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.765Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:24.012Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 662, "fields": {"created_at": "2026-01-27T11:17:24.015Z", "updated_at": "2026-01-27T11:29:48.292Z", "parish": 1, "slot": 132, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:17:24.015Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.292Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 678, "fields": {"created_at": "2026-01-27T11:29:48.297Z", "updated_at": "2026-01-27T11:33:49.896Z", "parish": 1, "slot": 132, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.297Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.896Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 695, "fields": {"created_at": "2026-01-27T11:33:49.899Z", "updated_at": "2026-01-27T11:33:49.899Z", "parish": 1, "slot": 132, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.899Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 630, "fields": {"created_at": "2026-01-27T11:15:02.500Z", "updated_at": "2026-01-27T11:17:23.771Z", "parish": 1, "slot": 133, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.500Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.771Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 648, "fields": {"created_at": "2026-01-27T11:17:23.775Z", "updated_at": "2026-01-27T11:17:24.024Z", "parish": 1, "slot": 133, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.775Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:24.024Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 663, "fields": {"created_at": "2026-01-27T11:17:24.028Z", "updated_at": "2026-01-27T11:29:48.307Z", "parish": 1, "slot": 133, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:17:24.028Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.307Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 679, "fields": {"created_at": "2026-01-27T11:29:48.311Z", "updated_at": "2026-01-27T11:33:49.906Z", "parish": 1, "slot": 133, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.312Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.906Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 696, "fields": {"created_at": "2026-01-27T11:33:49.910Z", "updated_at": "2026-01-27T11:33:49.910Z", "parish": 1, "slot": 133, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.910Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 631, "fields": {"created_at": "2026-01-27T11:15:02.510Z", "updated_at": "2026-01-27T11:17:23.780Z", "parish": 1, "slot": 134, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.510Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.780Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 649, "fields": {"created_at": "2026-01-27T11:17:23.783Z", "updated_at": "2026-01-27T11:17:24.037Z", "parish": 1, "slot": 134, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.783Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:24.037Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 664, "fields": {"created_at": "2026-01-27T11:17:24.040Z", "updated_at": "2026-01-27T11:29:48.319Z", "parish": 1, "slot": 134, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:17:24.040Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.319Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 680, "fields": {"created_at": "2026-01-27T11:29:48.323Z", "updated_at": "2026-01-27T11:33:49.919Z", "parish": 1, "slot": 134, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.323Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.919Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 697, "fields": {"created_at": "2026-01-27T11:33:49.922Z", "updated_at": "2026-01-27T11:33:49.922Z", "parish": 1, "slot": 134, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.922Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 632, "fields": {"created_at": "2026-01-27T11:15:02.519Z", "updated_at": "2026-01-27T11:17:23.790Z", "parish": 1, "slot": 135, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.519Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.790Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 650, "fields": {"created_at": "2026-01-27T11:17:23.793Z", "updated_at": "2026-01-27T11:17:24.047Z", "parish": 1, "slot": 135, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.793Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:24.047Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 665, "fields": {"created_at": "2026-01-27T11:17:24.050Z", "updated_at": "2026-01-27T11:29:48.330Z", "parish": 1, "slot": 135, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T11:17:24.050Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.330Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 681, "fields": {"created_at": "2026-01-27T11:29:48.333Z", "updated_at": "2026-01-27T11:33:49.930Z", "parish": 1, "slot": 135, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.333Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.930Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 698, "fields": {"created_at": "2026-01-27T11:33:49.934Z", "updated_at": "2026-01-27T11:33:49.934Z", "parish": 1, "slot": 135, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.934Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 633, "fields": {"created_at": "2026-01-27T11:15:02.530Z", "updated_at": "2026-01-27T11:17:23.800Z", "parish": 1, "slot": 136, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.530Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.800Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 651, "fields": {"created_at": "2026-01-27T11:17:23.803Z", "updated_at": "2026-01-27T11:17:24.058Z", "parish": 1, "slot": 136, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.803Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:24.058Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 666, "fields": {"created_at": "2026-01-27T11:17:24.061Z", "updated_at": "2026-01-27T11:29:48.342Z", "parish": 1, "slot": 136, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:17:24.061Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.342Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 682, "fields": {"created_at": "2026-01-27T11:29:48.346Z", "updated_at": "2026-01-27T11:33:49.941Z", "parish": 1, "slot": 136, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.346Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.941Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 699, "fields": {"created_at": "2026-01-27T11:33:49.944Z", "updated_at": "2026-01-27T11:33:49.944Z", "parish": 1, "slot": 136, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.944Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 634, "fields": {"created_at": "2026-01-27T11:15:02.540Z", "updated_at": "2026-01-27T11:17:23.810Z", "parish": 1, "slot": 137, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:15:02.540Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:23.810Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 652, "fields": {"created_at": "2026-01-27T11:17:23.812Z", "updated_at": "2026-01-27T11:17:24.068Z", "parish": 1, "slot": 137, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:17:23.812Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:17:24.068Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 667, "fields": {"created_at": "2026-01-27T11:17:24.071Z", "updated_at": "2026-01-27T11:29:48.355Z", "parish": 1, "slot": 137, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:17:24.071Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:29:48.355Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 683, "fields": {"created_at": "2026-01-27T11:29:48.359Z", "updated_at": "2026-01-27T11:33:49.952Z", "parish": 1, "slot": 137, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T11:29:48.359Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:33:49.952Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 700, "fields": {"created_at": "2026-01-27T11:33:49.955Z", "updated_at": "2026-01-27T11:33:49.955Z", "parish": 1, "slot": 137, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:33:49.955Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\massinterest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\massoverride.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\past_assignment.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\past_assignmentslot.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\past_massinstance.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\positionclaimrequest.json
```json
[{"model": "core.positionclaimrequest", "pk": 8, "fields": {"created_at": "2026-01-26T06:13:52.739Z", "updated_at": "2026-01-27T08:16:48.744Z", "parish": 1, "slot": 3, "requestor_acolyte": 3, "target_assignment": null, "status": "expired", "approval_mode": "", "resolution_reason": "assignment_changed", "auto_approve_at": "2026-02-05T20:00:00Z", "resolved_at": "2026-01-27T08:16:48.744Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 5, "fields": {"created_at": "2026-01-25T21:13:54.694Z", "updated_at": "2026-01-25T21:31:57.274Z", "parish": 1, "slot": 12, "requestor_acolyte": 1, "target_assignment": null, "status": "expired", "approval_mode": "coordination", "resolution_reason": "holder_confirmed", "auto_approve_at": null, "resolved_at": "2026-01-25T21:31:57.274Z", "approved_by": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\replacementrequest.json
```json
[{"model": "core.replacementrequest", "pk": 11, "fields": {"created_at": "2026-01-26T03:52:46.710Z", "updated_at": "2026-01-26T03:52:46.776Z", "parish": 1, "slot": 2, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 12, "fields": {"created_at": "2026-01-26T03:55:01.453Z", "updated_at": "2026-01-26T03:55:01.526Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 13, "fields": {"created_at": "2026-01-26T03:56:22.179Z", "updated_at": "2026-01-26T03:56:22.339Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 16, "fields": {"created_at": "2026-01-27T03:38:03.289Z", "updated_at": "2026-01-27T03:38:03.289Z", "parish": 1, "slot": 17, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 14, "fields": {"created_at": "2026-01-26T03:56:36.974Z", "updated_at": "2026-01-26T03:56:37.048Z", "parish": 1, "slot": 20, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 9, "fields": {"created_at": "2026-01-25T18:10:45.171Z", "updated_at": "2026-01-25T18:10:45.229Z", "parish": 1, "slot": 23, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 15, "fields": {"created_at": "2026-01-27T03:38:03.253Z", "updated_at": "2026-01-27T03:38:03.253Z", "parish": 1, "slot": 29, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 8, "fields": {"created_at": "2026-01-25T18:09:03.950Z", "updated_at": "2026-01-25T18:09:04.009Z", "parish": 1, "slot": 34, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 17, "fields": {"created_at": "2026-01-27T03:38:03.326Z", "updated_at": "2026-01-27T03:38:03.326Z", "parish": 1, "slot": 35, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 7, "fields": {"created_at": "2026-01-25T18:08:53.446Z", "updated_at": "2026-01-25T18:08:53.518Z", "parish": 1, "slot": 45, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 4, "fields": {"created_at": "2026-01-23T11:40:58.132Z", "updated_at": "2026-01-23T11:40:58.133Z", "parish": 1, "slot": 51, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 5, "fields": {"created_at": "2026-01-23T11:41:55.885Z", "updated_at": "2026-01-23T11:41:55.885Z", "parish": 1, "slot": 107, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\serializers\swaprequest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083429\meta.json
```json
{
  "created_at": "2026-01-27T08:34:29.719280-03:00",
  "cutoff_date": "2026-01-27",
  "counts": {
    "past_masses": 0,
    "past_slots": 0,
    "past_assignments": 0,
    "future_assignments_total": 84,
    "confirmations": 1,
    "claims": 2,
    "replacement_requests": 12,
    "swap_requests": 0,
    "mass_interest": 0,
    "mass_override": 0,
    "ledger_rows": 0,
    "audit_events": 150
  },
  "models_included": [
    "core.MassInstance",
    "core.AssignmentSlot",
    "core.Assignment",
    "core.Confirmation",
    "core.PositionClaimRequest",
    "core.ReplacementRequest",
    "core.SwapRequest",
    "core.MassInterest",
    "core.MassOverride",
    "core.AcolyteCreditLedger",
    "core.AuditEvent"
  ]
}
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\acolytecreditledger.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\auditevent.json
```json
[{"model": "core.auditevent", "pk": 1542, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "701", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 120}, "timestamp": "2026-01-27T11:35:31.655Z"}}, {"model": "core.auditevent", "pk": 1615, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "701", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 120}, "timestamp": "2026-01-27T11:35:59.874Z"}}, {"model": "core.auditevent", "pk": 1543, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "702", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 121}, "timestamp": "2026-01-27T11:35:31.666Z"}}, {"model": "core.auditevent", "pk": 1617, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "702", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 121}, "timestamp": "2026-01-27T11:35:59.921Z"}}, {"model": "core.auditevent", "pk": 1544, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "703", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 122}, "timestamp": "2026-01-27T11:35:31.676Z"}}, {"model": "core.auditevent", "pk": 1619, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "703", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 122}, "timestamp": "2026-01-27T11:35:59.971Z"}}, {"model": "core.auditevent", "pk": 1545, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "704", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 123}, "timestamp": "2026-01-27T11:35:31.686Z"}}, {"model": "core.auditevent", "pk": 1621, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "704", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 123}, "timestamp": "2026-01-27T11:36:00.017Z"}}, {"model": "core.auditevent", "pk": 1546, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "705", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 124}, "timestamp": "2026-01-27T11:35:31.696Z"}}, {"model": "core.auditevent", "pk": 1623, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "705", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 124}, "timestamp": "2026-01-27T11:36:00.070Z"}}, {"model": "core.auditevent", "pk": 1547, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "706", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 125}, "timestamp": "2026-01-27T11:35:31.706Z"}}, {"model": "core.auditevent", "pk": 1625, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "706", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 125}, "timestamp": "2026-01-27T11:36:00.112Z"}}, {"model": "core.auditevent", "pk": 1548, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "707", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 126}, "timestamp": "2026-01-27T11:35:31.716Z"}}, {"model": "core.auditevent", "pk": 1627, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "707", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 126}, "timestamp": "2026-01-27T11:36:00.161Z"}}, {"model": "core.auditevent", "pk": 1549, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "708", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 127}, "timestamp": "2026-01-27T11:35:31.727Z"}}, {"model": "core.auditevent", "pk": 1629, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "708", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 127}, "timestamp": "2026-01-27T11:36:00.206Z"}}, {"model": "core.auditevent", "pk": 1550, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "709", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 128}, "timestamp": "2026-01-27T11:35:31.737Z"}}, {"model": "core.auditevent", "pk": 1631, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "709", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 128}, "timestamp": "2026-01-27T11:36:00.254Z"}}, {"model": "core.auditevent", "pk": 1551, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "710", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 129}, "timestamp": "2026-01-27T11:35:31.748Z"}}, {"model": "core.auditevent", "pk": 1633, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "710", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 129}, "timestamp": "2026-01-27T11:36:00.301Z"}}, {"model": "core.auditevent", "pk": 1552, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "711", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 130}, "timestamp": "2026-01-27T11:35:31.758Z"}}, {"model": "core.auditevent", "pk": 1635, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "711", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 130}, "timestamp": "2026-01-27T11:36:00.346Z"}}, {"model": "core.auditevent", "pk": 1553, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "712", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 131}, "timestamp": "2026-01-27T11:35:31.769Z"}}, {"model": "core.auditevent", "pk": 1637, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "712", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 131}, "timestamp": "2026-01-27T11:36:00.392Z"}}, {"model": "core.auditevent", "pk": 1554, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "713", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 132}, "timestamp": "2026-01-27T11:35:31.777Z"}}, {"model": "core.auditevent", "pk": 1639, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "713", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 132}, "timestamp": "2026-01-27T11:36:00.437Z"}}, {"model": "core.auditevent", "pk": 1555, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "714", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 133}, "timestamp": "2026-01-27T11:35:31.785Z"}}, {"model": "core.auditevent", "pk": 1641, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "714", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 133}, "timestamp": "2026-01-27T11:36:00.486Z"}}, {"model": "core.auditevent", "pk": 1556, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "715", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 134}, "timestamp": "2026-01-27T11:35:31.793Z"}}, {"model": "core.auditevent", "pk": 1643, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "715", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 134}, "timestamp": "2026-01-27T11:36:00.531Z"}}, {"model": "core.auditevent", "pk": 1557, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "716", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 135}, "timestamp": "2026-01-27T11:35:31.802Z"}}, {"model": "core.auditevent", "pk": 1645, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "716", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 135}, "timestamp": "2026-01-27T11:36:00.579Z"}}, {"model": "core.auditevent", "pk": 1558, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "717", "action_type": "create", "diff_json": {"acolyte_id": 5, "slot_id": 136}, "timestamp": "2026-01-27T11:35:31.812Z"}}, {"model": "core.auditevent", "pk": 1647, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "717", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 136}, "timestamp": "2026-01-27T11:36:00.625Z"}}, {"model": "core.auditevent", "pk": 1559, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "718", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 137}, "timestamp": "2026-01-27T11:35:31.819Z"}}, {"model": "core.auditevent", "pk": 1649, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "718", "action_type": "deactivate", "diff_json": {"reason": "replaced_by_solver", "slot_id": 137}, "timestamp": "2026-01-27T11:36:00.672Z"}}, {"model": "core.auditevent", "pk": 1560, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "719", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 2}, "timestamp": "2026-01-27T11:35:58.184Z"}}, {"model": "core.auditevent", "pk": 1561, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "720", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 3}, "timestamp": "2026-01-27T11:35:58.202Z"}}, {"model": "core.auditevent", "pk": 1562, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "721", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 4}, "timestamp": "2026-01-27T11:35:58.220Z"}}, {"model": "core.auditevent", "pk": 1563, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "722", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 5}, "timestamp": "2026-01-27T11:35:58.233Z"}}, {"model": "core.auditevent", "pk": 1564, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "723", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 6}, "timestamp": "2026-01-27T11:35:58.248Z"}}, {"model": "core.auditevent", "pk": 1565, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "724", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 7}, "timestamp": "2026-01-27T11:35:58.263Z"}}, {"model": "core.auditevent", "pk": 1566, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "725", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 8}, "timestamp": "2026-01-27T11:35:58.281Z"}}, {"model": "core.auditevent", "pk": 1567, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "726", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 9}, "timestamp": "2026-01-27T11:35:58.297Z"}}, {"model": "core.auditevent", "pk": 1568, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "727", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 11}, "timestamp": "2026-01-27T11:35:58.313Z"}}, {"model": "core.auditevent", "pk": 1569, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "728", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 12}, "timestamp": "2026-01-27T11:35:58.327Z"}}, {"model": "core.auditevent", "pk": 1570, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "729", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 13}, "timestamp": "2026-01-27T11:35:58.344Z"}}, {"model": "core.auditevent", "pk": 1571, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "730", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 14}, "timestamp": "2026-01-27T11:35:58.363Z"}}, {"model": "core.auditevent", "pk": 1572, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "731", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 15}, "timestamp": "2026-01-27T11:35:58.377Z"}}, {"model": "core.auditevent", "pk": 1573, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "732", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 16}, "timestamp": "2026-01-27T11:35:58.389Z"}}, {"model": "core.auditevent", "pk": 1574, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "733", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 17}, "timestamp": "2026-01-27T11:35:58.400Z"}}, {"model": "core.auditevent", "pk": 1575, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "734", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 18}, "timestamp": "2026-01-27T11:35:58.416Z"}}, {"model": "core.auditevent", "pk": 1576, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "735", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 20}, "timestamp": "2026-01-27T11:35:58.432Z"}}, {"model": "core.auditevent", "pk": 1577, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "736", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 21}, "timestamp": "2026-01-27T11:35:58.446Z"}}, {"model": "core.auditevent", "pk": 1578, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "737", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 22}, "timestamp": "2026-01-27T11:35:58.462Z"}}, {"model": "core.auditevent", "pk": 1579, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "738", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 23}, "timestamp": "2026-01-27T11:35:58.476Z"}}, {"model": "core.auditevent", "pk": 1580, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "739", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 24}, "timestamp": "2026-01-27T11:35:58.490Z"}}, {"model": "core.auditevent", "pk": 1581, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "740", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 25}, "timestamp": "2026-01-27T11:35:58.513Z"}}, {"model": "core.auditevent", "pk": 1582, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "741", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 26}, "timestamp": "2026-01-27T11:35:58.522Z"}}, {"model": "core.auditevent", "pk": 1583, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "742", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 27}, "timestamp": "2026-01-27T11:35:58.533Z"}}, {"model": "core.auditevent", "pk": 1584, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "743", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 29}, "timestamp": "2026-01-27T11:35:58.546Z"}}, {"model": "core.auditevent", "pk": 1585, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "744", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 30}, "timestamp": "2026-01-27T11:35:58.599Z"}}, {"model": "core.auditevent", "pk": 1586, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "745", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 31}, "timestamp": "2026-01-27T11:35:58.644Z"}}, {"model": "core.auditevent", "pk": 1587, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "746", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 32}, "timestamp": "2026-01-27T11:35:58.682Z"}}, {"model": "core.auditevent", "pk": 1588, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "747", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 33}, "timestamp": "2026-01-27T11:35:58.724Z"}}, {"model": "core.auditevent", "pk": 1589, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "748", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 34}, "timestamp": "2026-01-27T11:35:58.761Z"}}, {"model": "core.auditevent", "pk": 1590, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "749", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 35}, "timestamp": "2026-01-27T11:35:58.805Z"}}, {"model": "core.auditevent", "pk": 1591, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "750", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 37}, "timestamp": "2026-01-27T11:35:58.835Z"}}, {"model": "core.auditevent", "pk": 1592, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "751", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 39}, "timestamp": "2026-01-27T11:35:58.884Z"}}, {"model": "core.auditevent", "pk": 1593, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "752", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 40}, "timestamp": "2026-01-27T11:35:58.927Z"}}, {"model": "core.auditevent", "pk": 1594, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "753", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 41}, "timestamp": "2026-01-27T11:35:58.967Z"}}, {"model": "core.auditevent", "pk": 1595, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "754", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 42}, "timestamp": "2026-01-27T11:35:59.012Z"}}, {"model": "core.auditevent", "pk": 1596, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "755", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 43}, "timestamp": "2026-01-27T11:35:59.045Z"}}, {"model": "core.auditevent", "pk": 1597, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "756", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 45}, "timestamp": "2026-01-27T11:35:59.093Z"}}, {"model": "core.auditevent", "pk": 1598, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "757", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 46}, "timestamp": "2026-01-27T11:35:59.136Z"}}, {"model": "core.auditevent", "pk": 1599, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "758", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 47}, "timestamp": "2026-01-27T11:35:59.175Z"}}, {"model": "core.auditevent", "pk": 1600, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "759", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 48}, "timestamp": "2026-01-27T11:35:59.247Z"}}, {"model": "core.auditevent", "pk": 1601, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "760", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 49}, "timestamp": "2026-01-27T11:35:59.294Z"}}, {"model": "core.auditevent", "pk": 1602, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "761", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 50}, "timestamp": "2026-01-27T11:35:59.340Z"}}, {"model": "core.auditevent", "pk": 1603, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "762", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 51}, "timestamp": "2026-01-27T11:35:59.383Z"}}, {"model": "core.auditevent", "pk": 1604, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "763", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 53}, "timestamp": "2026-01-27T11:35:59.429Z"}}, {"model": "core.auditevent", "pk": 1605, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "764", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 54}, "timestamp": "2026-01-27T11:35:59.464Z"}}, {"model": "core.auditevent", "pk": 1606, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "765", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 55}, "timestamp": "2026-01-27T11:35:59.509Z"}}, {"model": "core.auditevent", "pk": 1607, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "766", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 56}, "timestamp": "2026-01-27T11:35:59.546Z"}}, {"model": "core.auditevent", "pk": 1608, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "767", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 57}, "timestamp": "2026-01-27T11:35:59.590Z"}}, {"model": "core.auditevent", "pk": 1609, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "768", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 58}, "timestamp": "2026-01-27T11:35:59.633Z"}}, {"model": "core.auditevent", "pk": 1610, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "769", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 59}, "timestamp": "2026-01-27T11:35:59.666Z"}}, {"model": "core.auditevent", "pk": 1611, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "770", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 97}, "timestamp": "2026-01-27T11:35:59.711Z"}}, {"model": "core.auditevent", "pk": 1612, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "771", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 98}, "timestamp": "2026-01-27T11:35:59.752Z"}}, {"model": "core.auditevent", "pk": 1613, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "772", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 99}, "timestamp": "2026-01-27T11:35:59.791Z"}}, {"model": "core.auditevent", "pk": 1614, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "773", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 100}, "timestamp": "2026-01-27T11:35:59.835Z"}}, {"model": "core.auditevent", "pk": 1616, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "774", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 120}, "timestamp": "2026-01-27T11:35:59.877Z"}}, {"model": "core.auditevent", "pk": 1618, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "775", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 121}, "timestamp": "2026-01-27T11:35:59.924Z"}}, {"model": "core.auditevent", "pk": 1620, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "776", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 122}, "timestamp": "2026-01-27T11:35:59.974Z"}}, {"model": "core.auditevent", "pk": 1622, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "777", "action_type": "create", "diff_json": {"acolyte_id": 3, "slot_id": 123}, "timestamp": "2026-01-27T11:36:00.021Z"}}, {"model": "core.auditevent", "pk": 1624, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "778", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 124}, "timestamp": "2026-01-27T11:36:00.073Z"}}, {"model": "core.auditevent", "pk": 1626, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "779", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 125}, "timestamp": "2026-01-27T11:36:00.114Z"}}, {"model": "core.auditevent", "pk": 1628, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "780", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 126}, "timestamp": "2026-01-27T11:36:00.165Z"}}, {"model": "core.auditevent", "pk": 1630, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "781", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 127}, "timestamp": "2026-01-27T11:36:00.210Z"}}, {"model": "core.auditevent", "pk": 1632, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "782", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 128}, "timestamp": "2026-01-27T11:36:00.259Z"}}, {"model": "core.auditevent", "pk": 1634, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "783", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 129}, "timestamp": "2026-01-27T11:36:00.304Z"}}, {"model": "core.auditevent", "pk": 1636, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "784", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 130}, "timestamp": "2026-01-27T11:36:00.348Z"}}, {"model": "core.auditevent", "pk": 1638, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "785", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 131}, "timestamp": "2026-01-27T11:36:00.395Z"}}, {"model": "core.auditevent", "pk": 1640, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "786", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 132}, "timestamp": "2026-01-27T11:36:00.440Z"}}, {"model": "core.auditevent", "pk": 1642, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "787", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 133}, "timestamp": "2026-01-27T11:36:00.490Z"}}, {"model": "core.auditevent", "pk": 1644, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "788", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 134}, "timestamp": "2026-01-27T11:36:00.534Z"}}, {"model": "core.auditevent", "pk": 1646, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "789", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 135}, "timestamp": "2026-01-27T11:36:00.582Z"}}, {"model": "core.auditevent", "pk": 1648, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "790", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 136}, "timestamp": "2026-01-27T11:36:00.628Z"}}, {"model": "core.auditevent", "pk": 1650, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "791", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 137}, "timestamp": "2026-01-27T11:36:00.675Z"}}, {"model": "core.auditevent", "pk": 1651, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "792", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 144}, "timestamp": "2026-01-27T11:36:00.715Z"}}, {"model": "core.auditevent", "pk": 1652, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "793", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 145}, "timestamp": "2026-01-27T11:36:00.762Z"}}, {"model": "core.auditevent", "pk": 1653, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "794", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 146}, "timestamp": "2026-01-27T11:36:02.333Z"}}, {"model": "core.auditevent", "pk": 1654, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "795", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 147}, "timestamp": "2026-01-27T11:36:02.379Z"}}, {"model": "core.auditevent", "pk": 1655, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "796", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 148}, "timestamp": "2026-01-27T11:36:02.410Z"}}, {"model": "core.auditevent", "pk": 1656, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "797", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 149}, "timestamp": "2026-01-27T11:36:02.444Z"}}, {"model": "core.auditevent", "pk": 1657, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "798", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 150}, "timestamp": "2026-01-27T11:36:02.489Z"}}, {"model": "core.auditevent", "pk": 1658, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "799", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 151}, "timestamp": "2026-01-27T11:36:02.538Z"}}, {"model": "core.auditevent", "pk": 1659, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "800", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 152}, "timestamp": "2026-01-27T11:36:02.584Z"}}, {"model": "core.auditevent", "pk": 1660, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "801", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 153}, "timestamp": "2026-01-27T11:36:02.630Z"}}, {"model": "core.auditevent", "pk": 1661, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "802", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 154}, "timestamp": "2026-01-27T11:36:02.676Z"}}, {"model": "core.auditevent", "pk": 1662, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "803", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 155}, "timestamp": "2026-01-27T11:36:02.723Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\confirmation.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\future_assignment_active.json
```json
[{"model": "core.assignment", "pk": 719, "fields": {"created_at": "2026-01-27T11:35:58.180Z", "updated_at": "2026-01-27T11:35:58.180Z", "parish": 1, "slot": 2, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.180Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 720, "fields": {"created_at": "2026-01-27T11:35:58.199Z", "updated_at": "2026-01-27T11:35:58.199Z", "parish": 1, "slot": 3, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.199Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 721, "fields": {"created_at": "2026-01-27T11:35:58.217Z", "updated_at": "2026-01-27T11:35:58.217Z", "parish": 1, "slot": 4, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.217Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 722, "fields": {"created_at": "2026-01-27T11:35:58.231Z", "updated_at": "2026-01-27T11:35:58.231Z", "parish": 1, "slot": 5, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.231Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 723, "fields": {"created_at": "2026-01-27T11:35:58.246Z", "updated_at": "2026-01-27T11:35:58.246Z", "parish": 1, "slot": 6, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.246Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 724, "fields": {"created_at": "2026-01-27T11:35:58.261Z", "updated_at": "2026-01-27T11:35:58.261Z", "parish": 1, "slot": 7, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.261Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 725, "fields": {"created_at": "2026-01-27T11:35:58.278Z", "updated_at": "2026-01-27T11:35:58.278Z", "parish": 1, "slot": 8, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.278Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 726, "fields": {"created_at": "2026-01-27T11:35:58.294Z", "updated_at": "2026-01-27T11:35:58.294Z", "parish": 1, "slot": 9, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.294Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 727, "fields": {"created_at": "2026-01-27T11:35:58.310Z", "updated_at": "2026-01-27T11:35:58.310Z", "parish": 1, "slot": 11, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.310Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 728, "fields": {"created_at": "2026-01-27T11:35:58.324Z", "updated_at": "2026-01-27T11:35:58.324Z", "parish": 1, "slot": 12, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.324Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 729, "fields": {"created_at": "2026-01-27T11:35:58.341Z", "updated_at": "2026-01-27T11:35:58.341Z", "parish": 1, "slot": 13, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.341Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 730, "fields": {"created_at": "2026-01-27T11:35:58.359Z", "updated_at": "2026-01-27T11:35:58.359Z", "parish": 1, "slot": 14, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.359Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 731, "fields": {"created_at": "2026-01-27T11:35:58.375Z", "updated_at": "2026-01-27T11:35:58.375Z", "parish": 1, "slot": 15, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.375Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 732, "fields": {"created_at": "2026-01-27T11:35:58.388Z", "updated_at": "2026-01-27T11:35:58.388Z", "parish": 1, "slot": 16, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.388Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 733, "fields": {"created_at": "2026-01-27T11:35:58.397Z", "updated_at": "2026-01-27T11:35:58.397Z", "parish": 1, "slot": 17, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.397Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 734, "fields": {"created_at": "2026-01-27T11:35:58.412Z", "updated_at": "2026-01-27T11:35:58.412Z", "parish": 1, "slot": 18, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.412Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 735, "fields": {"created_at": "2026-01-27T11:35:58.429Z", "updated_at": "2026-01-27T11:35:58.430Z", "parish": 1, "slot": 20, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.430Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 736, "fields": {"created_at": "2026-01-27T11:35:58.443Z", "updated_at": "2026-01-27T11:35:58.443Z", "parish": 1, "slot": 21, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.443Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 737, "fields": {"created_at": "2026-01-27T11:35:58.458Z", "updated_at": "2026-01-27T11:35:58.458Z", "parish": 1, "slot": 22, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.458Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 738, "fields": {"created_at": "2026-01-27T11:35:58.473Z", "updated_at": "2026-01-27T11:35:58.474Z", "parish": 1, "slot": 23, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.474Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 739, "fields": {"created_at": "2026-01-27T11:35:58.487Z", "updated_at": "2026-01-27T11:35:58.487Z", "parish": 1, "slot": 24, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.487Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 740, "fields": {"created_at": "2026-01-27T11:35:58.511Z", "updated_at": "2026-01-27T11:35:58.511Z", "parish": 1, "slot": 25, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.511Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 741, "fields": {"created_at": "2026-01-27T11:35:58.521Z", "updated_at": "2026-01-27T11:35:58.521Z", "parish": 1, "slot": 26, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.521Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 742, "fields": {"created_at": "2026-01-27T11:35:58.531Z", "updated_at": "2026-01-27T11:35:58.531Z", "parish": 1, "slot": 27, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.531Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 743, "fields": {"created_at": "2026-01-27T11:35:58.543Z", "updated_at": "2026-01-27T11:35:58.543Z", "parish": 1, "slot": 29, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.543Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 744, "fields": {"created_at": "2026-01-27T11:35:58.596Z", "updated_at": "2026-01-27T11:35:58.597Z", "parish": 1, "slot": 30, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.597Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 745, "fields": {"created_at": "2026-01-27T11:35:58.642Z", "updated_at": "2026-01-27T11:35:58.642Z", "parish": 1, "slot": 31, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.642Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 746, "fields": {"created_at": "2026-01-27T11:35:58.680Z", "updated_at": "2026-01-27T11:35:58.680Z", "parish": 1, "slot": 32, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.680Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 747, "fields": {"created_at": "2026-01-27T11:35:58.723Z", "updated_at": "2026-01-27T11:35:58.723Z", "parish": 1, "slot": 33, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.723Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 748, "fields": {"created_at": "2026-01-27T11:35:58.758Z", "updated_at": "2026-01-27T11:35:58.758Z", "parish": 1, "slot": 34, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.758Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 749, "fields": {"created_at": "2026-01-27T11:35:58.803Z", "updated_at": "2026-01-27T11:35:58.803Z", "parish": 1, "slot": 35, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.804Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 750, "fields": {"created_at": "2026-01-27T11:35:58.833Z", "updated_at": "2026-01-27T11:35:58.833Z", "parish": 1, "slot": 37, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.833Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 751, "fields": {"created_at": "2026-01-27T11:35:58.882Z", "updated_at": "2026-01-27T11:35:58.882Z", "parish": 1, "slot": 39, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.882Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 752, "fields": {"created_at": "2026-01-27T11:35:58.925Z", "updated_at": "2026-01-27T11:35:58.925Z", "parish": 1, "slot": 40, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.925Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 753, "fields": {"created_at": "2026-01-27T11:35:58.966Z", "updated_at": "2026-01-27T11:35:58.966Z", "parish": 1, "slot": 41, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:58.966Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 754, "fields": {"created_at": "2026-01-27T11:35:59.011Z", "updated_at": "2026-01-27T11:35:59.011Z", "parish": 1, "slot": 42, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.011Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 755, "fields": {"created_at": "2026-01-27T11:35:59.043Z", "updated_at": "2026-01-27T11:35:59.043Z", "parish": 1, "slot": 43, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.043Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 756, "fields": {"created_at": "2026-01-27T11:35:59.091Z", "updated_at": "2026-01-27T11:35:59.091Z", "parish": 1, "slot": 45, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.091Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 757, "fields": {"created_at": "2026-01-27T11:35:59.133Z", "updated_at": "2026-01-27T11:35:59.133Z", "parish": 1, "slot": 46, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.133Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 758, "fields": {"created_at": "2026-01-27T11:35:59.174Z", "updated_at": "2026-01-27T11:35:59.174Z", "parish": 1, "slot": 47, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.174Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 759, "fields": {"created_at": "2026-01-27T11:35:59.245Z", "updated_at": "2026-01-27T11:35:59.245Z", "parish": 1, "slot": 48, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.245Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 760, "fields": {"created_at": "2026-01-27T11:35:59.293Z", "updated_at": "2026-01-27T11:35:59.293Z", "parish": 1, "slot": 49, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.293Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 761, "fields": {"created_at": "2026-01-27T11:35:59.338Z", "updated_at": "2026-01-27T11:35:59.338Z", "parish": 1, "slot": 50, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.338Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 762, "fields": {"created_at": "2026-01-27T11:35:59.381Z", "updated_at": "2026-01-27T11:35:59.381Z", "parish": 1, "slot": 51, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.381Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 763, "fields": {"created_at": "2026-01-27T11:35:59.427Z", "updated_at": "2026-01-27T11:35:59.427Z", "parish": 1, "slot": 53, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.427Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 764, "fields": {"created_at": "2026-01-27T11:35:59.462Z", "updated_at": "2026-01-27T11:35:59.462Z", "parish": 1, "slot": 54, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.462Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 765, "fields": {"created_at": "2026-01-27T11:35:59.506Z", "updated_at": "2026-01-27T11:35:59.506Z", "parish": 1, "slot": 55, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.506Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 766, "fields": {"created_at": "2026-01-27T11:35:59.544Z", "updated_at": "2026-01-27T11:35:59.544Z", "parish": 1, "slot": 56, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.544Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 767, "fields": {"created_at": "2026-01-27T11:35:59.588Z", "updated_at": "2026-01-27T11:35:59.588Z", "parish": 1, "slot": 57, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.588Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 768, "fields": {"created_at": "2026-01-27T11:35:59.631Z", "updated_at": "2026-01-27T11:35:59.631Z", "parish": 1, "slot": 58, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.631Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 769, "fields": {"created_at": "2026-01-27T11:35:59.664Z", "updated_at": "2026-01-27T11:35:59.664Z", "parish": 1, "slot": 59, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.664Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 770, "fields": {"created_at": "2026-01-27T11:35:59.708Z", "updated_at": "2026-01-27T11:35:59.708Z", "parish": 1, "slot": 97, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.708Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 771, "fields": {"created_at": "2026-01-27T11:35:59.751Z", "updated_at": "2026-01-27T11:35:59.751Z", "parish": 1, "slot": 98, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.751Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 772, "fields": {"created_at": "2026-01-27T11:35:59.789Z", "updated_at": "2026-01-27T11:35:59.789Z", "parish": 1, "slot": 99, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.789Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 773, "fields": {"created_at": "2026-01-27T11:35:59.833Z", "updated_at": "2026-01-27T11:35:59.833Z", "parish": 1, "slot": 100, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.833Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 701, "fields": {"created_at": "2026-01-27T11:35:31.653Z", "updated_at": "2026-01-27T11:35:59.872Z", "parish": 1, "slot": 120, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.653Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:35:59.872Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 774, "fields": {"created_at": "2026-01-27T11:35:59.876Z", "updated_at": "2026-01-27T11:35:59.876Z", "parish": 1, "slot": 120, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.876Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 702, "fields": {"created_at": "2026-01-27T11:35:31.665Z", "updated_at": "2026-01-27T11:35:59.919Z", "parish": 1, "slot": 121, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.665Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:35:59.919Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 775, "fields": {"created_at": "2026-01-27T11:35:59.924Z", "updated_at": "2026-01-27T11:35:59.924Z", "parish": 1, "slot": 121, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.924Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 703, "fields": {"created_at": "2026-01-27T11:35:31.675Z", "updated_at": "2026-01-27T11:35:59.968Z", "parish": 1, "slot": 122, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.675Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:35:59.968Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 776, "fields": {"created_at": "2026-01-27T11:35:59.974Z", "updated_at": "2026-01-27T11:35:59.974Z", "parish": 1, "slot": 122, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:59.974Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 704, "fields": {"created_at": "2026-01-27T11:35:31.685Z", "updated_at": "2026-01-27T11:36:00.015Z", "parish": 1, "slot": 123, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.685Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.015Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 777, "fields": {"created_at": "2026-01-27T11:36:00.020Z", "updated_at": "2026-01-27T11:36:00.020Z", "parish": 1, "slot": 123, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.020Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 705, "fields": {"created_at": "2026-01-27T11:35:31.694Z", "updated_at": "2026-01-27T11:36:00.068Z", "parish": 1, "slot": 124, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.694Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.068Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 778, "fields": {"created_at": "2026-01-27T11:36:00.072Z", "updated_at": "2026-01-27T11:36:00.072Z", "parish": 1, "slot": 124, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.072Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 706, "fields": {"created_at": "2026-01-27T11:35:31.704Z", "updated_at": "2026-01-27T11:36:00.110Z", "parish": 1, "slot": 125, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.704Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.110Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 779, "fields": {"created_at": "2026-01-27T11:36:00.114Z", "updated_at": "2026-01-27T11:36:00.114Z", "parish": 1, "slot": 125, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.114Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 707, "fields": {"created_at": "2026-01-27T11:35:31.714Z", "updated_at": "2026-01-27T11:36:00.158Z", "parish": 1, "slot": 126, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.714Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.158Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 780, "fields": {"created_at": "2026-01-27T11:36:00.164Z", "updated_at": "2026-01-27T11:36:00.164Z", "parish": 1, "slot": 126, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.164Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 708, "fields": {"created_at": "2026-01-27T11:35:31.725Z", "updated_at": "2026-01-27T11:36:00.204Z", "parish": 1, "slot": 127, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.725Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.204Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 781, "fields": {"created_at": "2026-01-27T11:36:00.209Z", "updated_at": "2026-01-27T11:36:00.209Z", "parish": 1, "slot": 127, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.209Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 709, "fields": {"created_at": "2026-01-27T11:35:31.736Z", "updated_at": "2026-01-27T11:36:00.250Z", "parish": 1, "slot": 128, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.736Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.250Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 782, "fields": {"created_at": "2026-01-27T11:36:00.258Z", "updated_at": "2026-01-27T11:36:00.258Z", "parish": 1, "slot": 128, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.258Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 710, "fields": {"created_at": "2026-01-27T11:35:31.746Z", "updated_at": "2026-01-27T11:36:00.298Z", "parish": 1, "slot": 129, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.746Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.298Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 783, "fields": {"created_at": "2026-01-27T11:36:00.303Z", "updated_at": "2026-01-27T11:36:00.303Z", "parish": 1, "slot": 129, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.303Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 711, "fields": {"created_at": "2026-01-27T11:35:31.756Z", "updated_at": "2026-01-27T11:36:00.343Z", "parish": 1, "slot": 130, "acolyte": 3, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.756Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.343Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 784, "fields": {"created_at": "2026-01-27T11:36:00.348Z", "updated_at": "2026-01-27T11:36:00.348Z", "parish": 1, "slot": 130, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.348Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 712, "fields": {"created_at": "2026-01-27T11:35:31.767Z", "updated_at": "2026-01-27T11:36:00.390Z", "parish": 1, "slot": 131, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.767Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.390Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 785, "fields": {"created_at": "2026-01-27T11:36:00.394Z", "updated_at": "2026-01-27T11:36:00.394Z", "parish": 1, "slot": 131, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.394Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 713, "fields": {"created_at": "2026-01-27T11:35:31.776Z", "updated_at": "2026-01-27T11:36:00.433Z", "parish": 1, "slot": 132, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.776Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.433Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 786, "fields": {"created_at": "2026-01-27T11:36:00.439Z", "updated_at": "2026-01-27T11:36:00.439Z", "parish": 1, "slot": 132, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.439Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 714, "fields": {"created_at": "2026-01-27T11:35:31.784Z", "updated_at": "2026-01-27T11:36:00.483Z", "parish": 1, "slot": 133, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.784Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.483Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 787, "fields": {"created_at": "2026-01-27T11:36:00.489Z", "updated_at": "2026-01-27T11:36:00.489Z", "parish": 1, "slot": 133, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.489Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 715, "fields": {"created_at": "2026-01-27T11:35:31.792Z", "updated_at": "2026-01-27T11:36:00.528Z", "parish": 1, "slot": 134, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.792Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.528Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 788, "fields": {"created_at": "2026-01-27T11:36:00.534Z", "updated_at": "2026-01-27T11:36:00.534Z", "parish": 1, "slot": 134, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.534Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 716, "fields": {"created_at": "2026-01-27T11:35:31.801Z", "updated_at": "2026-01-27T11:36:00.577Z", "parish": 1, "slot": 135, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.801Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.577Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 789, "fields": {"created_at": "2026-01-27T11:36:00.582Z", "updated_at": "2026-01-27T11:36:00.582Z", "parish": 1, "slot": 135, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.582Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 717, "fields": {"created_at": "2026-01-27T11:35:31.810Z", "updated_at": "2026-01-27T11:36:00.622Z", "parish": 1, "slot": 136, "acolyte": 5, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.810Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.622Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 790, "fields": {"created_at": "2026-01-27T11:36:00.627Z", "updated_at": "2026-01-27T11:36:00.627Z", "parish": 1, "slot": 136, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.627Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 718, "fields": {"created_at": "2026-01-27T11:35:31.818Z", "updated_at": "2026-01-27T11:36:00.670Z", "parish": 1, "slot": 137, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:35:31.818Z", "assignment_state": "proposed", "published_at": null, "is_active": false, "ended_at": "2026-01-27T11:36:00.670Z", "end_reason": "replaced_by_solver"}}, {"model": "core.assignment", "pk": 791, "fields": {"created_at": "2026-01-27T11:36:00.674Z", "updated_at": "2026-01-27T11:36:00.674Z", "parish": 1, "slot": 137, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.675Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 792, "fields": {"created_at": "2026-01-27T11:36:00.714Z", "updated_at": "2026-01-27T11:36:00.714Z", "parish": 1, "slot": 144, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.714Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 793, "fields": {"created_at": "2026-01-27T11:36:00.760Z", "updated_at": "2026-01-27T11:36:00.760Z", "parish": 1, "slot": 145, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:36:00.760Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 794, "fields": {"created_at": "2026-01-27T11:36:02.331Z", "updated_at": "2026-01-27T11:36:02.331Z", "parish": 1, "slot": 146, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.331Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 795, "fields": {"created_at": "2026-01-27T11:36:02.377Z", "updated_at": "2026-01-27T11:36:02.377Z", "parish": 1, "slot": 147, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.377Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 796, "fields": {"created_at": "2026-01-27T11:36:02.409Z", "updated_at": "2026-01-27T11:36:02.409Z", "parish": 1, "slot": 148, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.409Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 797, "fields": {"created_at": "2026-01-27T11:36:02.442Z", "updated_at": "2026-01-27T11:36:02.442Z", "parish": 1, "slot": 149, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.442Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 798, "fields": {"created_at": "2026-01-27T11:36:02.487Z", "updated_at": "2026-01-27T11:36:02.487Z", "parish": 1, "slot": 150, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.487Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 799, "fields": {"created_at": "2026-01-27T11:36:02.536Z", "updated_at": "2026-01-27T11:36:02.536Z", "parish": 1, "slot": 151, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.536Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 800, "fields": {"created_at": "2026-01-27T11:36:02.580Z", "updated_at": "2026-01-27T11:36:02.580Z", "parish": 1, "slot": 152, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.580Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 801, "fields": {"created_at": "2026-01-27T11:36:02.627Z", "updated_at": "2026-01-27T11:36:02.627Z", "parish": 1, "slot": 153, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.627Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 802, "fields": {"created_at": "2026-01-27T11:36:02.673Z", "updated_at": "2026-01-27T11:36:02.673Z", "parish": 1, "slot": 154, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.673Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 803, "fields": {"created_at": "2026-01-27T11:36:02.720Z", "updated_at": "2026-01-27T11:36:02.720Z", "parish": 1, "slot": 155, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:36:02.721Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\massinterest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\massoverride.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\past_assignment.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\past_assignmentslot.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\past_massinstance.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\positionclaimrequest.json
```json
[{"model": "core.positionclaimrequest", "pk": 8, "fields": {"created_at": "2026-01-26T06:13:52.739Z", "updated_at": "2026-01-27T08:16:48.744Z", "parish": 1, "slot": 3, "requestor_acolyte": 3, "target_assignment": null, "status": "expired", "approval_mode": "", "resolution_reason": "assignment_changed", "auto_approve_at": "2026-02-05T20:00:00Z", "resolved_at": "2026-01-27T08:16:48.744Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 5, "fields": {"created_at": "2026-01-25T21:13:54.694Z", "updated_at": "2026-01-25T21:31:57.274Z", "parish": 1, "slot": 12, "requestor_acolyte": 1, "target_assignment": null, "status": "expired", "approval_mode": "coordination", "resolution_reason": "holder_confirmed", "auto_approve_at": null, "resolved_at": "2026-01-25T21:31:57.274Z", "approved_by": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\replacementrequest.json
```json
[{"model": "core.replacementrequest", "pk": 11, "fields": {"created_at": "2026-01-26T03:52:46.710Z", "updated_at": "2026-01-26T03:52:46.776Z", "parish": 1, "slot": 2, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 12, "fields": {"created_at": "2026-01-26T03:55:01.453Z", "updated_at": "2026-01-26T03:55:01.526Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 13, "fields": {"created_at": "2026-01-26T03:56:22.179Z", "updated_at": "2026-01-26T03:56:22.339Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 16, "fields": {"created_at": "2026-01-27T03:38:03.289Z", "updated_at": "2026-01-27T03:38:03.289Z", "parish": 1, "slot": 17, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 14, "fields": {"created_at": "2026-01-26T03:56:36.974Z", "updated_at": "2026-01-26T03:56:37.048Z", "parish": 1, "slot": 20, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 9, "fields": {"created_at": "2026-01-25T18:10:45.171Z", "updated_at": "2026-01-25T18:10:45.229Z", "parish": 1, "slot": 23, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 15, "fields": {"created_at": "2026-01-27T03:38:03.253Z", "updated_at": "2026-01-27T03:38:03.253Z", "parish": 1, "slot": 29, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 8, "fields": {"created_at": "2026-01-25T18:09:03.950Z", "updated_at": "2026-01-25T18:09:04.009Z", "parish": 1, "slot": 34, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 17, "fields": {"created_at": "2026-01-27T03:38:03.326Z", "updated_at": "2026-01-27T03:38:03.326Z", "parish": 1, "slot": 35, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 7, "fields": {"created_at": "2026-01-25T18:08:53.446Z", "updated_at": "2026-01-25T18:08:53.518Z", "parish": 1, "slot": 45, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 4, "fields": {"created_at": "2026-01-23T11:40:58.132Z", "updated_at": "2026-01-23T11:40:58.133Z", "parish": 1, "slot": 51, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 5, "fields": {"created_at": "2026-01-23T11:41:55.885Z", "updated_at": "2026-01-23T11:41:55.885Z", "parish": 1, "slot": 107, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\serializers\swaprequest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T083740\meta.json
```json
{
  "created_at": "2026-01-27T08:37:40.916898-03:00",
  "cutoff_date": "2026-01-27",
  "counts": {
    "past_masses": 0,
    "past_slots": 0,
    "past_assignments": 0,
    "future_assignments_total": 103,
    "confirmations": 0,
    "claims": 2,
    "replacement_requests": 12,
    "swap_requests": 0,
    "mass_interest": 0,
    "mass_override": 0,
    "ledger_rows": 0,
    "audit_events": 121
  },
  "models_included": [
    "core.MassInstance",
    "core.AssignmentSlot",
    "core.Assignment",
    "core.Confirmation",
    "core.PositionClaimRequest",
    "core.ReplacementRequest",
    "core.SwapRequest",
    "core.MassInterest",
    "core.MassOverride",
    "core.AcolyteCreditLedger",
    "core.AuditEvent"
  ]
}
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\acolytecreditledger.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\auditevent.json
```json
[{"model": "core.auditevent", "pk": 1663, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "804", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 2}, "timestamp": "2026-01-27T11:38:00.141Z"}}, {"model": "core.auditevent", "pk": 1664, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "805", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 3}, "timestamp": "2026-01-27T11:38:00.169Z"}}, {"model": "core.auditevent", "pk": 1665, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "806", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 4}, "timestamp": "2026-01-27T11:38:00.195Z"}}, {"model": "core.auditevent", "pk": 1666, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "807", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 5}, "timestamp": "2026-01-27T11:38:00.223Z"}}, {"model": "core.auditevent", "pk": 1667, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "808", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 6}, "timestamp": "2026-01-27T11:38:00.249Z"}}, {"model": "core.auditevent", "pk": 1668, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "809", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 7}, "timestamp": "2026-01-27T11:38:00.272Z"}}, {"model": "core.auditevent", "pk": 1669, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "810", "action_type": "create", "diff_json": {"acolyte_id": 20, "slot_id": 8}, "timestamp": "2026-01-27T11:38:00.298Z"}}, {"model": "core.auditevent", "pk": 1670, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "811", "action_type": "create", "diff_json": {"acolyte_id": 21, "slot_id": 9}, "timestamp": "2026-01-27T11:38:00.321Z"}}, {"model": "core.auditevent", "pk": 1671, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "812", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 11}, "timestamp": "2026-01-27T11:38:00.344Z"}}, {"model": "core.auditevent", "pk": 1672, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "813", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 12}, "timestamp": "2026-01-27T11:38:00.370Z"}}, {"model": "core.auditevent", "pk": 1673, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "814", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 13}, "timestamp": "2026-01-27T11:38:00.394Z"}}, {"model": "core.auditevent", "pk": 1674, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "815", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 14}, "timestamp": "2026-01-27T11:38:00.416Z"}}, {"model": "core.auditevent", "pk": 1675, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "816", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 15}, "timestamp": "2026-01-27T11:38:00.440Z"}}, {"model": "core.auditevent", "pk": 1676, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "817", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 16}, "timestamp": "2026-01-27T11:38:00.461Z"}}, {"model": "core.auditevent", "pk": 1677, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "818", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 17}, "timestamp": "2026-01-27T11:38:00.482Z"}}, {"model": "core.auditevent", "pk": 1678, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "819", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 18}, "timestamp": "2026-01-27T11:38:00.501Z"}}, {"model": "core.auditevent", "pk": 1679, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "820", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 20}, "timestamp": "2026-01-27T11:38:00.522Z"}}, {"model": "core.auditevent", "pk": 1680, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "821", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 21}, "timestamp": "2026-01-27T11:38:00.541Z"}}, {"model": "core.auditevent", "pk": 1681, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "822", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 22}, "timestamp": "2026-01-27T11:38:00.564Z"}}, {"model": "core.auditevent", "pk": 1682, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "823", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 23}, "timestamp": "2026-01-27T11:38:00.582Z"}}, {"model": "core.auditevent", "pk": 1683, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "824", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 24}, "timestamp": "2026-01-27T11:38:00.601Z"}}, {"model": "core.auditevent", "pk": 1684, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "825", "action_type": "create", "diff_json": {"acolyte_id": 14, "slot_id": 25}, "timestamp": "2026-01-27T11:38:00.619Z"}}, {"model": "core.auditevent", "pk": 1685, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "826", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 26}, "timestamp": "2026-01-27T11:38:00.639Z"}}, {"model": "core.auditevent", "pk": 1686, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "827", "action_type": "create", "diff_json": {"acolyte_id": 15, "slot_id": 27}, "timestamp": "2026-01-27T11:38:00.657Z"}}, {"model": "core.auditevent", "pk": 1687, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "828", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 29}, "timestamp": "2026-01-27T11:38:00.676Z"}}, {"model": "core.auditevent", "pk": 1688, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "829", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 30}, "timestamp": "2026-01-27T11:38:00.694Z"}}, {"model": "core.auditevent", "pk": 1689, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "830", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 31}, "timestamp": "2026-01-27T11:38:00.714Z"}}, {"model": "core.auditevent", "pk": 1690, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "831", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 32}, "timestamp": "2026-01-27T11:38:00.734Z"}}, {"model": "core.auditevent", "pk": 1691, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "832", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 33}, "timestamp": "2026-01-27T11:38:00.758Z"}}, {"model": "core.auditevent", "pk": 1692, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "833", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 34}, "timestamp": "2026-01-27T11:38:00.779Z"}}, {"model": "core.auditevent", "pk": 1693, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "834", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 35}, "timestamp": "2026-01-27T11:38:00.802Z"}}, {"model": "core.auditevent", "pk": 1694, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "835", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 37}, "timestamp": "2026-01-27T11:38:00.818Z"}}, {"model": "core.auditevent", "pk": 1695, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "836", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 39}, "timestamp": "2026-01-27T11:38:00.843Z"}}, {"model": "core.auditevent", "pk": 1696, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "837", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 40}, "timestamp": "2026-01-27T11:38:00.863Z"}}, {"model": "core.auditevent", "pk": 1697, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "838", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 41}, "timestamp": "2026-01-27T11:38:00.885Z"}}, {"model": "core.auditevent", "pk": 1698, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "839", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 42}, "timestamp": "2026-01-27T11:38:00.905Z"}}, {"model": "core.auditevent", "pk": 1699, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "840", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 43}, "timestamp": "2026-01-27T11:38:00.923Z"}}, {"model": "core.auditevent", "pk": 1700, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "841", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 45}, "timestamp": "2026-01-27T11:38:00.944Z"}}, {"model": "core.auditevent", "pk": 1701, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "842", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 46}, "timestamp": "2026-01-27T11:38:00.961Z"}}, {"model": "core.auditevent", "pk": 1702, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "843", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 47}, "timestamp": "2026-01-27T11:38:00.978Z"}}, {"model": "core.auditevent", "pk": 1703, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "844", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 48}, "timestamp": "2026-01-27T11:38:00.996Z"}}, {"model": "core.auditevent", "pk": 1704, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "845", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 49}, "timestamp": "2026-01-27T11:38:01.011Z"}}, {"model": "core.auditevent", "pk": 1705, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "846", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 50}, "timestamp": "2026-01-27T11:38:01.032Z"}}, {"model": "core.auditevent", "pk": 1706, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "847", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 51}, "timestamp": "2026-01-27T11:38:01.047Z"}}, {"model": "core.auditevent", "pk": 1707, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "848", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 53}, "timestamp": "2026-01-27T11:38:01.065Z"}}, {"model": "core.auditevent", "pk": 1708, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "849", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 54}, "timestamp": "2026-01-27T11:38:01.080Z"}}, {"model": "core.auditevent", "pk": 1709, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "850", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 55}, "timestamp": "2026-01-27T11:38:01.097Z"}}, {"model": "core.auditevent", "pk": 1710, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "851", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 56}, "timestamp": "2026-01-27T11:38:01.114Z"}}, {"model": "core.auditevent", "pk": 1711, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "852", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 57}, "timestamp": "2026-01-27T11:38:01.130Z"}}, {"model": "core.auditevent", "pk": 1712, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "853", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 58}, "timestamp": "2026-01-27T11:38:01.146Z"}}, {"model": "core.auditevent", "pk": 1713, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "854", "action_type": "create", "diff_json": {"acolyte_id": 7, "slot_id": 59}, "timestamp": "2026-01-27T11:38:01.163Z"}}, {"model": "core.auditevent", "pk": 1714, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "855", "action_type": "create", "diff_json": {"acolyte_id": 11, "slot_id": 97}, "timestamp": "2026-01-27T11:38:01.179Z"}}, {"model": "core.auditevent", "pk": 1715, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "856", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 98}, "timestamp": "2026-01-27T11:38:01.192Z"}}, {"model": "core.auditevent", "pk": 1716, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "857", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 99}, "timestamp": "2026-01-27T11:38:01.204Z"}}, {"model": "core.auditevent", "pk": 1717, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "858", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 100}, "timestamp": "2026-01-27T11:38:01.218Z"}}, {"model": "core.auditevent", "pk": 1718, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "859", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 120}, "timestamp": "2026-01-27T11:38:01.232Z"}}, {"model": "core.auditevent", "pk": 1719, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "860", "action_type": "create", "diff_json": {"acolyte_id": 9, "slot_id": 121}, "timestamp": "2026-01-27T11:38:01.248Z"}}, {"model": "core.auditevent", "pk": 1720, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "861", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 122}, "timestamp": "2026-01-27T11:38:01.266Z"}}, {"model": "core.auditevent", "pk": 1721, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "862", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 123}, "timestamp": "2026-01-27T11:38:01.282Z"}}, {"model": "core.auditevent", "pk": 1722, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "863", "action_type": "create", "diff_json": {"acolyte_id": 6, "slot_id": 124}, "timestamp": "2026-01-27T11:38:01.296Z"}}, {"model": "core.auditevent", "pk": 1723, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "864", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 125}, "timestamp": "2026-01-27T11:38:01.310Z"}}, {"model": "core.auditevent", "pk": 1724, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "865", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 126}, "timestamp": "2026-01-27T11:38:01.325Z"}}, {"model": "core.auditevent", "pk": 1725, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "866", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 127}, "timestamp": "2026-01-27T11:38:01.339Z"}}, {"model": "core.auditevent", "pk": 1726, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "867", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 128}, "timestamp": "2026-01-27T11:38:01.356Z"}}, {"model": "core.auditevent", "pk": 1727, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "868", "action_type": "create", "diff_json": {"acolyte_id": 2, "slot_id": 129}, "timestamp": "2026-01-27T11:38:01.371Z"}}, {"model": "core.auditevent", "pk": 1728, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "869", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 130}, "timestamp": "2026-01-27T11:38:01.386Z"}}, {"model": "core.auditevent", "pk": 1729, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "870", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 131}, "timestamp": "2026-01-27T11:38:01.401Z"}}, {"model": "core.auditevent", "pk": 1730, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "871", "action_type": "create", "diff_json": {"acolyte_id": 8, "slot_id": 132}, "timestamp": "2026-01-27T11:38:01.412Z"}}, {"model": "core.auditevent", "pk": 1731, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "872", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 133}, "timestamp": "2026-01-27T11:38:01.425Z"}}, {"model": "core.auditevent", "pk": 1732, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "873", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 134}, "timestamp": "2026-01-27T11:38:01.442Z"}}, {"model": "core.auditevent", "pk": 1733, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "874", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 135}, "timestamp": "2026-01-27T11:38:01.456Z"}}, {"model": "core.auditevent", "pk": 1734, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "875", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 136}, "timestamp": "2026-01-27T11:38:01.470Z"}}, {"model": "core.auditevent", "pk": 1735, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "876", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 137}, "timestamp": "2026-01-27T11:38:01.483Z"}}, {"model": "core.auditevent", "pk": 1736, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "877", "action_type": "create", "diff_json": {"acolyte_id": 4, "slot_id": 144}, "timestamp": "2026-01-27T11:38:01.497Z"}}, {"model": "core.auditevent", "pk": 1737, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "878", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 145}, "timestamp": "2026-01-27T11:38:01.510Z"}}, {"model": "core.auditevent", "pk": 1738, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "879", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 146}, "timestamp": "2026-01-27T11:38:01.522Z"}}, {"model": "core.auditevent", "pk": 1739, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "880", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 147}, "timestamp": "2026-01-27T11:38:01.539Z"}}, {"model": "core.auditevent", "pk": 1740, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "881", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 148}, "timestamp": "2026-01-27T11:38:01.554Z"}}, {"model": "core.auditevent", "pk": 1741, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "882", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 149}, "timestamp": "2026-01-27T11:38:01.569Z"}}, {"model": "core.auditevent", "pk": 1742, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "883", "action_type": "create", "diff_json": {"acolyte_id": 12, "slot_id": 150}, "timestamp": "2026-01-27T11:38:01.587Z"}}, {"model": "core.auditevent", "pk": 1743, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "884", "action_type": "create", "diff_json": {"acolyte_id": 10, "slot_id": 151}, "timestamp": "2026-01-27T11:38:01.602Z"}}, {"model": "core.auditevent", "pk": 1744, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "885", "action_type": "create", "diff_json": {"acolyte_id": 19, "slot_id": 152}, "timestamp": "2026-01-27T11:38:01.616Z"}}, {"model": "core.auditevent", "pk": 1745, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "886", "action_type": "create", "diff_json": {"acolyte_id": 18, "slot_id": 153}, "timestamp": "2026-01-27T11:38:01.634Z"}}, {"model": "core.auditevent", "pk": 1746, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "887", "action_type": "create", "diff_json": {"acolyte_id": 16, "slot_id": 154}, "timestamp": "2026-01-27T11:38:01.649Z"}}, {"model": "core.auditevent", "pk": 1747, "fields": {"parish": 1, "actor_user": null, "entity_type": "Assignment", "entity_id": "888", "action_type": "create", "diff_json": {"acolyte_id": 1, "slot_id": 155}, "timestamp": "2026-01-27T11:38:01.663Z"}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\confirmation.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\future_assignment_active.json
```json
[{"model": "core.assignment", "pk": 804, "fields": {"created_at": "2026-01-27T11:38:00.136Z", "updated_at": "2026-01-27T11:38:00.136Z", "parish": 1, "slot": 2, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.136Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 805, "fields": {"created_at": "2026-01-27T11:38:00.166Z", "updated_at": "2026-01-27T11:38:00.166Z", "parish": 1, "slot": 3, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.166Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 806, "fields": {"created_at": "2026-01-27T11:38:00.191Z", "updated_at": "2026-01-27T11:38:00.191Z", "parish": 1, "slot": 4, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.191Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 807, "fields": {"created_at": "2026-01-27T11:38:00.219Z", "updated_at": "2026-01-27T11:38:00.219Z", "parish": 1, "slot": 5, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.219Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 808, "fields": {"created_at": "2026-01-27T11:38:00.245Z", "updated_at": "2026-01-27T11:38:00.245Z", "parish": 1, "slot": 6, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.245Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 809, "fields": {"created_at": "2026-01-27T11:38:00.269Z", "updated_at": "2026-01-27T11:38:00.269Z", "parish": 1, "slot": 7, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.269Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 810, "fields": {"created_at": "2026-01-27T11:38:00.293Z", "updated_at": "2026-01-27T11:38:00.293Z", "parish": 1, "slot": 8, "acolyte": 20, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.294Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 811, "fields": {"created_at": "2026-01-27T11:38:00.318Z", "updated_at": "2026-01-27T11:38:00.318Z", "parish": 1, "slot": 9, "acolyte": 21, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.318Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 812, "fields": {"created_at": "2026-01-27T11:38:00.339Z", "updated_at": "2026-01-27T11:38:00.339Z", "parish": 1, "slot": 11, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.339Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 813, "fields": {"created_at": "2026-01-27T11:38:00.366Z", "updated_at": "2026-01-27T11:38:00.366Z", "parish": 1, "slot": 12, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.366Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 814, "fields": {"created_at": "2026-01-27T11:38:00.390Z", "updated_at": "2026-01-27T11:38:00.390Z", "parish": 1, "slot": 13, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.391Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 815, "fields": {"created_at": "2026-01-27T11:38:00.412Z", "updated_at": "2026-01-27T11:38:00.412Z", "parish": 1, "slot": 14, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.412Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 816, "fields": {"created_at": "2026-01-27T11:38:00.436Z", "updated_at": "2026-01-27T11:38:00.436Z", "parish": 1, "slot": 15, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.436Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 817, "fields": {"created_at": "2026-01-27T11:38:00.458Z", "updated_at": "2026-01-27T11:38:00.458Z", "parish": 1, "slot": 16, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.458Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 818, "fields": {"created_at": "2026-01-27T11:38:00.478Z", "updated_at": "2026-01-27T11:38:00.478Z", "parish": 1, "slot": 17, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.478Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 819, "fields": {"created_at": "2026-01-27T11:38:00.498Z", "updated_at": "2026-01-27T11:38:00.498Z", "parish": 1, "slot": 18, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.498Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 820, "fields": {"created_at": "2026-01-27T11:38:00.518Z", "updated_at": "2026-01-27T11:38:00.518Z", "parish": 1, "slot": 20, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.518Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 821, "fields": {"created_at": "2026-01-27T11:38:00.537Z", "updated_at": "2026-01-27T11:38:00.537Z", "parish": 1, "slot": 21, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.537Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 822, "fields": {"created_at": "2026-01-27T11:38:00.561Z", "updated_at": "2026-01-27T11:38:00.561Z", "parish": 1, "slot": 22, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.561Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 823, "fields": {"created_at": "2026-01-27T11:38:00.578Z", "updated_at": "2026-01-27T11:38:00.578Z", "parish": 1, "slot": 23, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.578Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 824, "fields": {"created_at": "2026-01-27T11:38:00.598Z", "updated_at": "2026-01-27T11:38:00.598Z", "parish": 1, "slot": 24, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.598Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 825, "fields": {"created_at": "2026-01-27T11:38:00.615Z", "updated_at": "2026-01-27T11:38:00.615Z", "parish": 1, "slot": 25, "acolyte": 14, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.615Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 826, "fields": {"created_at": "2026-01-27T11:38:00.635Z", "updated_at": "2026-01-27T11:38:00.635Z", "parish": 1, "slot": 26, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.635Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 827, "fields": {"created_at": "2026-01-27T11:38:00.654Z", "updated_at": "2026-01-27T11:38:00.654Z", "parish": 1, "slot": 27, "acolyte": 15, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.654Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 828, "fields": {"created_at": "2026-01-27T11:38:00.673Z", "updated_at": "2026-01-27T11:38:00.673Z", "parish": 1, "slot": 29, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.673Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 829, "fields": {"created_at": "2026-01-27T11:38:00.692Z", "updated_at": "2026-01-27T11:38:00.692Z", "parish": 1, "slot": 30, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.692Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 830, "fields": {"created_at": "2026-01-27T11:38:00.710Z", "updated_at": "2026-01-27T11:38:00.710Z", "parish": 1, "slot": 31, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.710Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 831, "fields": {"created_at": "2026-01-27T11:38:00.731Z", "updated_at": "2026-01-27T11:38:00.731Z", "parish": 1, "slot": 32, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.731Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 832, "fields": {"created_at": "2026-01-27T11:38:00.755Z", "updated_at": "2026-01-27T11:38:00.755Z", "parish": 1, "slot": 33, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.755Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 833, "fields": {"created_at": "2026-01-27T11:38:00.775Z", "updated_at": "2026-01-27T11:38:00.775Z", "parish": 1, "slot": 34, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.775Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 834, "fields": {"created_at": "2026-01-27T11:38:00.799Z", "updated_at": "2026-01-27T11:38:00.799Z", "parish": 1, "slot": 35, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.799Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 835, "fields": {"created_at": "2026-01-27T11:38:00.816Z", "updated_at": "2026-01-27T11:38:00.816Z", "parish": 1, "slot": 37, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.816Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 836, "fields": {"created_at": "2026-01-27T11:38:00.840Z", "updated_at": "2026-01-27T11:38:00.840Z", "parish": 1, "slot": 39, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.840Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 837, "fields": {"created_at": "2026-01-27T11:38:00.860Z", "updated_at": "2026-01-27T11:38:00.860Z", "parish": 1, "slot": 40, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.860Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 838, "fields": {"created_at": "2026-01-27T11:38:00.882Z", "updated_at": "2026-01-27T11:38:00.882Z", "parish": 1, "slot": 41, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.882Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 839, "fields": {"created_at": "2026-01-27T11:38:00.903Z", "updated_at": "2026-01-27T11:38:00.903Z", "parish": 1, "slot": 42, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.903Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 840, "fields": {"created_at": "2026-01-27T11:38:00.920Z", "updated_at": "2026-01-27T11:38:00.920Z", "parish": 1, "slot": 43, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.920Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 841, "fields": {"created_at": "2026-01-27T11:38:00.940Z", "updated_at": "2026-01-27T11:38:00.941Z", "parish": 1, "slot": 45, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.941Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 842, "fields": {"created_at": "2026-01-27T11:38:00.958Z", "updated_at": "2026-01-27T11:38:00.958Z", "parish": 1, "slot": 46, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.958Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 843, "fields": {"created_at": "2026-01-27T11:38:00.975Z", "updated_at": "2026-01-27T11:38:00.976Z", "parish": 1, "slot": 47, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.976Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 844, "fields": {"created_at": "2026-01-27T11:38:00.993Z", "updated_at": "2026-01-27T11:38:00.993Z", "parish": 1, "slot": 48, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:00.993Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 845, "fields": {"created_at": "2026-01-27T11:38:01.008Z", "updated_at": "2026-01-27T11:38:01.008Z", "parish": 1, "slot": 49, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.008Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 846, "fields": {"created_at": "2026-01-27T11:38:01.029Z", "updated_at": "2026-01-27T11:38:01.029Z", "parish": 1, "slot": 50, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.029Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 847, "fields": {"created_at": "2026-01-27T11:38:01.044Z", "updated_at": "2026-01-27T11:38:01.044Z", "parish": 1, "slot": 51, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.045Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 848, "fields": {"created_at": "2026-01-27T11:38:01.062Z", "updated_at": "2026-01-27T11:38:01.062Z", "parish": 1, "slot": 53, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.062Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 849, "fields": {"created_at": "2026-01-27T11:38:01.078Z", "updated_at": "2026-01-27T11:38:01.078Z", "parish": 1, "slot": 54, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.078Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 850, "fields": {"created_at": "2026-01-27T11:38:01.095Z", "updated_at": "2026-01-27T11:38:01.095Z", "parish": 1, "slot": 55, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.095Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 851, "fields": {"created_at": "2026-01-27T11:38:01.111Z", "updated_at": "2026-01-27T11:38:01.111Z", "parish": 1, "slot": 56, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.111Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 852, "fields": {"created_at": "2026-01-27T11:38:01.127Z", "updated_at": "2026-01-27T11:38:01.127Z", "parish": 1, "slot": 57, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.127Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 853, "fields": {"created_at": "2026-01-27T11:38:01.144Z", "updated_at": "2026-01-27T11:38:01.144Z", "parish": 1, "slot": 58, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.144Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 854, "fields": {"created_at": "2026-01-27T11:38:01.161Z", "updated_at": "2026-01-27T11:38:01.161Z", "parish": 1, "slot": 59, "acolyte": 7, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.161Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 855, "fields": {"created_at": "2026-01-27T11:38:01.177Z", "updated_at": "2026-01-27T11:38:01.177Z", "parish": 1, "slot": 97, "acolyte": 11, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.177Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 856, "fields": {"created_at": "2026-01-27T11:38:01.190Z", "updated_at": "2026-01-27T11:38:01.190Z", "parish": 1, "slot": 98, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.190Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 857, "fields": {"created_at": "2026-01-27T11:38:01.202Z", "updated_at": "2026-01-27T11:38:01.202Z", "parish": 1, "slot": 99, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.202Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 858, "fields": {"created_at": "2026-01-27T11:38:01.216Z", "updated_at": "2026-01-27T11:38:01.216Z", "parish": 1, "slot": 100, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.216Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 859, "fields": {"created_at": "2026-01-27T11:38:01.229Z", "updated_at": "2026-01-27T11:38:01.229Z", "parish": 1, "slot": 120, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.229Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 860, "fields": {"created_at": "2026-01-27T11:38:01.245Z", "updated_at": "2026-01-27T11:38:01.245Z", "parish": 1, "slot": 121, "acolyte": 9, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.245Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 861, "fields": {"created_at": "2026-01-27T11:38:01.263Z", "updated_at": "2026-01-27T11:38:01.263Z", "parish": 1, "slot": 122, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.264Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 862, "fields": {"created_at": "2026-01-27T11:38:01.280Z", "updated_at": "2026-01-27T11:38:01.280Z", "parish": 1, "slot": 123, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.280Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 863, "fields": {"created_at": "2026-01-27T11:38:01.293Z", "updated_at": "2026-01-27T11:38:01.293Z", "parish": 1, "slot": 124, "acolyte": 6, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.293Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 864, "fields": {"created_at": "2026-01-27T11:38:01.308Z", "updated_at": "2026-01-27T11:38:01.308Z", "parish": 1, "slot": 125, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.308Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 865, "fields": {"created_at": "2026-01-27T11:38:01.322Z", "updated_at": "2026-01-27T11:38:01.322Z", "parish": 1, "slot": 126, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.322Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 866, "fields": {"created_at": "2026-01-27T11:38:01.337Z", "updated_at": "2026-01-27T11:38:01.337Z", "parish": 1, "slot": 127, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.337Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 867, "fields": {"created_at": "2026-01-27T11:38:01.353Z", "updated_at": "2026-01-27T11:38:01.353Z", "parish": 1, "slot": 128, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.353Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 868, "fields": {"created_at": "2026-01-27T11:38:01.368Z", "updated_at": "2026-01-27T11:38:01.368Z", "parish": 1, "slot": 129, "acolyte": 2, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.368Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 869, "fields": {"created_at": "2026-01-27T11:38:01.384Z", "updated_at": "2026-01-27T11:38:01.384Z", "parish": 1, "slot": 130, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.384Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 870, "fields": {"created_at": "2026-01-27T11:38:01.399Z", "updated_at": "2026-01-27T11:38:01.399Z", "parish": 1, "slot": 131, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.399Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 871, "fields": {"created_at": "2026-01-27T11:38:01.410Z", "updated_at": "2026-01-27T11:38:01.411Z", "parish": 1, "slot": 132, "acolyte": 8, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.411Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 872, "fields": {"created_at": "2026-01-27T11:38:01.423Z", "updated_at": "2026-01-27T11:38:01.423Z", "parish": 1, "slot": 133, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.423Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 873, "fields": {"created_at": "2026-01-27T11:38:01.440Z", "updated_at": "2026-01-27T11:38:01.440Z", "parish": 1, "slot": 134, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.440Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 874, "fields": {"created_at": "2026-01-27T11:38:01.454Z", "updated_at": "2026-01-27T11:38:01.454Z", "parish": 1, "slot": 135, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.454Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 875, "fields": {"created_at": "2026-01-27T11:38:01.468Z", "updated_at": "2026-01-27T11:38:01.468Z", "parish": 1, "slot": 136, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.468Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 876, "fields": {"created_at": "2026-01-27T11:38:01.481Z", "updated_at": "2026-01-27T11:38:01.481Z", "parish": 1, "slot": 137, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.481Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 877, "fields": {"created_at": "2026-01-27T11:38:01.495Z", "updated_at": "2026-01-27T11:38:01.495Z", "parish": 1, "slot": 144, "acolyte": 4, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.495Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 878, "fields": {"created_at": "2026-01-27T11:38:01.508Z", "updated_at": "2026-01-27T11:38:01.508Z", "parish": 1, "slot": 145, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.508Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 879, "fields": {"created_at": "2026-01-27T11:38:01.520Z", "updated_at": "2026-01-27T11:38:01.520Z", "parish": 1, "slot": 146, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.520Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 880, "fields": {"created_at": "2026-01-27T11:38:01.537Z", "updated_at": "2026-01-27T11:38:01.537Z", "parish": 1, "slot": 147, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.537Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 881, "fields": {"created_at": "2026-01-27T11:38:01.551Z", "updated_at": "2026-01-27T11:38:01.552Z", "parish": 1, "slot": 148, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.552Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 882, "fields": {"created_at": "2026-01-27T11:38:01.566Z", "updated_at": "2026-01-27T11:38:01.566Z", "parish": 1, "slot": 149, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.566Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 883, "fields": {"created_at": "2026-01-27T11:38:01.585Z", "updated_at": "2026-01-27T11:38:01.585Z", "parish": 1, "slot": 150, "acolyte": 12, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.585Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 884, "fields": {"created_at": "2026-01-27T11:38:01.600Z", "updated_at": "2026-01-27T11:38:01.600Z", "parish": 1, "slot": 151, "acolyte": 10, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.600Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 885, "fields": {"created_at": "2026-01-27T11:38:01.614Z", "updated_at": "2026-01-27T11:38:01.614Z", "parish": 1, "slot": 152, "acolyte": 19, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.614Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 886, "fields": {"created_at": "2026-01-27T11:38:01.632Z", "updated_at": "2026-01-27T11:38:01.632Z", "parish": 1, "slot": 153, "acolyte": 18, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.632Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 887, "fields": {"created_at": "2026-01-27T11:38:01.647Z", "updated_at": "2026-01-27T11:38:01.647Z", "parish": 1, "slot": 154, "acolyte": 16, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.647Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}, {"model": "core.assignment", "pk": 888, "fields": {"created_at": "2026-01-27T11:38:01.661Z", "updated_at": "2026-01-27T11:38:01.661Z", "parish": 1, "slot": 155, "acolyte": 1, "assigned_by": null, "assigned_at": "2026-01-27T11:38:01.661Z", "assignment_state": "proposed", "published_at": null, "is_active": true, "ended_at": null, "end_reason": ""}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\massinterest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\massoverride.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\past_assignment.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\past_assignmentslot.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\past_massinstance.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\positionclaimrequest.json
```json
[{"model": "core.positionclaimrequest", "pk": 8, "fields": {"created_at": "2026-01-26T06:13:52.739Z", "updated_at": "2026-01-27T08:16:48.744Z", "parish": 1, "slot": 3, "requestor_acolyte": 3, "target_assignment": null, "status": "expired", "approval_mode": "", "resolution_reason": "assignment_changed", "auto_approve_at": "2026-02-05T20:00:00Z", "resolved_at": "2026-01-27T08:16:48.744Z", "approved_by": null}}, {"model": "core.positionclaimrequest", "pk": 5, "fields": {"created_at": "2026-01-25T21:13:54.694Z", "updated_at": "2026-01-25T21:31:57.274Z", "parish": 1, "slot": 12, "requestor_acolyte": 1, "target_assignment": null, "status": "expired", "approval_mode": "coordination", "resolution_reason": "holder_confirmed", "auto_approve_at": null, "resolved_at": "2026-01-25T21:31:57.274Z", "approved_by": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\replacementrequest.json
```json
[{"model": "core.replacementrequest", "pk": 11, "fields": {"created_at": "2026-01-26T03:52:46.710Z", "updated_at": "2026-01-26T03:52:46.776Z", "parish": 1, "slot": 2, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 12, "fields": {"created_at": "2026-01-26T03:55:01.453Z", "updated_at": "2026-01-26T03:55:01.526Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 13, "fields": {"created_at": "2026-01-26T03:56:22.179Z", "updated_at": "2026-01-26T03:56:22.339Z", "parish": 1, "slot": 11, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 16, "fields": {"created_at": "2026-01-27T03:38:03.289Z", "updated_at": "2026-01-27T03:38:03.289Z", "parish": 1, "slot": 17, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 14, "fields": {"created_at": "2026-01-26T03:56:36.974Z", "updated_at": "2026-01-26T03:56:37.048Z", "parish": 1, "slot": 20, "requested_by": 3, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Pedro Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 9, "fields": {"created_at": "2026-01-25T18:10:45.171Z", "updated_at": "2026-01-25T18:10:45.229Z", "parish": 1, "slot": 23, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 15, "fields": {"created_at": "2026-01-27T03:38:03.253Z", "updated_at": "2026-01-27T03:38:03.253Z", "parish": 1, "slot": 29, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 8, "fields": {"created_at": "2026-01-25T18:09:03.950Z", "updated_at": "2026-01-25T18:09:04.009Z", "parish": 1, "slot": 34, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 17, "fields": {"created_at": "2026-01-27T03:38:03.326Z", "updated_at": "2026-01-27T03:38:03.326Z", "parish": 1, "slot": 35, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Acolito desativado", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 7, "fields": {"created_at": "2026-01-25T18:08:53.446Z", "updated_at": "2026-01-25T18:08:53.518Z", "parish": 1, "slot": 45, "requested_by": 1, "proposed_acolyte": null, "status": "assigned", "notes": "Criada por recusa de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 4, "fields": {"created_at": "2026-01-23T11:40:58.132Z", "updated_at": "2026-01-23T11:40:58.133Z", "parish": 1, "slot": 51, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}, {"model": "core.replacementrequest", "pk": 5, "fields": {"created_at": "2026-01-23T11:41:55.885Z", "updated_at": "2026-01-23T11:41:55.885Z", "parish": 1, "slot": 107, "requested_by": 1, "proposed_acolyte": null, "status": "pending", "notes": "Criada por cancelamento de Fábio Miguel", "resolved_reason": "", "resolved_notes": "", "resolved_at": null}}]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\serializers\swaprequest.json
```json
[]
```

### maintenance_backups\clear_masses_2026-01-27_20260127T092124\meta.json
```json
{
  "created_at": "2026-01-27T09:21:24.452831-03:00",
  "cutoff_date": "2026-01-27",
  "counts": {
    "past_masses": 0,
    "past_slots": 0,
    "past_assignments": 0,
    "future_assignments_total": 85,
    "confirmations": 0,
    "claims": 2,
    "replacement_requests": 12,
    "swap_requests": 0,
    "mass_interest": 0,
    "mass_override": 0,
    "ledger_rows": 0,
    "audit_events": 85
  },
  "models_included": [
    "core.MassInstance",
    "core.AssignmentSlot",
    "core.Assignment",
    "core.Confirmation",
    "core.PositionClaimRequest",
    "core.ReplacementRequest",
    "core.SwapRequest",
    "core.MassInterest",
    "core.MassOverride",
    "core.AcolyteCreditLedger",
    "core.AuditEvent"
  ]
}
```

### notifications\management\commands\__init__.py
```python

```

### notifications\management\commands\send_notifications.py
```python
from django.core.management.base import BaseCommand

from notifications.services import NotificationService


class Command(BaseCommand):
    help = "Send pending notifications (email/whatsapp)."

    def handle(self, *args, **options):
        service = NotificationService()
        service.send_pending()
        self.stdout.write(self.style.SUCCESS("Notifications processed"))
```

### notifications\management\__init__.py
```python

```

### notifications\migrations\0001_initial.py
```python
# Generated by Django 5.0.7 on 2026-01-19 23:05

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('core', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Notification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel', models.CharField(choices=[('email', 'Email'), ('whatsapp', 'WhatsApp')], max_length=20)),
                ('template_code', models.CharField(max_length=100)),
                ('payload', models.JSONField(blank=True, default=dict)),
                ('idempotency_key', models.CharField(max_length=120)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('sent', 'Sent'), ('failed', 'Failed'), ('skipped', 'Skipped')], default='pending', max_length=20)),
                ('error_message', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'unique_together': {('channel', 'idempotency_key')},
            },
        ),
        migrations.CreateModel(
            name='NotificationPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('email_enabled', models.BooleanField(default=True)),
                ('email_digest', models.BooleanField(default=False)),
                ('whatsapp_enabled', models.BooleanField(default=False)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'unique_together': {('parish', 'user')},
            },
        ),
    ]
```

### notifications\migrations\0002_notification_last_attempt_at_and_more.py
```python
# Generated by Django 5.0.7 on 2026-01-21 04:31

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('notifications', '0001_initial'),
    ]

    operations = [
        migrations.AddField(
            model_name='notification',
            name='last_attempt_at',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='notification',
            name='status',
            field=models.CharField(choices=[('pending', 'Pending'), ('processing', 'Processing'), ('sent', 'Sent'), ('failed', 'Failed'), ('skipped', 'Skipped')], default='pending', max_length=20),
        ),
    ]
```

### notifications\migrations\0003_alter_notification_status.py
```python
# Generated by Django 5.0.7 on 2026-01-23 10:33

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('notifications', '0002_notification_last_attempt_at_and_more'),
    ]

    operations = [
        migrations.AlterField(
            model_name='notification',
            name='status',
            field=models.CharField(choices=[('pending', 'Pendente'), ('processing', 'Processando'), ('sent', 'Enviada'), ('failed', 'Falhou'), ('skipped', 'Ignorada')], default='pending', max_length=20),
        ),
    ]
```

### notifications\apps.py
```python
from django.apps import AppConfig


class NotificationsConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "notifications"
```

### notifications\models.py
```python
from django.conf import settings
from django.db import models

from core.models import Parish


class NotificationPreference(models.Model):
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    email_enabled = models.BooleanField(default=True)
    email_digest = models.BooleanField(default=False)
    whatsapp_enabled = models.BooleanField(default=False)

    class Meta:
        unique_together = ("parish", "user")


class Notification(models.Model):
    CHANNEL_CHOICES = [
        ("email", "Email"),
        ("whatsapp", "WhatsApp"),
    ]
    STATUS_CHOICES = [
        ("pending", "Pendente"),
        ("processing", "Processando"),
        ("sent", "Enviada"),
        ("failed", "Falhou"),
        ("skipped", "Ignorada"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    channel = models.CharField(max_length=20, choices=CHANNEL_CHOICES)
    template_code = models.CharField(max_length=100)
    payload = models.JSONField(default=dict, blank=True)
    idempotency_key = models.CharField(max_length=120)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default="pending")
    error_message = models.TextField(blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    last_attempt_at = models.DateTimeField(null=True, blank=True)
    sent_at = models.DateTimeField(null=True, blank=True)

    class Meta:
        unique_together = ("channel", "idempotency_key")
```

### notifications\services.py
```python
from django.conf import settings
from django.core.mail import send_mail
from django.urls import reverse
from django.utils import timezone
from datetime import timedelta

from core.models import Assignment, AssignmentSlot, PositionClaimRequest, SwapRequest
from notifications.models import Notification, NotificationPreference


class WhatsAppProvider:
    def send(self, notification):
        return True


class NotificationService:
    def __init__(self):
        self.whatsapp_provider = WhatsAppProvider()

    def reclaim_stuck(self, now=None, timeout_minutes=10):
        now = now or timezone.now()
        cutoff = now - timedelta(minutes=timeout_minutes)
        Notification.objects.filter(status="processing", last_attempt_at__lt=cutoff).update(
            status="pending",
            error_message="reclaimed",
            last_attempt_at=None,
        )

    def claim_pending_ids(self, limit=100, now=None):
        now = now or timezone.now()
        self.reclaim_stuck(now=now)
        pending_ids = list(
            Notification.objects.filter(status="pending")
            .order_by("created_at")
            .values_list("id", flat=True)[:limit]
        )
        if not pending_ids:
            return []
        Notification.objects.filter(id__in=pending_ids, status="pending").update(
            status="processing",
            last_attempt_at=now,
        )
        return list(
            Notification.objects.filter(id__in=pending_ids, status="processing", last_attempt_at=now).values_list(
                "id", flat=True
            )
        )

    def deliver(self, notification):
        if notification.channel == "email":
            subject = notification.payload.get("subject", "Acoli notification")
            body = notification.payload.get("body", "")
            send_mail(subject, body, settings.DEFAULT_FROM_EMAIL, [notification.user.email])
            return True
        if notification.channel == "whatsapp":
            return self.whatsapp_provider.send(notification)
        return False

    def send_pending(self):
        claimed_ids = self.claim_pending_ids()
        if not claimed_ids:
            return
        processing = Notification.objects.filter(id__in=claimed_ids, status="processing")
        for notification in processing:
            try:
                delivered = self.deliver(notification)
                if delivered:
                    notification.status = "sent"
                    notification.sent_at = timezone.now()
                else:
                    notification.status = "failed"
                    notification.error_message = "delivery_failed"
            except Exception as exc:
                notification.status = "failed"
                notification.error_message = str(exc)
            notification.save(update_fields=["status", "sent_at", "error_message", "last_attempt_at"])


def _format_datetime(value):
    return timezone.localtime(value).strftime("%d/%m %H:%M")


def _absolute_url(path):
    base = getattr(settings, "APP_BASE_URL", "")
    if base:
        return f"{base}{path}"
    return path


def _render_payload(template_code, parish, payload):
    if payload.get("subject") and payload.get("body"):
        return payload

    assignment = payload.get("assignment")
    if not assignment and payload.get("assignment_id"):
        assignment = Assignment.objects.select_related(
            "slot__mass_instance__community", "slot__position_type"
        ).filter(parish=parish, id=payload["assignment_id"]).first()

    slot = payload.get("slot")
    if not slot and payload.get("slot_id"):
        slot = AssignmentSlot.objects.select_related(
            "mass_instance__community", "position_type"
        ).filter(parish=parish, id=payload["slot_id"]).first()

    swap = payload.get("swap")
    if not swap and payload.get("swap_id"):
        swap = SwapRequest.objects.select_related(
            "mass_instance__community", "from_slot__position_type"
        ).filter(parish=parish, id=payload["swap_id"]).first()

    claim = payload.get("claim")
    if not claim and payload.get("claim_id"):
        claim = PositionClaimRequest.objects.select_related(
            "slot__mass_instance__community",
            "slot__position_type",
            "requestor_acolyte",
            "target_assignment__acolyte",
        ).filter(parish=parish, id=payload["claim_id"]).first()

    if assignment:
        mass = assignment.slot.mass_instance
        context = {
            "date": _format_datetime(mass.starts_at),
            "community": mass.community.code,
            "position": assignment.slot.position_type.name,
            "url": _absolute_url(reverse("mass_detail", args=[mass.id])),
        }
        if template_code == "ASSIGNMENT_PUBLISHED":
            return {
                "subject": "Escala publicada",
                "body": f"Sua escala foi publicada para {context['date']} ({context['community']}). Ver detalhes: {context['url']}",
            }
        if template_code == "CONFIRMATION_REQUESTED":
            return {
                "subject": "Confirmacao de escala",
                "body": f"Confirme sua escala em {context['date']} ({context['community']}). Ver detalhes: {context['url']}",
            }
        if template_code == "REPLACEMENT_ASSIGNED":
            return {
                "subject": "Nova escala",
                "body": f"Voce foi atribuido em {context['date']} ({context['community']}). Ver detalhes: {context['url']}",
            }

    if slot:
        mass = slot.mass_instance
        context = {
            "date": _format_datetime(mass.starts_at),
            "community": mass.community.code,
            "position": slot.position_type.name,
            "url": _absolute_url(reverse("mass_detail", args=[mass.id])),
        }
        if template_code == "ASSIGNMENT_CANCELED_ALERT_ADMIN":
            return {
                "subject": "Vaga aberta",
                "body": f"Vaga aberta em {context['date']} ({context['community']}) - {context['position']}. Ver detalhes: {context['url']}",
            }

    if swap:
        mass = swap.mass_instance
        context = {
            "date": _format_datetime(mass.starts_at),
            "community": mass.community.code,
            "position": swap.from_slot.position_type.name if swap.from_slot else "Funcao",
            "url": _absolute_url(reverse("swap_requests")),
        }
        if template_code == "SWAP_REQUESTED":
            return {
                "subject": "Solicitacao de troca",
                "body": f"Voce recebeu uma solicitacao de troca para {context['date']} ({context['community']}). Ver detalhes: {context['url']}",
            }
        if template_code == "SWAP_ACCEPTED":
            return {
                "subject": "Troca aprovada",
                "body": f"A troca para {context['date']} ({context['community']}) foi aprovada. Ver detalhes: {context['url']}",
            }
        if template_code == "SWAP_REJECTED":
            return {
                "subject": "Troca recusada",
                "body": f"A troca para {context['date']} ({context['community']}) foi recusada. Ver detalhes: {context['url']}",
            }

    if claim:
        mass = claim.slot.mass_instance
        context = {
            "date": _format_datetime(mass.starts_at),
            "community": mass.community.code,
            "position": claim.slot.position_type.name,
            "requestor": claim.requestor_acolyte.display_name,
            "url": _absolute_url(reverse("mass_detail", args=[mass.id])),
        }
        if template_code == "POSITION_CLAIM_REQUESTED":
            return {
                "subject": "Solicitacao de posicao",
                "body": f"{context['requestor']} solicitou sua posicao em {context['date']} ({context['community']}) - {context['position']}. Ver detalhes: {context['url']}",
            }
        if template_code == "POSITION_CLAIM_APPROVED":
            return {
                "subject": "Solicitacao aprovada",
                "body": f"Sua solicitacao para {context['date']} ({context['community']}) - {context['position']} foi aprovada. Ver detalhes: {context['url']}",
            }
        if template_code == "POSITION_CLAIM_REJECTED":
            return {
                "subject": "Solicitacao recusada",
                "body": f"Sua solicitacao para {context['date']} ({context['community']}) - {context['position']} foi recusada. Ver detalhes: {context['url']}",
            }
        if template_code == "POSITION_CLAIM_COORDINATION_REQUIRED":
            return {
                "subject": "Solicitacao aguardando aprovacao",
                "body": f"Solicitacao de {context['requestor']} para {context['date']} ({context['community']}) - {context['position']} aguardando aprovacao. Ver detalhes: {context['url']}",
            }

    return {"subject": "Acoli", "body": "Voce tem uma nova atualizacao no sistema."}


def enqueue_notification(parish, user, template_code, payload, idempotency_key, channel="email"):
    if not idempotency_key.startswith(f"parish:{parish.id}:"):
        idempotency_key = f"parish:{parish.id}:{idempotency_key}"
    payload = _render_payload(template_code, parish, payload)
    if channel == "email":
        if not user.is_active:
            notification, _ = Notification.objects.get_or_create(
                channel=channel,
                idempotency_key=idempotency_key,
                defaults={
                    "parish": parish,
                    "user": user,
                    "template_code": template_code,
                    "payload": payload,
                    "status": "skipped",
                    "error_message": "user_inactive",
                },
            )
            return notification
        if not user.email:
            notification, _ = Notification.objects.get_or_create(
                channel=channel,
                idempotency_key=idempotency_key,
                defaults={
                    "parish": parish,
                    "user": user,
                    "template_code": template_code,
                    "payload": payload,
                    "status": "skipped",
                    "error_message": "missing_email",
                },
            )
            return notification
        pref = NotificationPreference.objects.filter(parish=parish, user=user).first()
        if pref and not pref.email_enabled:
            notification, _ = Notification.objects.get_or_create(
                channel=channel,
                idempotency_key=idempotency_key,
                defaults={
                    "parish": parish,
                    "user": user,
                    "template_code": template_code,
                    "payload": payload,
                    "status": "skipped",
                    "error_message": "email_disabled",
                },
            )
            return notification
    notification, _ = Notification.objects.get_or_create(
        channel=channel,
        idempotency_key=idempotency_key,
        defaults={
            "parish": parish,
            "user": user,
            "template_code": template_code,
            "payload": payload,
            "status": "pending",
        },
    )
    return notification
```

### notifications\tests.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase, override_settings
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    Parish,
    PositionType,
)
from notifications.models import Notification
from notifications.services import NotificationService, enqueue_notification


class NotificationIdempotencyTests(TestCase):
    def test_idempotency_is_scoped_by_parish(self):
        User = get_user_model()
        user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        parish_a = Parish.objects.create(name="Parish A")
        parish_b = Parish.objects.create(name="Parish B")

        enqueue_notification(parish_a, user, "ASSIGNMENT_PUBLISHED", {"assignment_id": 1}, "publish:1")
        enqueue_notification(parish_b, user, "ASSIGNMENT_PUBLISHED", {"assignment_id": 1}, "publish:1")

        self.assertEqual(Notification.objects.count(), 2)
        keys = set(Notification.objects.values_list("idempotency_key", flat=True))
        self.assertTrue(any(key.startswith(f"parish:{parish_a.id}:") for key in keys))
        self.assertTrue(any(key.startswith(f"parish:{parish_b.id}:") for key in keys))


class NotificationTemplateTests(TestCase):
    @override_settings(APP_BASE_URL="https://example.com")
    def test_assignment_payload_uses_absolute_url(self):
        User = get_user_model()
        user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, user=user, display_name="Acolito")

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now(),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="open",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte)

        notification = enqueue_notification(
            parish,
            user,
            "ASSIGNMENT_PUBLISHED",
            {"assignment_id": assignment.id},
            "publish:1",
        )
        self.assertIn("https://example.com", notification.payload.get("body", ""))


class NotificationProcessingTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")

    def test_claim_pending_is_exclusive(self):
        Notification.objects.create(
            parish=self.parish,
            user=self.user,
            channel="email",
            template_code="ASSIGNMENT_PUBLISHED",
            payload={"subject": "Teste", "body": "Teste"},
            idempotency_key="parish:1:claim:1",
        )
        Notification.objects.create(
            parish=self.parish,
            user=self.user,
            channel="email",
            template_code="ASSIGNMENT_PUBLISHED",
            payload={"subject": "Teste", "body": "Teste"},
            idempotency_key="parish:1:claim:2",
        )
        service = NotificationService()
        first = set(service.claim_pending_ids(limit=1))
        second = set(service.claim_pending_ids(limit=1))
        self.assertEqual(len(first), 1)
        self.assertEqual(len(second), 1)
        self.assertTrue(first.isdisjoint(second))

    def test_claim_pending_returns_only_updated_batch(self):
        Notification.objects.create(
            parish=self.parish,
            user=self.user,
            channel="email",
            template_code="ASSIGNMENT_PUBLISHED",
            payload={"subject": "Teste", "body": "Teste"},
            idempotency_key="parish:1:claim:3",
        )
        Notification.objects.create(
            parish=self.parish,
            user=self.user,
            channel="email",
            template_code="ASSIGNMENT_PUBLISHED",
            payload={"subject": "Teste", "body": "Teste"},
            idempotency_key="parish:1:claim:4",
        )
        service = NotificationService()
        now = timezone.now()
        claimed = service.claim_pending_ids(limit=10, now=now)
        self.assertEqual(len(claimed), 2)
        self.assertEqual(
            Notification.objects.filter(id__in=claimed, last_attempt_at=now).count(),
            2,
        )
        self.assertEqual(service.claim_pending_ids(limit=10), [])

    def test_failed_delivery_does_not_set_sent_at(self):
        class FailingService(NotificationService):
            def deliver(self, notification):
                raise RuntimeError("fail")

        notification = Notification.objects.create(
            parish=self.parish,
            user=self.user,
            channel="email",
            template_code="ASSIGNMENT_PUBLISHED",
            payload={"subject": "Teste", "body": "Teste"},
            idempotency_key="parish:1:fail:1",
        )
        service = FailingService()
        service.send_pending()
        notification.refresh_from_db()
        self.assertEqual(notification.status, "failed")
        self.assertIsNone(notification.sent_at)
        self.assertTrue(notification.error_message)

    def test_reclaim_stuck_processing(self):
        now = timezone.now()
        stuck = Notification.objects.create(
            parish=self.parish,
            user=self.user,
            channel="email",
            template_code="ASSIGNMENT_PUBLISHED",
            payload={"subject": "Teste", "body": "Teste"},
            idempotency_key="parish:1:stuck:1",
            status="processing",
            last_attempt_at=now - timedelta(minutes=20),
        )
        service = NotificationService()
        claimed = service.claim_pending_ids(limit=10, now=now)
        self.assertIn(stuck.id, claimed)
        stuck.refresh_from_db()
        self.assertEqual(stuck.status, "processing")
        self.assertEqual(stuck.last_attempt_at, now)
```

### scheduler\management\commands\__init__.py
```python

```

### scheduler\management\commands\run_global_scheduler.py
```python
from django.core.management.base import BaseCommand
from django.utils import timezone

from scheduler.models import ScheduleJobRequest
from core.models import AssignmentSlot
from core.services.replacements import assign_replacement, assign_replacement_request
from notifications.services import enqueue_notification
from scheduler.services.jobs import claim_job
from scheduler.services.horizon import build_horizon_instances
from scheduler.services.solver import solve_open_slots, solve_schedule


class Command(BaseCommand):
    help = "Run pending schedule jobs."

    def add_arguments(self, parser):
        parser.add_argument("--parish-id", type=int)

    def handle(self, *args, **options):
        parish_id = options.get("parish_id")
        jobs = ScheduleJobRequest.objects.filter(status="pending").order_by("created_at")
        if parish_id:
            jobs = jobs.filter(parish_id=parish_id)
        for job in jobs:
            if not claim_job(job.id):
                continue
            job.refresh_from_db()
            try:
                parish = job.parish
                weights = parish.schedule_weights or {}
                if job.job_type == "replacement":
                    payload = job.payload_json or {}
                    slot_ids = payload.get("slot_ids") or []
                    if payload.get("slot_id"):
                        slot_ids.append(payload.get("slot_id"))
                    slots = AssignmentSlot.objects.filter(parish=parish, id__in=slot_ids)
                    result = solve_open_slots(parish, slots, weights)
                    assigned = 0
                    replacement_id = payload.get("replacement_request_id")
                    for slot_id, acolyte in result.assigned_map.items():
                        try:
                            if replacement_id:
                                assignment = assign_replacement_request(parish, replacement_id, acolyte, actor=None)
                            else:
                                slot = AssignmentSlot.objects.filter(parish=parish, id=slot_id).first()
                                assignment = assign_replacement(parish, slot, acolyte, actor=None) if slot else None
                            if assignment:
                                assigned += 1
                                if assignment.acolyte.user:
                                    enqueue_notification(
                                        parish,
                                        assignment.acolyte.user,
                                        "REPLACEMENT_ASSIGNED",
                                        {"assignment_id": assignment.id},
                                        idempotency_key=f"replacement:{assignment.id}",
                                    )
                        except Exception:
                            continue
                    job.status = "success" if result.feasible else "failed"
                    job.summary_json = {
                        "coverage": result.coverage,
                        "preference_score": result.preference_score,
                        "fairness_std": result.fairness_std,
                        "changes": assigned,
                        "required_slots_count": result.required_slots_count,
                        "unfilled_slots_count": result.unfilled_slots_count,
                        "unfilled_details": result.unfilled_details,
                    }
                    if not result.feasible:
                        job.error_message = "Slots sem candidatos para cobertura."
                else:
                    instances = build_horizon_instances(parish, job.horizon_days)
                    result = solve_schedule(parish, instances, parish.consolidation_days, weights, allow_changes=job.force_republish)
                    job.status = "success" if result.feasible else "failed"
                    job.summary_json = {
                        "coverage": result.coverage,
                        "preference_score": result.preference_score,
                        "fairness_std": result.fairness_std,
                        "changes": result.changes,
                        "required_slots_count": result.required_slots_count,
                        "unfilled_slots_count": result.unfilled_slots_count,
                        "unfilled_details": result.unfilled_details,
                    }
                    if not result.feasible:
                        job.error_message = "Slots sem candidatos para cobertura."
                job.finished_at = timezone.now()
                job.save(update_fields=["status", "summary_json", "finished_at", "error_message"])
                self.stdout.write(self.style.SUCCESS(f"Job {job.id} completed"))
            except Exception as exc:
                job.status = "failed"
                job.error_message = str(exc)
                job.finished_at = timezone.now()
                job.save(update_fields=["status", "error_message", "finished_at"])
                self.stderr.write(self.style.ERROR(f"Job {job.id} failed: {exc}"))
```

### scheduler\management\__init__.py
```python

```

### scheduler\migrations\0001_initial.py
```python
# Generated by Django 5.0.7 on 2026-01-19 23:05

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('core', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ScheduleJobRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('success', 'Success'), ('failed', 'Failed')], default='pending', max_length=20)),
                ('horizon_days', models.PositiveIntegerField(default=60)),
                ('force_republish', models.BooleanField(default=False)),
                ('summary_json', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('finished_at', models.DateTimeField(blank=True, null=True)),
                ('error_message', models.TextField(blank=True)),
                ('parish', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.parish')),
                ('requested_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]
```

### scheduler\migrations\0002_alter_schedulejobrequest_status.py
```python
# Generated by Django 5.0.7 on 2026-01-23 10:33

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('scheduler', '0001_initial'),
    ]

    operations = [
        migrations.AlterField(
            model_name='schedulejobrequest',
            name='status',
            field=models.CharField(choices=[('pending', 'Pendente'), ('running', 'Executando'), ('success', 'Concluido'), ('failed', 'Falhou')], default='pending', max_length=20),
        ),
    ]
```

### scheduler\migrations\0003_schedulejobrequest_job_type_payload.py
```python
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ("scheduler", "0002_alter_schedulejobrequest_status"),
    ]

    operations = [
        migrations.AddField(
            model_name="schedulejobrequest",
            name="job_type",
            field=models.CharField(
                choices=[("schedule", "Escalonamento"), ("replacement", "Substituicao")],
                default="schedule",
                max_length=20,
            ),
        ),
        migrations.AddField(
            model_name="schedulejobrequest",
            name="payload_json",
            field=models.JSONField(blank=True, default=dict),
        ),
    ]
```

### scheduler\services\horizon.py
```python
from datetime import timedelta

from django.utils import timezone

from core.models import MassInstance


def build_horizon_instances(parish, horizon_days):
    start = timezone.now()
    end = start + timedelta(days=horizon_days)
    qs = MassInstance.objects.filter(parish=parish, starts_at__range=(start, end), status="scheduled")
    return qs.select_related("community", "requirement_profile", "template")
```

### scheduler\services\jobs.py
```python
from django.utils import timezone

from scheduler.models import ScheduleJobRequest


def claim_job(job_id, now=None):
    now = now or timezone.now()
    updated = ScheduleJobRequest.objects.filter(id=job_id, status="pending").update(
        status="running",
        started_at=now,
    )
    return updated == 1
```

### scheduler\services\quick_fill.py
```python
from core.models import AcolyteAvailabilityRule, AcolytePreference, AcolyteQualification, AcolyteStats
from core.services.recommendations import build_recommendation_cache, rank_candidates


def build_quick_fill_cache(parish, position_type_ids=None, slots=None):
    cache = build_recommendation_cache(parish, slots=slots)
    if position_type_ids:
        filtered = {}
        for position_id, acolyte_ids in cache["qualified_by_position"].items():
            if position_id in position_type_ids:
                filtered[position_id] = acolyte_ids
        cache["qualified_by_position"] = filtered
        qualified_pairs = {}
        for position_id, acolyte_ids in filtered.items():
            for acolyte_id in acolyte_ids:
                qualified_pairs[(acolyte_id, position_id)] = True
        cache["qualified_pairs"] = qualified_pairs
    return cache


def quick_fill_slot(slot, parish, max_candidates=3, cache=None, exclude_acolyte_ids=None):
    """
    Return a list of candidate acolytes for a slot, ranked by preference score.

    Args:
        slot: The AssignmentSlot to fill
        parish: The parish context
        max_candidates: Maximum number of candidates to return (default 3)
        cache: Optional pre-built cache from build_quick_fill_cache()
        exclude_acolyte_ids: Set of acolyte IDs to exclude (e.g., already assigned in this mass)
    """
    exclude_acolyte_ids = exclude_acolyte_ids or set()
    return rank_candidates(
        slot,
        parish,
        max_candidates=max_candidates,
        exclude_acolyte_ids=exclude_acolyte_ids,
        cache=cache,
        enforce_dynamic=True,
    )
```

### scheduler\services\solver.py
```python
from collections import defaultdict
from datetime import timedelta

from django.utils import timezone
from ortools.sat.python import cp_model

from django.db.models import Prefetch

from core.models import (
    AcolyteIntent,
    AcolytePreference,
    Assignment,
    AssignmentSlot,
)
from django.db import transaction

from core.services.assignments import _assign_acolyte_to_slot_locked, _lock_slot, ConcurrentUpdateError, deactivate_assignment
from core.services.recommendations import (
    build_candidate_map,
    build_recommendation_cache,
    get_mass_context,
    is_candidate_eligible_dynamic,
    is_candidate_eligible_static,
    score_candidate,
)


class ScheduleSolveResult:
    def __init__(
        self,
        coverage,
        preference_score,
        fairness_std,
        changes,
        required_slots_count=0,
        unfilled_slots_count=0,
        unfilled_details=None,
        feasible=True,
        assigned_map=None,
    ):
        self.coverage = coverage
        self.preference_score = preference_score
        self.fairness_std = fairness_std
        self.changes = changes
        self.required_slots_count = required_slots_count
        self.unfilled_slots_count = unfilled_slots_count
        self.unfilled_details = unfilled_details or []
        self.feasible = feasible
        self.assigned_map = assigned_map or {}


def _ensure_slots(instances):
    for instance in instances:
        if not instance.requirement_profile:
            continue
        for position in instance.requirement_profile.positions.select_related("position_type").all():
            for idx in range(1, position.quantity + 1):
                AssignmentSlot.objects.get_or_create(
                    parish=instance.parish,
                    mass_instance=instance,
                    position_type=position.position_type,
                    slot_index=idx,
                    defaults={"required": True, "status": "open"},
                )


def solve_schedule(parish, instances, consolidation_days, weights, allow_changes=False):
    instances = [instance for instance in instances if instance.status == "scheduled"]
    if not instances:
        return ScheduleSolveResult(coverage=0, preference_score=0, fairness_std=0, changes=0, feasible=False)

    _ensure_slots(instances)
    slots = list(
        AssignmentSlot.objects.filter(mass_instance__in=instances)
        .select_related("mass_instance", "mass_instance__event_series", "position_type")
        .prefetch_related(
            "position_type__functions",
            Prefetch("assignments", queryset=Assignment.objects.filter(is_active=True), to_attr="active_assignments"),
        )
    )
    if not slots:
        return ScheduleSolveResult(coverage=0, preference_score=0, fairness_std=0, changes=0, feasible=False)

    decision_slots = [slot for slot in slots if slot.required]
    if not decision_slots:
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=0,
            unfilled_slots_count=0,
            unfilled_details=[],
            feasible=True,
        )

    acolytes = list(parish.acolytes.filter(active=True))
    if not acolytes:
        return ScheduleSolveResult(coverage=0, preference_score=0, fairness_std=0, changes=0, feasible=False)
    reserve_ids = {acolyte.id for acolyte in acolytes if acolyte.scheduling_mode == "reserve"}

    preferences = AcolytePreference.objects.filter(parish=parish)
    intents = {intent.acolyte_id: intent for intent in AcolyteIntent.objects.filter(parish=parish)}

    cache = build_recommendation_cache(parish, slots=decision_slots, acolytes=acolytes)
    cache["weights"] = weights
    candidates, deferred_slots, cache = build_candidate_map(decision_slots, parish, cache=cache)

    if deferred_slots:
        decision_slots = [slot for slot in decision_slots if slot not in deferred_slots]

    context_by_slot = {}
    local_eligible_count_by_slot = {}
    max_candidates = weights.get("max_candidates_per_slot")
    try:
        max_candidates = int(max_candidates) if max_candidates else None
    except (TypeError, ValueError):
        max_candidates = None

    for slot in decision_slots:
        context = get_mass_context(slot.mass_instance, cache["weights"], cache.get("interest_map"), cache["now"])
        context_by_slot[slot.id] = context
        slot_candidates = candidates.get(slot.id, [])
        local_eligible_count = len(
            [
                acolyte
                for acolyte in slot_candidates
                if acolyte.community_of_origin_id == slot.mass_instance.community_id
                and slot.mass_instance.community_id not in cache["avoid_communities"].get(acolyte.id, set())
            ]
        )
        local_eligible_count_by_slot[slot.id] = local_eligible_count
        if max_candidates:
            scored = []
            for acolyte in slot_candidates:
                score = score_candidate(
                    acolyte,
                    slot,
                    context,
                    cache,
                    local_eligible_count=local_eligible_count,
                )
                scored.append((score, acolyte))
            scored.sort(key=lambda item: item[0], reverse=True)
            slot_candidates = [acolyte for _score, acolyte in scored[: int(max_candidates)]]
        candidates[slot.id] = slot_candidates

    unfilled_details = []
    for slot in deferred_slots:
        unfilled_details.append(
            {
                "mass_instance_id": slot.mass_instance_id,
                "starts_at": slot.mass_instance.starts_at.isoformat(),
                "community_id": slot.mass_instance.community_id,
                "position_type_id": slot.position_type_id,
                "slot_index": slot.slot_index,
                "reason": "interest_open",
            }
        )

    no_candidate_slots = []
    for slot in decision_slots:
        if not candidates.get(slot.id):
            no_candidate_slots.append(slot)
            unfilled_details.append(
                {
                    "mass_instance_id": slot.mass_instance_id,
                    "starts_at": slot.mass_instance.starts_at.isoformat(),
                    "community_id": slot.mass_instance.community_id,
                    "position_type_id": slot.position_type_id,
                    "slot_index": slot.slot_index,
                    "reason": "no_candidates",
                }
            )

    if no_candidate_slots:
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=len(decision_slots) + len(deferred_slots),
            unfilled_slots_count=len(unfilled_details),
            unfilled_details=unfilled_details,
            feasible=False,
        )

    if not decision_slots:
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=len(deferred_slots),
            unfilled_slots_count=len(unfilled_details),
            unfilled_details=unfilled_details,
            feasible=True,
        )

    model = cp_model.CpModel()
    x = {}

    for slot in decision_slots:
        for acolyte in candidates.get(slot.id, []):
            x[(slot.id, acolyte.id)] = model.NewBoolVar(f"x_{slot.id}_{acolyte.id}")

    for slot in decision_slots:
        vars_for_slot = [x[(slot.id, a.id)] for a in candidates.get(slot.id, [])]
        if not vars_for_slot:
            continue
        model.Add(sum(vars_for_slot) == 1)

    slots_by_mass = defaultdict(list)
    for slot in decision_slots:
        slots_by_mass[slot.mass_instance_id].append(slot)
    for mass_slots in slots_by_mass.values():
        for acolyte in acolytes:
            vars_for_acolyte = [x[(slot.id, acolyte.id)] for slot in mass_slots if (slot.id, acolyte.id) in x]
            if vars_for_acolyte:
                model.Add(sum(vars_for_acolyte) <= 1)

    senior_ids = {acolyte.id for acolyte in acolytes if acolyte.experience_level == "senior"}
    if senior_ids:
        for mass_id, mass_slots in slots_by_mass.items():
            min_senior = 0
            mass_instance = mass_slots[0].mass_instance if mass_slots else None
            if mass_instance and mass_instance.requirement_profile:
                min_senior = getattr(mass_instance.requirement_profile, "min_senior_per_mass", 0) or 0
            if min_senior:
                vars_for_senior = [
                    x[(slot.id, acolyte_id)]
                    for slot in mass_slots
                    for acolyte_id in senior_ids
                    if (slot.id, acolyte_id) in x
                ]
                model.Add(sum(vars_for_senior) >= int(min_senior))

    mass_duration = int(getattr(parish, "default_mass_duration_minutes", 60))
    rest_minutes = int(getattr(parish, "min_rest_minutes_between_masses", 0))
    min_gap = (mass_duration + rest_minutes) * 60
    sorted_slots = sorted(decision_slots, key=lambda slot: slot.mass_instance.starts_at)
    conflict_pairs = []
    for idx, slot_a in enumerate(sorted_slots):
        a_start = slot_a.mass_instance.starts_at
        for slot_b in sorted_slots[idx + 1 :]:
            if slot_a.mass_instance_id == slot_b.mass_instance_id:
                continue
            b_start = slot_b.mass_instance.starts_at
            if (b_start - a_start).total_seconds() >= min_gap:
                break
            conflict_pairs.append((slot_a, slot_b))
    for acolyte in acolytes:
        for slot_a, slot_b in conflict_pairs:
            if (slot_a.id, acolyte.id) in x and (slot_b.id, acolyte.id) in x:
                model.Add(x[(slot_a.id, acolyte.id)] + x[(slot_b.id, acolyte.id)] <= 1)

    decision_week_counts = defaultdict(lambda: defaultdict(int))
    for slot in decision_slots:
        for assignment in getattr(slot, "active_assignments", []):
            week_key = slot.mass_instance.starts_at.isocalendar()[:2]
            decision_week_counts[assignment.acolyte_id][week_key] += 1

    max_services_per_week = weights.get("max_services_per_week")
    if max_services_per_week:
        slots_by_week = defaultdict(list)
        for slot in decision_slots:
            key = slot.mass_instance.starts_at.isocalendar()[:2]
            slots_by_week[key].append(slot)
        for week_slots in slots_by_week.values():
            for acolyte in acolytes:
                vars_for_week = [x[(slot.id, acolyte.id)] for slot in week_slots if (slot.id, acolyte.id) in x]
                if vars_for_week:
                    week_key = week_slots[0].mass_instance.starts_at.isocalendar()[:2]
                    existing = cache["weekly_counts_by_acolyte"].get(acolyte.id, {}).get(week_key, 0)
                    existing -= decision_week_counts.get(acolyte.id, {}).get(week_key, 0)
                    if existing < 0:
                        existing = 0
                    limit = int(max_services_per_week) - existing
                    if limit < 0:
                        limit = 0
                    model.Add(sum(vars_for_week) <= limit)

    max_consecutive_weekends = weights.get("max_consecutive_weekends")
    if max_consecutive_weekends:
        weekend_map = defaultdict(list)
        for slot in decision_slots:
            weekday = slot.mass_instance.starts_at.weekday()
            if weekday in (5, 6):
                date = slot.mass_instance.starts_at.date()
                if weekday == 6:
                    date = date - timedelta(days=1)
                weekend_map[date].append(slot)
        weekend_keys = sorted(weekend_map.keys())
        if weekend_keys:
            weekend_vars = {acolyte.id: {} for acolyte in acolytes}
            for acolyte in acolytes:
                for weekend_date, weekend_slots in weekend_map.items():
                    vars_for_weekend = [x[(slot.id, acolyte.id)] for slot in weekend_slots if (slot.id, acolyte.id) in x]
                    if not vars_for_weekend:
                        continue
                    weekend_var = model.NewBoolVar(f"weekend_{acolyte.id}_{weekend_date}")
                    for var in vars_for_weekend:
                        model.Add(weekend_var >= var)
                    model.Add(weekend_var <= sum(vars_for_weekend))
                    weekend_vars[acolyte.id][weekend_date] = weekend_var
            window_size = int(max_consecutive_weekends) + 1
            for acolyte in acolytes:
                for idx in range(0, max(0, len(weekend_keys) - window_size + 1)):
                    window = weekend_keys[idx : idx + window_size]
                    vars_in_window = []
                    for key in window:
                        if key in weekend_vars[acolyte.id]:
                            vars_in_window.append(weekend_vars[acolyte.id][key])
                    if vars_in_window:
                        model.Add(sum(vars_in_window) <= int(max_consecutive_weekends))

    consolidation_limit = timezone.now() + timedelta(days=consolidation_days)
    locked_slots = []
    for slot in decision_slots:
        if slot.mass_instance.starts_at <= consolidation_limit and slot.is_locked:
            locked_slots.append(slot)
    for slot in locked_slots:
        existing_assignment = slot.get_active_assignment()
        if existing_assignment:
            for acolyte in candidates.get(slot.id, []):
                value = 1 if acolyte.id == existing_assignment.acolyte_id else 0
                if (slot.id, acolyte.id) in x:
                    model.Add(x[(slot.id, acolyte.id)] == value)

    preference_terms = []
    fairness_terms = []
    stability_terms = []
    partner_terms = []
    family_terms = []

    for slot in decision_slots:
        context = context_by_slot.get(slot.id)
        local_count = local_eligible_count_by_slot.get(slot.id, 0)
        for acolyte in candidates.get(slot.id, []):
            base_score = score_candidate(
                acolyte,
                slot,
                context,
                cache,
                local_eligible_count=local_count,
            )
            preference_terms.append(base_score * x[(slot.id, acolyte.id)])

            existing_assignment = slot.get_active_assignment()
            if existing_assignment and existing_assignment.assignment_state in ["published", "locked"]:
                if not allow_changes:
                    penalty = weights.get("stability_penalty", 10)
                    if acolyte.id != existing_assignment.acolyte_id:
                        stability_terms.append(penalty * x[(slot.id, acolyte.id)])

    partner_prefs = [pref for pref in preferences if pref.preference_type in ["preferred_partner", "avoid_partner"] and pref.target_acolyte_id]
    if partner_prefs:
        partner_ids = set()
        for pref in partner_prefs:
            partner_ids.add(pref.acolyte_id)
            partner_ids.add(pref.target_acolyte_id)
        mass_acolyte_vars = defaultdict(dict)
        for mass_id, mass_slots in slots_by_mass.items():
            for acolyte_id in partner_ids:
                vars_for_acolyte = [x[(slot.id, acolyte_id)] for slot in mass_slots if (slot.id, acolyte_id) in x]
                if not vars_for_acolyte:
                    continue
                assigned_var = model.NewBoolVar(f"mass_{mass_id}_a_{acolyte_id}")
                for var in vars_for_acolyte:
                    model.Add(assigned_var >= var)
                model.Add(assigned_var <= sum(vars_for_acolyte))
                mass_acolyte_vars[mass_id][acolyte_id] = assigned_var
        for pref in partner_prefs:
            for mass_id in slots_by_mass.keys():
                a_var = mass_acolyte_vars.get(mass_id, {}).get(pref.acolyte_id)
                b_var = mass_acolyte_vars.get(mass_id, {}).get(pref.target_acolyte_id)
                if a_var is None or b_var is None:
                    continue
                pair_var = model.NewBoolVar(f"pair_{pref.acolyte_id}_{pref.target_acolyte_id}_{mass_id}")
                model.Add(pair_var <= a_var)
                model.Add(pair_var <= b_var)
                model.Add(pair_var >= a_var + b_var - 1)
                weight = pref.weight or 0
                if pref.preference_type == "avoid_partner":
                    weight = -weight
                partner_terms.append(weight * pair_var)

    family_bonus = int(weights.get("family_group_bonus", 2))
    if family_bonus:
        families = defaultdict(list)
        for acolyte in acolytes:
            if acolyte.family_group_id:
                families[acolyte.family_group_id].append(acolyte.id)
        for family_id, members in families.items():
            if len(members) < 2:
                continue
            for mass_id, mass_slots in slots_by_mass.items():
                member_vars = {}
                for acolyte_id in members:
                    vars_for_acolyte = [
                        x[(slot.id, acolyte_id)]
                        for slot in mass_slots
                        if (slot.id, acolyte_id) in x
                    ]
                    if not vars_for_acolyte:
                        continue
                    assigned_var = model.NewBoolVar(f"family_{family_id}_{mass_id}_{acolyte_id}")
                    for var in vars_for_acolyte:
                        model.Add(assigned_var >= var)
                    model.Add(assigned_var <= sum(vars_for_acolyte))
                    member_vars[acolyte_id] = assigned_var
                member_ids = list(member_vars.keys())
                for idx, acolyte_id in enumerate(member_ids):
                    for other_id in member_ids[idx + 1 :]:
                        pair_var = model.NewBoolVar(f"family_pair_{family_id}_{mass_id}_{acolyte_id}_{other_id}")
                        model.Add(pair_var <= member_vars[acolyte_id])
                        model.Add(pair_var <= member_vars[other_id])
                        model.Add(pair_var >= member_vars[acolyte_id] + member_vars[other_id] - 1)
                        family_terms.append(family_bonus * pair_var)

    horizon_days = 30
    if decision_slots:
        starts = [slot.mass_instance.starts_at for slot in decision_slots]
        horizon_days = max((max(starts) - min(starts)).days, 1)

    if acolytes:
        base_target = len(decision_slots) / len(acolytes)
        raw_targets = {}
        for acolyte in acolytes:
            intent = intents.get(acolyte.id)
            if acolyte.id in reserve_ids:
                raw_target = 0
            elif intent and intent.desired_frequency_per_month:
                raw_target = intent.desired_frequency_per_month * (horizon_days / 30)
            else:
                level = getattr(intent, "willingness_level", "normal") if intent else "normal"
                factor = {"low": 0.8, "normal": 1.0, "high": 1.2}.get(level, 1.0)
                raw_target = base_target * factor
            raw_targets[acolyte.id] = raw_target
        total_raw = sum(raw_targets.values()) or 1
        scale = len(decision_slots) / total_raw
        target_loads = {acolyte_id: int(round(raw * scale)) for acolyte_id, raw in raw_targets.items()}

        for acolyte in acolytes:
            vars_for_acolyte = [x[(slot.id, acolyte.id)] for slot in decision_slots if (slot.id, acolyte.id) in x]
            if vars_for_acolyte:
                target = target_loads.get(acolyte.id, int(round(base_target)))
                diff = model.NewIntVar(-len(decision_slots), len(decision_slots), f"diff_{acolyte.id}")
                model.Add(diff == sum(vars_for_acolyte) - target)
                abs_diff = model.NewIntVar(0, len(decision_slots), f"abs_diff_{acolyte.id}")
                model.AddAbsEquality(abs_diff, diff)
                fairness_terms.append(abs_diff)

    objective_terms = []
    if preference_terms:
        objective_terms.append(sum(preference_terms))
    if fairness_terms:
        objective_terms.append(-weights.get("fairness_penalty", 1) * sum(fairness_terms))
    if stability_terms:
        objective_terms.append(-sum(stability_terms))
    if partner_terms:
        objective_terms.append(sum(partner_terms))
    if family_terms:
        objective_terms.append(sum(family_terms))

    model.Maximize(sum(objective_terms) if objective_terms else 0)

    solver = cp_model.CpSolver()
    solver.parameters.max_time_in_seconds = float(weights.get("max_solve_seconds", 15))
    status = solver.Solve(model)

    if status not in (cp_model.OPTIMAL, cp_model.FEASIBLE):
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=len(decision_slots),
            unfilled_slots_count=len(unfilled_details),
            unfilled_details=unfilled_details,
            feasible=False,
        )

    changes = 0
    coverage = 0
    preference_total = 0
    assignment_counts = []

    for slot in decision_slots:
        assigned_acolyte = None
        for acolyte in candidates.get(slot.id, []):
            if solver.Value(x[(slot.id, acolyte.id)]) == 1:
                assigned_acolyte = acolyte
                context = context_by_slot.get(slot.id)
                local_count = local_eligible_count_by_slot.get(slot.id, 0)
                preference_total += score_candidate(
                    acolyte,
                    slot,
                    context,
                    cache,
                    local_eligible_count=local_count,
                )
                break
        if assigned_acolyte:
            coverage += 1
            try:
                with transaction.atomic():
                    locked_slot = _lock_slot(slot.id)
                    existing = locked_slot.get_active_assignment()
                    desired_state = existing.assignment_state if existing else "proposed"
                    if not existing:
                        _assign_acolyte_to_slot_locked(
                            locked_slot,
                            assigned_acolyte,
                            assignment_state=desired_state,
                            end_reason="replaced_by_solver",
                        )
                        locked_slot.status = "finalized" if locked_slot.is_locked else "assigned"
                        locked_slot.save(update_fields=["status", "updated_at"])
                        changes += 1
                    elif existing.acolyte_id != assigned_acolyte.id:
                        deactivate_assignment(existing, "replaced_by_solver", actor=None)
                        _assign_acolyte_to_slot_locked(
                            locked_slot,
                            assigned_acolyte,
                            assignment_state=desired_state,
                            end_reason="replaced_by_solver",
                        )
                        locked_slot.status = "finalized" if locked_slot.is_locked else "assigned"
                        locked_slot.save(update_fields=["status", "updated_at"])
                        changes += 1
            except (ConcurrentUpdateError, ValueError):
                continue

    for acolyte in acolytes:
        count = 0
        for slot in decision_slots:
            key = (slot.id, acolyte.id)
            if key in x and solver.Value(x[key]) == 1:
                count += 1
        assignment_counts.append(count)
    if assignment_counts:
        mean = sum(assignment_counts) / len(assignment_counts)
        variance = sum((value - mean) ** 2 for value in assignment_counts) / len(assignment_counts)
        fairness_std = variance ** 0.5
    else:
        fairness_std = 0
    return ScheduleSolveResult(
        coverage=coverage,
        preference_score=preference_total,
        fairness_std=fairness_std,
        changes=changes,
        required_slots_count=len(decision_slots) + len(deferred_slots),
        unfilled_slots_count=len(unfilled_details),
        unfilled_details=unfilled_details,
        feasible=True,
    )


def solve_open_slots(parish, slots, weights):
    slots = [slot for slot in slots if slot.mass_instance.status == "scheduled"]
    decision_slots = [slot for slot in slots if slot.required and slot.status == "open"]
    if not decision_slots:
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=0,
            unfilled_slots_count=0,
            unfilled_details=[],
            feasible=True,
            assigned_map={},
        )

    acolytes = list(parish.acolytes.filter(active=True))
    if not acolytes:
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=len(decision_slots),
            unfilled_slots_count=len(decision_slots),
            unfilled_details=[],
            feasible=False,
            assigned_map={},
        )

    preferences = AcolytePreference.objects.filter(parish=parish)
    intents = {intent.acolyte_id: intent for intent in AcolyteIntent.objects.filter(parish=parish)}
    cache = build_recommendation_cache(parish, slots=decision_slots, acolytes=acolytes)
    cache["weights"] = weights

    candidates = {}
    context_by_slot = {}
    local_eligible_count_by_slot = {}
    deferred_slots = []
    unfilled_details = []

    for slot in decision_slots:
        context = get_mass_context(slot.mass_instance, cache["weights"], cache.get("interest_map"), cache["now"])
        if context.get("pool_mode") == "empty" and context.get("candidate_pool") == "interested_only":
            deferred_slots.append(slot)
            continue
        slot_candidates = []
        for acolyte in acolytes:
            if not is_candidate_eligible_static(acolyte, slot, context, cache):
                continue
            if not is_candidate_eligible_dynamic(acolyte, slot, cache):
                continue
            slot_candidates.append(acolyte)
        local_eligible_count = len(
            [
                acolyte
                for acolyte in slot_candidates
                if acolyte.community_of_origin_id == slot.mass_instance.community_id
                and slot.mass_instance.community_id not in cache["avoid_communities"].get(acolyte.id, set())
            ]
        )
        context_by_slot[slot.id] = context
        local_eligible_count_by_slot[slot.id] = local_eligible_count
        candidates[slot.id] = slot_candidates

    decision_slots = [slot for slot in decision_slots if slot not in deferred_slots]
    for slot in deferred_slots:
        unfilled_details.append(
            {
                "mass_instance_id": slot.mass_instance_id,
                "starts_at": slot.mass_instance.starts_at.isoformat(),
                "community_id": slot.mass_instance.community_id,
                "position_type_id": slot.position_type_id,
                "slot_index": slot.slot_index,
                "reason": "interest_open",
            }
        )

    no_candidate_slots = []
    for slot in decision_slots:
        if not candidates.get(slot.id):
            no_candidate_slots.append(slot)
            unfilled_details.append(
                {
                    "mass_instance_id": slot.mass_instance_id,
                    "starts_at": slot.mass_instance.starts_at.isoformat(),
                    "community_id": slot.mass_instance.community_id,
                    "position_type_id": slot.position_type_id,
                    "slot_index": slot.slot_index,
                    "reason": "no_candidates",
                }
            )

    if no_candidate_slots:
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=len(decision_slots) + len(deferred_slots),
            unfilled_slots_count=len(unfilled_details),
            unfilled_details=unfilled_details,
            feasible=False,
            assigned_map={},
        )

    if not decision_slots:
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=len(deferred_slots),
            unfilled_slots_count=len(unfilled_details),
            unfilled_details=unfilled_details,
            feasible=True,
            assigned_map={},
        )

    model = cp_model.CpModel()
    x = {}

    for slot in decision_slots:
        for acolyte in candidates.get(slot.id, []):
            x[(slot.id, acolyte.id)] = model.NewBoolVar(f"x_{slot.id}_{acolyte.id}")

    for slot in decision_slots:
        vars_for_slot = [x[(slot.id, a.id)] for a in candidates.get(slot.id, [])]
        if vars_for_slot:
            model.Add(sum(vars_for_slot) == 1)

    slots_by_mass = defaultdict(list)
    for slot in decision_slots:
        slots_by_mass[slot.mass_instance_id].append(slot)
    for mass_slots in slots_by_mass.values():
        for acolyte in acolytes:
            vars_for_acolyte = [x[(slot.id, acolyte.id)] for slot in mass_slots if (slot.id, acolyte.id) in x]
            if vars_for_acolyte:
                model.Add(sum(vars_for_acolyte) <= 1)

    senior_ids = {acolyte.id for acolyte in acolytes if acolyte.experience_level == "senior"}
    if senior_ids:
        for mass_id, mass_slots in slots_by_mass.items():
            min_senior = 0
            mass_instance = mass_slots[0].mass_instance if mass_slots else None
            if mass_instance and mass_instance.requirement_profile:
                min_senior = getattr(mass_instance.requirement_profile, "min_senior_per_mass", 0) or 0
            if min_senior:
                vars_for_senior = [
                    x[(slot.id, acolyte_id)]
                    for slot in mass_slots
                    for acolyte_id in senior_ids
                    if (slot.id, acolyte_id) in x
                ]
                model.Add(sum(vars_for_senior) >= int(min_senior))

    mass_duration = int(getattr(parish, "default_mass_duration_minutes", 60))
    rest_minutes = int(getattr(parish, "min_rest_minutes_between_masses", 0))
    min_gap = (mass_duration + rest_minutes) * 60
    sorted_slots = sorted(decision_slots, key=lambda slot: slot.mass_instance.starts_at)
    conflict_pairs = []
    for idx, slot_a in enumerate(sorted_slots):
        a_start = slot_a.mass_instance.starts_at
        for slot_b in sorted_slots[idx + 1 :]:
            if slot_a.mass_instance_id == slot_b.mass_instance_id:
                continue
            b_start = slot_b.mass_instance.starts_at
            if (b_start - a_start).total_seconds() >= min_gap:
                break
            conflict_pairs.append((slot_a, slot_b))
    for acolyte in acolytes:
        for slot_a, slot_b in conflict_pairs:
            if (slot_a.id, acolyte.id) in x and (slot_b.id, acolyte.id) in x:
                model.Add(x[(slot_a.id, acolyte.id)] + x[(slot_b.id, acolyte.id)] <= 1)

    decision_week_counts = defaultdict(lambda: defaultdict(int))
    if decision_slots:
        active_assignments = (
            Assignment.objects.filter(
                parish=parish,
                is_active=True,
                assignment_state__in=["proposed", "published", "locked"],
                slot_id__in=[slot.id for slot in decision_slots],
            )
            .select_related("slot__mass_instance")
        )
        for assignment in active_assignments:
            start = assignment.slot.mass_instance.starts_at
            week_key = start.isocalendar()[:2]
            decision_week_counts[assignment.acolyte_id][week_key] += 1

    max_services_per_week = weights.get("max_services_per_week")
    if max_services_per_week:
        slots_by_week = defaultdict(list)
        for slot in decision_slots:
            key = slot.mass_instance.starts_at.isocalendar()[:2]
            slots_by_week[key].append(slot)
        for week_key, week_slots in slots_by_week.items():
            for acolyte in acolytes:
                existing = cache["weekly_counts_by_acolyte"].get(acolyte.id, {}).get(week_key, 0)
                existing -= decision_week_counts.get(acolyte.id, {}).get(week_key, 0)
                if existing < 0:
                    existing = 0
                limit = int(max_services_per_week) - existing
                if limit < 0:
                    limit = 0
                vars_for_week = [x[(slot.id, acolyte.id)] for slot in week_slots if (slot.id, acolyte.id) in x]
                if vars_for_week:
                    model.Add(sum(vars_for_week) <= limit)

    max_consecutive_weekends = weights.get("max_consecutive_weekends")
    if max_consecutive_weekends:
        weekend_map = defaultdict(list)
        for slot in decision_slots:
            weekday = slot.mass_instance.starts_at.weekday()
            if weekday in (5, 6):
                date = slot.mass_instance.starts_at.date()
                if weekday == 6:
                    date = date - timedelta(days=1)
                weekend_map[date].append(slot)
        weekend_keys = sorted(weekend_map.keys())
        if weekend_keys:
            weekend_vars = {acolyte.id: {} for acolyte in acolytes}
            for acolyte in acolytes:
                for weekend_date, weekend_slots in weekend_map.items():
                    vars_for_weekend = [x[(slot.id, acolyte.id)] for slot in weekend_slots if (slot.id, acolyte.id) in x]
                    if not vars_for_weekend:
                        continue
                    weekend_var = model.NewBoolVar(f"weekend_{acolyte.id}_{weekend_date}")
                    for var in vars_for_weekend:
                        model.Add(weekend_var >= var)
                    model.Add(weekend_var <= sum(vars_for_weekend))
                    weekend_vars[acolyte.id][weekend_date] = weekend_var
            window_size = int(max_consecutive_weekends) + 1
            for acolyte in acolytes:
                for idx in range(0, max(0, len(weekend_keys) - window_size + 1)):
                    window = weekend_keys[idx : idx + window_size]
                    vars_in_window = []
                    for key in window:
                        if key in weekend_vars[acolyte.id]:
                            vars_in_window.append(weekend_vars[acolyte.id][key])
                    if vars_in_window:
                        model.Add(sum(vars_in_window) <= int(max_consecutive_weekends))

    preference_terms = []
    fairness_terms = []
    partner_terms = []
    family_terms = []

    for slot in decision_slots:
        context = context_by_slot.get(slot.id)
        local_count = local_eligible_count_by_slot.get(slot.id, 0)
        for acolyte in candidates.get(slot.id, []):
            base_score = score_candidate(
                acolyte,
                slot,
                context,
                cache,
                local_eligible_count=local_count,
            )
            preference_terms.append(base_score * x[(slot.id, acolyte.id)])

    partner_prefs = [pref for pref in preferences if pref.preference_type in ["preferred_partner", "avoid_partner"] and pref.target_acolyte_id]
    if partner_prefs:
        partner_ids = set()
        for pref in partner_prefs:
            partner_ids.add(pref.acolyte_id)
            partner_ids.add(pref.target_acolyte_id)
        mass_acolyte_vars = defaultdict(dict)
        for mass_id, mass_slots in slots_by_mass.items():
            for acolyte_id in partner_ids:
                vars_for_acolyte = [x[(slot.id, acolyte_id)] for slot in mass_slots if (slot.id, acolyte_id) in x]
                if not vars_for_acolyte:
                    continue
                assigned_var = model.NewBoolVar(f"mass_{mass_id}_a_{acolyte_id}")
                for var in vars_for_acolyte:
                    model.Add(assigned_var >= var)
                model.Add(assigned_var <= sum(vars_for_acolyte))
                mass_acolyte_vars[mass_id][acolyte_id] = assigned_var
        for pref in partner_prefs:
            for mass_id in slots_by_mass.keys():
                a_var = mass_acolyte_vars.get(mass_id, {}).get(pref.acolyte_id)
                b_var = mass_acolyte_vars.get(mass_id, {}).get(pref.target_acolyte_id)
                if a_var is None or b_var is None:
                    continue
                pair_var = model.NewBoolVar(f"pair_{pref.acolyte_id}_{pref.target_acolyte_id}_{mass_id}")
                model.Add(pair_var <= a_var)
                model.Add(pair_var <= b_var)
                model.Add(pair_var >= a_var + b_var - 1)
                weight = pref.weight or 0
                if pref.preference_type == "avoid_partner":
                    weight = -weight
                partner_terms.append(weight * pair_var)

    family_bonus = int(weights.get("family_group_bonus", 2))
    if family_bonus:
        families = defaultdict(list)
        for acolyte in acolytes:
            if acolyte.family_group_id:
                families[acolyte.family_group_id].append(acolyte.id)
        for family_id, members in families.items():
            if len(members) < 2:
                continue
            for mass_id, mass_slots in slots_by_mass.items():
                member_vars = {}
                for acolyte_id in members:
                    vars_for_acolyte = [
                        x[(slot.id, acolyte_id)]
                        for slot in mass_slots
                        if (slot.id, acolyte_id) in x
                    ]
                    if not vars_for_acolyte:
                        continue
                    assigned_var = model.NewBoolVar(f"family_{family_id}_{mass_id}_{acolyte_id}")
                    for var in vars_for_acolyte:
                        model.Add(assigned_var >= var)
                    model.Add(assigned_var <= sum(vars_for_acolyte))
                    member_vars[acolyte_id] = assigned_var
                member_ids = list(member_vars.keys())
                for idx, acolyte_id in enumerate(member_ids):
                    for other_id in member_ids[idx + 1 :]:
                        pair_var = model.NewBoolVar(f"family_pair_{family_id}_{mass_id}_{acolyte_id}_{other_id}")
                        model.Add(pair_var <= member_vars[acolyte_id])
                        model.Add(pair_var <= member_vars[other_id])
                        model.Add(pair_var >= member_vars[acolyte_id] + member_vars[other_id] - 1)
                        family_terms.append(family_bonus * pair_var)

    horizon_days = 30
    if decision_slots:
        starts = [slot.mass_instance.starts_at for slot in decision_slots]
        horizon_days = max((max(starts) - min(starts)).days, 1)

    if acolytes:
        base_target = len(decision_slots) / len(acolytes)
        raw_targets = {}
        for acolyte in acolytes:
            intent = intents.get(acolyte.id)
            if acolyte.scheduling_mode == "reserve":
                raw_target = 0
            elif intent and intent.desired_frequency_per_month:
                raw_target = intent.desired_frequency_per_month * (horizon_days / 30)
            else:
                level = getattr(intent, "willingness_level", "normal") if intent else "normal"
                factor = {"low": 0.8, "normal": 1.0, "high": 1.2}.get(level, 1.0)
                raw_target = base_target * factor
            raw_targets[acolyte.id] = raw_target
        total_raw = sum(raw_targets.values()) or 1
        scale = len(decision_slots) / total_raw
        target_loads = {acolyte_id: int(round(raw * scale)) for acolyte_id, raw in raw_targets.items()}

        for acolyte in acolytes:
            vars_for_acolyte = [x[(slot.id, acolyte.id)] for slot in decision_slots if (slot.id, acolyte.id) in x]
            if vars_for_acolyte:
                target = target_loads.get(acolyte.id, int(round(base_target)))
                diff = model.NewIntVar(-len(decision_slots), len(decision_slots), f"diff_{acolyte.id}")
                model.Add(diff == sum(vars_for_acolyte) - target)
                abs_diff = model.NewIntVar(0, len(decision_slots), f"abs_diff_{acolyte.id}")
                model.AddAbsEquality(abs_diff, diff)
                fairness_terms.append(abs_diff)

    objective_terms = []
    if preference_terms:
        objective_terms.append(sum(preference_terms))
    if fairness_terms:
        objective_terms.append(-weights.get("fairness_penalty", 1) * sum(fairness_terms))
    if partner_terms:
        objective_terms.append(sum(partner_terms))
    if family_terms:
        objective_terms.append(sum(family_terms))

    model.Maximize(sum(objective_terms) if objective_terms else 0)

    solver = cp_model.CpSolver()
    solver.parameters.max_time_in_seconds = float(weights.get("max_solve_seconds", 15))
    status = solver.Solve(model)

    if status not in (cp_model.OPTIMAL, cp_model.FEASIBLE):
        return ScheduleSolveResult(
            coverage=0,
            preference_score=0,
            fairness_std=0,
            changes=0,
            required_slots_count=len(decision_slots) + len(deferred_slots),
            unfilled_slots_count=len(unfilled_details),
            unfilled_details=unfilled_details,
            feasible=False,
            assigned_map={},
        )

    assigned_map = {}
    preference_total = 0
    coverage = 0
    for slot in decision_slots:
        for acolyte in candidates.get(slot.id, []):
            if solver.Value(x[(slot.id, acolyte.id)]) == 1:
                assigned_map[slot.id] = acolyte
                coverage += 1
                context = context_by_slot.get(slot.id)
                local_count = local_eligible_count_by_slot.get(slot.id, 0)
                preference_total += score_candidate(
                    acolyte,
                    slot,
                    context,
                    cache,
                    local_eligible_count=local_count,
                )
                break

    assignment_counts = []
    for acolyte in acolytes:
        count = 0
        for slot in decision_slots:
            key = (slot.id, acolyte.id)
            if key in x and solver.Value(x[key]) == 1:
                count += 1
        assignment_counts.append(count)
    if assignment_counts:
        mean = sum(assignment_counts) / len(assignment_counts)
        variance = sum((value - mean) ** 2 for value in assignment_counts) / len(assignment_counts)
        fairness_std = variance ** 0.5
    else:
        fairness_std = 0

    return ScheduleSolveResult(
        coverage=coverage,
        preference_score=preference_total,
        fairness_std=fairness_std,
        changes=coverage,
        required_slots_count=len(decision_slots) + len(deferred_slots),
        unfilled_slots_count=len(unfilled_details),
        unfilled_details=unfilled_details,
        feasible=True,
        assigned_map=assigned_map,
    )
```

### scheduler\tests\test_job_claim.py
```python
from django.test import TestCase

from core.models import Parish
from scheduler.models import ScheduleJobRequest
from scheduler.services.jobs import claim_job


class JobClaimTests(TestCase):
    def test_claim_job_only_once(self):
        parish = Parish.objects.create(name="Parish")
        job = ScheduleJobRequest.objects.create(parish=parish, status="pending")
        first = claim_job(job.id)
        second = claim_job(job.id)
        self.assertTrue(first)
        self.assertFalse(second)
```

### scheduler\tests\test_quick_fill.py
```python
from datetime import timedelta

from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    AcolyteQualification,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    Parish,
    PositionType,
)
from scheduler.services.quick_fill import quick_fill_slot


class QuickFillSlotTests(TestCase):
    def setUp(self):
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        self.position2 = PositionType.objects.create(parish=self.parish, code="TUR", name="Turiferario")

        self.acolyte_a = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito A")
        self.acolyte_b = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito B")
        self.acolyte_c = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito C")

        # All qualified for both positions
        for acolyte in [self.acolyte_a, self.acolyte_b, self.acolyte_c]:
            AcolyteQualification.objects.create(
                parish=self.parish, acolyte=acolyte, position_type=self.position, qualified=True
            )
            AcolyteQualification.objects.create(
                parish=self.parish, acolyte=acolyte, position_type=self.position2, qualified=True
            )

        self.instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        self.slot1 = AssignmentSlot.objects.create(
            parish=self.parish, mass_instance=self.instance, position_type=self.position
        )
        self.slot2 = AssignmentSlot.objects.create(
            parish=self.parish, mass_instance=self.instance, position_type=self.position2
        )

    def test_quick_fill_returns_candidates(self):
        """quick_fill_slot returns qualified acolytes"""
        candidates = quick_fill_slot(self.slot1, self.parish)
        self.assertEqual(len(candidates), 3)
        candidate_ids = {c.id for c in candidates}
        self.assertIn(self.acolyte_a.id, candidate_ids)
        self.assertIn(self.acolyte_b.id, candidate_ids)
        self.assertIn(self.acolyte_c.id, candidate_ids)

    def test_quick_fill_excludes_specified_acolytes(self):
        """quick_fill_slot excludes acolytes in exclude_acolyte_ids"""
        exclude_ids = {self.acolyte_a.id, self.acolyte_b.id}
        candidates = quick_fill_slot(self.slot1, self.parish, exclude_acolyte_ids=exclude_ids)
        self.assertEqual(len(candidates), 1)
        self.assertEqual(candidates[0].id, self.acolyte_c.id)

    def test_quick_fill_excludes_already_assigned_in_same_mass(self):
        """quick_fill_slot should not suggest acolytes already assigned to another slot in the same mass"""
        # Assign acolyte_a to slot1
        Assignment.objects.create(
            parish=self.parish,
            slot=self.slot1,
            acolyte=self.acolyte_a,
            is_active=True,
        )
        # When getting suggestions for slot2, exclude acolyte_a
        exclude_ids = {self.acolyte_a.id}
        candidates = quick_fill_slot(self.slot2, self.parish, exclude_acolyte_ids=exclude_ids)

        candidate_ids = {c.id for c in candidates}
        self.assertNotIn(self.acolyte_a.id, candidate_ids)
        self.assertIn(self.acolyte_b.id, candidate_ids)
        self.assertIn(self.acolyte_c.id, candidate_ids)

    def test_quick_fill_empty_exclude_set(self):
        """quick_fill_slot with empty exclude set returns all candidates"""
        candidates = quick_fill_slot(self.slot1, self.parish, exclude_acolyte_ids=set())
        self.assertEqual(len(candidates), 3)

    def test_quick_fill_none_exclude_set(self):
        """quick_fill_slot with None exclude set returns all candidates"""
        candidates = quick_fill_slot(self.slot1, self.parish, exclude_acolyte_ids=None)
        self.assertEqual(len(candidates), 3)

    def test_quick_fill_deprioritizes_reserve(self):
        """reserve acolytes should be ranked after normal candidates"""
        self.acolyte_b.scheduling_mode = "reserve"
        self.acolyte_b.save(update_fields=["scheduling_mode"])
        candidates = quick_fill_slot(self.slot1, self.parish)
        self.assertEqual(candidates[0].id, self.acolyte_a.id)
```

### scheduler\tests\test_solver.py
```python
from collections import defaultdict
from datetime import timedelta

from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteAvailabilityRule,
    AcolyteProfile,
    AcolyteQualification,
    Assignment,
    AssignmentSlot,
    Community,
    FamilyGroup,
    MassInstance,
    Parish,
    PositionType,
    RequirementProfile,
    RequirementProfilePosition,
)
from scheduler.services.solver import solve_schedule


class SolverTests(TestCase):
    def test_solver_assigns_slots(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolyte")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position, qualified=True)
        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(parish=parish, mass_instance=instance, position_type=position)

        result = solve_schedule(parish, [instance], parish.consolidation_days, {}, allow_changes=True)
        slot.refresh_from_db()
        self.assertIsNotNone(slot.get_active_assignment())
        self.assertEqual(result.coverage, 1)

    def test_rotation_considers_historical_assignments(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=parish, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=parish, display_name="Acolito B")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_a, position_type=position, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_b, position_type=position, qualified=True)

        past_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() - timedelta(days=7),
            status="scheduled",
        )
        past_slot = AssignmentSlot.objects.create(parish=parish, mass_instance=past_instance, position_type=position)
        past_assignment = Assignment.objects.create(
            parish=parish,
            slot=past_slot,
            acolyte=acolyte_a,
            assignment_state="published",
            is_active=False,
        )
        Assignment.objects.filter(id=past_assignment.id).update(
            created_at=past_instance.starts_at - timedelta(hours=1),
            ended_at=past_instance.starts_at + timedelta(hours=1),
        )

        future_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        future_slot = AssignmentSlot.objects.create(parish=parish, mass_instance=future_instance, position_type=position)

        weights = {"rotation_penalty": 1000, "rotation_days": 60, "fairness_penalty": 0, "stability_penalty": 0}
        solve_schedule(parish, [future_instance], parish.consolidation_days, weights, allow_changes=True)

        future_slot.refresh_from_db()
        self.assertEqual(future_slot.get_active_assignment().acolyte_id, acolyte_b.id)

    def test_solver_ignores_optional_slots(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        required_slot = AssignmentSlot.objects.create(
            parish=parish, mass_instance=instance, position_type=position, required=True, slot_index=1
        )
        optional_slot = AssignmentSlot.objects.create(
            parish=parish, mass_instance=instance, position_type=position, required=False, slot_index=2
        )

        result = solve_schedule(parish, [instance], parish.consolidation_days, {}, allow_changes=True)

        required_slot.refresh_from_db()
        optional_slot.refresh_from_db()
        self.assertIsNotNone(required_slot.get_active_assignment())
        self.assertIsNone(optional_slot.get_active_assignment())
        self.assertEqual(result.required_slots_count, 1)
        self.assertEqual(result.coverage, 1)

    def test_solver_ignores_canceled_instances(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position, qualified=True)

        canceled_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=1),
            status="canceled",
        )
        canceled_slot = AssignmentSlot.objects.create(
            parish=parish, mass_instance=canceled_instance, position_type=position, required=True, slot_index=1
        )

        scheduled_instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        scheduled_slot = AssignmentSlot.objects.create(
            parish=parish, mass_instance=scheduled_instance, position_type=position, required=True, slot_index=1
        )

        solve_schedule(parish, [canceled_instance, scheduled_instance], parish.consolidation_days, {}, allow_changes=True)

        canceled_slot.refresh_from_db()
        scheduled_slot.refresh_from_db()
        self.assertIsNone(canceled_slot.get_active_assignment())
        self.assertIsNotNone(scheduled_slot.get_active_assignment())

    def test_solver_limits_candidates_per_slot(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=parish, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=parish, display_name="Acolito B")
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_a, position_type=position, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte_b, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish, mass_instance=instance, position_type=position, required=True, slot_index=1
        )
        AcolyteAvailabilityRule.objects.create(
            parish=parish,
            acolyte=acolyte_b,
            rule_type="unavailable",
            day_of_week=None,
        )

        result = solve_schedule(
            parish,
            [instance],
            parish.consolidation_days,
            {"max_candidates_per_slot": 1},
            allow_changes=True,
        )

        slot.refresh_from_db()
        self.assertEqual(result.coverage, 1)
        self.assertEqual(slot.get_active_assignment().acolyte_id, acolyte_a.id)

    def test_solver_requires_senior_when_configured(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile = RequirementProfile.objects.create(parish=parish, name="Solenidade", min_senior_per_mass=1)
        RequirementProfilePosition.objects.create(profile=profile, position_type=position, quantity=1)
        senior = AcolyteProfile.objects.create(
            parish=parish, display_name="Senior", experience_level="senior"
        )
        junior = AcolyteProfile.objects.create(
            parish=parish, display_name="Junior", experience_level="intermediate"
        )
        AcolyteQualification.objects.create(parish=parish, acolyte=senior, position_type=position, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=junior, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            requirement_profile=profile,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )

        solve_schedule(parish, [instance], parish.consolidation_days, {"fairness_penalty": 0}, allow_changes=True)

        slot = AssignmentSlot.objects.filter(parish=parish, mass_instance=instance).first()
        self.assertEqual(slot.get_active_assignment().acolyte_id, senior.id)

    def test_solver_family_bonus_groups_members(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        profile = RequirementProfile.objects.create(parish=parish, name="Dupla")
        RequirementProfilePosition.objects.create(profile=profile, position_type=position, quantity=2)

        family = FamilyGroup.objects.create(parish=parish, name="Familia A")
        fam_a = AcolyteProfile.objects.create(parish=parish, display_name="A1", family_group=family)
        fam_b = AcolyteProfile.objects.create(parish=parish, display_name="A2", family_group=family)
        other_a = AcolyteProfile.objects.create(parish=parish, display_name="B1")
        other_b = AcolyteProfile.objects.create(parish=parish, display_name="B2")
        for acolyte in (fam_a, fam_b, other_a, other_b):
            AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position, qualified=True)

        mass_a = MassInstance.objects.create(
            parish=parish,
            community=community,
            requirement_profile=profile,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        mass_b = MassInstance.objects.create(
            parish=parish,
            community=community,
            requirement_profile=profile,
            starts_at=timezone.now() + timedelta(days=4),
            status="scheduled",
        )

        solve_schedule(
            parish,
            [mass_a, mass_b],
            parish.consolidation_days,
            {"family_group_bonus": 10, "fairness_penalty": 0, "stability_penalty": 0},
            allow_changes=True,
        )

        fam_assignments = Assignment.objects.filter(
            parish=parish, is_active=True, acolyte_id__in=[fam_a.id, fam_b.id]
        ).select_related("slot__mass_instance")
        members_by_mass = defaultdict(set)
        for assignment in fam_assignments:
            members_by_mass[assignment.slot.mass_instance_id].add(assignment.acolyte_id)
        self.assertTrue(any(len(members) == 2 for members in members_by_mass.values()))
        for members in members_by_mass.values():
            self.assertNotEqual(len(members), 1)

    def test_solver_penalizes_reserve_acolyte(self):
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        normal = AcolyteProfile.objects.create(parish=parish, display_name="Normal")
        reserve = AcolyteProfile.objects.create(
            parish=parish, display_name="Reserva", scheduling_mode="reserve"
        )
        AcolyteQualification.objects.create(parish=parish, acolyte=normal, position_type=position, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=reserve, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        AssignmentSlot.objects.create(
            parish=parish, mass_instance=instance, position_type=position, required=True, slot_index=1
        )

        solve_schedule(
            parish,
            [instance],
            parish.consolidation_days,
            {"reserve_penalty": 1000, "fairness_penalty": 0, "stability_penalty": 0},
            allow_changes=True,
        )

        slot = AssignmentSlot.objects.filter(parish=parish, mass_instance=instance).first()
        self.assertEqual(slot.get_active_assignment().acolyte_id, normal.id)
```

### scheduler\apps.py
```python
from django.apps import AppConfig


class SchedulerConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "scheduler"
```

### scheduler\models.py
```python
from django.conf import settings
from django.db import models

from core.models import Parish


class ScheduleJobRequest(models.Model):
    JOB_TYPE_CHOICES = [
        ("schedule", "Escalonamento"),
        ("replacement", "Substituicao"),
    ]
    STATUS_CHOICES = [
        ("pending", "Pendente"),
        ("running", "Executando"),
        ("success", "Concluido"),
        ("failed", "Falhou"),
    ]
    parish = models.ForeignKey(Parish, on_delete=models.CASCADE)
    requested_by = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    job_type = models.CharField(max_length=20, choices=JOB_TYPE_CHOICES, default="schedule")
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default="pending")
    horizon_days = models.PositiveIntegerField(default=60)
    force_republish = models.BooleanField(default=False)
    payload_json = models.JSONField(default=dict, blank=True)
    summary_json = models.JSONField(default=dict, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    started_at = models.DateTimeField(null=True, blank=True)
    finished_at = models.DateTimeField(null=True, blank=True)
    error_message = models.TextField(blank=True)
```

### static\css\app.css
```css
body { font-family: 'Alegreya Sans', sans-serif; transition: all 0.3s ease; }
.nav-link { padding: 0.5rem 0.875rem; border-radius: 0.875rem; color: #5a6a72; transition: all 0.2s ease; position: relative; overflow: hidden; }
.nav-link:hover { background: linear-gradient(135deg, rgba(15, 94, 77, 0.1), rgba(15, 94, 77, 0.05)); color: #0f5e4d; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(15, 94, 77, 0.15); }
.card { background: linear-gradient(135deg, white 0%, #fefefe 100%); border-radius: 1.5rem; padding: 1.75rem; box-shadow: 0 20px 40px rgba(10, 24, 32, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.8); transition: all 0.3s ease; }
.card:hover { box-shadow: 0 25px 50px rgba(10, 24, 32, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.9); transform: translateY(-2px); }
.label { display: block; font-size: 0.75rem; letter-spacing: 0.1em; text-transform: uppercase; color: #5a6a72; margin-bottom: 0.5rem; font-weight: 500; transition: color 0.2s ease; }
.label:hover { color: #0f5e4d; }
input:not([type="checkbox"]):not([type="radio"]), select, textarea { width: 100%; border: 1px solid rgba(10, 24, 32, 0.15); border-radius: 0.875rem; padding: 0.75rem 0.875rem; transition: all 0.2s ease; background: linear-gradient(135deg, #fefefe 0%, white 100%); }
input:not([type="checkbox"]):not([type="radio"]):hover, select:hover, textarea:hover { border-color: rgba(15, 94, 77, 0.3); }
input:not([type="checkbox"]):not([type="radio"]):focus, select:focus, textarea:focus { border-color: #0f5e4d; box-shadow: 0 0 0 3px rgba(15, 94, 77, 0.15), 0 4px 12px rgba(10, 24, 32, 0.08); transform: translateY(-1px); background: white; }



.select-wrapper {
  position: relative;
  display: inline-block;
  width: 100%;
}

.select-wrapper::after {
  content: '';
  position: absolute;
  top: 50%;
  right: 1rem;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 0.375rem solid transparent;
  border-right: 0.375rem solid transparent;
  border-top: 0.375rem solid #5a6a72;
  pointer-events: none;
  transition: all 0.2s ease;
}

.select-wrapper select:focus + .select-arrow,
.select-wrapper:focus-within::after {
  border-top-color: #0f5e4d;
}

/* Custom Select Component */
.custom-select {
  position: relative;
  width: 100%;
}

.custom-select-button {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 0.875rem;
  border: 1px solid rgba(10, 24, 32, 0.15);
  border-radius: 0.875rem;
  background: linear-gradient(135deg, #fefefe 0%, white 100%);
  color: #0b1f26;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(10, 24, 32, 0.05);
}

.custom-select-button:hover {
  border-color: rgba(15, 94, 77, 0.3);
  box-shadow: 0 2px 8px rgba(10, 24, 32, 0.1);
}

.custom-select-button:focus {
  border-color: #0f5e4d;
  box-shadow: 0 0 0 3px rgba(15, 94, 77, 0.15), 0 4px 12px rgba(10, 24, 32, 0.08);
  transform: translateY(-1px);
  background: white;
}

.custom-select-button::after {
  content: '';
  width: 0;
  height: 0;
  border-left: 0.375rem solid transparent;
  border-right: 0.375rem solid transparent;
  border-top: 0.375rem solid #5a6a72;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.custom-select.open .custom-select-button::after {
  transform: rotate(180deg);
}

.custom-select-options {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  z-index: 50;
  margin-top: 0.25rem;
  max-height: 12rem;
  overflow-y: auto;
  background: white;
  border: 1px solid rgba(10, 24, 32, 0.15);
  border-radius: 0.875rem;
  box-shadow: 0 10px 25px rgba(10, 24, 32, 0.15);
  opacity: 0;
  visibility: hidden;
  transform: translateY(-0.5rem);
  transition: all 0.2s ease;
}

.custom-select.open .custom-select-options {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.custom-select-option {
  display: block;
  width: 100%;
  padding: 0.75rem 0.875rem;
  text-align: left;
  color: #0b1f26;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  border: none;
  background: none;
}

.custom-select-option:hover {
  background: linear-gradient(135deg, rgba(15, 94, 77, 0.05) 0%, rgba(15, 94, 77, 0.02) 100%);
  color: #0f5e4d;
}

.custom-select-option.selected {
  background: linear-gradient(135deg, #0f5e4d 0%, #0a4a3d 100%);
  color: white;
}

.custom-select-option.selected:hover {
  background: linear-gradient(135deg, #0a4a3d 0%, #0f5e4d 100%);
}
input[type="checkbox"] { width: 1rem; height: 1rem; padding: 0; border-radius: 0.375rem; transition: all 0.2s ease; }
.btn-primary { background: linear-gradient(135deg, #0f5e4d 0%, #0a4a3d 100%); color: white; padding: 0.75rem 1.25rem; border-radius: 0.875rem; font-size: 0.9rem; font-weight: 500; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(15, 94, 77, 0.2); }
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(15, 94, 77, 0.3); background: linear-gradient(135deg, #0a4a3d 0%, #0f5e4d 100%); }
.btn-secondary { background: linear-gradient(135deg, rgba(10, 24, 32, 0.08) 0%, rgba(10, 24, 32, 0.05) 100%); color: #0b1f26; padding: 0.625rem 1rem; border-radius: 0.875rem; font-size: 0.85rem; font-weight: 500; transition: all 0.2s ease; border: 1px solid rgba(10, 24, 32, 0.08); }
.btn-secondary:hover { background: linear-gradient(135deg, rgba(10, 24, 32, 0.12) 0%, rgba(10, 24, 32, 0.08) 100%); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(10, 24, 32, 0.1); }
.btn-danger { background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; padding: 0.75rem 1.25rem; border-radius: 0.875rem; font-size: 0.9rem; font-weight: 500; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2); }
.btn-danger:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(220, 38, 38, 0.3); background: linear-gradient(135deg, #b91c1c 0%, #dc2626 100%); }
.btn-compact { padding: 0.5rem 0.9rem; font-size: 0.78rem; border-radius: 0.75rem; box-shadow: none; }
.btn-compact:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(10, 24, 32, 0.12); }
.badge { background: linear-gradient(135deg, rgba(217, 164, 65, 0.25) 0%, rgba(217, 164, 65, 0.15) 100%); color: #7a5a12; padding: 0.375rem 0.75rem; border-radius: 0.875rem; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 500; border: 1px solid rgba(217, 164, 65, 0.2); transition: all 0.2s ease; }
.badge:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(217, 164, 65, 0.2); }
.check-grid { display: grid; gap: 0.75rem; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
.check-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0.75rem; border: 1px solid rgba(10, 24, 32, 0.1); border-radius: 0.875rem; background: linear-gradient(135deg, white 0%, #fefefe 100%); cursor: pointer; line-height: 1.4; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(10, 24, 32, 0.05); }
.check-item span { line-height: 1.2; }
.check-item:hover { border-color: rgba(10, 24, 32, 0.2); background: linear-gradient(135deg, rgba(15, 94, 77, 0.05) 0%, rgba(15, 94, 77, 0.02) 100%); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(10, 24, 32, 0.1); }
.check-inline { display: inline-flex; align-items: center; gap: 0.75rem; padding: 0; border: 0; background: transparent; cursor: pointer; transition: all 0.2s ease; }
.check-row { display: flex; align-items: center; justify-content: space-between; gap: 1rem; padding: 0.75rem 0.875rem; border: 1px solid rgba(10, 24, 32, 0.1); border-radius: 0.875rem; background: linear-gradient(135deg, white 0%, #fefefe 100%); cursor: pointer; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(10, 24, 32, 0.05); }
.check-row:hover { border-color: rgba(10, 24, 32, 0.2); background: linear-gradient(135deg, rgba(15, 94, 77, 0.05) 0%, rgba(15, 94, 77, 0.02) 100%); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(10, 24, 32, 0.1); }
.check-item input[type="checkbox"],
.check-inline input[type="checkbox"],
.check-row input[type="checkbox"] { appearance: none; width: 1rem; height: 1rem; margin: 0; flex: 0 0 auto; border: 1px solid rgba(10, 24, 32, 0.4); border-radius: 0.375rem; display: inline-grid; place-content: center; background: linear-gradient(135deg, white 0%, #fefefe 100%); transition: all 0.2s ease; }
.check-item input[type="checkbox"]:checked,
.check-inline input[type="checkbox"]:checked,
.check-row input[type="checkbox"]:checked { background: linear-gradient(135deg, #0f5e4d 0%, #0a4a3d 100%); border-color: #0f5e4d; box-shadow: 0 2px 8px rgba(15, 94, 77, 0.3); }
.check-item input[type="checkbox"]:checked::after,
.check-inline input[type="checkbox"]:checked::after,
.check-row input[type="checkbox"]:checked::after { content: ""; width: 0.5rem; height: 0.3rem; border-left: 2px solid white; border-bottom: 2px solid white; transform: rotate(-45deg); }
.check-item input[type="checkbox"]:focus-visible,
.check-inline input[type="checkbox"]:focus-visible,
.check-row input[type="checkbox"]:focus-visible { outline: 2px solid rgba(15, 94, 77, 0.5); outline-offset: 2px; }

/* Toggle Switch Styles */
.toggle-switch {
  display: inline-flex;
  align-items: center;
  gap: 0.75rem;
  font-size: 0.875rem;
}

.toggle-input {
  opacity: 0;
  width: 0;
  height: 0;
  position: absolute;
}

.toggle-label {
  position: relative;
  display: flex;
  align-items: center;
  cursor: pointer;
  width: 3.5rem;
  height: 1.75rem;
  background: linear-gradient(135deg, rgba(10, 24, 32, 0.1) 0%, rgba(10, 24, 32, 0.05) 100%);
  border-radius: 0.875rem;
  transition: all 0.3s ease;
  border: 1px solid rgba(10, 24, 32, 0.1);
}

.toggle-slider {
  position: absolute;
  top: 0.125rem;
  left: 0.125rem;
  width: 1.5rem;
  height: 1.5rem;
  background: white;
  border-radius: 50%;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(10, 24, 32, 0.2);
}

.toggle-text-active,
.toggle-text-inactive {
  position: absolute;
  font-size: 0.75rem;
  font-weight: 500;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.toggle-text-active {
  right: 0.375rem;
  color: rgba(10, 24, 32, 0.4);
}

.toggle-text-inactive {
  left: 0.375rem;
  color: rgba(10, 24, 32, 0.6);
}

.toggle-input:checked + .toggle-label {
  background: linear-gradient(135deg, #0f5e4d 0%, #0a4a3d 100%);
  border-color: #0f5e4d;
  box-shadow: 0 0 0 1px rgba(15, 94, 77, 0.2);
}

.toggle-input:checked + .toggle-label .toggle-slider {
  transform: translateX(1.75rem);
  background: white;
  box-shadow: 0 2px 6px rgba(15, 94, 77, 0.4);
}

.toggle-input:checked + .toggle-label .toggle-text-active {
  color: white;
}

.toggle-input:checked + .toggle-label .toggle-text-inactive {
  color: rgba(255, 255, 255, 0.4);
}

.toggle-label:hover {
  box-shadow: 0 4px 12px rgba(10, 24, 32, 0.15);
}

.toggle-input:focus-visible + .toggle-label {
  outline: 2px solid rgba(15, 94, 77, 0.5);
  outline-offset: 2px;
}

/* Custom Checkbox Styles */
.custom-checkbox {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.checkbox-input {
  opacity: 0;
  width: 0;
  height: 0;
  position: absolute;
}

.checkbox-label {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  width: 1.25rem;
  height: 1.25rem;
  background: linear-gradient(135deg, white 0%, #fefefe 100%);
  border: 2px solid rgba(10, 24, 32, 0.2);
  border-radius: 0.375rem;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(10, 24, 32, 0.1);
}

.checkbox-label:hover {
  border-color: rgba(15, 94, 77, 0.4);
  box-shadow: 0 2px 8px rgba(15, 94, 77, 0.15);
}

.checkbox-input:checked + .checkbox-label {
  background: linear-gradient(135deg, #0f5e4d 0%, #0a4a3d 100%);
  border-color: #0f5e4d;
  box-shadow: 0 0 0 2px rgba(15, 94, 77, 0.2), 0 2px 8px rgba(15, 94, 77, 0.3);
}

.checkbox-checkmark {
  opacity: 0;
  transform: scale(0.8);
  transition: all 0.2s ease;
  color: white;
  width: 0.875rem;
  height: 0.875rem;
}

.checkbox-input:checked + .checkbox-label .checkbox-checkmark {
  opacity: 1;
  transform: scale(1);
}

.checkbox-input:focus-visible + .checkbox-label {
  outline: 2px solid rgba(15, 94, 77, 0.5);
  outline-offset: 2px;
}

/* Error messages styling */
.form-error {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
  border: 1px solid #fecaca;
  border-radius: 0.75rem;
  padding: 0.75rem;
  margin-top: 0.5rem;
  font-size: 0.75rem;
  color: #dc2626;
  box-shadow: 0 1px 3px rgba(220, 38, 38, 0.1);
}
.form-error svg {
  flex-shrink: 0;
  width: 1rem;
  height: 1rem;
  color: #dc2626;
}

/* Help text styling */
.form-help {
  font-size: 0.75rem;
  color: #6b7280;
  margin-top: 0.5rem;
  line-height: 1.4;
}

/* HTMX Success Flash Animation */
@keyframes successFlash {
  0% {
    background-color: rgba(15, 94, 77, 0.1);
  }
  50% {
    background-color: rgba(15, 94, 77, 0.2);
  }
  100% {
    background-color: transparent;
  }
}

.htmx-success-flash {
  animation: successFlash 1s ease-out;
}

/* Badge variations */
.badge-green {
  background: linear-gradient(135deg, rgba(15, 94, 77, 0.15) 0%, rgba(15, 94, 77, 0.1) 100%);
  color: #0f5e4d;
  border: 1px solid rgba(15, 94, 77, 0.2);
}

.badge-red {
  background: linear-gradient(135deg, rgba(220, 38, 38, 0.15) 0%, rgba(220, 38, 38, 0.1) 100%);
  color: #dc2626;
  border: 1px solid rgba(220, 38, 38, 0.2);
}

.badge-yellow {
  background: linear-gradient(135deg, rgba(217, 164, 65, 0.25) 0%, rgba(217, 164, 65, 0.15) 100%);
  color: #7a5a12;
  border: 1px solid rgba(217, 164, 65, 0.2);
}

.badge-blue {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.1) 100%);
  color: #2563eb;
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.badge-gray {
  background: linear-gradient(135deg, rgba(90, 106, 114, 0.15) 0%, rgba(90, 106, 114, 0.1) 100%);
  color: #5a6a72;
  border: 1px solid rgba(90, 106, 114, 0.2);
}

/* People Directory Premium Styles */
.people-table-header {
  display: grid;
  grid-template-columns: minmax(200px, 2fr) minmax(150px, 1.5fr) minmax(120px, 1.2fr) minmax(100px, 0.8fr) minmax(90px, 0.7fr);
  gap: 1rem;
  padding: 0.5rem 1rem;
  border-bottom: 1px solid rgba(10, 24, 32, 0.1);
  font-size: 0.65rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: #5a6a72;
  font-weight: 600;
  width: 100%;
}

.people-row {
  display: grid;
  grid-template-columns: minmax(200px, 2fr) minmax(150px, 1.5fr) minmax(120px, 1.2fr) minmax(100px, 0.8fr) minmax(90px, 0.7fr);
  gap: 1rem;
  padding: 0.75rem 1rem;
  align-items: center;
  border-bottom: 1px solid rgba(10, 24, 32, 0.05);
  transition: all 0.2s ease;
  width: 100%;
}

.people-row:hover {
  background: linear-gradient(135deg, rgba(15, 94, 77, 0.02) 0%, rgba(15, 94, 77, 0.01) 100%);
  transform: translateX(2px);
}

.people-row:last-child {
  border-bottom: none;
}

.people-cell-person {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.people-cell-meta {
  display: flex;
  flex-direction: column;
  gap: 0.125rem;
}

.people-role-text {
  font-size: 0.75rem;
  color: #5a6a72;
  font-style: italic;
  line-height: 1.4;
}

.people-qual-code {
  display: inline-block;
  font-family: 'Courier New', monospace;
  font-size: 0.7rem;
  color: #7a5a12;
  background: rgba(217, 164, 65, 0.08);
  padding: 0.125rem 0.375rem;
  border-radius: 0.25rem;
  border: 1px solid rgba(217, 164, 65, 0.15);
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  font-weight: 500;
}

.people-qual-all {
  font-size: 0.75rem;
  color: #0f5e4d;
  font-weight: 500;
}

.people-reliability {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.people-reliability-bar {
  height: 4px;
  width: 60px;
  background: rgba(10, 24, 32, 0.08);
  border-radius: 2px;
  overflow: hidden;
}

.people-reliability-fill {
  height: 100%;
  background: linear-gradient(90deg, #0f5e4d 0%, #0a4a3d 100%);
  transition: width 0.3s ease;
}

.people-reliability-text {
  font-size: 0.75rem;
  color: #0b1f26;
  font-weight: 500;
  font-variant-numeric: tabular-nums;
}

.people-freq {
  font-size: 0.7rem;
  color: #5a6a72;
  font-variant-numeric: tabular-nums;
  line-height: 1.5;
}

/* Mobile Layout */
@media (max-width: 1023px) {
  .people-table-header {
    display: none;
  }
  
  .people-row {
    grid-template-columns: 1fr;
    gap: 0.5rem;
    padding: 1rem;
  }
  
  .people-cell-person {
    grid-column: 1;
  }
  
  .people-mobile-inline {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
    align-items: center;
    font-size: 0.75rem;
    color: #5a6a72;
  }
  
  .people-mobile-separator {
    color: #5a6a72;
    opacity: 0.5;
  }
}


.custom-toggle:hover {
  box-shadow: 0 2px 8px rgba(10, 24, 32, 0.1);
}

.toggle-input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: relative;
  display: inline-block;
  width: 2.25rem;
  height: 1.25rem;
  background: rgba(10, 24, 32, 0.2);
  border-radius: 0.625rem;
  transition: all 0.2s ease;
  cursor: pointer;
}

.toggle-slider::after {
  content: '';
  position: absolute;
  top: 0.125rem;
  left: 0.125rem;
  width: 1rem;
  height: 1rem;
  background: white;
  border-radius: 50%;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.toggle-input:checked ~ .toggle-slider {
  background: linear-gradient(135deg, #0f5e4d 0%, #0a4a3d 100%);
}

.toggle-input:checked ~ .toggle-slider::after {
  transform: translateX(1rem);
  box-shadow: 0 1px 3px rgba(15, 94, 77, 0.3);
}

.toggle-content {
  flex: 1;
}

.toggle-title {
  font-size: 0.875rem;
  font-weight: 500;
  color: #0b1f26;
  margin-bottom: 0.125rem;
}

.toggle-description {
  font-size: 0.75rem;
  color: #5a6a72;
  line-height: 1.4;
}

.checkbox-title {
  font-weight: 500;
  color: #0b1f26;
  margin-bottom: 0.125rem;
}

.checkbox-description {
  color: #5a6a72;
  font-size: 0.75rem;
  line-height: 1.4;
}

/* Error messages styling */
.form-error {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
  border: 1px solid #fecaca;
  border-radius: 0.75rem;
  padding: 0.75rem;
  margin-top: 0.5rem;
  font-size: 0.75rem;
  color: #dc2626;
  box-shadow: 0 1px 3px rgba(220, 38, 38, 0.1);
}
.form-error svg {
  flex-shrink: 0;
  width: 1rem;
  height: 1rem;
  color: #dc2626;
}

/* Help text styling */
.form-help {
  font-size: 0.75rem;
  color: #6b7280;
  margin-top: 0.5rem;
  line-height: 1.4;
}

/* Native Select using existing button styles */
select.custom-select-button {
  appearance: none;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.5rem center;
  background-repeat: no-repeat;
  background-size: 1.5em 1.5em;
  padding-right: 2.5rem;
}

/* Hero Assignment Attention Animation */
@keyframes hero-breathe {
  0%, 100% {
    box-shadow: 0 20px 40px rgba(10, 24, 32, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.8), 0 0 0 0 rgba(250, 204, 21, 0.4);
    border-color: rgba(217, 164, 65, 0.5);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 20px 40px rgba(10, 24, 32, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.8), 0 0 0 8px rgba(250, 204, 21, 0.15), 0 0 0 16px rgba(250, 204, 21, 0.05);
    border-color: rgba(217, 164, 65, 0.8);
    transform: scale(1.02);
  }
}

.hero-attn {
  animation: hero-breathe 5s ease-in-out infinite;
}

@media (prefers-reduced-motion: reduce) {
  .hero-attn {
    animation: none;
  }
}

/* Error messages styling */
.form-error {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
  border: 1px solid #fecaca;
  border-radius: 0.75rem;
  padding: 0.75rem;
  margin-top: 0.5rem;
  font-size: 0.75rem;
  color: #dc2626;
  box-shadow: 0 1px 3px rgba(220, 38, 38, 0.1);
}
.form-error svg {
  flex-shrink: 0;
  width: 1rem;
  height: 1rem;
  color: #dc2626;
}

/* Help text styling */
.form-help {
  font-size: 0.75rem;
  color: #6b7280;
  margin-top: 0.5rem;
  line-height: 1.4;
}
```

### templates\acolytes\_partials\assignment_card.html
```html
{% load extras %}
<div class="bg-white border border-sand-200 rounded-xl p-5 hover:border-sand-300 hover:shadow-soft transition-all duration-200" id="assignment-{{ assignment.id }}">
  <div class="flex items-start justify-between gap-4">
    <!-- Info principal -->
    <div class="flex-1 min-w-0">
      <div class="flex items-baseline gap-3 mb-2">
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4 text-slate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12,6 12,12 16,14"></polyline>
          </svg>
          <time class="text-ink font-semibold">{{ assignment.slot.mass_instance.starts_at|date:"H:i" }}</time>
        </div>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4 text-slate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
          <span class="text-ink-600 text-sm font-medium">{{ assignment.slot.mass_instance.community.code }}</span>
        </div>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4 text-slate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          <span class="text-ink-500 text-sm">{{ assignment.slot.mass_instance.starts_at|date:"d/m/Y" }}</span>
        </div>
      </div>

      <div class="text-base text-ink font-medium mb-1">{{ assignment.slot.position_type.name }}</div>

      {% with team=team_names_map|get_item:assignment.slot.mass_instance_id %}
        {% if team %}
          <div class="text-sm text-slate">{{ team }}</div>
        {% endif %}
      {% endwith %}
    </div>

    <!-- Status e Ações -->
    <div class="flex flex-col items-end gap-3 flex-shrink-0">
      {# Status Badge #}
      {% with status=assignment.confirmation_status %}
        {% if status == "confirmed" %}
          <span class="inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium text-moss bg-moss-50 border border-moss-200 rounded-full">
            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            Confirmada
          </span>
        {% elif status == "pending" %}
          <span class="inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium text-sun bg-sun-50 border border-sun-200 rounded-full">
            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
            </svg>
            Aguardando confirmação
          </span>
        {% else %}
          <span class="inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium text-slate bg-sand-50 border border-sand-200 rounded-full">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
            {{ assignment.get_confirmation_status_display }}
          </span>
        {% endif %}
      {% endwith %}

      {% with claims=claims_by_slot|get_item:assignment.slot_id %}
        {% if claims %}
          <div class="w-full space-y-2">
            <div class="text-[11px] uppercase tracking-[0.2em] text-slate text-right">Solicitacoes</div>
            <div class="space-y-2">
              {% for claim in claims %}
                <div class="flex items-center justify-between gap-3 rounded-lg bg-sand-50 px-3 py-2">
                  <span class="text-sm text-ink">{{ claim.requestor_acolyte.display_name }}</span>
                  <button
                    hx-post="{% url 'position_claim_choose' claim.id %}"
                    hx-target="#assignment-{{ assignment.id }}"
                    hx-swap="outerHTML"
                    hx-vals='{"return": "assignment_card"}'
                    class="btn-secondary btn-compact"
                    type="button">
                    Ceder
                  </button>
                </div>
              {% endfor %}
            </div>
          </div>
        {% endif %}
      {% endwith %}

      {# Buttons #}
      <div class="flex flex-wrap items-center gap-2">
        {# Confirmar - mostrar se não confirmado ainda #}
        {% if assignment.confirmation_status != "confirmed" %}
          <button
            hx-post="{% url 'confirm_assignment' assignment.id %}"
            hx-target="#assignment-{{ assignment.id }}"
            hx-swap="outerHTML"
            hx-vals='{"return": "assignment_card"}'
            class="btn-primary inline-flex items-center gap-2"
            type="button">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            Confirmar
          </button>
        {% endif %}

        {# Trocar função - se missa tem múltiplos slots e não há troca pendente #}
        {% with has_multiple=mass_has_multiple_slots|get_item:assignment.slot.mass_instance_id %}
          {% with has_pending_swap=pending_swaps_by_slot|get_item:assignment.slot_id %}
            {% if has_pending_swap %}
              <span class="inline-flex items-center gap-1.5 px-3 py-2 text-sm text-sun bg-sun-50 border border-sun-200 rounded-lg">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                </svg>
                Troca pendente
              </span>
            {% elif has_multiple %}
              <a
                href="{% url 'swap_request_create' assignment.id %}"
                class="btn-secondary inline-flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                </svg>
                Trocar função
              </a>
            {% endif %}
          {% endwith %}
        {% endwith %}

        {# Rejeitar #}
        <button
          hx-post="{% url 'decline_assignment' assignment.id %}"
          hx-target="#assignment-{{ assignment.id }}"
          hx-swap="outerHTML"
          hx-confirm="Tem certeza que deseja rejeitar esta escala?"
          class="btn-danger inline-flex items-center gap-2"
          type="button">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Rejeitar
        </button>
      </div>
    </div>
  </div>
</div>
```

### templates\acolytes\_partials\calendar_feed_section.html
```html
<div id="calendar-feed-section">
{% if calendar_feed_url %}
  <div class="mt-4 text-sm">
    <button 
      type="button" 
      class="text-ink-600 hover:text-ink-900 underline decoration-dotted underline-offset-2"
      onclick="copyCalendarLink(this, '{{ calendar_feed_url }}')">
      <span class="copy-text">Copiar link do calendario</span>
    </button>
    <span class="text-ink-400 mx-2">·</span>
    <button 
      type="button"
      class="text-ink-400 hover:text-ink-600 underline decoration-dotted underline-offset-2"
      onclick="document.getElementById('calendar-details').classList.toggle('hidden')">
      Ver detalhes
    </button>
    
    <div id="calendar-details" class="hidden mt-3 pt-3 border-t border-sand-200">
      <input 
        type="text" 
        readonly 
        value="{{ calendar_feed_url }}" 
        class="input text-xs w-full bg-sand-50 font-mono text-ink-500 mb-2"
        onclick="this.select()">
      <button 
        hx-post="{% url 'calendar_feed_token' %}"
        hx-target="#calendar-feed-section"
        hx-swap="outerHTML"
        hx-confirm="O link anterior deixara de funcionar. Continuar?"
        class="text-ink-400 hover:text-ink-600 text-xs underline decoration-dotted underline-offset-2" 
        type="button">
        Gerar novo link
      </button>
    </div>
  </div>
{% else %}
  <button 
    hx-post="{% url 'calendar_feed_token' %}"
    hx-target="#calendar-feed-section"
    hx-swap="outerHTML"
    class="mt-4 text-sm text-ink-600 hover:text-ink-900 underline decoration-dotted underline-offset-2" 
    type="button">
    Gerar link do calendario
  </button>
{% endif %}
</div>

<script>
function copyCalendarLink(button, url) {
  navigator.clipboard.writeText(url).then(() => {
    const span = button.querySelector('.copy-text');
    const originalText = span.textContent;
    span.textContent = 'Link copiado';
    setTimeout(() => {
      span.textContent = originalText;
    }, 2000);
  }).catch(() => {
    document.getElementById('calendar-details').classList.remove('hidden');
    document.querySelector('#calendar-details input').select();
  });
}
</script>
```

### templates\acolytes\_partials\claim_card.html
```html
{% load extras %}
<div class="bg-white border border-sand-200 rounded-lg p-4 hover:border-sand-300 transition-colors" id="claim-{{ claim.id }}">
  <div class="flex items-start justify-between gap-4">
    <div class="flex-1 min-w-0">
      <div class="text-sm text-ink-600 mb-2">
        {{ claim.slot.mass_instance.starts_at|date:"H:i" }} · {{ claim.slot.mass_instance.community.code }} · {{ claim.slot.mass_instance.starts_at|date:"d/m/Y" }}
      </div>
      <div class="text-base font-medium text-ink">{{ claim.slot.position_type.name }}</div>
      <div class="text-sm text-slate mt-1">Solicitante: {{ claim.requestor_acolyte.display_name }}</div>
      {% if claim.target_assignment %}
        <div class="text-sm text-slate">Titular: {{ claim.target_assignment.acolyte.display_name }}</div>
      {% endif %}
      {% if claim.status == "scheduled_auto_approve" and claim.auto_approve_at %}
        <div class="text-xs text-slate mt-2">Auto aprova {{ claim.auto_approve_at|date:"d/m H:i" }}</div>
      {% endif %}
      {% if claim.resolution_reason %}
        <div class="text-xs text-slate mt-2">
          {{ claim_reason_labels|get_item:claim.resolution_reason|default:claim.resolution_reason }}
        </div>
      {% endif %}
      {% if claim.approved_by %}
        <div class="text-xs text-slate">Aprovado por {{ claim.approved_by.full_name|default:claim.approved_by.email }}</div>
      {% endif %}
    </div>
    <span class="badge badge-gray">{{ claim_status_labels|get_item:claim.status|default:claim.status }}</span>
  </div>

  {% if claim.status == "pending_coordination" and can_manage_parish %}
    <div class="flex flex-wrap items-center gap-2 pt-3 border-t border-sand-100">
      <button
        hx-post="{% url 'position_claim_approve' claim.id %}"
        hx-target="#claim-{{ claim.id }}"
        hx-swap="outerHTML"
        hx-vals='{"return": "claim_card"}'
        class="btn-primary btn-compact"
        type="button">
        Aprovar
      </button>
      <button
        hx-post="{% url 'position_claim_reject' claim.id %}"
        hx-target="#claim-{{ claim.id }}"
        hx-swap="outerHTML"
        hx-vals='{"return": "claim_card"}'
        class="btn-secondary btn-compact"
        type="button">
        Recusar
      </button>
    </div>
  {% endif %}

  {% if claim.status == "pending_target" or claim.status == "scheduled_auto_approve" %}
    {% if claim.target_assignment and claim.target_assignment.acolyte.user_id == request.user.id %}
      <div class="flex flex-wrap items-center gap-2 pt-3 border-t border-sand-100">
        <button
          hx-post="{% url 'position_claim_choose' claim.id %}"
          hx-target="#claim-{{ claim.id }}"
          hx-swap="outerHTML"
          hx-vals='{"return": "claim_card"}'
          class="btn-secondary btn-compact"
          type="button">
          Ceder
        </button>
        <button
          hx-post="{% url 'position_claim_reject' claim.id %}"
          hx-target="#claim-{{ claim.id }}"
          hx-swap="outerHTML"
          hx-vals='{"return": "claim_card"}'
          class="btn-secondary btn-compact"
          type="button">
          Recusar
        </button>
      </div>
    {% endif %}

    {% if claim.requestor_acolyte.user_id == request.user.id %}
      <div class="flex flex-wrap items-center gap-2 pt-3 border-t border-sand-100">
        <button
          hx-post="{% url 'position_claim_cancel' claim.id %}"
          hx-target="#claim-{{ claim.id }}"
          hx-swap="outerHTML"
          hx-vals='{"return": "claim_card"}'
          class="btn-secondary btn-compact"
          type="button">
          Cancelar
        </button>
      </div>
    {% endif %}
  {% endif %}
</div>
```

### templates\acolytes\_partials\dashboard_hero_assignment.html
```html
{% load extras %}
{% if hero_assignment %}
  <div id="assignment-{{ hero_assignment.id }}" class="rounded-2xl bg-gradient-to-br from-sand-50 via-white to-moss-50/40 p-6 sm:p-8 shadow-soft border border-white/70{% if hero_assignment.confirmation_status != 'confirmed' %} hero-attn{% endif %}">
    <div class="flex flex-col gap-6 md:flex-row md:items-start md:justify-between">
      <div class="space-y-3">
        <div class="text-xs uppercase tracking-[0.2em] text-slate">Sua proxima escala</div>
        <div class="text-2xl sm:text-3xl font-serif text-ink">{{ hero_assignment.slot.mass_instance.starts_at|date:"l, d M" }}</div>
        <div class="text-5xl sm:text-6xl font-serif text-ink">{{ hero_assignment.slot.mass_instance.starts_at|date:"H:i" }}</div>
        <div class="flex items-center gap-2">
          <div class="text-base text-slate">{{ hero_assignment.slot.mass_instance.community.code }}</div>
          <div class="inline-flex items-center justify-center rounded-full bg-moss-100 px-3 py-1 text-sm font-medium text-ink">
            {{ hero_assignment.slot.position_type.name }}
          </div>
        </div>
      </div>
      <div class="flex w-full flex-col gap-4 md:w-auto md:min-w-[280px]">
        {% with claims=claims_by_slot|get_item:hero_assignment.slot_id %}
          {% if claims %}
            <div class="rounded-lg bg-white/70 px-3 py-3">
              <div class="text-[11px] uppercase tracking-[0.2em] text-slate">Solicitacoes de posicao</div>
              <div class="mt-2 space-y-2">
                {% for claim in claims %}
                  <div class="flex items-center justify-between gap-3">
                    <span class="text-sm text-ink">{{ claim.requestor_acolyte.display_name }}</span>
                    <button
                      hx-post="{% url 'position_claim_choose' claim.id %}"
                      hx-target="#assignment-{{ hero_assignment.id }}"
                      hx-swap="outerHTML"
                      hx-vals='{"return": "dashboard_hero"}'
                      class="btn-secondary btn-compact"
                      type="button">
                      Ceder
                    </button>
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endif %}
        {% endwith %}

        {% if hero_assignment.confirmation_status == 'confirmed' %}
          <div class="text-sm font-medium text-ink ml-auto">
            Confirmado
          </div>
          {% if hero_has_swap_options %}
            <a href="{% url 'swap_request_create' hero_assignment.id %}" class="btn-secondary w-full md:w-auto text-center">Solicitar troca</a>
          {% endif %}
         {% else %}
           <button
             hx-post="{% url 'confirm_assignment' hero_assignment.id %}"
             hx-target="#assignment-{{ hero_assignment.id }}"
             hx-swap="outerHTML"
             hx-vals='{"return": "dashboard_hero"}'
             class="btn-primary w-full md:w-auto"
             type="button">
             Confirmar presenca
           </button>
           <button
             hx-post="{% url 'decline_assignment' hero_assignment.id %}"
             hx-target="#assignment-{{ hero_assignment.id }}"
             hx-swap="outerHTML"
             hx-vals='{"return": "dashboard_hero"}'
             hx-confirm="Tem certeza que deseja recusar esta escala?"
             class="text-sm text-ink hover:text-slate"
             type="button">
             Recusar
           </button>
         {% endif %}
      </div>
    </div>
  </div>
{% endif %}
```

### templates\acolytes\_partials\dashboard_pending_row.html
```html
{% load extras %}
{% with status=assignment.confirmation_status %}
{% if status == "pending" %}
<div id="assignment-{{ assignment.id }}" class="flex flex-col gap-4 py-4 sm:flex-row sm:items-start sm:justify-between">
  <div class="flex flex-col gap-2">
    <div class="text-xs uppercase tracking-[0.2em] text-slate">Escala pendente</div>
    <div class="flex items-center gap-3">
      <div class="text-sm text-slate">{{ assignment.slot.mass_instance.starts_at|date:"D, d M • H:i" }}</div>
      <div class="text-base text-ink font-medium">{{ assignment.slot.position_type.name }}</div>
    </div>
  </div>

  {% with claims=claims_by_slot|get_item:assignment.slot_id %}
    {% if claims %}
      <div class="flex w-full flex-col gap-3 sm:w-auto sm:min-w-[280px]">
        <div class="space-y-2">
          <div class="text-[11px] uppercase tracking-[0.2em] text-slate">Solicitacoes</div>
          <div class="space-y-2">
            {% for claim in claims %}
              <div class="flex items-start justify-between gap-3 rounded-lg bg-sand-50 px-3 py-2">
                <div class="min-w-0">
                  <div class="text-sm text-ink">{{ claim.requestor_acolyte.display_name }}</div>
                  <div class="text-xs text-slate">Pediu para voce ceder esta escala</div>
                </div>
                <button
                  hx-post="{% url 'position_claim_choose' claim.id %}"
                  hx-target="#assignment-{{ assignment.id }}"
                  hx-swap="outerHTML"
                  hx-vals='{"return": "dashboard_pending"}'
                  class="btn-secondary btn-compact"
                  type="button">
                  Ceder
                </button>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
      <div class="flex w-full flex-col gap-3 sm:w-auto sm:min-w-[200px] sm:items-end">
        {% if status == "confirmed" %}
          <span class="text-xs font-medium uppercase tracking-[0.2em] text-moss">Confirmado</span>
        {% else %}
          <button
            hx-post="{% url 'confirm_assignment' assignment.id %}"
            hx-target="#assignment-{{ assignment.id }}"
            hx-swap="outerHTML"
            hx-vals='{"return": "dashboard_pending"}'
            class="text-sm px-4 py-2 bg-sand-100 text-ink rounded-lg hover:bg-sand-200 transition-colors"
            type="button">
            Confirmar
          </button>
        {% endif %}
      </div>
    {% else %}
      <div class="flex w-full flex-col gap-3 sm:w-auto sm:min-w-[280px] sm:items-end">
        {% if status == "confirmed" %}
          <span class="text-xs font-medium uppercase tracking-[0.2em] text-moss">Confirmado</span>
        {% else %}
          <button
            hx-post="{% url 'confirm_assignment' assignment.id %}"
            hx-target="#assignment-{{ assignment.id }}"
            hx-swap="outerHTML"
            hx-vals='{"return": "dashboard_pending"}'
            class="text-sm px-4 py-2 bg-sand-100 text-ink rounded-lg hover:bg-sand-200 transition-colors"
            type="button">
            Confirmar
          </button>
        {% endif %}
      </div>
    {% endif %}
  {% endwith %}
 </div>
{% endif %}
{% endwith %}
```

### templates\acolytes\_partials\swap_card.html
```html
{% load extras %}
<div class="bg-white border border-sand-200 rounded-lg p-4 hover:border-sand-300 transition-colors" id="swap-{{ swap.id }}">
  <div class="flex items-start justify-between gap-4 mb-3">
    {# Main info #}
    <div class="flex-1 min-w-0">
      {# Date, time, location #}
      <div class="text-sm text-ink-600 mb-2">
        {{ swap.mass_instance.starts_at|date:"H:i" }} · {{ swap.mass_instance.community.short_name|default:swap.mass_instance.community.name }} · {{ swap.mass_instance.starts_at|date:"d/m/Y" }}
      </div>

      {# Swap details #}
      <div class="text-base font-medium text-ink mb-1">
        {% if swap.swap_type == "role_swap" %}
          {% if swap.target_acolyte %}
            Trocar {{ swap.from_slot.position_type.name }} → {{ swap.to_slot.position_type.name }}
            <div class="text-sm font-normal text-ink-600 mt-1">
              {% if swap.status == "awaiting_approval" %}
                Aprovado por <span class="font-medium">{{ swap.target_acolyte.user.first_name|default:swap.target_acolyte.display_name }}</span> · Aguardando coordenação
              {% elif swap.requestor_acolyte.user_id == request.user.id %}
                Solicitado para <span class="font-medium">{{ swap.target_acolyte.user.first_name|default:swap.target_acolyte.display_name }}</span>
              {% elif swap.target_acolyte.user_id == request.user.id %}
                Solicitado por <span class="font-medium">{{ swap.requestor_acolyte.user.first_name|default:swap.requestor_acolyte.display_name }}</span>
              {% else %}
                Entre <span class="font-medium">{{ swap.requestor_acolyte.user.first_name|default:swap.requestor_acolyte.display_name }}</span> e <span class="font-medium">{{ swap.target_acolyte.user.first_name|default:swap.target_acolyte.display_name }}</span>
              {% endif %}
            </div>
          {% else %}
            Trocar {{ swap.from_slot.position_type.name }} → {{ swap.to_slot.position_type.name }}
            <div class="text-sm font-normal text-ink-600 mt-1">
              {% if swap.open_to_admin %}
                Aguardando coordenação
              {% else %}
                Solicitado por <span class="font-medium">{{ swap.requestor_acolyte.user.first_name|default:swap.requestor_acolyte.display_name }}</span>
              {% endif %}
            </div>
          {% endif %}
        {% else %}
          Troca de acólito
          <div class="text-sm font-normal text-ink-600 mt-1">
            {% if swap.status == "awaiting_approval" %}
              Aprovado por <span class="font-medium">{{ swap.target_acolyte.user.first_name|default:swap.target_acolyte.display_name }}</span> · Aguardando coordenação
            {% elif swap.target_acolyte %}
              Entre <span class="font-medium">{{ swap.requestor_acolyte.user.first_name|default:swap.requestor_acolyte.display_name }}</span> e <span class="font-medium">{{ swap.target_acolyte.user.first_name|default:swap.target_acolyte.display_name }}</span>
            {% elif swap.open_to_admin %}
              Aguardando atribuição
            {% endif %}
          </div>
        {% endif %}
      </div>

      {# Notes if present #}
      {% if swap.notes %}
        <div class="mt-2 px-3 py-2 bg-sand-50 rounded text-sm text-ink-600 border-l-2 border-sand-300">
          {{ swap.notes }}
        </div>
      {% endif %}
    </div>

    {# Status badge #}
    <div class="flex-shrink-0">
      {% if swap.open_to_admin and swap.status == "pending" %}
        <span class="inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-50 border border-amber-200 rounded-full">
          <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
          </svg>
          Aguardando coordenação
        </span>
      {% elif swap.status == "pending" %}
        <span class="text-xs text-amber-600">Pendente</span>
      {% elif swap.status == "awaiting_approval" %}
        <span class="inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-full">
          <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          Aguardando aprovação
        </span>
      {% elif swap.status == "accepted" %}
        <span class="inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium text-moss-700 bg-moss-50 border border-moss-200 rounded-full">
          <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          Aceita
        </span>
      {% elif swap.status == "rejected" %}
        <span class="inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium text-ink-500 bg-sand-100 border border-sand-200 rounded-full">
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Recusada
        </span>
      {% elif swap.status == "canceled" %}
        <span class="inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium text-ink-500 bg-sand-100 border border-sand-200 rounded-full">
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Cancelada
        </span>
      {% endif %}
    </div>
  </div>

  {# Actions #}
  {% if swap.status == "pending" or swap.status == "awaiting_approval" %}
    <div class="flex flex-wrap items-center gap-2 pt-3 border-t border-sand-100">
      {# Target can accept/reject if pending #}
      {% if swap.target_acolyte and swap.target_acolyte.user_id == request.user.id and swap.status == "pending" %}
        <button
          hx-post="{% url 'swap_request_accept' swap.id %}"
          hx-target="#swap-{{ swap.id }}"
          hx-swap="outerHTML"
          class="btn-primary inline-flex items-center gap-2"
          type="button">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Aceitar
        </button>
        <button
          hx-post="{% url 'swap_request_reject' swap.id %}"
          hx-target="#swap-{{ swap.id }}"
          hx-swap="outerHTML"
          hx-confirm="Tem certeza que deseja recusar esta troca?"
          class="btn-secondary inline-flex items-center gap-2"
          type="button">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Recusar
        </button>
      {% endif %}

      {# Admin can approve if awaiting_approval #}
      {% if can_manage_parish and swap.status == "awaiting_approval" %}
        <button
          hx-post="{% url 'swap_request_approve' swap.id %}"
          hx-target="#swap-{{ swap.id }}"
          hx-swap="outerHTML"
          class="btn-primary inline-flex items-center gap-2"
          type="button">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Aprovar
        </button>
      {% endif %}

      {# Admin can assign if open_to_admin #}
      {% if swap.open_to_admin and can_manage_parish and swap.status == "pending" %}
        <a
          href="{% url 'swap_request_assign' swap.id %}"
          class="btn-secondary inline-flex items-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
          </svg>
          Atribuir acólito
        </a>
      {% endif %}

      {# Requestor can cancel if pending (but not if they are also the target seeing accept/reject) #}
      {% if swap.requestor_acolyte.user_id == request.user.id and swap.status == "pending" %}
        {% if not swap.target_acolyte or swap.target_acolyte.user_id != request.user.id %}
          <button
            hx-post="{% url 'swap_request_cancel' swap.id %}"
            hx-target="#swap-{{ swap.id }}"
            hx-swap="outerHTML"
            hx-confirm="Tem certeza que deseja cancelar esta solicitacao?"
            class="btn-danger inline-flex items-center gap-2"
            type="button">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
            Cancelar
          </button>
        {% endif %}
      {% endif %}

      {# Admin can cancel any pending swap (if not the requestor and not showing other buttons) #}
      {% if can_manage_parish and swap.status == "pending" and swap.requestor_acolyte.user_id != request.user.id %}
        {% if not swap.target_acolyte or swap.target_acolyte.user_id != request.user.id %}
          <button
            hx-post="{% url 'swap_request_cancel' swap.id %}"
            hx-target="#swap-{{ swap.id }}"
            hx-swap="outerHTML"
            hx-confirm="Tem certeza que deseja cancelar esta solicitacao?"
            class="btn-danger inline-flex items-center gap-2"
            type="button">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
            Cancelar
          </button>
        {% endif %}
      {% endif %}
    </div>
  {% endif %}
</div>
```

### templates\acolytes\assignments.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Minhas escalas{% endblock %}
{% block content %}
<div class="space-y-8">
  <!-- Header Section -->
  <div class="bg-white rounded-xl p-6 shadow-soft border border-sand-200">
    <div class="flex items-center gap-4 mb-4">
      <div class="w-12 h-12 bg-moss-50 rounded-xl flex items-center justify-center">
        <svg class="w-6 h-6 text-moss" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
      </div>
      <div>
        <h1 class="font-serif text-2xl text-ink">Minhas escalas</h1>
        <p class="text-slate mt-1">Consulte suas escalas e confirme com antecedência</p>
      </div>
    </div>
    {% include 'acolytes/_partials/calendar_feed_section.html' %}
  </div>

  <!-- Assignments Section -->
  <div class="bg-white rounded-xl p-6 shadow-soft border border-sand-200">
    <div class="mb-6">
      <div class="flex items-center gap-3 mb-2">
        <svg class="w-5 h-5 text-moss" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <h2 class="font-semibold text-xl text-ink">Próximas escalas</h2>
      </div>
      <p class="text-slate">Suas atribuições litúrgicas agendadas</p>
    </div>
    <div class="space-y-4">
      {% for assignment in assignments %}
        {% include "acolytes/_partials/assignment_card.html" with assignment=assignment %}
      {% empty %}
        <div class="text-center py-16">
          <div class="w-20 h-20 bg-sand-100 rounded-2xl flex items-center justify-center mx-auto mb-6">
            <svg class="w-10 h-10 text-slate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
          </div>
          <h3 class="text-slate font-semibold text-xl mb-2">Nenhuma escala atribuída</h3>
          <p class="text-slate-600 mb-6 max-w-md mx-auto">Suas próximas atribuições aparecerão aqui quando forem agendadas. Mantenha suas preferências atualizadas para receber mais convites.</p>
          <a href="{% url 'my_preferences' %}" class="btn-primary inline-flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            Atualizar preferências
          </a>
        </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
```

### templates\acolytes\link_user.html
```html
{% extends 'base.html' %}
{% block title %}Vincular usuario{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card max-w-3xl">
    <h2 class="font-serif text-xl mb-2">Vincular usuario</h2>
    <p class="text-sm text-slate">Associe um usuario existente ou crie um novo para um acolito.</p>
  </div>

  <form method="post" class="card max-w-3xl space-y-4">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="label">Email</label>
        {{ form.email }}
      </div>
      <div>
        <label class="label">Nome completo</label>
        {{ form.full_name }}
      </div>
      <div>
        <label class="label">Senha (se criar usuario)</label>
        {{ form.password }}
      </div>
      <div>
        <label class="label">Acolito</label>
        {{ form.acolyte }}
      </div>
      <div class="sm:col-span-2">
        <label class="label">Papeis adicionais</label>
        {{ form.roles }}
        <p class="text-xs text-slate mt-1">O papel de acolito sera sempre adicionado automaticamente.</p>
      </div>
    </div>
    {% url 'acolyte_list' as fallback_url %}
    <div class="flex items-center gap-3">
      <button class="btn-primary" type="submit">Vincular</button>
      <a class="btn-secondary" href="{{ back_url|default:fallback_url }}">Voltar</a>
    </div>
  </form>
</div>
{% endblock %}
```

### templates\acolytes\list.html
```html
{% extends 'base.html' %}
{% block title %}Acolitos{% endblock %}
{% block content %}
<div class="card">
  <h2 class="font-serif text-xl mb-4">Acolitos</h2>
  <div class="space-y-2">
    {% for acolyte in acolytes %}
      <div class="border border-black/5 rounded-lg p-3">
        <div class="font-medium">{{ acolyte.display_name }}</div>
        {% if acolyte.community_of_origin %}
          <div class="text-sm text-slate">{{ acolyte.community_of_origin.code }}</div>
        {% endif %}
      </div>
    {% empty %}
      <p class="text-sm text-slate">Nenhum acolyto cadastrado.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
```

### templates\acolytes\preferences.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Preferencias{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card">
    <h2 class="font-serif text-xl mb-1">Preferencias</h2>
    {% if not acolyte %}
      <p class="text-sm text-slate">Seu usuario nao esta vinculado a um perfil de acolito.</p>
    {% else %}
      <p class="text-sm text-slate">Atualize disponibilidade e preferencias para melhorar suas escalas.</p>
    {% endif %}
  </div>

  {% if acolyte %}
    <div class="grid lg:grid-cols-2 gap-6">
      <div class="space-y-6">
        <div class="card">
          <div>
            <h3 class="font-semibold">Minha rotina semanal</h3>
            <p class="text-sm text-slate">Indisponivel bloqueia. Disponivel apenas restringe e ativa o modo so nesses horarios.</p>
            <p class="text-xs text-slate mt-1">Horario final nao inclui o horario exato.</p>
          </div>

          <div class="mt-4 space-y-3">
            {% if any_day_rules %}
              <div class="border border-black/5 rounded-lg p-3">
                <div class="text-xs uppercase tracking-wide text-slate mb-1">Regra geral (qualquer dia)</div>
                <p class="text-xs text-slate mb-3">Aplica em todos os dias e pode restringir toda a agenda.</p>
                <div class="space-y-2">
                  {% for rule in any_day_rules %}
                    <div class="flex items-center justify-between gap-3">
                      <div>
                        <div class="text-sm text-slate">
                          {% if rule.rule_type == "unavailable" %}Indisponivel{% else %}Disponivel apenas{% endif %}
                        </div>
                        <div class="font-medium">
                          {% if rule.start_time or rule.end_time %}
                            {{ rule.start_time|time:"H:i"|default:"--:--" }}-{{ rule.end_time|time:"H:i"|default:"--:--" }}
                          {% else %}
                            Qualquer horario
                          {% endif %}
                        </div>
                        {% if rule.community %}
                          <div class="text-xs text-slate">Somente em {{ rule.community.code }}</div>
                        {% endif %}
                      </div>
                      <form method="post" action="{% url 'delete_availability' rule.id %}">
                        {% csrf_token %}
                        <button class="btn-secondary" type="submit">Remover</button>
                      </form>
                    </div>
                  {% endfor %}
                </div>
              </div>
            {% endif %}

            <div class="grid sm:grid-cols-2 gap-3">
              {% for day, label in weekday_choices %}
                <div class="border border-black/5 rounded-lg p-3">
                  <div class="text-xs uppercase tracking-wide text-slate mb-2">{{ label }}</div>
                  {% with rules=weekly_by_day|get_list_item:day %}
                    {% if rules %}
                      <div class="space-y-2">
                        {% for rule in rules %}
                          <div class="flex items-center justify-between gap-3">
                            <div>
                              <div class="text-sm text-slate">
                                {% if rule.rule_type == "unavailable" %}Indisponivel{% else %}Disponivel apenas{% endif %}
                              </div>
                              <div class="font-medium">
                                {% if rule.start_time or rule.end_time %}
                                  {{ rule.start_time|time:"H:i"|default:"--:--" }}-{{ rule.end_time|time:"H:i"|default:"--:--" }}
                                {% else %}
                                  Qualquer horario
                                {% endif %}
                              </div>
                              {% if rule.community %}
                                <div class="text-xs text-slate">Somente em {{ rule.community.code }}</div>
                              {% endif %}
                            </div>
                            <form method="post" action="{% url 'delete_availability' rule.id %}">
                              {% csrf_token %}
                              <button class="btn-secondary" type="submit">Remover</button>
                            </form>
                          </div>
                        {% endfor %}
                      </div>
                    {% else %}
                      <span class="text-xs text-slate">Livre</span>
                    {% endif %}
                  {% endwith %}
                </div>
              {% endfor %}
            </div>
          </div>

          <details class="mt-4">
            <summary class="cursor-pointer inline-flex items-center gap-2 text-sm px-4 py-2 rounded-full border border-black/10 bg-white">
              Adicionar rotina
            </summary>
            <form method="post" class="space-y-3 mt-3">
              {% csrf_token %}
              <input type="hidden" name="form_type" value="weekly_availability" />
              {{ weekly_form.non_field_errors }}
              <div class="grid sm:grid-cols-2 gap-3">
                 <div>
                   <label class="label">Dia da semana</label>
                   <div class="custom-select">
                     <input type="hidden" name="day_of_week" value="{{ weekly_form.day_of_week.value }}">
                     <button type="button" class="custom-select-button">
                       <span class="selected-text">
                         {% if weekly_form.day_of_week.value %}
                           {% for choice_value, choice_label in weekly_form.day_of_week.field.choices %}
                             {% if weekly_form.day_of_week.value == choice_value %}{{ choice_label }}{% endif %}
                           {% endfor %}
                         {% else %}
                           Selecionar...
                         {% endif %}
                       </span>
                     </button>
                     <div class="custom-select-options">
                       {% for choice_value, choice_label in weekly_form.day_of_week.field.choices %}
                         <button type="button" class="custom-select-option {% if weekly_form.day_of_week.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                       {% endfor %}
                     </div>
                   </div>
                   {% if weekly_form.day_of_week.errors %}<div class="form-error">{{ weekly_form.day_of_week.errors.0 }}</div>{% endif %}
                 </div>
                 <div>
                   <label class="label">Tipo</label>
                   <div class="custom-select">
                     <input type="hidden" name="rule_type" value="{{ weekly_form.rule_type.value }}">
                     <button type="button" class="custom-select-button">
                       <span class="selected-text">
                         {% if weekly_form.rule_type.value %}
                           {% for choice_value, choice_label in weekly_form.rule_type.field.choices %}
                             {% if weekly_form.rule_type.value == choice_value %}{{ choice_label }}{% endif %}
                           {% endfor %}
                         {% else %}
                           Selecionar...
                         {% endif %}
                       </span>
                     </button>
                     <div class="custom-select-options">
                       {% for choice_value, choice_label in weekly_form.rule_type.field.choices %}
                         <button type="button" class="custom-select-option {% if weekly_form.rule_type.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                       {% endfor %}
                     </div>
                   </div>
                   {% if weekly_form.rule_type.errors %}<div class="form-error">{{ weekly_form.rule_type.errors.0 }}</div>{% endif %}
                 </div>
                <div>
                  <label class="label">Inicio</label>
                  {{ weekly_form.start_time }}
                  {{ weekly_form.start_time.errors }}
                </div>
                <div>
                  <label class="label">Fim</label>
                  {{ weekly_form.end_time }}
                  {{ weekly_form.end_time.errors }}
                </div>
                 <div class="sm:col-span-2">
                   <label class="label">Comunidade (opcional)</label>
                   <div class="custom-select">
                     <input type="hidden" name="community" value="{{ weekly_form.community.value }}">
                     <button type="button" class="custom-select-button">
                       <span class="selected-text">
                         {% if weekly_form.community.value %}
                           {% for choice_value, choice_label in weekly_form.community.field.choices %}
                             {% if weekly_form.community.value == choice_value %}{{ choice_label|slice:":3" }}{% endif %}
                           {% endfor %}
                         {% else %}
                           Selecionar...
                         {% endif %}
                       </span>
                     </button>
                     <div class="custom-select-options">
                       {% for choice_value, choice_label in weekly_form.community.field.choices %}
                         <button type="button" class="custom-select-option {% if weekly_form.community.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label|slice:":3" }}</button>
                       {% endfor %}
                     </div>
                   </div>
                   {% if weekly_form.community.errors %}<div class="form-error">{{ weekly_form.community.errors.0 }}</div>{% endif %}
                 </div>
                <div class="sm:col-span-2">
                  <label class="label">Notas</label>
                  {{ weekly_form.notes }}
                  {{ weekly_form.notes.errors }}
                </div>
              </div>
              <button class="btn-secondary">Salvar rotina</button>
            </form>
          </details>
        </div>

        <div class="card">
          <div>
            <h3 class="font-semibold">Ausencias por data</h3>
            <p class="text-sm text-slate">Sempre bloqueiam e tem prioridade sobre a rotina semanal.</p>
          </div>
          <div class="mt-4 space-y-2">
            {% for rule in date_absences %}
              <div class="border border-black/5 rounded-lg p-3 flex items-center justify-between gap-3">
                <div>
                  <div class="font-medium">
                    {{ rule.start_date|date:"d/m/Y" }}
                    {% if rule.end_date and rule.end_date != rule.start_date %}
                      - {{ rule.end_date|date:"d/m/Y" }}
                    {% endif %}
                  </div>
                  {% if rule.notes %}
                    <div class="text-sm text-slate">{{ rule.notes }}</div>
                  {% endif %}
                </div>
                <form method="post" action="{% url 'delete_availability' rule.id %}">
                  {% csrf_token %}
                  <button class="btn-secondary" type="submit">Remover</button>
                </form>
              </div>
            {% empty %}
              <p class="text-sm text-slate">Nenhuma ausencia cadastrada.</p>
            {% endfor %}
          </div>
          <details class="mt-4">
            <summary class="cursor-pointer inline-flex items-center gap-2 text-sm px-4 py-2 rounded-full border border-black/10 bg-white">
              Adicionar ausencia
            </summary>
            <form method="post" class="space-y-3 mt-3">
              {% csrf_token %}
              <input type="hidden" name="form_type" value="date_absence" />
              {{ date_absence_form.non_field_errors }}
              <div class="grid sm:grid-cols-2 gap-3">
                <div>
                  <label class="label">Data inicio</label>
                  {{ date_absence_form.start_date }}
                  {{ date_absence_form.start_date.errors }}
                </div>
                <div>
                  <label class="label">Data fim (opcional)</label>
                  {{ date_absence_form.end_date }}
                  {{ date_absence_form.end_date.errors }}
                </div>
                <div class="sm:col-span-2">
                  <label class="label">Motivo</label>
                  {{ date_absence_form.notes }}
                  {{ date_absence_form.notes.errors }}
                </div>
              </div>
              <button class="btn-secondary">Salvar ausencia</button>
            </form>
          </details>
        </div>
      </div>

      <div class="space-y-6">
        {% if diagnostics %}
          <div class="card">
            <h3 class="font-semibold">Diagnostico rapido</h3>
            <p class="text-sm text-slate">Resumo das oportunidades nos proximos 30 dias.</p>
            <div class="mt-4 grid sm:grid-cols-2 gap-3 text-sm">
              <div class="border border-black/5 rounded-lg p-3">
                <div class="text-xs text-slate uppercase tracking-wide">Missas no periodo</div>
                <div class="text-xl font-semibold">{{ diagnostics.total }}</div>
              </div>
              <div class="border border-black/5 rounded-lg p-3">
                <div class="text-xs text-slate uppercase tracking-wide">Oportunidades elegiveis</div>
                <div class="text-xl font-semibold">{{ diagnostics.eligible_opportunities }}</div>
              </div>
              <div class="border border-black/5 rounded-lg p-3">
                <div class="text-xs text-slate uppercase tracking-wide">Qualificacoes</div>
                <div class="text-xl font-semibold">{{ diagnostics.qualified_positions }}</div>
              </div>
              <div class="border border-black/5 rounded-lg p-3">
                <div class="text-xs text-slate uppercase tracking-wide">Bloqueios por disponibilidade</div>
                <div class="text-xl font-semibold">{{ diagnostics.blocked_availability }}</div>
              </div>
            </div>
            {% if diagnostics.reasons %}
              <div class="mt-4 text-sm text-slate">
                <p class="font-medium text-ink">Possiveis motivos:</p>
                <ul class="list-disc list-inside space-y-1">
                  {% for reason in diagnostics.reasons %}
                    <li>{{ reason }}</li>
                  {% endfor %}
                </ul>
              </div>
            {% endif %}
          </div>
        {% endif %}

        <div class="card">
          <div>
            <h3 class="font-semibold">Preferencias atuais</h3>
            <p class="text-sm text-slate">Resumo simples para facilitar a leitura.</p>
          </div>
          <div class="mt-4 space-y-2">
            {% for pref in preferences %}
              <div class="border border-black/5 rounded-lg p-3 flex items-center justify-between gap-3">
                <div>
                  <div class="font-medium">{{ pref|preference_summary }}</div>
                  <div class="flex items-center gap-2 text-xs uppercase tracking-wide text-slate mt-1">
                    <span class="px-2 py-0.5 rounded-full bg-sand text-ink/70">{{ pref.weight|preference_priority_label }}</span>
                    {% with detail=pref|preference_detail %}
                      {% if detail %}
                        <span>{{ detail }}</span>
                      {% endif %}
                    {% endwith %}
                  </div>
                </div>
                <form method="post" action="{% url 'delete_preference' pref.id %}">
                  {% csrf_token %}
                  <button class="btn-secondary" type="submit">Remover</button>
                </form>
              </div>
            {% empty %}
              <p class="text-sm text-slate">Nenhuma preferencia cadastrada.</p>
            {% endfor %}
          </div>
        </div>

        <div class="card">
          <div>
            <h3 class="font-semibold">Adicionar preferencia</h3>
            <p class="text-sm text-slate">Prioridade alta reforca, mas nao garante.</p>
          </div>
          <form method="post" class="space-y-3 mt-4">
            {% csrf_token %}
            <input type="hidden" name="form_type" value="preference" />
            {{ preference_form.non_field_errors }}
            {{ preference_form.weight.as_hidden }}
            <div class="grid sm:grid-cols-2 gap-3">
               <div class="sm:col-span-2">
                 <label class="label">Tipo</label>
                  <div class="custom-select">
                    <input type="hidden" id="id_preference_type" name="preference_type" value="{{ preference_form.preference_type.value }}">
                   <button type="button" class="custom-select-button">
                     <span class="selected-text">
                       {% if preference_form.preference_type.value %}
                         {% for choice_value, choice_label in preference_form.preference_type.field.choices %}
                           {% if preference_form.preference_type.value == choice_value %}{{ choice_label }}{% endif %}
                         {% endfor %}
                       {% else %}
                         Selecionar...
                       {% endif %}
                     </span>
                   </button>
                   <div class="custom-select-options">
                     {% for choice_value, choice_label in preference_form.preference_type.field.choices %}
                       <button type="button" class="custom-select-option {% if preference_form.preference_type.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                     {% endfor %}
                   </div>
                 </div>
                 {% if preference_form.preference_type.errors %}<div class="form-error">{{ preference_form.preference_type.errors.0 }}</div>{% endif %}
               </div>
              <div class="sm:col-span-2">
                <label class="label">Prioridade</label>
                {% with weight_value=preference_form.weight.value|default:50 %}
                  <div class="flex flex-wrap gap-2" id="pref_priority_group">
                    <button type="button" data-priority="25"
                      class="px-4 py-2 rounded-full border text-sm {% if weight_value|stringformat:"s" == "25" %}bg-ink text-white border-ink{% else %}border-black/10 text-slate{% endif %}">
                      Baixa
                    </button>
                    <button type="button" data-priority="50"
                      class="px-4 py-2 rounded-full border text-sm {% if weight_value|stringformat:"s" == "50" %}bg-ink text-white border-ink{% else %}border-black/10 text-slate{% endif %}">
                      Media
                    </button>
                    <button type="button" data-priority="100"
                      class="px-4 py-2 rounded-full border text-sm {% if weight_value|stringformat:"s" == "100" %}bg-ink text-white border-ink{% else %}border-black/10 text-slate{% endif %}">
                      Alta
                    </button>
                  </div>
                {% endwith %}
              </div>
               <div class="sm:col-span-2 hidden" data-pref-field="target_community">
                 <label class="label">Comunidade</label>
                 <div class="custom-select">
                   <input type="hidden" name="target_community" value="{{ preference_form.target_community.value }}">
                   <button type="button" class="custom-select-button">
                     <span class="selected-text">
                       {% if preference_form.target_community.value %}
                         {% for choice_value, choice_label in preference_form.target_community.field.choices %}
                           {% if preference_form.target_community.value == choice_value %}{{ choice_label|slice:":3" }}{% endif %}
                         {% endfor %}
                       {% else %}
                         Selecionar...
                       {% endif %}
                     </span>
                   </button>
                   <div class="custom-select-options">
                     {% for choice_value, choice_label in preference_form.target_community.field.choices %}
                       <button type="button" class="custom-select-option {% if preference_form.target_community.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label|slice:":3" }}</button>
                     {% endfor %}
                   </div>
                 </div>
                 {% if preference_form.target_community.errors %}<div class="form-error">{{ preference_form.target_community.errors.0 }}</div>{% endif %}
              </div>
               <div class="sm:col-span-2 hidden" data-pref-field="target_position">
                 <label class="label">Posição</label>
                 <div class="custom-select">
                   <input type="hidden" name="target_position" value="{{ preference_form.target_position.value }}">
                   <button type="button" class="custom-select-button">
                     <span class="selected-text">
                       {% if preference_form.target_position.value %}
                         {% for choice_value, choice_label in preference_form.target_position.field.choices %}
                           {% if preference_form.target_position.value == choice_value %}{{ choice_label }}{% endif %}
                         {% endfor %}
                       {% else %}
                         Selecionar...
                       {% endif %}
                     </span>
                   </button>
                   <div class="custom-select-options">
                     {% for choice_value, choice_label in preference_form.target_position.field.choices %}
                       <button type="button" class="custom-select-option {% if preference_form.target_position.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                     {% endfor %}
                   </div>
                 </div>
                 {% if preference_form.target_position.errors %}<div class="form-error">{{ preference_form.target_position.errors.0 }}</div>{% endif %}
               </div>
               <div class="sm:col-span-2 hidden" data-pref-field="target_function">
                 <label class="label">Função</label>
                 <div class="custom-select">
                   <input type="hidden" name="target_function" value="{{ preference_form.target_function.value }}">
                   <button type="button" class="custom-select-button">
                     <span class="selected-text">
                       {% if preference_form.target_function.value %}
                         {% for choice_value, choice_label in preference_form.target_function.field.choices %}
                           {% if preference_form.target_function.value == choice_value %}{{ choice_label }}{% endif %}
                         {% endfor %}
                       {% else %}
                         Selecionar...
                       {% endif %}
                     </span>
                   </button>
                   <div class="custom-select-options">
                     {% for choice_value, choice_label in preference_form.target_function.field.choices %}
                       <button type="button" class="custom-select-option {% if preference_form.target_function.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                     {% endfor %}
                   </div>
                 </div>
                 {% if preference_form.target_function.errors %}<div class="form-error">{{ preference_form.target_function.errors.0 }}</div>{% endif %}
               </div>
               <div class="sm:col-span-2 hidden" data-pref-field="target_template">
                 <label class="label">Modelo</label>
                 <div class="custom-select">
                   <input type="hidden" name="target_template" value="{{ preference_form.target_template.value }}">
                   <button type="button" class="custom-select-button">
                     <span class="selected-text">
                       {% if preference_form.target_template.value %}
                         {% for choice_value, choice_label in preference_form.target_template.field.choices %}
                           {% if preference_form.target_template.value == choice_value %}{{ choice_label }}{% endif %}
                         {% endfor %}
                       {% else %}
                         Selecionar...
                       {% endif %}
                     </span>
                   </button>
                   <div class="custom-select-options">
                     {% for choice_value, choice_label in preference_form.target_template.field.choices %}
                       <button type="button" class="custom-select-option {% if preference_form.target_template.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                     {% endfor %}
                   </div>
                 </div>
                 {% if preference_form.target_template.errors %}<div class="form-error">{{ preference_form.target_template.errors.0 }}</div>{% endif %}
               </div>
               <div class="sm:col-span-2 hidden" data-pref-field="target_acolyte">
                 <label class="label">Parceiro</label>
                 <div class="custom-select">
                   <input type="hidden" name="target_acolyte" value="{{ preference_form.target_acolyte.value }}">
                   <button type="button" class="custom-select-button">
                     <span class="selected-text">
                       {% if preference_form.target_acolyte.value %}
                         {% for choice_value, choice_label in preference_form.target_acolyte.field.choices %}
                           {% if preference_form.target_acolyte.value == choice_value %}{{ choice_label }}{% endif %}
                         {% endfor %}
                       {% else %}
                         Selecionar...
                       {% endif %}
                     </span>
                   </button>
                   <div class="custom-select-options">
                     {% for choice_value, choice_label in preference_form.target_acolyte.field.choices %}
                       <button type="button" class="custom-select-option {% if preference_form.target_acolyte.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                     {% endfor %}
                   </div>
                 </div>
                 {% if preference_form.target_acolyte.errors %}<div class="form-error">{{ preference_form.target_acolyte.errors.0 }}</div>{% endif %}
               </div>
               <div class="hidden" data-pref-field="weekday">
                 <label class="label">Dia da semana</label>
                 <div class="custom-select">
                   <input type="hidden" name="weekday" value="{{ preference_form.weekday.value }}">
                   <button type="button" class="custom-select-button">
                     <span class="selected-text">
                       {% if preference_form.weekday.value %}
                         {% for choice_value, choice_label in preference_form.weekday.field.choices %}
                           {% if preference_form.weekday.value == choice_value %}{{ choice_label }}{% endif %}
                         {% endfor %}
                       {% else %}
                         Selecionar...
                       {% endif %}
                     </span>
                   </button>
                   <div class="custom-select-options">
                     {% for choice_value, choice_label in preference_form.weekday.field.choices %}
                       <button type="button" class="custom-select-option {% if preference_form.weekday.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                     {% endfor %}
                   </div>
                 </div>
                 {% if preference_form.weekday.errors %}<div class="form-error">{{ preference_form.weekday.errors.0 }}</div>{% endif %}
               </div>
              <div class="hidden" data-pref-field="start_time">
                <label class="label">Horario inicio</label>
                {{ preference_form.start_time }}
                {{ preference_form.start_time.errors }}
              </div>
              <div class="hidden" data-pref-field="end_time">
                <label class="label">Horario fim</label>
                {{ preference_form.end_time }}
                {{ preference_form.end_time.errors }}
              </div>
            </div>
            <button class="btn-secondary">Salvar preferencia</button>
          </form>
        </div>
      </div>
    </div>
  {% endif %}
</div>

<script>
  (function () {
    const typeSelect = document.getElementById("id_preference_type");
    const weightInput = document.getElementById("id_weight");
    const priorityButtons = document.querySelectorAll("[data-priority]");
    const groups = document.querySelectorAll("[data-pref-field]");
    const mapping = {
      preferred_community: ["target_community"],
      avoid_community: ["target_community"],
      preferred_position: ["target_position"],
      avoid_position: ["target_position"],
      preferred_function: ["target_function"],
      avoid_function: ["target_function"],
      preferred_mass_template: ["target_template"],
      preferred_partner: ["target_acolyte"],
      avoid_partner: ["target_acolyte"],
      preferred_timeslot: ["weekday", "start_time", "end_time"],
    };

    function resetField(el) {
      if (el.tagName === "SELECT") {
        el.selectedIndex = 0;
        return;
      }
      if (el.type === "checkbox" || el.type === "radio") {
        el.checked = false;
        return;
      }
      el.value = "";
    }

    function updateFields() {
       if (!typeSelect) {
         return;
       }
       const allowed = mapping[typeSelect.value] || [];
       groups.forEach((group) => {
         const field = group.getAttribute("data-pref-field");
         const show = allowed.includes(field);
         const wasHidden = group.classList.contains("hidden");
         group.classList.toggle("hidden", !show);
         group.querySelectorAll("select, input, textarea").forEach((el) => {
           el.disabled = !show;
           if (!show) {
             resetField(el);
           }
         });
         // Re-initialize custom selects if the group was hidden and now shown
         if (wasHidden && show && window.initCustomSelects) {
           window.initCustomSelects(group);
         }
       });
     }

    function setPriority(value) {
      if (!weightInput) {
        return;
      }
      weightInput.value = value;
      priorityButtons.forEach((btn) => {
        const isActive = btn.dataset.priority === value;
        btn.classList.toggle("bg-ink", isActive);
        btn.classList.toggle("text-white", isActive);
        btn.classList.toggle("border-ink", isActive);
        btn.classList.toggle("border-black/10", !isActive);
        btn.classList.toggle("text-slate", !isActive);
      });
    }

    if (typeSelect) {
      typeSelect.addEventListener("change", updateFields);
      updateFields();
    }
    priorityButtons.forEach((btn) => {
      btn.addEventListener("click", () => setPriority(btn.dataset.priority));
    });
    if (weightInput) {
      setPriority(weightInput.value || "50");
    }
  })();
</script>
{% endblock %}
```

### templates\acolytes\swap_assign.html
```html
{% extends 'base.html' %}
{% block title %}Atribuir troca{% endblock %}
{% block content %}
<div class="card max-w-2xl">
  <h2 class="font-serif text-xl mb-2">Atribuir troca</h2>
  <p class="text-sm text-slate mb-4">Selecione o acolito que ira assumir esta troca.</p>
  <form method="post" class="space-y-4">
    {% csrf_token %}
    <div>
      <label class="label">Acolito</label>
      {{ form.target_acolyte }}
    </div>
    <div class="flex items-center gap-3">
      <button class="btn-primary" type="submit">Atribuir e aplicar</button>
      <a class="btn-secondary" href="{% url 'swap_requests' %}">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
```

### templates\acolytes\swap_form.html
```html
{% extends 'base.html' %}
{% block title %}Trocar função{% endblock %}
{% block content %}
<div class="max-w-lg">
  {% url 'my_assignments' as fallback_url %}
   <div class="mb-6">
     <a href="{{ back_url|default:fallback_url }}" class="text-sm text-ink-500 hover:text-ink-700">&larr; Voltar</a>
   </div>
  
  <div class="card">
    <h2 class="font-serif text-xl mb-2">Trocar função</h2>
    
    <div class="text-sm text-ink-600 mb-6">
      <div class="mb-1">
        <span class="text-ink-400">Missa:</span>
        {{ mass_instance.starts_at|date:"d/m/Y" }} às {{ mass_instance.starts_at|date:"H:i" }} • {{ mass_instance.community.code }}
      </div>
      <div>
        <span class="text-ink-400">Sua função atual:</span>
        {{ assignment.slot.position_type.name }}
      </div>
    </div>
    
    {% if swap_options %}
    <form method="post">
      {% csrf_token %}
      
      <div class="mb-4">
        <label class="label mb-2">Selecione as funções que aceita trocar</label>
        <p class="text-xs text-ink-400 mb-3">Você pode selecionar múltiplas opções. Os acólitos selecionados serão notificados e quem aceitar primeiro concretiza a troca.</p>
        <div class="space-y-2">
          {% for option in swap_options %}
          <label class="flex items-center gap-3 p-3 border border-sand-200 rounded-lg cursor-pointer hover:border-sand-300 has-[:checked]:border-[#0f5e4d] has-[:checked]:bg-[#0f5e4d]/5 transition-colors">
            <input type="checkbox" name="target_slots" value="{{ option.slot.id }}" class="w-4 h-4 text-[#0f5e4d] rounded border-sand-300 focus:ring-[#0f5e4d]">
            <div class="flex-1">
              <div class="text-ink-700 font-medium">{{ option.position_name }}</div>
              <div class="text-sm text-ink-500">{{ option.acolyte.display_name }}</div>
            </div>
          </label>
          {% endfor %}
        </div>
      </div>
      
      <div class="mb-6">
        <label class="label">Motivo (opcional)</label>
        <input type="text" name="notes" class="input w-full" placeholder="Ex: prefiro esta função...">
      </div>
      
      <div class="flex gap-3">
        <button type="submit" class="btn-primary">Solicitar troca</button>
        <a href="{{ back_url|default:fallback_url }}" class="btn-secondary">Cancelar</a>
      </div>
    </form>
    {% else %}
    <p class="text-ink-500 py-4">Não há outras funções disponíveis para troca nesta missa.</p>
    <a href="{{ back_url|default:fallback_url }}" class="btn-secondary inline-block">Voltar</a>
    {% endif %}
  </div>
</div>
{% endblock %}
```

### templates\acolytes\swaps.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Trocas{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card">
    <div class="flex items-center justify-between mb-4">
      <h2 class="font-serif text-xl">Solicitações de troca</h2>
      {% if can_manage_parish %}
        {% if show_all %}
          <a href="{% url 'swap_requests' %}" class="text-sm text-ink-600 hover:text-ink-800 underline">Ver minhas trocas</a>
        {% else %}
          <a href="{% url 'swap_requests' %}?all=true" class="text-sm text-ink-600 hover:text-ink-800 underline">Ver todas as trocas</a>
        {% endif %}
      {% endif %}
    </div>
    <div class="space-y-2">
      {% for swap in swaps %}
        {% include "acolytes/_partials/swap_card.html" with swap=swap can_manage_parish=can_manage_parish %}
      {% empty %}
        <p class="text-sm text-slate">Nenhuma solicitação.</p>
      {% endfor %}
    </div>
  </div>

  <div class="card">
    <div class="flex items-center justify-between mb-4">
      <h2 class="font-serif text-xl">Solicitações de posição</h2>
    </div>
    <div class="space-y-2">
      {% for claim in claims %}
        {% include "acolytes/_partials/claim_card.html" with claim=claim can_manage_parish=can_manage_parish claim_status_labels=claim_status_labels claim_reason_labels=claim_reason_labels %}
      {% empty %}
        <p class="text-sm text-slate">Nenhuma solicitação de posição.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
```

### templates\audit\list.html
```html
{% extends 'base.html' %}
{% block title %}Auditoria{% endblock %}
{% block content %}
<div class="space-y-8">
  <div>
    <h1 class="font-serif text-3xl text-moss mb-2">Auditoria</h1>
    <p class="text-slate">Acompanhe alterações recentes na paróquia para rastreamento e conformidade.</p>
  </div>

  <form method="get" class="card">
    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
    <div>
      <label class="label">Entidade</label>
      <div class="custom-select">
        <input type="hidden" name="entity" value="{{ entity_type }}">
        <button type="button" class="custom-select-button">
          <span class="selected-text">
            {% if entity_type %}{{ entity_type }}{% else %}Todas{% endif %}
          </span>
        </button>
        <div class="custom-select-options">
          <button type="button" class="custom-select-option {% if not entity_type %}selected{% endif %}" data-value="">Todas</button>
          <button type="button" class="custom-select-option {% if entity_type == "MassInstance" %}selected{% endif %}" data-value="MassInstance">Missa</button>
          <button type="button" class="custom-select-option {% if entity_type == "Assignment" %}selected{% endif %}" data-value="Assignment">Escala</button>
          <button type="button" class="custom-select-option {% if entity_type == "SwapRequest" %}selected{% endif %}" data-value="SwapRequest">Troca</button>
          <button type="button" class="custom-select-option {% if entity_type == "ReplacementRequest" %}selected{% endif %}" data-value="ReplacementRequest">Substituição</button>
          <button type="button" class="custom-select-option {% if entity_type == "Parish" %}selected{% endif %}" data-value="Parish">Paróquia</button>
          <button type="button" class="custom-select-option {% if entity_type == "Confirmation" %}selected{% endif %}" data-value="Confirmation">Confirmação</button>
        </div>
      </div>
    </div>
    <div>
      <label class="label">Ação</label>
      <div class="custom-select">
        <input type="hidden" name="action" value="{{ action_type }}">
        <button type="button" class="custom-select-button">
          <span class="selected-text">
            {% if action_type %}{{ action_type|title }}{% else %}Todas{% endif %}
          </span>
        </button>
         <div class="custom-select-options">
           <button type="button" class="custom-select-option {% if not action_type %}selected{% endif %}" data-value="">Todas</button>
           <button type="button" class="custom-select-option {% if action_type == "create" %}selected{% endif %}" data-value="create">Criar</button>
           <button type="button" class="custom-select-option {% if action_type == "update" %}selected{% endif %}" data-value="update">Atualizar</button>
           <button type="button" class="custom-select-option {% if action_type == "delete" %}selected{% endif %}" data-value="delete">Excluir</button>
           <button type="button" class="custom-select-option {% if action_type == "cancel" %}selected{% endif %}" data-value="cancel">Cancelar</button>
           <button type="button" class="custom-select-option {% if action_type == "move" %}selected{% endif %}" data-value="move">Mover</button>
           <button type="button" class="custom-select-option {% if action_type == "publish" %}selected{% endif %}" data-value="publish">Publicar</button>
           <button type="button" class="custom-select-option {% if action_type == "assign" %}selected{% endif %}" data-value="assign">Atribuir</button>
         </div>
       </div>
    </div>
    <div>
      <label class="label">Inicio</label>
      <input type="date" name="start" value="{{ start_date }}" />
    </div>
    <div>
      <label class="label">Fim</label>
      <input type="date" name="end" value="{{ end_date }}" />
    </div>
    <div class="lg:col-span-2 flex items-end gap-3">
      <button class="btn-primary" type="submit">Aplicar filtros</button>
      <a class="btn-secondary" href="{% url 'audit_log' %}">Limpar filtros</a>
    </div>
  </div>
  </form>

  <div class="card">
    <div class="flex items-center justify-between mb-6">
      <div>
        <h2 class="font-semibold text-xl text-ink">Histórico de alterações</h2>
        <p class="text-sm text-slate">{{ rows|length }} evento{{ rows|length|pluralize }} encontrado{{ rows|length|pluralize }}</p>
      </div>
      <div class="text-sm text-slate">
        Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
      </div>
    </div>
    <div class="space-y-4">
      {% for row in rows %}
        <div class="border border-black/8 rounded-xl p-5 hover:bg-sand/20 transition-all duration-200 hover:shadow-sm">
          <div class="flex items-start justify-between gap-4">
            <div class="flex items-start gap-4">
              <div class="w-10 h-10 bg-moss/10 rounded-full flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-moss" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                </svg>
              </div>
              <div>
                <div class="text-sm text-slate font-medium">{{ row.event.timestamp|date:"d/m/Y às H:i" }}</div>
                <div class="font-semibold text-ink mt-1">{{ row.summary }}</div>
                <div class="text-sm text-slate mt-1 flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                  {% if row.event.actor_user %}
                    {{ row.event.actor_user.full_name|default:row.event.actor_user.email }}
                  {% else %}
                    Sistema
                  {% endif %}
                </div>
              </div>
            </div>
            {% if row.link %}
              <div class="flex-shrink-0">
                {% if row.link.1 %}
                  <a class="btn-secondary text-sm px-3 py-1.5" href="{% url row.link.0 row.link.1 %}">Ver detalhes</a>
                {% else %}
                  <a class="btn-secondary text-sm px-3 py-1.5" href="{% url row.link.0 %}">Ver detalhes</a>
                {% endif %}
              </div>
            {% endif %}
          </div>
        </div>
      {% empty %}
        <div class="text-center py-12">
          <div class="w-16 h-16 bg-sand rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-slate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
          </div>
          <p class="text-slate font-medium">Nenhum evento encontrado</p>
          <p class="text-sm text-slate mt-1">Ajuste os filtros para ver mais resultados.</p>
        </div>
      {% endfor %}
    </div>

    {% if page_obj.paginator.num_pages > 1 %}
    <div class="mt-8 flex items-center justify-between pt-6 border-t border-black/5">
      <div class="flex items-center gap-3">
        {% if page_obj.has_previous %}
          <a class="btn-secondary" href="?page={{ page_obj.previous_page_number }}&entity={{ entity_type }}&action={{ action_type }}&start={{ start_date }}&end={{ end_date }}">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Anterior
          </a>
        {% else %}
          <span class="text-slate">Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
        {% endif %}
      </div>
      <div class="flex items-center gap-3">
        {% if page_obj.has_next %}
          <a class="btn-secondary" href="?page={{ page_obj.next_page_number }}&entity={{ entity_type }}&action={{ action_type }}&start={{ start_date }}&end={{ end_date }}">
            Próxima
            <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </a>
        {% endif %}
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
```

### templates\calendar\_slots_section.html
```html
{% load extras %}
{% include 'partials/_messages.html' %}
<div id="slots-section" class="card">
  <h3 class="font-semibold mb-3">Funcoes</h3>
  <div class="space-y-2">
    {% for slot in slots %}
      <div class="rounded-xl border border-black/5 bg-white/80 p-4 space-y-4 transition-all hover:bg-white hover:shadow-soft">
        <div class="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4">
          <div class="space-y-2">
            <div class="text-xs uppercase tracking-wide text-slate">{{ slot.position_type.name }}</div>
            {% if slot.externally_covered %}
              <div class="text-base font-medium text-ink">Coberto externamente</div>
              {% if slot.external_coverage_notes %}
                <div class="text-xs text-slate">{{ slot.external_coverage_notes }}</div>
              {% endif %}
            {% elif not slot.required %}
              <div class="text-base font-medium text-ink">Nao necessario</div>
            {% else %}
              {% with active=slot.active_assignment %}
                <div class="flex flex-wrap items-center gap-2">
                  <div class="text-lg font-medium text-ink">{% if active %}{{ active.acolyte.display_name }}{% else %}Vaga aberta{% endif %}</div>
                  {% if active %}
                    {% with status=active.confirmation_status %}
                      {% if status == "confirmed" %}
                        <span class="rounded-full bg-moss/15 px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide text-moss">Confirmada</span>
                      {% elif status == "declined" %}
                        <span class="rounded-full bg-sun/15 px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide text-sun">Recusada</span>
                      {% elif status == "no_show" %}
                        <span class="rounded-full bg-slate/15 px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide text-slate">Nao compareceu</span>
                      {% elif status == "canceled_by_acolyte" %}
                        <span class="rounded-full bg-slate/15 px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide text-slate">Cancelada</span>
                      {% elif status == "replaced" %}
                        <span class="rounded-full bg-slate/15 px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide text-slate">Substituida</span>
                      {% else %}
                        <span class="rounded-full bg-sun/15 px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide text-sun">Pendente</span>
                      {% endif %}
                    {% endwith %}
                  {% endif %}
                </div>
              {% endwith %}
            {% endif %}
          </div>
        </div>

        {% with active=slot.active_assignment %}
          {% with claims=claims_by_slot|get_item:slot.id %}
            {% if active and active.acolyte.user_id == request.user.id and claims %}
              <div class="border-t border-black/5 pt-4">
                <div class="text-[11px] uppercase tracking-[0.2em] text-slate">Solicitacoes de posicao</div>
                <div class="mt-2 space-y-2">
                  {% for claim in claims %}
                    <div class="flex items-center justify-between gap-3 rounded-lg bg-sand-50 px-3 py-2">
                      <span class="text-sm text-ink">{{ claim.requestor_acolyte.display_name }}</span>
                      <button
                        hx-post="{% url 'position_claim_choose' claim.id %}"
                        hx-target="#slots-section"
                        hx-swap="outerHTML"
                        hx-vals='{"return": "slots_section"}'
                        class="btn-secondary btn-compact"
                        type="button">
                        Ceder
                      </button>
                    </div>
                  {% endfor %}
                </div>
              </div>
            {% endif %}
          {% endwith %}

          {% if user_acolyte and active and active.acolyte_id != user_acolyte.id and not user_has_assignment_in_instance %}
            {% with my_claim=user_claims_by_slot|get_item:slot.id %}
              <div class="border-t border-black/5 pt-4">
                {% if my_claim %}
                  <div class="text-xs uppercase tracking-[0.2em] text-slate">Solicitado</div>
                {% else %}
                  <button
                    hx-post="{% url 'position_claim_create' instance.id slot.id %}"
                    hx-target="#slots-section"
                    hx-swap="outerHTML"
                    hx-vals='{"return": "slots_section"}'
                    class="text-xs uppercase tracking-[0.2em] text-moss hover:text-moss-700"
                    type="button">
                    Solicitar posicao
                  </button>
                {% endif %}
              </div>
            {% endwith %}
          {% endif %}
        {% endwith %}

        {% if can_manage_parish and slot.required and not slot.externally_covered %}
          {% with active=slot.active_assignment %}
            <div class="space-y-3 border-t border-black/5 pt-4">
              <div class="flex flex-wrap items-center gap-2">
                {% if active %}
                  {% if active.confirmation_status != "confirmed" %}
                    <button
                      class="btn-primary btn-compact"
                      hx-post="{% url 'slot_confirm_assignment' instance.id slot.id %}"
                      hx-target="#slots-section"
                      hx-swap="outerHTML"
                    >Confirmar presenca</button>
                  {% endif %}
                  <button
                    class="btn-danger btn-compact"
                    hx-post="{% url 'slot_remove_assignment' instance.id slot.id %}"
                    hx-target="#slots-section"
                    hx-swap="outerHTML"
                    hx-confirm="Remover este acolito da escala?"
                  >Remover da escala</button>
                {% endif %}
                <a class="btn-secondary btn-compact" href="{% url 'slot_assign' instance.id slot.id %}">Escolher outro</a>
              </div>
              <div class="flex flex-wrap items-center gap-2 border-t border-black/5 pt-3">
                {% for candidate in slot_suggestions|get_list_item:slot.id %}
                  <button
                    class="btn-secondary btn-compact"
                    hx-post="{% if active %}{% url 'slot_replace' instance.id slot.id %}{% else %}{% url 'slot_assign' instance.id slot.id %}{% endif %}"
                    hx-vals='{"acolyte_id": "{{ candidate.id }}"}'
                    hx-target="#slots-section"
                    hx-swap="outerHTML"
                    {% if slot.is_locked %}hx-confirm="Esta missa esta consolidada. Deseja continuar?"{% endif %}
                  >{% if active %}Substituir{% else %}Atribuir{% endif %} {{ candidate.display_name }}</button>
                {% empty %}
                  <span class="text-xs text-slate">Sem sugestoes automaticas.</span>
                {% endfor %}
              </div>
            </div>
          {% endwith %}
        {% endif %}

        {% if slot.recent_assignments and slot.recent_assignments|length > 1 %}
          <details class="group border-t border-black/5 pt-4">
            <summary class="text-xs uppercase tracking-wide text-slate cursor-pointer transition-colors group-open:text-ink">Historico recente</summary>
            <div class="mt-2 space-y-1 text-xs text-slate">
              {% for past in slot.recent_assignments %}
                {% if not past.is_active %}
                  <div>{{ past.acolyte.display_name }}{% if past.end_reason %} ({{ past.end_reason|assignment_end_reason_label }}){% endif %}</div>
                {% endif %}
              {% endfor %}
            </div>
          </details>
        {% endif %}
      </div>
    {% empty %}
      <p class="text-sm text-slate">Sem slots configurados.</p>
    {% endfor %}
  </div>
</div>
```

### templates\calendar\assign_slot.html
```html
{% extends 'base.html' %}
{% block title %}{{ action_label }} acolito{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <div class="text-sm text-slate">{{ instance.starts_at|date:"d/m/Y H:i" }}</div>
    <h2 class="font-serif text-xl">{{ instance.community.name }}</h2>
    <p class="text-slate">{{ slot.position_type.name }}</p>
    {% if slot.is_locked %}
      <p class="text-sm text-slate mt-2">Esta missa esta dentro da consolidacao. Alteracoes devem ser justificadas.</p>
    {% endif %}
  </div>

  <div class="card">
    {% url 'mass_detail' instance.id as fallback_url %}
    <form method="get" class="flex flex-wrap items-center gap-3">
      <input class="flex-1" type="text" name="q" value="{{ query }}" placeholder="Buscar acolito" />
      <button class="btn-secondary" type="submit">Buscar</button>
      <a class="btn-secondary" href="{{ back_url|default:fallback_url }}">Voltar</a>
    </form>
  </div>

  <div class="card">
    <h3 class="font-semibold mb-3">{{ action_label }}</h3>
    <div class="space-y-2">
      {% for candidate in candidates %}
        <form method="post" action="{% url 'slot_assign' instance.id slot.id %}" class="border border-black/5 rounded-lg p-3 flex items-center justify-between gap-3">
          {% csrf_token %}
          <div>
            <div class="font-medium">{{ candidate.acolyte.display_name }}</div>
            {% if candidate.acolyte.community_of_origin %}
              <div class="text-sm text-slate">{{ candidate.acolyte.community_of_origin.code }}</div>
            {% endif %}
            {% if candidate.score %}
              <div class="text-xs text-slate">Score: {{ candidate.score|floatformat:1 }}</div>
            {% endif %}
            {% if candidate.reason %}
              <div class="text-xs text-slate">{{ candidate.reason }}</div>
            {% endif %}
          </div>
          <input type="hidden" name="acolyte_id" value="{{ candidate.acolyte.id }}" />
          <button class="btn-primary" type="submit">{{ action_label }}</button>
        </form>
      {% empty %}
        <p class="text-sm text-slate">Nenhum acolito encontrado para este filtro.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% if show_conflict_modal %}
  {% include 'modals/assignment_conflict.html' %}
  <script>
    setTimeout(function() {
      var modalEl = document.getElementById('assignmentConflictModal');
      if (modalEl) {
        var modal = new bootstrap.Modal(modalEl);
        modal.show();
      }
    }, 100);
  </script>
{% endif %}
{% endblock %}
```

### templates\calendar\detail.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Detalhe da missa{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <div class="text-sm text-slate">{{ instance.starts_at|date:"d/m/Y H:i" }}</div>
    <h2 class="font-serif text-2xl">{{ instance.community.name }}</h2>
    <p class="text-slate">{{ instance.liturgy_label|default:"Missa" }}</p>
    <div class="mt-4 flex items-center gap-2">
      <span class="badge">{{ instance.status|mass_status_label }}</span>
      {% if instance.event_series %}
        <span class="badge">Evento</span>
      {% endif %}
    </div>
  </div>

  {% if can_manage_parish %}
    <div class="grid lg:grid-cols-3 gap-4">
      <div class="card">
        <h3 class="font-semibold mb-3">Editar informacoes</h3>
        <form method="post" action="{% url 'mass_update' instance.id %}" class="space-y-3">
          {% csrf_token %}
          <div>
            <label class="label">Rotulo</label>
            {{ update_form.liturgy_label }}
          </div>
           <div>
             <label class="label">Perfil de requisitos</label>
             <div class="custom-select">
               <input type="hidden" name="requirement_profile" value="{{ update_form.requirement_profile.value }}">
               <button type="button" class="custom-select-button">
                 <span class="selected-text">
                   {% if update_form.requirement_profile.value %}
                     {% for choice_value, choice_label in update_form.requirement_profile.field.choices %}
                       {% if update_form.requirement_profile.value == choice_value %}{{ choice_label }}{% endif %}
                     {% endfor %}
                   {% else %}
                     Selecionar...
                   {% endif %}
                 </span>
               </button>
               <div class="custom-select-options">
                 {% for choice_value, choice_label in update_form.requirement_profile.field.choices %}
                   <button type="button" class="custom-select-option {% if update_form.requirement_profile.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                 {% endfor %}
               </div>
             </div>
           </div>
          <button class="btn-secondary" type="submit">Salvar</button>
        </form>
      </div>
      <div class="card">
        <h3 class="font-semibold mb-3">Mover missa</h3>
        <form method="post" action="{% url 'mass_move' instance.id %}" class="space-y-3">
          {% csrf_token %}
          <div>
            <label class="label">Nova data/hora</label>
            {{ move_form.starts_at }}
          </div>
           <div>
             <label class="label">Nova comunidade</label>
             <div class="custom-select">
               <input type="hidden" name="community" value="{{ move_form.community.value }}">
               <button type="button" class="custom-select-button">
                  <span class="selected-text">
                    {% if move_form.community.value %}
                      {% for choice_value, choice_label in move_form.community.field.choices %}
                        {% if move_form.community.value == choice_value %}{{ choice_label|slice:":3" }}{% endif %}
                      {% endfor %}
                    {% else %}
                      Selecionar...
                    {% endif %}
                  </span>
               </button>
               <div class="custom-select-options">
                  {% for choice_value, choice_label in move_form.community.field.choices %}
                    <button type="button" class="custom-select-option {% if move_form.community.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label|slice:":3" }}</button>
                  {% endfor %}
               </div>
             </div>
           </div>
          <button class="btn-secondary" type="submit">Mover</button>
        </form>
      </div>
      <div class="card">
        <h3 class="font-semibold mb-3">Cancelar</h3>
        <form method="post" action="{% url 'mass_cancel' instance.id %}" class="space-y-3" onsubmit="return confirm('Tem certeza que deseja cancelar esta missa?');">
          {% csrf_token %}
          <div>
            <label class="label">Motivo (opcional)</label>
            {{ cancel_form.reason }}
          </div>
          <button class="btn-primary" type="submit">Cancelar missa</button>
        </form>
      </div>
    </div>
  {% endif %}

  {% include 'calendar/_slots_section.html' %}
</div>
{% if show_conflict_modal %}
  {% include 'modals/assignment_conflict.html' %}
{% endif %}
{% endblock %}
```

### templates\calendar\month.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Calendario{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
      <div>
        <h2 class="font-serif text-2xl text-moss">{{ month }}/{{ year }}</h2>
        <p class="text-sm text-slate">Visualização mensal do calendário litúrgico</p>
      </div>
      <div class="flex items-center gap-3">
        <a class="btn-secondary" href="?year={{ prev_month.year }}&month={{ prev_month.month }}">
          <span class="hidden sm:inline">Anterior</span>
          <span class="sm:hidden">←</span>
        </a>
        <div class="px-4 py-2 bg-sand/50 rounded-xl text-sm font-medium text-ink">
          {{ month }}/{{ year }}
        </div>
        <a class="btn-secondary" href="?year={{ next_month.year }}&month={{ next_month.month }}">
          <span class="hidden sm:inline">Próximo</span>
          <span class="sm:hidden">→</span>
        </a>
      </div>
    </div>
    <form method="get" class="grid sm:grid-cols-4 gap-4">
      <input type="hidden" name="year" value="{{ year }}" />
      <input type="hidden" name="month" value="{{ month }}" />
       <div>
         <label class="label">Comunidade</label>
         <div class="custom-select">
           <input type="hidden" name="community" value="{{ filters.community }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if filters.community %}
                 {% for community in communities %}
                   {% if filters.community == community.id|stringformat:"s" %}{{ community.code }}{% endif %}
                 {% endfor %}
               {% else %}
                 Todas
               {% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             <button type="button" class="custom-select-option {% if not filters.community %}selected{% endif %}" data-value="">Todas</button>
             {% for community in communities %}
               <button type="button" class="custom-select-option {% if filters.community == community.id|stringformat:"s" %}selected{% endif %}" data-value="{{ community.id }}">{{ community.code }}</button>
             {% endfor %}
           </div>
         </div>
       </div>
       <div>
         <label class="label">Status</label>
         <div class="custom-select">
           <input type="hidden" name="status" value="{{ filters.status }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if filters.status == "scheduled" %}Agendado{% elif filters.status == "canceled" %}Cancelado{% else %}Todos os status{% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             <button type="button" class="custom-select-option {% if not filters.status %}selected{% endif %}" data-value="">Todos os status</button>
             <button type="button" class="custom-select-option {% if filters.status == "scheduled" %}selected{% endif %}" data-value="scheduled">Agendado</button>
             <button type="button" class="custom-select-option {% if filters.status == "canceled" %}selected{% endif %}" data-value="canceled">Cancelado</button>
           </div>
         </div>
       </div>
       <div>
         <label class="label">Tipo</label>
         <div class="custom-select">
           <input type="hidden" name="kind" value="{{ filters.kind }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if filters.kind == "template" %}Recorrente{% elif filters.kind == "event" %}Evento único{% else %}Todos os tipos{% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             <button type="button" class="custom-select-option {% if not filters.kind %}selected{% endif %}" data-value="">Todos os tipos</button>
             <button type="button" class="custom-select-option {% if filters.kind == "template" %}selected{% endif %}" data-value="template">Recorrente</button>
             <button type="button" class="custom-select-option {% if filters.kind == "event" %}selected{% endif %}" data-value="event">Evento único</button>
           </div>
         </div>
       </div>
      <div class="flex items-end">
        <button class="btn-primary w-full">Aplicar filtros</button>
      </div>
    </form>
  </div>

  <div class="card lg:hidden">
    <div class="mb-6">
      <h3 class="font-semibold text-lg text-ink">Eventos do mês</h3>
      <p class="text-sm text-slate">Lista completa para dispositivos móveis</p>
    </div>
    <div class="space-y-4">
      {% for instance in instances %}
        <a class="block border border-black/8 rounded-xl p-4 hover:bg-sand/40 hover:border-moss/20 transition-all duration-200 hover:shadow-sm group {% if instance.id in my_confirmed_ids %}bg-moss-50/70 border-moss-200{% elif instance.id in my_pending_ids %}bg-sun-50/70 border-sun-200{% elif instance.id in pending_confirmation_ids %}bg-sun-50/30 border-sun-200{% endif %}" href="{% url 'mass_detail' instance.id %}">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-slate rounded-full flex items-center justify-center text-white font-serif text-sm font-bold">
                {{ instance.community.code|slice:":1" }}
              </div>
              <div>
                <div class="text-sm text-slate font-medium">{{ instance.starts_at|date:"D, d/m" }}</div>
                <div class="font-semibold text-ink group-hover:text-moss transition-colors">{{ instance.starts_at|date:"H:i" }} • {{ instance.community.code }}</div>
              </div>
            </div>
            <div class="text-right">
              <span class="badge">{{ instance.status|mass_status_label }}</span>
            </div>
          </div>
          <div class="text-sm text-slate ml-13">{{ instance.liturgy_label|default:"Missa" }}</div>
        </a>
      {% empty %}
        <div class="text-center py-8">
          <div class="w-16 h-16 bg-sand rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-slate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-5.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H3"></path>
            </svg>
          </div>
          <p class="text-slate font-medium">Nenhum evento encontrado</p>
          <p class="text-sm text-slate mt-1">Tente ajustar os filtros ou navegar para outro mês.</p>
        </div>
      {% endfor %}
    </div>
  </div>

  <div class="card hidden lg:block">
    <div class="grid grid-cols-7 text-xs uppercase tracking-widest text-slate font-medium mb-4">
      <div class="p-3 text-center">Dom</div>
      <div class="p-3 text-center">Seg</div>
      <div class="p-3 text-center">Ter</div>
      <div class="p-3 text-center">Qua</div>
      <div class="p-3 text-center">Qui</div>
      <div class="p-3 text-center">Sex</div>
      <div class="p-3 text-center">Sáb</div>
    </div>
    <div class="grid grid-cols-7 gap-1 bg-sand/30 rounded-xl p-1">
      {% for week in month_grid %}
        {% for day in week %}
          <div class="bg-white min-h-[140px] p-3 rounded-lg {% if day.month != month %}opacity-40{% endif %} hover:shadow-sm transition-all duration-200">
            <div class="text-sm font-medium text-ink mb-2">{{ day|date:"d" }}</div>
            <div class="space-y-2">
              {% for instance in instances_by_day|get_list_item:day %}
                <a class="block text-xs rounded-lg border border-black/8 px-3 py-2 hover:bg-moss/5 hover:border-moss/20 transition-all duration-200 group {% if instance.id in my_confirmed_ids %}bg-moss-50/70 border-moss-200{% elif instance.id in my_pending_ids %}bg-sun-50/70 border-sun-200{% elif instance.id in pending_confirmation_ids %}bg-sun-50/30 border-sun-200{% endif %}" href="{% url 'mass_detail' instance.id %}">
                  <div class="font-semibold text-ink group-hover:text-moss transition-colors">{{ instance.starts_at|date:"H:i" }}</div>
                  <div class="text-slate font-medium">{{ instance.community.code }}</div>
                  <div class="text-slate text-xs mt-0.5">{{ instance.liturgy_label|default:"Missa" }}</div>
                </a>
              {% endfor %}
            </div>
          </div>
        {% endfor %}
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
```

### templates\events\basics.html
```html
{% extends 'base.html' %}
{% block title %}{{ page_title|default:"Nova celebracao" }}{% endblock %}
{% block content %}
<div class="card max-w-3xl">
  <h2 class="font-serif text-xl mb-2">{{ heading|default:"Agendar celebracao" }}</h2>
  <p class="text-sm text-slate mb-6">Defina o tipo liturgico e o periodo. Voce ajusta cada dia na etapa seguinte.</p>
  <form method="post" class="space-y-5">
    {% csrf_token %}
    {% if form.non_field_errors %}
      <div class="rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">
        {{ form.non_field_errors }}
      </div>
    {% endif %}
    <div class="grid sm:grid-cols-2 gap-5">
       <div>
         <label class="label" for="id_series_type">Tipo litúrgico</label>
         <div class="custom-select">
           <input type="hidden" name="series_type" value="{{ form.series_type.value }}" id="id_series_type">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if form.series_type.value %}
                 {% for choice_value, choice_label in form.series_type.field.choices %}
                   {% if form.series_type.value == choice_value %}{{ choice_label }}{% endif %}
                 {% endfor %}
               {% else %}
                 Selecionar...
               {% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             {% for choice_value, choice_label in form.series_type.field.choices %}
               <button type="button" class="custom-select-option {% if form.series_type.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
             {% endfor %}
           </div>
         </div>
         {% if form.series_type.errors %}
           <div class="form-error">{{ form.series_type.errors.0 }}</div>
         {% endif %}
        <div id="series_type_other_field" class="mt-3 {% if form.series_type.value != 'Outro' %}hidden{% endif %}">
          <label class="label" for="id_series_type_other">Outro tipo</label>
          {{ form.series_type_other }}
          {% if form.series_type_other.errors %}
            <p class="mt-1 text-xs text-red-600">{{ form.series_type_other.errors.0 }}</p>
          {% endif %}
        </div>
      </div>
      <div>
        <label class="label" for="id_title">Titulo da celebracao</label>
        {{ form.title }}
        {% if form.title.errors %}
          <p class="mt-1 text-xs text-red-600">{{ form.title.errors.0 }}</p>
        {% endif %}
      </div>
      <div>
        <label class="label" for="id_start_date">Inicio</label>
        {{ form.start_date }}
        {% if form.start_date.errors %}
          <p class="mt-1 text-xs text-red-600">{{ form.start_date.errors.0 }}</p>
        {% endif %}
      </div>
      <div>
        <label class="label" for="id_end_date">Fim</label>
        {{ form.end_date }}
        {% if form.end_date.errors %}
          <p class="mt-1 text-xs text-red-600">{{ form.end_date.errors.0 }}</p>
        {% endif %}
      </div>
      <div>
        <label class="label" for="id_default_time">Horario padrao</label>
        {{ form.default_time }}
        {% if form.default_time.errors %}
          <p class="mt-1 text-xs text-red-600">{{ form.default_time.errors.0 }}</p>
        {% endif %}
      </div>
       <div>
         <label class="label" for="id_default_community">Comunidade padrão</label>
         <div class="custom-select">
           <input type="hidden" name="default_community" value="{{ form.default_community.value }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if form.default_community.value %}
                 {% for choice_value, choice_label in form.default_community.field.choices %}
                   {% if form.default_community.value == choice_value %}{{ choice_label|slice:":3" }}{% endif %}
                 {% endfor %}
               {% else %}
                 Selecionar...
               {% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             {% for choice_value, choice_label in form.default_community.field.choices %}
               <button type="button" class="custom-select-option {% if form.default_community.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label|slice:":3" }}</button>
             {% endfor %}
           </div>
         </div>
         {% if form.default_community.errors %}
           <div class="form-error">{{ form.default_community.errors.0 }}</div>
         {% endif %}
       </div>
      <div class="sm:col-span-2">
        <div class="flex items-center justify-between mb-1">
          <label class="label mb-0" for="id_default_requirement_profile">Perfil de requisitos padrao</label>
          {% if profile_create_url %}
            <a class="text-xs text-moss hover:text-ink font-medium transition-colors" href="{{ profile_create_url }}">+ Criar perfil</a>
          {% endif %}
        </div>
        <div class="custom-select">
          <input type="hidden" name="default_requirement_profile" value="{{ form.default_requirement_profile.value }}">
          <button type="button" class="custom-select-button">
            <span class="selected-text">
              {% if form.default_requirement_profile.value %}
                {% for choice_value, choice_label in form.default_requirement_profile.field.choices %}
                  {% if form.default_requirement_profile.value == choice_value %}{{ choice_label }}{% endif %}
                {% endfor %}
              {% else %}
                Selecionar...
              {% endif %}
            </span>
          </button>
          <div class="custom-select-options">
            {% for choice_value, choice_label in form.default_requirement_profile.field.choices %}
              <button type="button" class="custom-select-option {% if form.default_requirement_profile.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
            {% endfor %}
          </div>
        </div>
        {% if form.default_requirement_profile.errors %}
          <div class="form-error">{{ form.default_requirement_profile.errors.0 }}</div>
        {% endif %}
        {% if not profiles_exist %}
          <div class="mt-3 rounded-xl border border-sun/30 bg-sun/5 px-4 py-3 text-xs text-slate">
            <span class="font-medium text-ink">Nenhum perfil cadastrado.</span> Crie um perfil para definir quantas funcoes cada celebracao exige.
          </div>
        {% endif %}
      </div>
       <div class="sm:col-span-2">
         <label class="label" for="id_candidate_pool">Pool de candidatos</label>
          <div class="custom-select">
            <input type="hidden" name="candidate_pool" value="{{ form.candidate_pool.value }}" id="id_candidate_pool">
            <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if form.candidate_pool.value %}
                 {% for choice_value, choice_label in form.candidate_pool.field.choices %}
                   {% if form.candidate_pool.value == choice_value %}{{ choice_label }}{% endif %}
                 {% endfor %}
               {% else %}
                 Selecionar...
               {% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             {% for choice_value, choice_label in form.candidate_pool.field.choices %}
               <button type="button" class="custom-select-option {% if form.candidate_pool.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
             {% endfor %}
           </div>
         </div>
          {% if form.candidate_pool.errors %}
            <div class="form-error">{{ form.candidate_pool.errors.0 }}</div>
          {% endif %}
        </div>
        <div id="interest_deadline_field" class="sm:col-span-2 {% if form.candidate_pool.value != 'interested_only' %}hidden{% endif %}">
          <label class="label" for="id_interest_deadline_at">Prazo de interesse</label>
          {{ form.interest_deadline_at }}
          {% if form.interest_deadline_at.errors %}
            <p class="mt-1 text-xs text-red-600">{{ form.interest_deadline_at.errors.0 }}</p>
          {% endif %}
          <p class="text-xs text-slate mt-1">Opcional. Se vazio, usa o prazo padrao da paroquia.</p>
        </div>
    </div>
    <div class="flex items-center gap-3 pt-2">
      <button type="submit" class="btn-primary">{{ submit_label|default:"Avancar" }}</button>
      <a class="btn-secondary" href="{{ cancel_url|default:default_cancel_url }}">Cancelar</a>
    </div>
  </form>
</div>
<script>
  (function () {
    const typeField = document.getElementById("id_series_type");
    const otherWrap = document.getElementById("series_type_other_field");
    const otherInput = document.getElementById("id_series_type_other");
    if (!typeField || !otherWrap || !otherInput) return;
    
    let isInitialLoad = true;
    
    const toggleOther = () => {
      const show = typeField.value === "Outro";
      otherWrap.classList.toggle("hidden", !show);
      otherInput.disabled = !show;
      // Somente limpa o valor se o usuario mudou o select (nao na carga inicial)
      if (!show && !isInitialLoad) {
        otherInput.value = "";
      }
      isInitialLoad = false;
    };
    
    typeField.addEventListener("change", toggleOther);
    toggleOther();
  })();
  (function () {
    const poolField = document.getElementById("id_candidate_pool");
    const deadlineWrap = document.getElementById("interest_deadline_field");
    const deadlineInput = document.getElementById("id_interest_deadline_at");
    if (!poolField || !deadlineWrap || !deadlineInput) return;

    let isInitialLoad = true;

    const toggleDeadline = () => {
      const show = poolField.value === "interested_only";
      deadlineWrap.classList.toggle("hidden", !show);
      deadlineInput.disabled = !show;
      if (!show && !isInitialLoad) {
        deadlineInput.value = "";
      }
      isInitialLoad = false;
    };

    poolField.addEventListener("change", toggleDeadline);
    toggleDeadline();
  })();
</script>
{% endblock %}
```

### templates\events\days.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Dias da celebracao{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <h2 class="font-serif text-xl mb-2">Dias da celebracao</h2>
    {% if series %}
      <div class="text-sm text-slate">{{ series.title }} · {{ series.series_type }}</div>
    {% endif %}
    <p class="text-sm text-slate mt-2">Revise cada dia e resolva conflitos antes de gerar.</p>
  </div>
  <details class="card">
    <summary class="cursor-pointer font-medium">Acoes em lote</summary>
    <div class="mt-3 space-y-3 text-sm text-slate">
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-3">
        <div>
          <label class="label">Horario padrao</label>
          <input id="bulk_time" type="time" class="input" value="{{ draft.default_time|default:default_time|default:'' }}">
        </div>
        <div>
          <label class="label">Comunidade padrão</label>
          <div class="custom-select">
            <select id="bulk_community" class="hidden">
              <option value="">--</option>
              {% for option in formset.0.community %}
                {{ option }}
              {% endfor %}
            </select>
            <button type="button" class="custom-select-button">
              <span class="selected-text">{{ formset.0.community.field.choices|choice_label:formset.0.community.value|slice:":3"|default:"--" }}</span>
            </button>
            <div class="custom-select-options">
              <button type="button" class="custom-select-option{% if not formset.0.community.value %} selected{% endif %}" data-value="">--</button>
              {% for option in formset.0.community %}
                <button type="button" class="custom-select-option{% if formset.0.community.value|stringformat:"s" == option.data.value|stringformat:"s" %} selected{% endif %}" data-value="{{ option.data.value }}">{{ option.data.label|slice:":3" }}</button>
              {% endfor %}
            </div>
          </div>
        </div>
        <div>
          <label class="label">Perfil padrão</label>
          <div class="custom-select">
            <select id="bulk_profile" class="hidden">
              <option value="">--</option>
              {% for option in formset.0.requirement_profile %}
                {{ option }}
              {% endfor %}
            </select>
            <button type="button" class="custom-select-button">
              <span class="selected-text">{{ formset.0.requirement_profile.field.choices|choice_label:formset.0.requirement_profile.value|default:"--" }}</span>
            </button>
            <div class="custom-select-options">
              <button type="button" class="custom-select-option{% if not formset.0.requirement_profile.value %} selected{% endif %}" data-value="">--</button>
              {% for option in formset.0.requirement_profile %}
                <button type="button" class="custom-select-option{% if formset.0.requirement_profile.value|stringformat:"s" == option.data.value|stringformat:"s" %} selected{% endif %}" data-value="{{ option.data.value }}">{{ option.data.label }}</button>
              {% endfor %}
            </div>
          </div>
        </div>
        <div>
          <label class="label">Rotulo padrao</label>
          <input id="bulk_label" type="text" class="input" value="{{ default_label|default:'' }}">
        </div>
      </div>
      <button type="button" class="btn-secondary" id="apply_defaults">Aplicar padroes a todos os dias</button>
    </div>
  </details>
  <form method="post" class="card space-y-4">
    {% csrf_token %}
    {{ formset.management_form }}
    <div class="space-y-4">
      {% for form in formset %}
        <div class="border border-black/5 rounded-xl p-4">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div class="text-sm text-slate">{{ form.date.value }}</div>
            {% if conflicts|index:forloop.counter0 %}
              <span class="badge">Conflito</span>
            {% endif %}
          </div>
          {% if conflicts|index:forloop.counter0 %}
            {% with conflict=conflicts|index:forloop.counter0 %}
              <div class="text-xs text-slate mt-1">
                Ja existe: {{ conflict.starts_at|date:"H:i" }} · {{ conflict.community.code }} · {{ conflict.liturgy_label|default:"-" }}{% if conflict.status == "canceled" %} (Cancelada){% endif %}
              </div>
            {% endwith %}
          {% endif %}
           <div class="time-slots" data-day-index="{{ forloop.counter0 }}">
             <div class="slot" data-slot-index="0">
               <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 mt-3">
                 {{ form.date }}
                 {% with base_occurrence_id=base_occurrence_ids|index:forloop.counter0 %}
                   <input type="hidden" name="form-{{ forloop.counter0 }}-occurrence_id" value="{{ base_occurrence_id|default:'' }}">
                 {% endwith %}
                 <div>
                   <label class="label">Horario</label>
                   {{ form.time }}
                 </div>
                  <div>
                    <label class="label">Comunidade</label>
                    <div class="custom-select">
                      <select class="hidden" name="{{ form.community.html_name }}">
                        {% for option in form.community %}
                          {{ option }}
                        {% endfor %}
                      </select>
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">{{ form.community.field.choices|choice_label:form.community.value|slice:":3"|default:"--" }}</span>
                      </button>
                      <div class="custom-select-options">
                        {% for option in form.community %}
                          <button type="button" class="custom-select-option{% if form.community.value|stringformat:"s" == option.data.value|stringformat:"s" %} selected{% endif %}" data-value="{{ option.data.value }}">{{ option.data.label|slice:":3" }}</button>
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                  <div>
                    <label class="label">Perfil</label>
                    <div class="custom-select">
                      <select class="hidden" name="{{ form.requirement_profile.html_name }}">
                        {% for option in form.requirement_profile %}
                          {{ option }}
                        {% endfor %}
                      </select>
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">{{ form.requirement_profile.field.choices|choice_label:form.requirement_profile.value|default:"--" }}</span>
                      </button>
                      <div class="custom-select-options">
                        {% for option in form.requirement_profile %}
                          <button type="button" class="custom-select-option{% if form.requirement_profile.value|stringformat:"s" == option.data.value|stringformat:"s" %} selected{% endif %}" data-value="{{ option.data.value }}">{{ option.data.label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                  <div>
                    <label class="label">Conflito</label>
                    <div class="custom-select">
                      <select class="hidden" name="{{ form.conflict_action.html_name }}">
                        {% for option in form.conflict_action %}
                          {{ option }}
                        {% endfor %}
                      </select>
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">{{ form.conflict_action.field.choices|choice_label:form.conflict_action.value|default:"--" }}</span>
                      </button>
                      <div class="custom-select-options">
                        {% for option in form.conflict_action %}
                          <button type="button" class="custom-select-option{% if form.conflict_action.value|stringformat:"s" == option.data.value|stringformat:"s" %} selected{% endif %}" data-value="{{ option.data.value }}">{{ option.data.label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                   <p class="text-xs text-slate mt-1">
                     Manter: usa a missa existente · Cancelar: remove a missa existente · Mover: transfere a missa existente · Pular: ignora este dia
                   </p>
                 </div>
                 <div class="sm:col-span-2">
                   <label class="label">Rotulo</label>
                   {{ form.label }}
                   <p class="text-xs text-slate mt-1">Se vazio, usamos o titulo da celebracao.</p>
                 </div>
               </div>
                <div class="grid sm:grid-cols-3 gap-3 mt-3 hidden" data-move-fields="">
                  <div>
                    <label class="label">Mover para (data)</label>
                    {{ form.move_to_date }}
                  </div>
                  <div>
                    <label class="label">Mover para (hora)</label>
                    {{ form.move_to_time }}
                  </div>
                  <div>
                    <label class="label">Mover para (comunidade)</label>
                    {{ form.move_to_community }}
                  </div>
                </div>
              </div>
              {% with extras=extra_occurrences_by_index|index:forloop.counter0 %}
                {% if extras %}
                  {% for extra in extras %}
                    <div class="slot" data-slot-index="{{ forloop.counter }}">
                      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 mt-3">
                        <input type="hidden" name="form-{{ forloop.parentloop.counter0 }}-occurrence_id-{{ forloop.counter }}" value="{{ extra.id }}">
                        <div>
                          <label class="label">Horario</label>
                          <input type="time" name="form-{{ forloop.parentloop.counter0 }}-time-{{ forloop.counter }}" value="{{ extra.time|time:'H:i' }}" id="id_form-{{ forloop.parentloop.counter0 }}-time-{{ forloop.counter }}">
                        </div>
                        <div>
                          <label class="label">Comunidade</label>
                          <div class="custom-select">
                            <select class="hidden" name="form-{{ forloop.parentloop.counter0 }}-community-{{ forloop.counter }}">
                              {% for value, label in form.community.field.choices %}
                                <option value="{{ value }}"{% if value|stringformat:"s" == extra.community_id|stringformat:"s" %} selected{% endif %}>{{ label }}</option>
                              {% endfor %}
                            </select>
                            <button type="button" class="custom-select-button">
                              <span class="selected-text">{{ form.community.field.choices|choice_label:extra.community_id|slice:":3"|default:"--" }}</span>
                            </button>
                            <div class="custom-select-options">
                              {% for value, label in form.community.field.choices %}
                                <button type="button" class="custom-select-option{% if value|stringformat:"s" == extra.community_id|stringformat:"s" %} selected{% endif %}" data-value="{{ value }}">{{ label|slice:":3" }}</button>
                              {% endfor %}
                            </div>
                          </div>
                        </div>
                        <div>
                          <label class="label">Perfil</label>
                          <div class="custom-select">
                            <select class="hidden" name="form-{{ forloop.parentloop.counter0 }}-requirement_profile-{{ forloop.counter }}">
                              {% for value, label in form.requirement_profile.field.choices %}
                                <option value="{{ value }}"{% if value|stringformat:"s" == extra.requirement_profile_id|stringformat:"s" %} selected{% endif %}>{{ label }}</option>
                              {% endfor %}
                            </select>
                            <button type="button" class="custom-select-button">
                              <span class="selected-text">{{ form.requirement_profile.field.choices|choice_label:extra.requirement_profile_id|default:"--" }}</span>
                            </button>
                            <div class="custom-select-options">
                              {% for value, label in form.requirement_profile.field.choices %}
                                <button type="button" class="custom-select-option{% if value|stringformat:"s" == extra.requirement_profile_id|stringformat:"s" %} selected{% endif %}" data-value="{{ value }}">{{ label }}</button>
                              {% endfor %}
                            </div>
                          </div>
                        </div>
                        <div>
                          <label class="label">Conflito</label>
                          <div class="custom-select">
                            <select class="hidden" name="form-{{ forloop.parentloop.counter0 }}-conflict_action-{{ forloop.counter }}">
                              {% for value, label in form.conflict_action.field.choices %}
                                <option value="{{ value }}"{% if value|stringformat:"s" == extra.conflict_action|stringformat:"s" %} selected{% endif %}>{{ label }}</option>
                              {% endfor %}
                            </select>
                            <button type="button" class="custom-select-button">
                              <span class="selected-text">{{ form.conflict_action.field.choices|choice_label:extra.conflict_action|default:"--" }}</span>
                            </button>
                            <div class="custom-select-options">
                              {% for value, label in form.conflict_action.field.choices %}
                                <button type="button" class="custom-select-option{% if value|stringformat:"s" == extra.conflict_action|stringformat:"s" %} selected{% endif %}" data-value="{{ value }}">{{ label }}</button>
                              {% endfor %}
                            </div>
                          </div>
                          <p class="text-xs text-slate mt-1">
                            Manter: usa a missa existente · Cancelar: remove a missa existente · Mover: transfere a missa existente · Pular: ignora este dia
                          </p>
                        </div>
                        <div class="sm:col-span-2">
                          <label class="label">Rotulo</label>
                          <input type="text" name="form-{{ forloop.parentloop.counter0 }}-label-{{ forloop.counter }}" value="{{ extra.label }}" maxlength="200" id="id_form-{{ forloop.parentloop.counter0 }}-label-{{ forloop.counter }}">
                          <p class="text-xs text-slate mt-1">Se vazio, usamos o titulo da celebracao.</p>
                        </div>
                      </div>
                      <div class="grid sm:grid-cols-3 gap-3 mt-3 hidden" data-move-fields="">
                        <div>
                          <label class="label">Mover para (data)</label>
                          <input type="date" name="form-{{ forloop.parentloop.counter0 }}-move_to_date-{{ forloop.counter }}" value="{{ extra.move_to_date|date:'Y-m-d' }}" id="id_form-{{ forloop.parentloop.counter0 }}-move_to_date-{{ forloop.counter }}">
                        </div>
                        <div>
                          <label class="label">Mover para (hora)</label>
                          <input type="time" name="form-{{ forloop.parentloop.counter0 }}-move_to_time-{{ forloop.counter }}" value="{{ extra.move_to_time|time:'H:i' }}" id="id_form-{{ forloop.parentloop.counter0 }}-move_to_time-{{ forloop.counter }}">
                        </div>
                        <div>
                          <label class="label">Mover para (comunidade)</label>
                          <select name="form-{{ forloop.parentloop.counter0 }}-move_to_community-{{ forloop.counter }}" id="id_form-{{ forloop.parentloop.counter0 }}-move_to_community-{{ forloop.counter }}">
                            {% for value, label in form.move_to_community.field.choices %}
                              <option value="{{ value }}"{% if value|stringformat:"s" == extra.move_to_community_id|stringformat:"s" %} selected{% endif %}>{{ label }}</option>
                            {% endfor %}
                          </select>
                        </div>
                      </div>
                      <button type="button" class="remove-slot-btn btn-secondary mt-3">Remover missa</button>
                    </div>
                  {% endfor %}
                {% endif %}
              {% endwith %}
              <button type="button" class="add-slot-btn btn-secondary mt-3">Adicionar missa</button>
            </div>
           {{ form.non_field_errors }}
        </div>
     </div>
     {% endfor %}
    {% if series %}
      {% url 'event_series_detail' series.id as fallback_url %}
    {% else %}
      {% url 'event_series_create' as fallback_url %}
    {% endif %}
    <div class="flex items-center gap-3">
      <button class="btn-primary">{% if series %}Salvar ocorrencias{% else %}Gerar celebracoes{% endif %}</button>
      <a class="btn-secondary" href="{{ back_url|default:fallback_url }}">Voltar</a>
    </div>
  </form>
</div>
<script>
  (function () {
    const applyDefaults = document.getElementById("apply_defaults");
    if (applyDefaults) {
      applyDefaults.addEventListener("click", () => {
        const defaultTime = document.getElementById("bulk_time")?.value || "";
        const defaultCommunity = document.getElementById("bulk_community")?.value || "";
        const defaultProfile = document.getElementById("bulk_profile")?.value || "";
        const defaultLabel = document.getElementById("bulk_label")?.value || "";
        document.querySelectorAll("input[name$='-time']").forEach((input) => {
          if (defaultTime) input.value = defaultTime;
        });
        document.querySelectorAll("select[name$='-community']").forEach((select) => {
          if (defaultCommunity) select.value = defaultCommunity;
        });
        document.querySelectorAll("select[name$='-requirement_profile']").forEach((select) => {
          if (defaultProfile || defaultProfile === "") select.value = defaultProfile;
        });
        document.querySelectorAll("input[name$='-label']").forEach((input) => {
          if (defaultLabel) input.value = defaultLabel;
        });
      });
    }

    // Function to clone a slot and update names
    function cloneSlot(slot, dayIndex, newSlotIndex) {
      const cloned = slot.cloneNode(true);
      cloned.setAttribute('data-slot-index', newSlotIndex);
      
      // Copy values from the original slot and update names/IDs
      cloned.querySelectorAll('input, select').forEach(el => {
        const name = el.name;
        if (!name) return;
        const suffixes = [
          '-move_to_date',
          '-move_to_time',
          '-move_to_community',
          '-requirement_profile',
          '-conflict_action',
          '-community',
          '-time',
          '-label',
          '-occurrence_id'
        ];
        let newName = name;
        for (const suffix of suffixes) {
          const regex = new RegExp(`${suffix}(?:-\\d+)?$`);
          if (regex.test(name)) {
            newName = name.replace(regex, `${suffix}-${newSlotIndex}`);
            break;
          }
        }
        el.name = newName;
        if (newName.includes('-occurrence_id')) {
          el.value = '';
        }
        if (el.id) el.id = el.id.replace(/\d+$/, newSlotIndex);
      });

      cloned.querySelectorAll('input[name$="-date"]').forEach(el => {
        if (!el.name.includes('move_to_date')) {
          el.remove();
        }
      });
      
      // Reinitialize custom selects with correct display
      cloned.querySelectorAll('.custom-select').forEach(customSelect => {
        const select = customSelect.querySelector('select');
        const button = customSelect.querySelector('.custom-select-button');
        const selectedText = button ? button.querySelector('.selected-text') : null;
        const options = customSelect.querySelector('.custom-select-options');

        customSelect.classList.remove('open');
        customSelect.removeAttribute('data-custom-select-init');

        const selectedValue = select ? select.value : "";
        let displayText = '--';

        if (options) {
          let selectedOptionButton = null;
          options.querySelectorAll('.custom-select-option').forEach(opt => {
            const isSelected = opt.getAttribute('data-value') === selectedValue;
            opt.classList.toggle('selected', isSelected);
            if (isSelected) selectedOptionButton = opt;
          });
          if (selectedOptionButton) {
            displayText = selectedOptionButton.textContent.trim();
          }
        } else if (select) {
          const selectedOption = select.selectedOptions ? select.selectedOptions[0] : null;
          if (selectedOption) {
            displayText = selectedOption.textContent.trim();
          }
        }

        if (selectedText) {
          selectedText.textContent = displayText || '--';
        }
      });

      cloned.querySelectorAll('.remove-slot-btn').forEach(btn => btn.remove());
      cloned.querySelectorAll('.add-slot-btn').forEach(btn => btn.remove());
      
      // Add remove button for cloned slots
      const removeBtn = document.createElement('button');
      removeBtn.type = 'button';
      removeBtn.className = 'remove-slot-btn btn-secondary mt-3';
      removeBtn.textContent = 'Remover missa';
      cloned.appendChild(removeBtn);
      
      return cloned;
    }

    // Add event listeners for add-slot-btn
    document.addEventListener('click', (e) => {
      const addButton = e.target.closest('.add-slot-btn');
      if (!addButton) return;
      const timeSlots = addButton.closest('.time-slots');
      const dayIndex = timeSlots.getAttribute('data-day-index');
      const slots = timeSlots.querySelectorAll('.slot');
      const newSlotIndex = slots.length;

      if (newSlotIndex >= 5) return; // Limit to 5 slots

      const lastSlot = slots[slots.length - 1];
      const clonedSlot = cloneSlot(lastSlot, dayIndex, newSlotIndex);

      timeSlots.insertBefore(clonedSlot, addButton);

      if (window.initCustomSelects) {
        window.initCustomSelects(clonedSlot);
      }

      clonedSlot.querySelectorAll("select[name$='-conflict_action']").forEach(bindConflictSelect);
    });

    // Add event listeners for remove-slot-btn
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('remove-slot-btn')) {
        const slot = e.target.closest('.slot');
        const timeSlots = e.target.closest('.time-slots');
        const slots = timeSlots.querySelectorAll('.slot');
        if (slots.length > 1) {
          slot.remove();
        }
      }
    });

    function bindConflictSelect(select) {
      const container = select.closest(".slot");
      if (!container) return;
      const moveFields = container.querySelector("[data-move-fields]");
      const update = () => {
        const show = select.value === "move_existing";
        if (moveFields) {
          moveFields.classList.toggle("hidden", !show);
          moveFields.querySelectorAll("input, select").forEach((input) => {
            input.disabled = !show;
            if (!show) input.value = "";
          });
        }
      };
      select.addEventListener("change", update);
      update();
    }

    document.querySelectorAll("select[name$='-conflict_action']").forEach(bindConflictSelect);
  })();
</script>
{% endblock %}
```

### templates\events\detail.html
```html
{% extends 'base.html' %}
{% block title %}Celebracao{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card">
    <div class="flex flex-wrap items-start justify-between gap-4">
      <div>
        <h2 class="font-serif text-xl">{{ series.title }}</h2>
        <div class="text-sm text-slate">
          {{ series.series_type }} · {{ series.start_date }} a {{ series.end_date }}
        </div>
        <div class="mt-2 flex items-center gap-2">
          <span class="badge">{% if series.is_active %}Ativa{% else %}Arquivada{% endif %}</span>
          {% if series.candidate_pool == "interested_only" %}
            <span class="badge">Somente interessados</span>
          {% endif %}
        </div>
        <div class="text-xs text-slate mt-2 space-y-1">
          <div>Pool: {% if series.candidate_pool == "interested_only" %}Somente interessados{% else %}Todos os acolitos{% endif %}</div>
          <div>Comunidade padrao: {{ series.default_community|default:"-" }}</div>
          <div>Horario padrao: {{ default_time|default:"-" }}</div>
          <div>Perfil padrao: {{ default_profile|default:"-" }}</div>
          {% if series.candidate_pool == "interested_only" %}
            <div>Prazo de interesse: {% if series.interest_deadline_at %}{{ series.interest_deadline_at|date:"d/m/Y H:i" }}{% else %}ate {{ interest_deadline_hours }}h antes de cada missa{% endif %}</div>
          {% endif %}
        </div>
      </div>
      <div class="flex items-center gap-2">
        <a class="btn-secondary" href="{% url 'event_series_edit' series.id %}">Editar serie</a>
        <a class="btn-secondary" href="{% url 'event_series_occurrences' series.id %}">Editar dias</a>
        {% if series.is_active %}
          <form method="post" action="{% url 'event_series_archive' series.id %}" onsubmit="return confirm('Arquivar esta serie? As missas geradas permanecem no historico.');">
            {% csrf_token %}
            <button class="btn-secondary" type="submit">Arquivar</button>
          </form>
        {% else %}
          <form method="post" action="{% url 'event_series_unarchive' series.id %}">
            {% csrf_token %}
            <button class="btn-secondary" type="submit">Reativar</button>
          </form>
          <form method="post" action="{% url 'event_series_delete' series.id %}" onsubmit="return confirm('Excluir esta serie e todas as missas geradas? Esta acao e irreversivel.');">
            {% csrf_token %}
            <button class="btn-secondary" type="submit">Excluir</button>
          </form>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="card">
    <h3 class="font-serif text-lg mb-3">Ocorrencias</h3>
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm">
        <thead>
          <tr class="text-left text-slate">
            <th class="py-2 pr-4">Data</th>
            <th class="py-2 pr-4">Horario</th>
            <th class="py-2 pr-4">Comunidade</th>
            <th class="py-2 pr-4">Perfil</th>
            <th class="py-2 pr-4">Rotulo</th>
            <th class="py-2">Conflito</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-black/5">
          {% for occ in occurrences %}
            <tr>
              <td class="py-2 pr-4">{{ occ.date }}</td>
              <td class="py-2 pr-4">{{ occ.time }}</td>
              <td class="py-2 pr-4">{{ occ.community.code }}</td>
              <td class="py-2 pr-4">{{ occ.requirement_profile|default:"-" }}</td>
              <td class="py-2 pr-4">{{ occ.label|default:"-" }}</td>
              <td class="py-2">{{ occ.get_conflict_action_display }}</td>
            </tr>
          {% empty %}
            <tr><td class="py-2 text-slate" colspan="6">Nenhuma ocorrencia registrada.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="card">
    <h3 class="font-serif text-lg mb-3">Missas geradas</h3>
    <div class="space-y-2">
      {% for mass in masses %}
        <a class="block border border-black/5 rounded-lg p-3 hover:border-black/10" href="{% url 'mass_detail' mass.id %}">
          <div class="font-medium">{{ mass.starts_at|date:"d/m/Y H:i" }} · {{ mass.community.code }}</div>
          <div class="text-xs text-slate">{{ mass.liturgy_label|default:"-" }}{% if mass.status == "canceled" %} · Cancelada{% endif %}</div>
        </a>
      {% empty %}
        <p class="text-sm text-slate">Nenhuma missa gerada.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
```

### templates\events\form.html
```html
{% extends 'base.html' %}
{% block title %}Novo evento{% endblock %}
{% block content %}
<div class="card max-w-3xl">
  <div class="mb-8">
    <h2 class="font-serif text-2xl text-moss">Criar série de eventos</h2>
    <p class="text-sm text-slate">Configure uma nova programação litúrgica recorrente</p>
  </div>
      <div>
        <label class="label">Tipo de série</label>
        {{ form.series_type }}
        {% if form.series_type.errors %}
      <div class="form-error">
        <span class="font-medium">Erros no formulário</span>
        <ul class="mt-1 space-y-1">
          {% for error in form.non_field_errors %}
            <li>{{ error }}</li>
          {% endfor %}
        </ul>
      </div>
        {% endif %}
      </div>
  </div>
  <form method="post" class="space-y-6">
    {% csrf_token %}
    {% if form.non_field_errors %}
      <div class="bg-red-50 border border-red-200 rounded-xl p-4">
        <div class="flex items-center gap-2 mb-2">
          <span class="text-red-600 font-medium">⚠️ Erros no formulário</span>
        </div>
        <ul class="text-sm text-red-700 space-y-1">
          {% for error in form.non_field_errors %}
            <li>{{ error }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
    <div class="grid sm:grid-cols-2 gap-6">
      <div class="space-y-2">
        <label class="label">Tipo de série</label>
        {{ form.series_type }}
        {% if form.series_type.errors %}
          <p class="text-sm text-red-600">{{ form.series_type.errors.0 }}</p>
        {% endif %}
      </div>
      <div class="space-y-2">
        <label class="label">Título da série</label>
        {{ form.title }}
        {% if form.title.errors %}
          <p class="text-sm text-red-600">{{ form.title.errors.0 }}</p>
        {% endif %}
      </div>
      <div class="space-y-2">
        <label class="label">Data de início</label>
        {{ form.start_date }}
        {% if form.start_date.errors %}
          <p class="text-sm text-red-600">{{ form.start_date.errors.0 }}</p>
        {% endif %}
      </div>
      <div class="space-y-2">
        <label class="label">Data de fim</label>
        {{ form.end_date }}
        {% if form.end_date.errors %}
          <p class="text-sm text-red-600">{{ form.end_date.errors.0 }}</p>
        {% endif %}
      </div>
      <div class="sm:col-span-2 space-y-2">
        <label class="label">Comunidade padrão</label>
        {{ form.default_community }}
        {% if form.default_community.errors %}
          <p class="text-sm text-red-600">{{ form.default_community.errors.0 }}</p>
        {% endif %}
      </div>
      <div class="sm:col-span-2 space-y-2">
        <label class="label">Regras de recorrência (JSON)</label>
        {{ form.ruleset_json }}
        {% if form.ruleset_json.errors %}
          <p class="text-sm text-red-600">{{ form.ruleset_json.errors.0 }}</p>
        {% endif %}
        <p class="text-xs text-slate mt-1">Configure as regras de recorrência em formato JSON. Exemplo: {"freq": "weekly", "byweekday": ["SU"]}</p>
      </div>
    </div>
    <div class="flex gap-4 pt-6 border-t border-black/5">
      <button class="btn-primary flex-1 justify-center">Salvar e gerar série</button>
      <a href="{% url 'event_series_list' %}" class="btn-secondary">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
```

### templates\events\interest.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Eventos{% endblock %}
{% block content %}
<div class="card">
  <h2 class="font-serif text-xl mb-2">Interesse em eventos</h2>
  {% if not acolyte %}
    <p class="text-sm text-slate">Seu usuario nao esta vinculado a um perfil de acolito.</p>
  {% else %}
    <form method="post" class="space-y-3">
      {% csrf_token %}
      <div class="space-y-4">
        {% for item in series %}
          <div class="border border-black/5 rounded-lg p-3 space-y-2">
            <div>
              <div class="font-medium">{{ item.title }}</div>
              <div class="text-sm text-slate">{{ item.start_date }} a {{ item.end_date }}</div>
              {% if item.candidate_pool == "interested_only" and item.interest_deadline_at %}
                <div class="text-xs text-slate">Prazo de interesse: {{ item.interest_deadline_at|date:"d/m/Y H:i" }}</div>
              {% endif %}
            </div>
            <div class="space-y-2">
              {% for mass in item.upcoming_masses %}
                <label class="check-row">
                  <div>
                    <div class="font-medium">{{ mass.starts_at|date:"d/m/Y" }} as {{ mass.starts_at|date:"H:i" }}</div>
                    <div class="text-sm text-slate">{{ mass.community.code }} · {{ mass.liturgy_label|default:item.title }}</div>
                    {% if item.candidate_pool == "interested_only" and not item.interest_deadline_at %}
                      {% with deadline=deadline_by_mass|get_item:mass.id %}
                        {% if deadline %}
                          <div class="text-xs text-slate">Prazo de interesse: {{ deadline|date:"d/m/Y H:i" }}</div>
                        {% endif %}
                      {% endwith %}
                    {% endif %}
                    {% if mass.id in closed_ids %}
                      <div class="text-xs text-slate">Inscricoes encerradas.</div>
                    {% endif %}
                  </div>
                  {% with interest=interests|get_item:mass.id %}
                    <input type="checkbox" name="masses" value="{{ mass.id }}" {% if interest and interest.interested %}checked{% endif %} {% if mass.id in closed_ids %}disabled{% endif %} />
                  {% endwith %}
                </label>
              {% empty %}
                <p class="text-sm text-slate">Nenhuma missa futura para este evento.</p>
              {% endfor %}
            </div>
          </div>
        {% empty %}
          <p class="text-sm text-slate">Nenhum evento cadastrado.</p>
        {% endfor %}
      </div>
      {% if series %}
        <button class="btn-primary">Salvar interesse</button>
      {% endif %}
    </form>
  {% endif %}
</div>
{% endblock %}
```

### templates\events\list.html
```html
{% extends 'base.html' %}
{% block title %}Programacao liturgica{% endblock %}
{% block content %}
<div class="card space-y-4">
  <div class="flex flex-wrap items-center justify-between gap-3">
    <div>
      <h2 class="font-serif text-xl">Programacao liturgica</h2>
      <p class="text-sm text-slate">Gerencie celebracoes recorrentes e eventos especiais.</p>
    </div>
    <a class="btn-primary" href="{% url 'event_series_create' %}">Agendar celebracao</a>
  </div>
  <div class="flex flex-wrap items-center gap-2 text-sm">
    <a class="btn-secondary {% if status == 'active' %}bg-moss text-white border-moss{% endif %}" href="{% url 'event_series_list' %}?status=active">
      Ativas ({{ active_count }})
    </a>
    <a class="btn-secondary {% if status == 'archived' %}bg-moss text-white border-moss{% endif %}" href="{% url 'event_series_list' %}?status=archived">
      Arquivadas ({{ archived_count }})
    </a>
  </div>
  <div class="space-y-2">
    {% for item in series %}
      <div class="border border-black/5 rounded-lg p-3 flex flex-wrap items-start justify-between gap-3">
        <a class="flex-1 min-w-[220px]" href="{% url 'event_series_detail' item.id %}">
          <div class="font-medium">{{ item.title }}</div>
          <div class="text-sm text-slate">
            {{ item.series_type }} · {{ item.start_date }} a {{ item.end_date }}
          </div>
          <div class="text-xs text-slate mt-1">
            Pool: {% if item.candidate_pool == "interested_only" %}Somente interessados{% else %}Todos os acolitos{% endif %}
            · Ocorrencias: {{ item.occurrence_count }}
            · Missas geradas: {{ item.mass_count }}
            {% if item.candidate_pool == "interested_only" and item.interest_deadline_at %}
              · Prazo: {{ item.interest_deadline_at|date:"d/m/Y H:i" }}
            {% endif %}
          </div>
        </a>
        <div class="flex items-center gap-2">
          <a class="btn-secondary" href="{% url 'event_series_edit' item.id %}">Editar</a>
          {% if status == "archived" %}
            <form method="post" action="{% url 'event_series_unarchive' item.id %}">
              {% csrf_token %}
              <button class="btn-secondary" type="submit">Reativar</button>
            </form>
            <form method="post" action="{% url 'event_series_delete' item.id %}" onsubmit="return confirm('Excluir esta serie e todas as missas geradas? Esta acao e irreversivel.');">
              {% csrf_token %}
              <button class="btn-secondary" type="submit">Excluir</button>
            </form>
          {% else %}
            <form method="post" action="{% url 'event_series_archive' item.id %}" onsubmit="return confirm('Arquivar esta serie? As missas geradas permanecem no historico.');">
              {% csrf_token %}
              <button class="btn-secondary" type="submit">Arquivar</button>
            </form>
          {% endif %}
        </div>
      </div>
    {% empty %}
      <p class="text-sm text-slate">Nenhuma celebracao cadastrada.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
```

### templates\mass_templates\form.html
```html
{% extends 'base.html' %}
{% block title %}Novo horario{% endblock %}
{% block content %}
<div class="card max-w-2xl">
  <h2 class="font-serif text-xl mb-4">Criar horario fixo</h2>
   <form method="post" class="space-y-4" id="mass-template-form">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="label">Titulo</label>
        {{ form.title }}
      </div>
      <div>
        <label class="label">Comunidade</label>
        {{ form.community }}
      </div>
      <div>
        <label class="label">Dia da semana</label>
        {{ form.weekday }}
      </div>
      <div>
        <label class="label">Horario</label>
        {{ form.time }}
      </div>
      <div class="sm:col-span-2">
        <label class="label">RRULE</label>
        {{ form.rrule_text }}
      </div>
      <div class="sm:col-span-2">
        <div class="flex items-center justify-between">
          <label class="label">Perfil de requisitos</label>
          <a class="text-xs text-slate hover:text-ink" href="{{ profile_create_url }}">+ Criar perfil</a>
        </div>
        {{ form.default_requirement_profile }}
        {% if not profiles_exist %}
          <div class="mt-2 rounded-lg border border-black/10 bg-white px-3 py-2 text-xs text-slate">
            Nenhum perfil cadastrado. Crie um perfil para definir quantas funcoes cada missa exige.
          </div>
        {% endif %}
      </div>
      <div class="sm:col-span-2">
        <label class="label">Notas</label>
        {{ form.notes }}
      </div>
      <div class="sm:col-span-2">
        <div class="custom-checkbox">
          <input type="checkbox" id="{{ form.active.id_for_label }}" name="{{ form.active.name }}" class="checkbox-input" {% if form.active.value %}checked{% endif %}>
          <label for="{{ form.active.id_for_label }}" class="checkbox-label">
            <svg class="checkbox-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </label>
          <label for="{{ form.active.id_for_label }}" class="checkbox-text">
            <div class="checkbox-title">Template ativo</div>
            <p class="checkbox-description">Quando ativo, o template gera eventos automaticamente conforme sua programação.</p>
          </label>
        </div>
      </div>
       </div>
     </div>
   </form>
   <div class="mt-6 flex justify-end">
     <button class="btn-primary" form="mass-template-form">Salvar</button>
   </div>
 </div>
{% endblock %}
```

### templates\mass_templates\list.html
```html
{% extends 'base.html' %}
{% block title %}Horarios fixos{% endblock %}
{% block content %}
<div class="card">
  <div class="flex flex-wrap items-center justify-between gap-3 mb-4">
    <h2 class="font-serif text-xl">Horarios fixos</h2>
    <div class="flex items-center gap-2">
      <form method="post" action="{% url 'generate_instances' %}" class="flex items-center gap-2">
        {% csrf_token %}
        <input type="number" name="days" value="60" class="w-24" />
        <button class="btn-secondary" type="submit">Aplicar na agenda</button>
      </form>
      <a class="btn-primary" href="{% url 'template_create' %}">Novo horario</a>
    </div>
  </div>
  <div class="space-y-2">
    {% for template in templates %}
      <div class="flex items-center justify-between border border-black/5 rounded-lg p-3">
        <div>
          <div class="font-medium">{{ template.title }}</div>
          <div class="text-sm text-slate">{{ template.community.code }} - {{ template.get_weekday_display }} {{ template.time }}</div>
        </div>
        <span class="badge">{{ template.active|yesno:"ativo,inativo" }}</span>
      </div>
    {% empty %}
      <p class="text-sm text-slate">Nenhum horario cadastrado.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
```

### templates\modals\assignment_conflict.html
```html
{% if show_conflict_modal %}
<!-- Modal Backdrop -->
<div id="assignmentConflictModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center" onclick="if(event.target === this) closeConflictModal()">
  <!-- Modal Content -->
  <div class="bg-white rounded-2xl shadow-soft border border-black/10 max-w-md w-full mx-4 overflow-hidden" onclick="event.stopPropagation()">
    <!-- Modal Header -->
    <div class="px-6 py-4 border-b border-black/10">
      <h3 class="text-xl font-serif text-ink">Conflito de Atribuição</h3>
    </div>
    
    <!-- Modal Body -->
    <div class="px-6 py-6 space-y-3 text-sm">
      <p>O acólito <strong class="text-moss">{{ conflict_acolyte.display_name }}</strong> já está atribuído à posição <strong class="text-moss">{{ current_slot.position_type.name }}</strong> nesta missa.</p>
      <p class="text-slate">Deseja movê-lo para a posição <strong class="text-ink">{{ new_slot.position_type.name }}</strong>?</p>
    </div>
    
    <!-- Modal Footer -->
    <div class="px-6 py-4 bg-sand/30 border-t border-black/10 flex items-center justify-end gap-3">
      <button type="button" class="btn-secondary" onclick="closeConflictModal()">Cancelar</button>
      <form method="post" action="{% url 'move_acolyte' instance.id new_slot.id %}" style="display: inline;" onsubmit="handleMoveSubmit(event)">
        {% csrf_token %}
        <input type="hidden" name="current_slot_id" value="{{ current_slot.id }}">
        <input type="hidden" name="acolyte_id" value="{{ conflict_acolyte.id }}">
        <button type="submit" class="btn-primary" id="moveButton">Mover para Esta Posição</button>
      </form>
    </div>
  </div>
</div>

<script>
  // Show modal immediately
  document.getElementById('assignmentConflictModal').style.display = 'flex';
  
  // Close modal function
  function closeConflictModal() {
    // Remove query params and redirect to clean URL
    window.location.href = "{% url 'mass_detail' instance.id %}";
  }
  
  // Handle form submission
  function handleMoveSubmit(event) {
    // Disable button to prevent double-submit
    const button = document.getElementById('moveButton');
    button.disabled = true;
    button.textContent = 'Movendo...';
    // Form will submit normally
  }
  
  // Close on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeConflictModal();
    }
  });
</script>
{% endif %}
```

### templates\partials\_messages.html
```html
<div id="messages-container" hx-swap-oob="true">
  {% if messages %}
    <script>
      (function() {
        const pushToast = function(message, type) {
          if (window.showToast) {
            window.showToast(message, type);
            return;
          }
          window.pendingToasts = window.pendingToasts || [];
          window.pendingToasts.push([message, type]);
        };
        {% for message in messages %}
          pushToast('{{ message|escapejs }}', 'info');
        {% endfor %}
      })();
    </script>
  {% endif %}
</div>
```

### templates\people\acolyte_tabs\_assign_slot_modal.html
```html
<div class="p-6 max-h-[80vh] overflow-y-auto">
    <div class="flex items-center justify-between mb-6">
        <h3 class="text-lg font-semibold text-ink">Escalar {{ acolyte.display_name }}</h3>
        <button type="button" class="text-slate hover:text-ink transition-colors"
                onclick="document.getElementById('modal-container').classList.add('hidden')">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
        </button>
    </div>
    
    {% if slots %}
    <form method="post" action="{% url 'acolyte_assign_to_slot' acolyte.id %}" id="assign-slot-form">
        {% csrf_token %}
        <input type="hidden" name="slot" id="selected-slot-id" value="">
        
        <div class="mb-6">
            <label class="label mb-3">Slots disponiveis</label>
            <div class="space-y-2 max-h-96 overflow-y-auto">
                {% for slot in slots %}
                <label class="slot-option block p-3 border border-sand-200 rounded-lg cursor-pointer hover:border-moss hover:bg-moss/5 transition-all">
                    <input type="radio" name="slot_radio" value="{{ slot.id }}" class="sr-only slot-radio">
                    <div class="flex items-start justify-between gap-3">
                        <div class="flex-1 min-w-0">
                            <div class="font-medium text-ink mb-1">
                                {{ slot.mass_instance.starts_at|date:"d/m/Y H:i" }}
                            </div>
                            <div class="text-sm text-slate">
                                {{ slot.mass_instance.community.code }} - {{ slot.position_type.name }}
                            </div>
                        </div>
                        {% with days_until=slot.mass_instance.starts_at|timeuntil %}
                        <div class="text-xs {% if 'dia' in days_until or 'hour' in days_until %}text-red-600{% else %}text-slate{% endif %}">
                            {{ days_until }}
                        </div>
                        {% endwith %}
                    </div>
                </label>
                {% endfor %}
            </div>
        </div>
        
        <div class="mb-6">
            <label class="label">Observacoes</label>
            <textarea name="notes" rows="2" class="input w-full" placeholder="Opcional"></textarea>
        </div>
        
        <div class="flex flex-col-reverse sm:flex-row justify-end gap-3">
            <button type="button" class="btn-secondary"
                    onclick="document.getElementById('modal-container').classList.add('hidden')">
                Cancelar
            </button>
            <button type="submit" class="btn-primary" id="confirm-btn" disabled>
                Confirmar
            </button>
        </div>
    </form>
    {% else %}
    <div class="text-center py-12">
        <p class="text-slate mb-2">Nenhum slot disponivel para as qualificacoes deste acolito.</p>
        <p class="text-sm text-slate">Verifique se ha missas com slots abertos.</p>
        <button type="button" class="btn-secondary mt-6"
                onclick="document.getElementById('modal-container').classList.add('hidden')">
            Fechar
        </button>
    </div>
    {% endif %}
</div>

<script>
function initAssignSlotModal(root) {
    const radios = root.querySelectorAll('.slot-radio');
    const hiddenInput = root.querySelector('#selected-slot-id');
    const confirmBtn = root.querySelector('#confirm-btn');
    const slotOptions = root.querySelectorAll('.slot-option');
    
    if (!radios.length || !hiddenInput || !confirmBtn) {
        return;
    }
    
    radios.forEach((radio, index) => {
        radio.addEventListener('change', function() {
            hiddenInput.value = this.value;
            confirmBtn.disabled = false;
            
            slotOptions.forEach(opt => opt.classList.remove('border-moss', 'bg-moss/10'));
            if (this.checked) {
                slotOptions[index].classList.add('border-moss', 'bg-moss/10');
            }
        });
    });
}

function bootAssignSlotModal() {
    const modalContent = document.getElementById('modal-content') || document;
    initAssignSlotModal(modalContent);
}

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', bootAssignSlotModal);
} else {
    bootAssignSlotModal();
}

document.body.addEventListener('htmx:afterSwap', function(evt) {
    if (evt.detail.target && (evt.detail.target.id === 'modal-content' || evt.detail.target.id === 'modal-container')) {
        initAssignSlotModal(evt.detail.target);
    }
});
</script>
```

### templates\people\acolyte_tabs\_schedule_row.html
```html
<tr class="hover:bg-sand-50 {% if not assignment.is_active %}opacity-60{% endif %}" id="assignment-row-{{ assignment.id }}">
    <td class="px-4 py-3 whitespace-nowrap">
        <div class="font-medium text-ink-900">{{ assignment.slot.mass_instance.starts_at|date:"d/m/Y" }}</div>
        <div class="text-sm text-ink-500">{{ assignment.slot.mass_instance.starts_at|time:"H:i" }}</div>
    </td>
    <td class="px-4 py-3">
        {{ assignment.slot.mass_instance.community.name }}
    </td>
    <td class="px-4 py-3">
        {{ assignment.slot.position_type.name }}
    </td>
    <td class="px-4 py-3">
        <span class="badge {% if assignment.assignment_state == 'published' %}badge-green{% elif assignment.assignment_state == 'proposed' %}badge-yellow{% else %}badge-blue{% endif %}">
            {{ assignment.get_assignment_state_display }}
        </span>
        {% if not assignment.is_active %}
        <span class="badge badge-gray ml-1">{{ assignment.get_end_reason_display }}</span>
        {% endif %}
    </td>
    <td class="px-4 py-3">
        {% with status=assignment.confirmation_status %}
        <span class="badge {% if status == 'confirmed' %}badge-green{% elif status == 'declined' %}badge-red{% elif status == 'pending' %}badge-yellow{% else %}badge-gray{% endif %}">
            {{ assignment.get_confirmation_status_display }}
        </span>
        {% endwith %}
    </td>
    <td class="px-4 py-3 text-sm text-ink-500">
        {% if assignment.assigned_by %}
        {{ assignment.assigned_by.full_name }}
        {% else %}
        Sistema
        {% endif %}
    </td>
    <td class="px-4 py-3 text-right">
        {% if assignment.is_active %}
        <div class="flex items-center justify-end gap-2">
            {% if assignment.confirmation_status == 'pending' %}
            <button 
                hx-post="{% url 'acolyte_confirm_assignment' acolyte.id assignment.id %}"
                hx-target="#assignment-row-{{ assignment.id }}"
                hx-swap="outerHTML"
                type="button"
                class="text-moss-600 hover:text-moss-700 text-sm font-medium">
                Confirmar
            </button>
            {% endif %}
            <button 
                hx-post="{% url 'acolyte_remove_assignment' acolyte.id assignment.id %}"
                hx-target="#assignment-row-{{ assignment.id }}"
                hx-swap="outerHTML"
                hx-confirm="Tem certeza que deseja remover esta escala?"
                type="button"
                class="text-red-600 hover:text-red-700 text-sm font-medium">
                Remover
            </button>
        </div>
        {% endif %}
    </td>
</tr>
```

### templates\people\acolyte_tabs\audit.html
```html
{% load extras %}
<!-- Audit Tab -->
<div class="space-y-6">
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Historico de Auditoria</h3>
        <p class="text-ink-500 mb-6">Todas as acoes relacionadas a este acolito registradas no sistema.</p>
        
        {% if audit_events %}
        <div class="space-y-3">
            {% for event in audit_events %}
            <div class="flex items-start gap-4 p-4 bg-sand-50 rounded-lg">
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center">
                    {% if event.actor_user %}
                    <span class="text-sm font-medium text-slate-700">
                        {{ event.actor_user.full_name|slice:":1"|upper }}
                    </span>
                    {% else %}
                    <span class="text-sm font-medium text-slate-500">S</span>
                    {% endif %}
                </div>
                <div class="flex-1">
                    <div class="flex items-center justify-between mb-1">
                        <div class="font-medium text-ink-900">
                            {{ event.action_type }}
                            <span class="font-normal text-ink-500">em</span>
                            {{ event.entity_type }}
                        </div>
                        <div class="text-sm text-ink-500">
                            {{ event.timestamp|date:"d/m/Y H:i" }}
                        </div>
                    </div>
                    <div class="text-sm text-ink-500 mb-2">
                        {% if event.actor_user %}
                        Por {{ event.actor_user.full_name }}
                        {% else %}
                        Acao do sistema
                        {% endif %}
                    </div>
                    {% if event.diff_json %}
                    <details class="mt-2">
                        <summary class="text-sm text-moss-600 cursor-pointer hover:text-moss-700">
                            Ver detalhes
                        </summary>
                        <pre class="mt-2 p-3 bg-white rounded border border-sand-200 text-xs overflow-x-auto">{{ event.diff_json|pprint }}</pre>
                    </details>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if audit_events.has_other_pages %}
        <div class="flex justify-center mt-6 gap-2">
            {% if audit_events.has_previous %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=audit&page={{ audit_events.previous_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=audit&page={{ audit_events.previous_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Anterior
            </a>
            {% endif %}
            <span class="px-4 py-2 text-ink-500">
                Pagina {{ audit_events.number }} de {{ audit_events.paginator.num_pages }}
            </span>
            {% if audit_events.has_next %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=audit&page={{ audit_events.next_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=audit&page={{ audit_events.next_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Proxima
            </a>
            {% endif %}
        </div>
        {% endif %}
        {% else %}
        <p class="text-ink-500 text-center py-8">Nenhum evento de auditoria encontrado para este acolito.</p>
        {% endif %}
    </div>
    
    <!-- Audit Legend -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Sobre a Auditoria</h3>
        <div class="text-sm text-ink-600 space-y-2">
            <p>O historico de auditoria registra todas as alteracoes importantes relacionadas a este acolito:</p>
            <ul class="list-disc list-inside space-y-1 ml-4">
                <li>Alteracoes no perfil (nome, comunidade, nivel de experiencia)</li>
                <li>Mudancas de status (ativo/inativo)</li>
                <li>Adicao/remocao de qualificacoes</li>
                <li>Alteracoes em regras de disponibilidade</li>
                <li>Adicao/remocao de preferencias</li>
                <li>Escalas (atribuicao, confirmacao, cancelamento)</li>
                <li>Ajustes de creditos</li>
                <li>Solicitacoes de troca e substituicao</li>
            </ul>
        </div>
    </div>
</div>
```

### templates\people\acolyte_tabs\availability.html
```html
{% load extras %}
<!-- Availability Tab -->
<div class="space-y-6">
    <!-- Weekly Availability Grid -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Disponibilidade Semanal</h3>
        
        <!-- Visual Grid -->
        <div class="grid grid-cols-7 gap-2 mb-6">
            {% for day_name in weekdays %}
            <div class="text-center">
                <div class="font-medium text-ink-700 mb-2">{{ day_name }}</div>
                <div class="space-y-1">
                    {% with rules=weekly_grid|get_item:forloop.counter0 %}
                    {% if rules %}
                    {% for rule in rules %}
                    <div class="p-2 rounded text-xs {% if rule.rule_type == 'unavailable' %}bg-red-100 text-red-700{% else %}bg-moss-100 text-moss-700{% endif %}">
                        {% if rule.start_time %}{{ rule.start_time|time:"H:i" }}{% endif %}
                        {% if rule.end_time %}- {{ rule.end_time|time:"H:i" }}{% endif %}
                        {% if rule.community %}<br>{{ rule.community.name }}{% endif %}
                        <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="inline">
                            {% csrf_token %}
                            <input type="hidden" name="form_type" value="delete_availability">
                            <input type="hidden" name="rule_id" value="{{ rule.id }}">
                            <input type="hidden" name="current_tab" value="availability">
                            <button type="submit" class="ml-1 text-red-500 hover:text-red-700">&times;</button>
                        </form>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="p-2 rounded text-xs bg-sand-100 text-ink-400">
                        Sem regras
                    </div>
                    {% endif %}
                    {% endwith %}
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Add Weekly Rule Form -->
        <div class="border-t border-sand-200 pt-4">
            <h4 class="font-medium text-ink-800 mb-3">Adicionar Regra Semanal</h4>
            <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="space-y-4">
                {% csrf_token %}
                <input type="hidden" name="form_type" value="weekly_availability">
                <input type="hidden" name="current_tab" value="availability">
                
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div>
                        <label class="label">Tipo</label>
                        <div class="custom-select">
                            <input type="hidden" name="rule_type" value="">
                            <button type="button" class="custom-select-button">
                                <span class="selected-text">Selecionar...</span>
                            </button>
                            <div class="custom-select-options">
                                {% for value, label in weekly_form.fields.rule_type.choices %}
                                    <button type="button" class="custom-select-option" data-value="{{ value }}">{{ label }}</button>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="label">Dia da Semana</label>
                        <div class="custom-select">
                            <input type="hidden" name="day_of_week" value="">
                            <button type="button" class="custom-select-button">
                                <span class="selected-text">Todos os dias</span>
                            </button>
                            <div class="custom-select-options">
                                <button type="button" class="custom-select-option selected" data-value="">Todos os dias</button>
                                {% for value, label in weekly_form.fields.day_of_week.choices %}
                                    {% if value != "" %}
                                        <button type="button" class="custom-select-option" data-value="{{ value }}">{{ label }}</button>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="label">Hora Inicio</label>
                        <input type="time" name="start_time" class="input w-full">
                    </div>
                    <div>
                        <label class="label">Hora Fim</label>
                        <input type="time" name="end_time" class="input w-full">
                    </div>
                    <div>
                        <label class="label">Comunidade</label>
                        <div class="custom-select">
                            <input type="hidden" name="community" value="">
                            <button type="button" class="custom-select-button">
                                <span class="selected-text">Todas</span>
                            </button>
                            <div class="custom-select-options">
                                <button type="button" class="custom-select-option selected" data-value="">Todas</button>
                                {% for c in weekly_form.fields.community.queryset %}
                                    <button type="button" class="custom-select-option" data-value="{{ c.id }}">{{ c.code }}</button>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn-primary">Adicionar Regra</button>
            </form>
        </div>
    </div>
    
    <!-- Date-based Absences -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Ausencias por Periodo</h3>
        
        {% if date_absences %}
        <div class="space-y-2 mb-6">
            {% for absence in date_absences %}
            <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-100">
                <div>
                    <span class="font-medium text-red-800">
                        {% if absence.start_date %}{{ absence.start_date|date:"d/m/Y" }}{% endif %}
                        {% if absence.end_date %} ate {{ absence.end_date|date:"d/m/Y" }}{% endif %}
                    </span>
                    {% if absence.notes %}
                    <span class="text-red-600 ml-2">- {{ absence.notes }}</span>
                    {% endif %}
                </div>
                <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="inline">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="delete_availability">
                    <input type="hidden" name="rule_id" value="{{ absence.id }}">
                    <input type="hidden" name="current_tab" value="availability">
                    <button type="submit" class="text-red-600 hover:text-red-700">
                        Remover
                    </button>
                </form>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-ink-500 mb-6">Nenhuma ausencia cadastrada.</p>
        {% endif %}
        
        <!-- Add Absence Form -->
        <div class="border-t border-sand-200 pt-4">
            <h4 class="font-medium text-ink-800 mb-3">Adicionar Ausencia</h4>
            <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="space-y-4">
                {% csrf_token %}
                <input type="hidden" name="form_type" value="date_absence">
                <input type="hidden" name="current_tab" value="availability">
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="label">Data Inicio</label>
                        <input type="date" name="start_date" class="input w-full" required>
                    </div>
                    <div>
                        <label class="label">Data Fim</label>
                        <input type="date" name="end_date" class="input w-full">
                        <p class="text-xs text-ink-500 mt-1">Deixe vazio para ausencia de um dia</p>
                    </div>
                    <div>
                        <label class="label">Observacoes</label>
                        <input type="text" name="notes" class="input w-full" placeholder="Ex: Ferias, viagem...">
                    </div>
                </div>
                
                <button type="submit" class="btn-primary">Adicionar Ausencia</button>
            </form>
        </div>
    </div>
    
    <!-- All Rules List -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Todas as Regras</h3>
        
        {% if weekly_rules or date_absences %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-sand-200">
                <thead>
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Tipo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Dia</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Horario</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Periodo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Comunidade</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Notas</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase">Acoes</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-sand-100">
                    {% for rule in weekly_rules %}
                    <tr class="hover:bg-sand-50">
                        <td class="px-4 py-3">
                            <span class="badge {% if rule.rule_type == 'unavailable' %}badge-red{% else %}badge-green{% endif %}">
                                {{ rule.get_rule_type_display }}
                            </span>
                        </td>
                        <td class="px-4 py-3">
                            {% if rule.day_of_week is not None %}
                            {{ weekdays|index:rule.day_of_week }}
                            {% else %}
                            Todos
                            {% endif %}
                        </td>
                        <td class="px-4 py-3">
                            {% if rule.start_time or rule.end_time %}
                            {{ rule.start_time|time:"H:i"|default:"-" }} - {{ rule.end_time|time:"H:i"|default:"-" }}
                            {% else %}
                            Dia todo
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-ink-400">Semanal</td>
                        <td class="px-4 py-3">{{ rule.community.name|default:"-" }}</td>
                        <td class="px-4 py-3 text-sm text-ink-500">{{ rule.notes|default:"-" }}</td>
                        <td class="px-4 py-3 text-right">
                            <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="inline">
                                {% csrf_token %}
                                <input type="hidden" name="form_type" value="delete_availability">
                                <input type="hidden" name="rule_id" value="{{ rule.id }}">
                                <input type="hidden" name="current_tab" value="availability">
                                <button type="submit" class="text-red-600 hover:text-red-700 text-sm">Remover</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                    {% for absence in date_absences %}
                    <tr class="hover:bg-sand-50">
                        <td class="px-4 py-3">
                            <span class="badge badge-red">Indisponivel</span>
                        </td>
                        <td class="px-4 py-3 text-ink-400">-</td>
                        <td class="px-4 py-3 text-ink-400">-</td>
                        <td class="px-4 py-3">
                            {{ absence.start_date|date:"d/m/Y" }}
                            {% if absence.end_date %} - {{ absence.end_date|date:"d/m/Y" }}{% endif %}
                        </td>
                        <td class="px-4 py-3">{{ absence.community.name|default:"-" }}</td>
                        <td class="px-4 py-3 text-sm text-ink-500">{{ absence.notes|default:"-" }}</td>
                        <td class="px-4 py-3 text-right">
                            <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="inline">
                                {% csrf_token %}
                                <input type="hidden" name="form_type" value="delete_availability">
                                <input type="hidden" name="rule_id" value="{{ absence.id }}">
                                <input type="hidden" name="current_tab" value="availability">
                                <button type="submit" class="text-red-600 hover:text-red-700 text-sm">Remover</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-ink-500 text-center py-4">Nenhuma regra de disponibilidade cadastrada.</p>
        {% endif %}
    </div>
</div>
```

### templates\people\acolyte_tabs\credits.html
```html
{% load extras %}
<!-- Credits Tab -->
<div class="space-y-6">
    <!-- Balance Summary -->
    <div class="card">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h3 class="text-lg font-semibold text-ink-900">Saldo de Creditos</h3>
                <p class="text-ink-500">Creditos sao usados para priorizar acolitos em escalas disputadas.</p>
            </div>
            <div class="text-center">
                <div class="text-4xl font-bold {% if balance > 0 %}text-moss-600{% elif balance < 0 %}text-red-600{% else %}text-ink-900{% endif %}">
                    {{ balance|default:0 }}
                </div>
                <div class="text-sm text-ink-500">creditos</div>
            </div>
        </div>
        
        <!-- Adjustment Form -->
        <div class="border-t border-sand-200 pt-4">
            <h4 class="font-medium text-ink-800 mb-3">Ajuste Manual</h4>
            <form method="post" action="{% url 'acolyte_adjust_credits' acolyte.id %}" class="space-y-4">
                {% csrf_token %}
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="label">Valor do Ajuste</label>
                        <input type="number" name="delta" class="input w-full" placeholder="Ex: 10 ou -5" required>
                        <p class="text-xs text-ink-500 mt-1">Positivo para adicionar, negativo para remover</p>
                    </div>
                    <div>
                        <label class="label">Justificativa</label>
                        <input type="text" name="notes" class="input w-full" placeholder="Motivo do ajuste..." required>
                    </div>
                </div>
                
                <button type="submit" class="btn-primary">Aplicar Ajuste</button>
            </form>
        </div>
    </div>
    
    <!-- Credit Ledger -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Historico de Creditos</h3>
        
        {% if ledger %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-sand-200">
                <thead>
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Data</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Motivo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Escala Relacionada</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Notas</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Por</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase">Valor</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-sand-100">
                    {% for entry in ledger %}
                    <tr class="hover:bg-sand-50">
                        <td class="px-4 py-3 whitespace-nowrap text-sm">
                            {{ entry.created_at|date:"d/m/Y H:i" }}
                        </td>
                        <td class="px-4 py-3">
                            <span class="badge badge-gray">
                                {{ reason_labels|get_item:entry.reason_code|default:entry.reason_code }}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-sm">
                            {% if entry.related_assignment %}
                            {{ entry.related_assignment.slot.mass_instance.starts_at|date:"d/m/Y" }}
                            - {{ entry.related_assignment.slot.position_type.name }}
                            {% else %}
                            <span class="text-ink-400">-</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-sm text-ink-500">
                            {{ entry.notes|default:"-" }}
                        </td>
                        <td class="px-4 py-3 text-sm text-ink-500">
                            {% if entry.created_by %}
                            {{ entry.created_by.full_name }}
                            {% else %}
                            Sistema
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-right font-medium {% if entry.delta > 0 %}text-moss-600{% else %}text-red-600{% endif %}">
                            {% if entry.delta > 0 %}+{% endif %}{{ entry.delta }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        {% if ledger.has_other_pages %}
        <div class="flex justify-center mt-6 gap-2">
            {% if ledger.has_previous %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=credits&page={{ ledger.previous_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=credits&page={{ ledger.previous_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Anterior
            </a>
            {% endif %}
            <span class="px-4 py-2 text-ink-500">
                Pagina {{ ledger.number }} de {{ ledger.paginator.num_pages }}
            </span>
            {% if ledger.has_next %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=credits&page={{ ledger.next_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=credits&page={{ ledger.next_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Proxima
            </a>
            {% endif %}
        </div>
        {% endif %}
        {% else %}
        <p class="text-ink-500 text-center py-8">Nenhuma movimentacao de creditos registrada.</p>
        {% endif %}
    </div>
    
    <!-- Reason Code Legend -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Legenda de Motivos</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {% for code, label in reason_labels.items %}
            <div class="flex items-center gap-2">
                <span class="badge badge-gray">{{ label }}</span>
                <span class="text-sm text-ink-500">{{ code }}</span>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
```

### templates\people\acolyte_tabs\notifications.html
```html
{% load extras %}
<!-- Notifications Tab -->
<div class="space-y-6">
    {% if user %}
    <!-- Notification Preferences -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Preferencias de Notificacao</h3>
        
        <form method="post" action="{% url 'acolyte_update_notifications' acolyte.id %}" class="space-y-4">
            {% csrf_token %}
            
            <div class="space-y-3">
                <label class="flex items-center gap-3 p-4 rounded-lg border border-sand-200 hover:bg-sand-50 cursor-pointer">
                    <input type="checkbox" name="email_enabled" 
                           {% if notification_prefs.email_enabled %}checked{% endif %}
                           class="rounded text-moss-600 focus:ring-moss-500">
                    <div>
                        <div class="font-medium text-ink-800">Receber notificacoes por email</div>
                        <div class="text-sm text-ink-500">Receba alertas de escalas, confirmacoes e alteracoes por email</div>
                    </div>
                </label>
                
                <label class="flex items-center gap-3 p-4 rounded-lg border border-sand-200 hover:bg-sand-50 cursor-pointer">
                    <input type="checkbox" name="email_digest" 
                           {% if notification_prefs.email_digest %}checked{% endif %}
                           class="rounded text-moss-600 focus:ring-moss-500">
                    <div>
                        <div class="font-medium text-ink-800">Resumo diario por email</div>
                        <div class="text-sm text-ink-500">Ao inves de notificacoes individuais, receba um resumo diario</div>
                    </div>
                </label>
                
                <label class="flex items-center gap-3 p-4 rounded-lg border border-sand-200 hover:bg-sand-50 cursor-pointer">
                    <input type="checkbox" name="whatsapp_enabled" 
                           {% if notification_prefs.whatsapp_enabled %}checked{% endif %}
                           class="rounded text-moss-600 focus:ring-moss-500">
                    <div>
                        <div class="font-medium text-ink-800">Receber notificacoes por WhatsApp</div>
                        <div class="text-sm text-ink-500">Receba alertas importantes via WhatsApp (requer numero cadastrado)</div>
                    </div>
                </label>
            </div>
            
            <button type="submit" class="btn-primary">Salvar Preferencias</button>
        </form>
    </div>
    
    <!-- Notification Log -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Historico de Notificacoes</h3>
        
        {% if notifications %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-sand-200">
                <thead>
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Data</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Canal</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Tipo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Status</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Erro</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase">Acoes</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-sand-100">
                    {% for notif in notifications %}
                    <tr class="hover:bg-sand-50">
                        <td class="px-4 py-3 whitespace-nowrap text-sm">
                            {{ notif.created_at|date:"d/m/Y H:i" }}
                        </td>
                        <td class="px-4 py-3">
                            <span class="badge {% if notif.channel == 'email' %}badge-blue{% else %}badge-green{% endif %}">
                                {{ channel_labels|get_item:notif.channel|default:notif.channel }}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-sm">
                            {{ notif.template_code }}
                        </td>
                        <td class="px-4 py-3">
                            <span class="badge {% if notif.status == 'sent' %}badge-green{% elif notif.status == 'failed' %}badge-red{% elif notif.status == 'pending' or notif.status == 'processing' %}badge-yellow{% else %}badge-gray{% endif %}">
                                {{ status_labels|get_item:notif.status|default:notif.status }}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-sm text-red-600 max-w-xs truncate">
                            {{ notif.error_message|default:"-" }}
                        </td>
                        <td class="px-4 py-3 text-right">
                            {% if notif.status == 'failed' or notif.status == 'skipped' %}
                            <form method="post" action="{% url 'acolyte_resend_notification' acolyte.id notif.id %}" class="inline">
                                {% csrf_token %}
                                <button type="submit" class="text-moss-600 hover:text-moss-700 text-sm font-medium">
                                    Reenviar
                                </button>
                            </form>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        {% if notifications.has_other_pages %}
        <div class="flex justify-center mt-6 gap-2">
            {% if notifications.has_previous %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=notifications&page={{ notifications.previous_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=notifications&page={{ notifications.previous_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Anterior
            </a>
            {% endif %}
            <span class="px-4 py-2 text-ink-500">
                Pagina {{ notifications.number }} de {{ notifications.paginator.num_pages }}
            </span>
            {% if notifications.has_next %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=notifications&page={{ notifications.next_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=notifications&page={{ notifications.next_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Proxima
            </a>
            {% endif %}
        </div>
        {% endif %}
        {% else %}
        <p class="text-ink-500 text-center py-8">Nenhuma notificacao enviada para este usuario.</p>
        {% endif %}
    </div>
    {% else %}
    <div class="card">
        <div class="text-center py-12">
            <div class="text-6xl mb-4">&#9888;</div>
            <h3 class="text-lg font-semibold text-ink-900 mb-2">Usuario nao vinculado</h3>
            <p class="text-ink-500">Este acolito nao possui um usuario vinculado, portanto nao pode receber notificacoes.</p>
            <p class="text-ink-500 mt-2">Para habilitar notificacoes, vincule um usuario a este perfil de acolito.</p>
        </div>
    </div>
    {% endif %}
</div>
```

### templates\people\acolyte_tabs\overview.html
```html
<!-- Overview Tab -->
<div class="space-y-6">
    <!-- Status Alerts -->
    {% if alerts %}
    <div class="space-y-2">
        {% for alert in alerts %}
        <div class="p-4 rounded-lg border {% if alert.type == 'warning' %}bg-sun-50 border-sun-200 text-sun-800{% elif alert.type == 'info' %}bg-slate-50 border-slate-200 text-slate-700{% else %}bg-moss-50 border-moss-200 text-moss-800{% endif %}">
            {{ alert.message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Left Column -->
        <div class="space-y-6">
            <!-- Intent & Load Target -->
            <div class="card">
                <h3 class="text-lg font-semibold text-ink-900 mb-4">Intencoes e Disponibilidade</h3>
                <form method="post" action="{% url 'acolyte_update_intent' acolyte.id %}" class="space-y-4">
                    {% csrf_token %}
                    <input type="hidden" name="current_tab" value="overview">
                    
                    <div>
                        <label class="label">{{ intent_form.desired_frequency_per_month.label }}</label>
                        <input type="number" name="desired_frequency_per_month" 
                               value="{{ intent_form.instance.desired_frequency_per_month|default:'' }}"
                               min="0" max="12" class="input w-full"
                               placeholder="Ex: 2">
                        <p class="text-xs text-ink-500 mt-1">Quantas vezes por mes o acolito deseja servir</p>
                    </div>
                    
                     <div>
                         <label class="label">{{ intent_form.willingness_level.label }}</label>
                         <div class="custom-select">
                             <input type="hidden" name="willingness_level" value="{{ intent_form.instance.willingness_level }}">
                             <button type="button" class="custom-select-button">
                                 <span class="selected-text">
                                     {% for value, label in intent_form.fields.willingness_level.choices %}
                                         {% if intent_form.instance.willingness_level == value %}{{ label }}{% endif %}
                                     {% endfor %}
                                 </span>
                             </button>
                             <div class="custom-select-options">
                                 {% for value, label in intent_form.fields.willingness_level.choices %}
                                     <button type="button" class="custom-select-option {% if intent_form.instance.willingness_level == value %}selected{% endif %}" data-value="{{ value }}">{{ label }}</button>
                                 {% endfor %}
                             </div>
                         </div>
                     </div>
                    
                    <button type="submit" class="btn-primary">Salvar Intencoes</button>
                </form>
            </div>
            
            <!-- Profile Quick Edit -->
            <div class="card">
                <h3 class="text-lg font-semibold text-ink-900 mb-4">Perfil do Acolito</h3>
                <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="space-y-4">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="acolyte">
                    <input type="hidden" name="current_tab" value="overview">
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="label">Nome de Exibicao</label>
                            <input type="text" name="display_name" value="{{ acolyte.display_name }}" class="input w-full">
                        </div>
                         <div>
                             <label class="label">Comunidade de Origem</label>
                             <div class="custom-select">
                                 <input type="hidden" name="community_of_origin" value="{{ acolyte.community_of_origin_id }}">
                                 <button type="button" class="custom-select-button">
                                     <span class="selected-text">
                                         {% if acolyte.community_of_origin_id %}
                                             {% for c in acolyte_form.fields.community_of_origin.queryset %}
                                                 {% if acolyte.community_of_origin_id == c.id %}{{ c.code }}{% endif %}
                                             {% endfor %}
                                         {% else %}
                                             -
                                         {% endif %}
                                     </span>
                                 </button>
                                 <div class="custom-select-options">
                                     <button type="button" class="custom-select-option" data-value="">-</button>
                                     {% for c in acolyte_form.fields.community_of_origin.queryset %}
                                         <button type="button" class="custom-select-option {% if acolyte.community_of_origin_id == c.id %}selected{% endif %}" data-value="{{ c.id }}">{{ c.code }}</button>
                                     {% endfor %}
                                 </div>
                             </div>
                         </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                         <div>
                             <label class="label">Nível de Experiência</label>
                             <div class="custom-select">
                                 <input type="hidden" name="experience_level" value="{{ acolyte.experience_level }}">
                                 <button type="button" class="custom-select-button">
                                     <span class="selected-text">
                                         {% for value, label in acolyte_form.fields.experience_level.choices %}
                                             {% if acolyte.experience_level == value %}{{ label }}{% endif %}
                                         {% endfor %}
                                     </span>
                                 </button>
                                 <div class="custom-select-options">
                                     {% for value, label in acolyte_form.fields.experience_level.choices %}
                                         <button type="button" class="custom-select-option {% if acolyte.experience_level == value %}selected{% endif %}" data-value="{{ value }}">{{ label }}</button>
                                     {% endfor %}
                                 </div>
                             </div>
                         </div>
                         <div>
                             <label class="label">Modo de Escalação</label>
                             <div class="custom-select">
                                 <input type="hidden" name="scheduling_mode" value="{{ acolyte.scheduling_mode }}">
                                 <button type="button" class="custom-select-button">
                                     <span class="selected-text">
                                         {% for value, label in acolyte_form.fields.scheduling_mode.choices %}
                                             {% if acolyte.scheduling_mode == value %}{{ label }}{% endif %}
                                         {% endfor %}
                                     </span>
                                 </button>
                                 <div class="custom-select-options">
                                     {% for value, label in acolyte_form.fields.scheduling_mode.choices %}
                                         <button type="button" class="custom-select-option {% if acolyte.scheduling_mode == value %}selected{% endif %}" data-value="{{ value }}">{{ label }}</button>
                                     {% endfor %}
                                 </div>
                             </div>
                         </div>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <label class="flex items-center gap-2">
                            <input type="checkbox" name="active" {% if acolyte.active %}checked{% endif %} class="rounded">
                            <span>Ativo</span>
                        </label>
                    </div>
                    
                    <button type="submit" class="btn-primary">Salvar Perfil</button>
                </form>
             </div>

             <!-- Create Login (if no user) -->
             {% if not user %}
             <div class="card">
                 <h3 class="text-lg font-semibold text-ink-900 mb-4">Criar Credenciais de Login</h3>
                 <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="space-y-4">
                     {% csrf_token %}
                     <input type="hidden" name="form_type" value="login">
                     <input type="hidden" name="current_tab" value="overview">

                     <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                         <div>
                             <label class="label">Email</label>
                             <input type="email" name="email" class="input w-full" required>
                         </div>
                         <div>
                             <label class="label">Senha</label>
                             <input type="password" name="password" class="input w-full" required>
                         </div>
                     </div>

                     <div class="flex items-center gap-4">
                         <label class="flex items-center gap-2">
                             <input type="checkbox" name="send_invite" class="rounded">
                             <span>Enviar convite por email</span>
                         </label>
                     </div>

                      <button type="submit" class="btn-primary">Criar Login</button>
                  </form>
              </div>
             {% endif %}
 </div>

         <!-- Right Column -->
        <div class="space-y-6">
            <!-- Stats Summary -->
            {% if stats %}
            <div class="card">
                <h3 class="text-lg font-semibold text-ink-900 mb-4">Estatisticas</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-center p-3 bg-sand-50 rounded-lg">
                        <div class="text-2xl font-bold text-ink-900">{{ stats.services_last_30_days }}</div>
                        <div class="text-xs text-ink-500">Servicos (30 dias)</div>
                    </div>
                    <div class="text-center p-3 bg-sand-50 rounded-lg">
                        <div class="text-2xl font-bold text-ink-900">{{ stats.services_last_90_days }}</div>
                        <div class="text-xs text-ink-500">Servicos (90 dias)</div>
                    </div>
                    <div class="text-center p-3 bg-sand-50 rounded-lg">
                        <div class="text-2xl font-bold {% if stats.confirmation_rate >= 0.8 %}text-moss-600{% elif stats.confirmation_rate < 0.5 %}text-red-600{% else %}text-sun-600{% endif %}">
                            {{ stats.confirmation_rate|floatformat:0 }}%
                        </div>
                        <div class="text-xs text-ink-500">Taxa Confirmacao</div>
                    </div>
                    <div class="text-center p-3 bg-sand-50 rounded-lg">
                        <div class="text-2xl font-bold {% if stats.reliability_score >= 0.8 %}text-moss-600{% elif stats.reliability_score < 0.5 %}text-red-600{% else %}text-sun-600{% endif %}">
                            {{ stats.reliability_score|floatformat:0 }}%
                        </div>
                        <div class="text-xs text-ink-500">Confiabilidade</div>
                    </div>
                    <div class="text-center p-3 bg-sand-50 rounded-lg">
                        <div class="text-2xl font-bold text-ink-900">{{ stats.no_show_count }}</div>
                        <div class="text-xs text-ink-500">Faltas</div>
                    </div>
                    <div class="text-center p-3 bg-sand-50 rounded-lg">
                        <div class="text-2xl font-bold {% if stats.credit_balance > 0 %}text-moss-600{% elif stats.credit_balance < 0 %}text-red-600{% else %}text-ink-900{% endif %}">
                            {{ stats.credit_balance|default:0 }}
                        </div>
                        <div class="text-xs text-ink-500">Creditos</div>
                    </div>
                </div>
            </div>
            {% endif %}
            
            <!-- Upcoming Assignments -->
            <div class="card">
                <h3 class="text-lg font-semibold text-ink-900 mb-4">Proximas Escalas</h3>
                {% if upcoming_assignments %}
                <div class="space-y-2">
                    {% for assignment in upcoming_assignments %}
                    {% with status=assignment.confirmation_status %}
                    <div class="flex items-center justify-between p-3 rounded-lg {% if status == 'pending' %}bg-sun-50 border border-sun-200{% else %}bg-sand-50{% endif %}">
                        <div>
                            <div class="font-medium text-ink-900">
                                {{ assignment.slot.mass_instance.starts_at|date:"d/m/Y" }} - {{ assignment.slot.mass_instance.starts_at|time:"H:i" }}
                            </div>
                            <div class="text-sm text-ink-500">
                                {{ assignment.slot.position_type.name }} - {{ assignment.slot.mass_instance.community.name }}
                            </div>
                        </div>
                        <div>
                            {% if status == 'confirmed' %}
                            <span class="badge badge-green">Confirmado</span>
                            {% elif status == 'pending' %}
                            <span class="badge badge-yellow">Aguardando confirmacao</span>
                            {% else %}
                            <span class="badge badge-gray">{{ assignment.get_confirmation_status_display }}</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endwith %}
                    {% endfor %}
                </div>
                <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&time=upcoming" 
                   hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&time=upcoming"
                   hx-target="#tab-content"
                   hx-push-url="true"
                   class="block mt-4 text-center text-moss-600 hover:text-moss-700 font-medium">
                    Ver todas as escalas futuras
                </a>
                {% else %}
                <p class="text-ink-500 text-center py-4">Nenhuma escala futura agendada.</p>
                {% endif %}
            </div>
            
            <!-- Past Assignments -->
            <div class="card">
                <h3 class="text-lg font-semibold text-ink-900 mb-4">Ultimas Escalas Servidas</h3>
                {% if past_assignments %}
                <div class="space-y-2">
                    {% for assignment in past_assignments %}
                    {% with status=assignment.confirmation_status %}
                    <div class="flex items-center justify-between p-2 rounded-lg hover:bg-sand-50">
                        <div>
                            <div class="font-medium text-ink-900">
                                {{ assignment.slot.mass_instance.starts_at|date:"d/m/Y" }} - {{ assignment.slot.mass_instance.starts_at|time:"H:i" }}
                            </div>
                            <div class="text-sm text-ink-500">
                                {{ assignment.slot.position_type.name }} - {{ assignment.slot.mass_instance.community.name }}
                            </div>
                        </div>
                        <div>
                            {% if status == 'confirmed' %}
                            <span class="badge badge-green">Compareceu</span>
                            {% elif status == 'no_show' %}
                            <span class="badge badge-red">Faltou</span>
                            {% else %}
                            <span class="badge badge-gray">{{ assignment.get_confirmation_status_display }}</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endwith %}
                    {% endfor %}
                </div>
                <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&time=past" 
                   hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&time=past"
                   hx-target="#tab-content"
                   hx-push-url="true"
                   class="block mt-4 text-center text-moss-600 hover:text-moss-700 font-medium">
                    Ver historico completo
                </a>
                {% else %}
                <p class="text-ink-500 text-center py-4">Nenhuma escala passada.</p>
                {% endif %}
            </div>
            
            <!-- Recent Audit -->
            <div class="card">
                <h3 class="text-lg font-semibold text-ink-900 mb-4">Atividade Recente</h3>
                {% if recent_audit %}
                <div class="space-y-2">
                    {% for event in recent_audit %}
                    <div class="flex items-start gap-2 p-2 text-sm">
                        <div class="text-ink-400">{{ event.timestamp|date:"d/m H:i" }}</div>
                        <div class="flex-1">
                            <span class="font-medium">{{ event.action_type }}</span>
                            {% if event.actor_user %}
                            <span class="text-ink-500">por {{ event.actor_user.full_name }}</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=audit" 
                   hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=audit"
                   hx-target="#tab-content"
                   hx-push-url="true"
                   class="block mt-4 text-center text-moss-600 hover:text-moss-700 font-medium">
                    Ver auditoria completa
                </a>
                {% else %}
                <p class="text-ink-500 text-center py-4">Nenhuma atividade registrada.</p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- User Identity Section (if has user) -->
    {% if user %}
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Identidade do Usuario</h3>
        <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="space-y-4">
            {% csrf_token %}
            <input type="hidden" name="form_type" value="user">
            <input type="hidden" name="current_tab" value="overview">
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="label">Nome Completo</label>
                    <input type="text" name="full_name" value="{{ user.full_name }}" class="input w-full">
                </div>
                <div>
                    <label class="label">Email</label>
                    <input type="email" name="email" value="{{ user.email }}" class="input w-full" readonly>
                </div>
                <div>
                    <label class="label">Telefone</label>
                    <input type="text" name="phone" value="{{ user.phone|default:'' }}" class="input w-full">
                </div>
            </div>

             <div class="grid grid-cols-1 gap-4">
                 <div>
                     <label class="label">Papeis na Paroquia</label>
                     <div class="space-y-2">
                         {% for role in membership_form.fields.roles.queryset %}
                             <label class="flex items-center gap-2">
                                 <input type="checkbox" name="roles" value="{{ role.id }}" {% if role in membership_form.initial.roles %}checked{% endif %} class="rounded">
                                 <span>{{ role.name }}</span>
                             </label>
                         {% endfor %}
                     </div>
                 </div>
             </div>

             <div class="flex items-center gap-4">
                 <label class="flex items-center gap-2">
                     <input type="checkbox" name="is_active" {% if user.is_active %}checked{% endif %} class="rounded">
                     <span>Conta ativa</span>
                 </label>
                 <label class="flex items-center gap-2">
                     <input type="checkbox" name="active" {% if membership_form.initial.active %}checked{% endif %} class="rounded">
                     <span>Membro ativo</span>
                 </label>
             </div>

             <button type="submit" class="btn-primary">Salvar Identidade e Papeis</button>
         </form>
     </div>
     {% endif %}
</div>
```

### templates\people\acolyte_tabs\preferences.html
```html
{% load extras %}
<!-- Preferences Tab -->
<div class="space-y-6">
    <!-- Add Preference Form -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Adicionar Preferencia</h3>
        <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="space-y-4">
            {% csrf_token %}
            <input type="hidden" name="form_type" value="preference">
            <input type="hidden" name="current_tab" value="preferences">
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                 <div>
                     <label class="label">Tipo de Preferência</label>
                     <div class="custom-select">
                         <input type="hidden" name="preference_type" value="" onchange="togglePreferenceFields(this.value)">
                         <button type="button" class="custom-select-button" id="pref-type-select" onclick="togglePreferenceFields(document.querySelector('input[name=preference_type]').value)">
                             <span class="selected-text">Selecionar...</span>
                         </button>
                         <div class="custom-select-options">
                             {% for value, label in preference_form.fields.preference_type.choices %}
                                 <button type="button" class="custom-select-option" data-value="{{ value }}" onclick="togglePreferenceFields('{{ value }}')">{{ label }}</button>
                             {% endfor %}
                         </div>
                     </div>
                 </div>
                <div id="pref-community-field">
                    <label class="label">Comunidade</label>
                    <div class="custom-select">
                        <input type="hidden" name="target_community" value="">
                        <button type="button" class="custom-select-button">
                            <span class="selected-text">-</span>
                        </button>
                        <div class="custom-select-options">
                            <button type="button" class="custom-select-option selected" data-value="">-</button>
                            {% for c in preference_form.fields.target_community.queryset %}
                                <button type="button" class="custom-select-option" data-value="{{ c.id }}">{{ c.code }}</button>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div id="pref-position-field" style="display: none;">
                    <label class="label">Função</label>
                    <div class="custom-select">
                        <input type="hidden" name="target_position" value="">
                        <button type="button" class="custom-select-button">
                            <span class="selected-text">-</span>
                        </button>
                        <div class="custom-select-options">
                            <button type="button" class="custom-select-option selected" data-value="">-</button>
                            {% for p in preference_form.fields.target_position.queryset %}
                                <button type="button" class="custom-select-option" data-value="{{ p.id }}">{{ p.name }}</button>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div id="pref-function-field" style="display: none;">
                    <label class="label">Função Base</label>
                    <div class="custom-select">
                        <input type="hidden" name="target_function" value="">
                        <button type="button" class="custom-select-button">
                            <span class="selected-text">-</span>
                        </button>
                        <div class="custom-select-options">
                            <button type="button" class="custom-select-option selected" data-value="">-</button>
                            {% for f in preference_form.fields.target_function.queryset %}
                                <button type="button" class="custom-select-option" data-value="{{ f.id }}">{{ f.name }}</button>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div id="pref-template-field" style="display: none;">
                    <label class="label">Modelo de Missa</label>
                    <div class="custom-select">
                        <input type="hidden" name="target_template" value="">
                        <button type="button" class="custom-select-button">
                            <span class="selected-text">-</span>
                        </button>
                        <div class="custom-select-options">
                            <button type="button" class="custom-select-option selected" data-value="">-</button>
                            {% for t in preference_form.fields.target_template.queryset %}
                                <button type="button" class="custom-select-option" data-value="{{ t.id }}">{{ t.title }}</button>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div id="pref-acolyte-field" style="display: none;">
                    <label class="label">Acólito Parceiro</label>
                    <div class="custom-select">
                        <input type="hidden" name="target_acolyte" value="">
                        <button type="button" class="custom-select-button">
                            <span class="selected-text">-</span>
                        </button>
                        <div class="custom-select-options">
                            <button type="button" class="custom-select-option selected" data-value="">-</button>
                            {% for a in preference_form.fields.target_acolyte.queryset %}
                                <button type="button" class="custom-select-option" data-value="{{ a.id }}">{{ a.display_name }}</button>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div id="pref-weight-field">
                    <label class="label">Peso (1-100)</label>
                    <input type="number" name="weight" value="50" min="1" max="100" class="input w-full">
                    <p class="text-xs text-ink-500 mt-1">Maior peso = maior prioridade</p>
                </div>
            </div>
            
            <button type="submit" class="btn-primary">Adicionar Preferencia</button>
        </form>
    </div>
    
    <!-- Preferences by Group -->
    {% if preference_groups %}
    {% for pref_type, prefs in preference_groups.items %}
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">
            {{ pref_type_labels|get_item:pref_type|default:pref_type }}
        </h3>
        <div class="space-y-2">
            {% for pref in prefs %}
            <div class="flex items-center justify-between p-3 bg-sand-50 rounded-lg">
                <div class="flex items-center gap-3">
                    <span class="badge {% if 'avoid' in pref.preference_type %}badge-red{% else %}badge-green{% endif %}">
                        {% if 'avoid' in pref.preference_type %}Evitar{% else %}Preferir{% endif %}
                    </span>
                    <span class="font-medium text-ink-800">
                        {% if pref.target_community %}{{ pref.target_community.name }}{% endif %}
                        {% if pref.target_position %}{{ pref.target_position.name }}{% endif %}
                        {% if pref.target_function %}{{ pref.target_function.name }}{% endif %}
                        {% if pref.target_template %}{{ pref.target_template.title }}{% endif %}
                        {% if pref.target_acolyte %}{{ pref.target_acolyte.display_name }}{% endif %}
                        {% if pref.weekday is not None %}Dia {{ pref.weekday }}{% endif %}
                        {% if pref.start_time %}{{ pref.start_time|time:"H:i" }}{% endif %}
                    </span>
                    <span class="text-sm text-ink-500">Peso: {{ pref.weight }}</span>
                </div>
                <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="inline">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="delete_preference">
                    <input type="hidden" name="pref_id" value="{{ pref.id }}">
                    <input type="hidden" name="current_tab" value="preferences">
                    <button type="submit" class="text-red-600 hover:text-red-700 text-sm">
                        Remover
                    </button>
                </form>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="card">
        <p class="text-ink-500 text-center py-8">Nenhuma preferencia cadastrada.</p>
    </div>
    {% endif %}
    
    <!-- All Preferences Table -->
    {% if preferences %}
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Todas as Preferencias</h3>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-sand-200">
                <thead>
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Tipo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Alvo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Peso</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase">Acoes</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-sand-100">
                    {% for pref in preferences %}
                    <tr class="hover:bg-sand-50">
                        <td class="px-4 py-3">
                            <span class="badge {% if 'avoid' in pref.preference_type %}badge-red{% else %}badge-green{% endif %}">
                                {{ pref.get_preference_type_display }}
                            </span>
                        </td>
                        <td class="px-4 py-3">
                            {% if pref.target_community %}{{ pref.target_community.name }}{% endif %}
                            {% if pref.target_position %}{{ pref.target_position.name }}{% endif %}
                            {% if pref.target_function %}{{ pref.target_function.name }}{% endif %}
                            {% if pref.target_template %}{{ pref.target_template.title }}{% endif %}
                            {% if pref.target_acolyte %}{{ pref.target_acolyte.display_name }}{% endif %}
                        </td>
                        <td class="px-4 py-3">{{ pref.weight }}</td>
                        <td class="px-4 py-3 text-right">
                            <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}" class="inline">
                                {% csrf_token %}
                                <input type="hidden" name="form_type" value="delete_preference">
                                <input type="hidden" name="pref_id" value="{{ pref.id }}">
                                <input type="hidden" name="current_tab" value="preferences">
                                <button type="submit" class="text-red-600 hover:text-red-700 text-sm">Remover</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
</div>

<script>
function togglePreferenceFields(type) {
    const fields = {
        'community': ['preferred_community', 'avoid_community'],
        'position': ['preferred_position', 'avoid_position'],
        'function': ['preferred_function', 'avoid_function'],
        'template': ['preferred_mass_template'],
        'acolyte': ['preferred_partner', 'avoid_partner'],
        'timeslot': ['preferred_timeslot'],
    };
    
    // Hide all optional fields
    document.getElementById('pref-community-field').style.display = 'none';
    document.getElementById('pref-position-field').style.display = 'none';
    document.getElementById('pref-function-field').style.display = 'none';
    document.getElementById('pref-template-field').style.display = 'none';
    document.getElementById('pref-acolyte-field').style.display = 'none';
    
    // Show relevant field based on type
    if (type.includes('community')) {
        document.getElementById('pref-community-field').style.display = 'block';
    } else if (type.includes('position')) {
        document.getElementById('pref-position-field').style.display = 'block';
    } else if (type.includes('function')) {
        document.getElementById('pref-function-field').style.display = 'block';
    } else if (type.includes('template')) {
        document.getElementById('pref-template-field').style.display = 'block';
    } else if (type.includes('partner')) {
        document.getElementById('pref-acolyte-field').style.display = 'block';
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    const select = document.getElementById('pref-type-select');
    if (select) {
        togglePreferenceFields(select.value);
    }
});
</script>
```

### templates\people\acolyte_tabs\qualifications.html
```html
<!-- Qualifications Tab -->
<div class="space-y-6">
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Qualificacoes do Acolito</h3>
        <p class="text-ink-500 mb-6">Marque as funcoes que este acolito esta qualificado para exercer.</p>
        
        <form method="post" action="{% url 'people_acolyte_detail' acolyte.id %}">
            {% csrf_token %}
            <input type="hidden" name="form_type" value="qualifications">
            <input type="hidden" name="current_tab" value="qualifications">
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                {% for item in checklist %}
                <label class="flex items-center gap-3 p-4 rounded-lg border cursor-pointer hover:bg-sand-50 transition-colors
                              {% if item.qualified %}border-moss-300 bg-moss-50{% else %}border-sand-200{% endif %}">
                    <input type="checkbox" name="qualifications" value="{{ item.position.id }}"
                           {% if item.qualified %}checked{% endif %}
                           class="rounded text-moss-600 focus:ring-moss-500">
                    <div>
                        <div class="font-medium text-ink-800">{{ item.position.name }}</div>
                        <div class="text-xs text-ink-500">{{ item.position.code }}</div>
                    </div>
                </label>
                {% empty %}
                <p class="text-ink-500 col-span-full text-center py-4">
                    Nenhuma funcao cadastrada na paroquia.
                </p>
                {% endfor %}
            </div>
            
            {% if checklist %}
            <button type="submit" class="btn-primary">Salvar Qualificacoes</button>
            {% endif %}
        </form>
    </div>
    
    <!-- Qualification Analysis -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Analise de Qualificacoes</h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Qualified Functions -->
            <div>
                <h4 class="font-medium text-moss-700 mb-3">Funcoes Qualificadas</h4>
                {% with qualified_count=0 %}
                <div class="space-y-2">
                    {% for item in checklist %}
                    {% if item.qualified %}
                    <div class="flex items-center gap-2 text-moss-700">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                        {{ item.position.name }}
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endwith %}
            </div>
            
            <!-- Missing Functions -->
            <div>
                <h4 class="font-medium text-sun-700 mb-3">Funcoes Nao Qualificadas</h4>
                <div class="space-y-2">
                    {% for item in checklist %}
                    {% if not item.qualified %}
                    <div class="flex items-center gap-2 text-ink-500">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                        </svg>
                        {{ item.position.name }}
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
```

### templates\people\acolyte_tabs\schedule.html
```html
<!-- Schedule Tab -->
<div class="space-y-6">
    <!-- Filters -->
    <div class="card">
        <form method="get" action="{% url 'people_acolyte_detail' acolyte.id %}">
            <input type="hidden" name="tab" value="schedule">
            <div class="flex flex-wrap items-center gap-4">
                <div>
                    <label class="label">Período</label>
                    <select name="time" class="custom-select-button"
                            hx-get="{% url 'people_acolyte_detail' acolyte.id %}"
                            hx-target="#tab-content"
                            hx-include="[name='time'],[name='status']"
                            hx-vals='{"tab": "schedule"}'>
                        <option value="all" {% if time_filter == "all" %}selected{% endif %}>Todos</option>
                        <option value="upcoming" {% if time_filter == "upcoming" %}selected{% endif %}>Futuras</option>
                        <option value="past" {% if time_filter == "past" %}selected{% endif %}>Passadas</option>
                    </select>
                </div>
                <div>
                    <label class="label">Status</label>
                    <select name="status" class="custom-select-button"
                            hx-get="{% url 'people_acolyte_detail' acolyte.id %}"
                            hx-target="#tab-content"
                            hx-include="[name='time'],[name='status']"
                            hx-vals='{"tab": "schedule"}'>
                        <option value="all" {% if status_filter == "all" %}selected{% endif %}>Todas</option>
                        <option value="active" {% if status_filter == "active" %}selected{% endif %}>Ativas</option>
                        <option value="ended" {% if status_filter == "ended" %}selected{% endif %}>Encerradas</option>
                    </select>
                </div>
            </div>
        </form>
    </div>
    
    <!-- Assignments List -->
    <div class="card">
        {% if assignments %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-sand-200">
                <thead>
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider">Data/Hora</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider">Comunidade</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider">Funcao</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider">Estado</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider">Confirmacao</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider">Atribuido por</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase tracking-wider">Acoes</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-sand-100">
                    {% for assignment in assignments %}
                    <tr class="hover:bg-sand-50 {% if not assignment.is_active %}opacity-60{% endif %}" id="assignment-row-{{ assignment.id }}">
                        <td class="px-4 py-3 whitespace-nowrap">
                            <div class="font-medium text-ink-900">{{ assignment.slot.mass_instance.starts_at|date:"d/m/Y" }}</div>
                            <div class="text-sm text-ink-500">{{ assignment.slot.mass_instance.starts_at|time:"H:i" }}</div>
                        </td>
                        <td class="px-4 py-3">
                            {{ assignment.slot.mass_instance.community.name }}
                        </td>
                        <td class="px-4 py-3">
                            {{ assignment.slot.position_type.name }}
                        </td>
                        <td class="px-4 py-3">
                            <span class="badge {% if assignment.assignment_state == 'published' %}badge-green{% elif assignment.assignment_state == 'proposed' %}badge-yellow{% else %}badge-blue{% endif %}">
                                {{ assignment.get_assignment_state_display }}
                            </span>
                            {% if not assignment.is_active %}
                            <span class="badge badge-gray ml-1">{{ assignment.get_end_reason_display }}</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3">
                            {% with status=assignment.confirmation_status %}
                            <span class="badge {% if status == 'confirmed' %}badge-green{% elif status == 'declined' %}badge-red{% elif status == 'pending' %}badge-yellow{% else %}badge-gray{% endif %}">
                                {{ assignment.get_confirmation_status_display }}
                            </span>
                            {% endwith %}
                        </td>
                        <td class="px-4 py-3 text-sm text-ink-500">
                            {% if assignment.assigned_by %}
                            {{ assignment.assigned_by.full_name }}
                            {% else %}
                            Sistema
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-right">
                            {% if assignment.is_active %}
                            <div class="flex items-center justify-end gap-2">
                                {% if assignment.confirmation_status == 'pending' %}
                                <button 
                                    hx-post="{% url 'acolyte_confirm_assignment' acolyte.id assignment.id %}"
                                    hx-target="#assignment-row-{{ assignment.id }}"
                                    hx-swap="outerHTML"
                                    type="button"
                                    class="text-moss-600 hover:text-moss-700 text-sm font-medium">
                                    Confirmar
                                </button>
                                {% endif %}
                                <button 
                                    hx-post="{% url 'acolyte_remove_assignment' acolyte.id assignment.id %}"
                                    hx-target="#assignment-row-{{ assignment.id }}"
                                    hx-swap="outerHTML"
                                    hx-confirm="Tem certeza que deseja remover esta escala?"
                                    type="button"
                                    class="text-red-600 hover:text-red-700 text-sm font-medium">
                                    Remover
                                </button>
                            </div>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        {% if assignments.has_other_pages %}
        <div class="flex justify-center mt-6 gap-2">
            {% if assignments.has_previous %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&page={{ assignments.previous_page_number }}&status={{ status_filter }}&time={{ time_filter }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&page={{ assignments.previous_page_number }}&status={{ status_filter }}&time={{ time_filter }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Anterior
            </a>
            {% endif %}
            <span class="px-4 py-2 text-ink-500">
                Pagina {{ assignments.number }} de {{ assignments.paginator.num_pages }}
            </span>
            {% if assignments.has_next %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&page={{ assignments.next_page_number }}&status={{ status_filter }}&time={{ time_filter }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=schedule&page={{ assignments.next_page_number }}&status={{ status_filter }}&time={{ time_filter }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Proxima
            </a>
            {% endif %}
        </div>
        {% endif %}
        {% else %}
        <div class="text-center py-8">
            <p class="text-ink-500">Nenhuma escala encontrada com os filtros selecionados.</p>
            <button type="button" class="btn-primary mt-4"
                    hx-get="{% url 'acolyte_open_slots' acolyte.id %}"
                    hx-target="#modal-content"
                    hx-swap="innerHTML"
                    onclick="document.getElementById('modal-container').classList.remove('hidden')">
                Atribuir a slot disponivel
            </button>
        </div>
        {% endif %}
    </div>
</div>
```

### templates\people\acolyte_tabs\swaps.html
```html
<!-- Swaps & Replacements Tab -->
<div class="space-y-6">
    <!-- Swap Requests -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Solicitacoes de Troca</h3>
        
        {% if swaps %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-sand-200">
                <thead>
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Data</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Tipo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Solicitante</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Alvo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Escala Origem</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Status</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase">Acoes</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-sand-100">
                    {% for swap in swaps %}
                    <tr class="hover:bg-sand-50">
                        <td class="px-4 py-3 whitespace-nowrap text-sm">
                            {{ swap.created_at|date:"d/m/Y H:i" }}
                        </td>
                        <td class="px-4 py-3">
                            <span class="badge badge-blue">{{ swap.get_swap_type_display }}</span>
                        </td>
                        <td class="px-4 py-3">
                            <span class="{% if swap.requestor_acolyte_id == acolyte.id %}font-bold{% endif %}">
                                {{ swap.requestor_acolyte.display_name }}
                            </span>
                        </td>
                        <td class="px-4 py-3">
                            {% if swap.target_acolyte %}
                            <span class="{% if swap.target_acolyte_id == acolyte.id %}font-bold{% endif %}">
                                {{ swap.target_acolyte.display_name }}
                            </span>
                            {% else %}
                            <span class="text-ink-400">-</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-sm">
                            {% if swap.requestor_assignment %}
                            {{ swap.requestor_assignment.slot.mass_instance.starts_at|date:"d/m" }}
                            {{ swap.requestor_assignment.slot.mass_instance.community.name }}
                            {% else %}
                            <span class="text-ink-400">-</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3">
                            <span class="badge {% if swap.status == 'accepted' %}badge-green{% elif swap.status == 'rejected' or swap.status == 'canceled' %}badge-red{% elif swap.status == 'pending' or swap.status == 'awaiting_approval' %}badge-yellow{% else %}badge-gray{% endif %}">
                                {{ swap.get_status_display }}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-right">
                            {% if swap.status == 'pending' or swap.status == 'awaiting_approval' %}
                            <a href="{% url 'swap_requests' %}" class="text-moss-600 hover:text-moss-700 text-sm font-medium">
                                Gerenciar
                            </a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        {% if swaps.has_other_pages %}
        <div class="flex justify-center mt-6 gap-2">
            {% if swaps.has_previous %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&swap_page={{ swaps.previous_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&swap_page={{ swaps.previous_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Anterior
            </a>
            {% endif %}
            <span class="px-4 py-2 text-ink-500">
                Pagina {{ swaps.number }} de {{ swaps.paginator.num_pages }}
            </span>
            {% if swaps.has_next %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&swap_page={{ swaps.next_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&swap_page={{ swaps.next_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Proxima
            </a>
            {% endif %}
        </div>
        {% endif %}
        {% else %}
        <p class="text-ink-500 text-center py-8">Nenhuma solicitacao de troca encontrada.</p>
        {% endif %}
    </div>
    
    <!-- Replacement Requests -->
    <div class="card">
        <h3 class="text-lg font-semibold text-ink-900 mb-4">Solicitacoes de Substituicao</h3>
        
        {% if replacements %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-sand-200">
                <thead>
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Data</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Escala Original</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Funcao</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Substituto</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase">Status</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase">Acoes</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-sand-100">
                    {% for repl in replacements %}
                    <tr class="hover:bg-sand-50">
                        <td class="px-4 py-3 whitespace-nowrap text-sm">
                            {{ repl.created_at|date:"d/m/Y H:i" }}
                        </td>
                        <td class="px-4 py-3">
                            {{ repl.slot.mass_instance.starts_at|date:"d/m/Y H:i" }}
                            - {{ repl.slot.mass_instance.community.name }}
                        </td>
                        <td class="px-4 py-3">
                            {{ repl.slot.position_type.name }}
                        </td>
                        <td class="px-4 py-3">
                            {% if repl.proposed_acolyte %}
                            {{ repl.proposed_acolyte.display_name }}
                            {% else %}
                            <span class="text-ink-400">Pendente</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3">
                            <span class="badge {% if repl.status == 'assigned' %}badge-green{% elif repl.status == 'canceled' or repl.status == 'resolved' %}badge-gray{% elif repl.status == 'pending' %}badge-yellow{% else %}badge-blue{% endif %}">
                                {{ repl.get_status_display }}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-right">
                            {% if repl.status == 'pending' %}
                            <a href="{% url 'replacement_center' %}" class="text-moss-600 hover:text-moss-700 text-sm font-medium">
                                Gerenciar
                            </a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        {% if replacements.has_other_pages %}
        <div class="flex justify-center mt-6 gap-2">
            {% if replacements.has_previous %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&repl_page={{ replacements.previous_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&repl_page={{ replacements.previous_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Anterior
            </a>
            {% endif %}
            <span class="px-4 py-2 text-ink-500">
                Pagina {{ replacements.number }} de {{ replacements.paginator.num_pages }}
            </span>
            {% if replacements.has_next %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&repl_page={{ replacements.next_page_number }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab=swaps&repl_page={{ replacements.next_page_number }}"
               hx-target="#tab-content"
               class="btn-secondary">
                Proxima
            </a>
            {% endif %}
        </div>
        {% endif %}
        {% else %}
        <p class="text-ink-500 text-center py-8">Nenhuma solicitacao de substituicao encontrada.</p>
        {% endif %}
    </div>
</div>
```

### templates\people\_people_list.html
```html
{% load extras %}

{# Desktop: Table-like Layout with Header #}
<div class="hidden lg:block">
  <div class="card p-0 overflow-hidden">
    <div class="grid grid-cols-[2fr_1.5fr_1.2fr_0.8fr_0.7fr] gap-4 px-4 py-3 border-b border-slate-200 bg-slate-50 text-xs font-semibold uppercase tracking-wide text-slate-600">
      <div>Pessoa</div>
      <div>Papeis / Experiencia</div>
      <div>Qualificacoes</div>
      <div>Confiabilidade</div>
      <div>Frequencia</div>
    </div>

    {% for member in members %}
      <a href="{{ member.detail_url }}" class="grid grid-cols-[2fr_1.5fr_1.2fr_0.8fr_0.7fr] gap-4 px-4 py-3 items-center border-b border-slate-100 hover:bg-slate-50 hover:translate-x-1 transition-all duration-200 w-full block">
        {# Person Cell #}
        <div class="flex items-center gap-3 min-w-0">
          <div class="h-9 w-9 rounded-full bg-sand-100 text-ink flex items-center justify-center font-semibold text-xs flex-shrink-0">
            {{ member.name|initials }}
          </div>
          <div class="min-w-0 flex-1">
            <div class="font-medium text-sm text-ink truncate">{{ member.name }}</div>
            <div class="text-xs text-slate truncate">
              {% if member.user %}
                {{ member.user.email|default:"Sem email" }}{% if member.user.phone %} · {{ member.user.phone }}{% endif %}
              {% else %}
                Sem login
              {% endif %}
            </div>
          </div>
        </div>
        
        {# Roles/Experience Cell - All inline #}
        <div class="text-xs text-slate leading-relaxed">
          {% if member.roles %}
            <span class="italic text-slate-600">{% for role in member.roles %}{{ role.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</span>{% if member.acolyte %} · {% endif %}
          {% endif %}
          {% if member.acolyte %}
            {{ member.acolyte.get_experience_level_display }}{% if member.acolyte.scheduling_mode == "reserve" %} · Reserva{% endif %}{% if member.user and not member.user.is_active or member.acolyte and not member.acolyte.active %} · {% endif %}
          {% endif %}
          {% if member.user and not member.user.is_active %}Inativo{% elif member.acolyte and not member.acolyte.active %}Inativo{% endif %}
        </div>
        
        {# Qualifications Cell #}
        <div>
          {% if member.is_all_qualified %}
            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800" title="Qualificado para todas as funcoes: {{ member.qualifications|join:', ' }}">Todas ({{ member.qualification_codes|length }})</span>
          {% elif member.qualification_codes %}
            <div class="flex flex-wrap gap-1">
              {% for code in member.qualification_codes %}
                <span class="inline-flex items-center px-1.5 py-0.5 rounded text-xs font-mono font-medium bg-slate-100 text-slate-700">{{ code }}</span>
              {% endfor %}
            </div>
          {% else %}
            <span class="text-xs text-slate">—</span>
          {% endif %}
        </div>
        
        {# Reliability Cell #}
        <div>
          {% if member.stats and member.stats.reliability_score is not None %}
            <div class="flex items-center gap-2">
              <div class="flex-1 h-2 bg-slate-200 rounded-full overflow-hidden">
                <div class="h-full bg-green-500 transition-all duration-300" style="width: {{ member.stats.reliability_score|floatformat:1 }}%;"></div>
              </div>
              <div class="text-xs font-medium text-slate-700 tabular-nums">{{ member.stats.reliability_score|floatformat:0 }}%</div>
            </div>
          {% else %}
            <div class="text-xs text-slate">n/d</div>
          {% endif %}
        </div>
        
        {# Frequency Cell - Inline #}
        <div class="text-xs text-slate tabular-nums">
          <span>30d: <span class="text-slate-900 font-medium">{{ member.stats.services_last_30_days|default:"0" }}</span></span> · <span>90d: <span class="text-slate-900 font-medium">{{ member.stats.services_last_90_days|default:"0" }}</span></span>
        </div>
      </a>
    {% empty %}
      <div class="p-6 text-sm text-slate text-center">
        Nenhuma pessoa encontrada com os filtros atuais.
      </div>
    {% endfor %}
  </div>
</div>

{# Mobile: Compact Stacked Cards #}
<div class="lg:hidden space-y-3">
  {% for member in members %}
    <a href="{{ member.detail_url }}" class="card block">
      <div class="flex items-center gap-3 mb-3">
        <div class="h-10 w-10 rounded-full bg-sand-100 text-ink flex items-center justify-center font-semibold text-sm flex-shrink-0">
          {{ member.name|initials }}
        </div>
        <div class="flex-1 min-w-0">
          <div class="font-medium truncate">{{ member.name }}</div>
          <div class="text-xs text-slate truncate">
            {% if member.user %}
              {{ member.user.email|default:"Sem email" }}
              {% if member.user.phone %} - {{ member.user.phone }}{% endif %}
            {% else %}
              Sem login
            {% endif %}
          </div>
        </div>
      </div>
      
      <div class="people-mobile-inline mb-2">
        {% if member.roles %}
          {% for role in member.roles %}{{ role.name }}{% if not forloop.last %}, {% endif %}{% endfor %}
        {% else %}
          <span class="text-slate">Sem papel</span>
        {% endif %}
        {% if member.acolyte %}
          <span class="people-mobile-separator">·</span>
          {{ member.acolyte.get_experience_level_display }}
          {% if member.acolyte.scheduling_mode == "reserve" %}
            <span class="people-mobile-separator">·</span>
            Reserva
          {% endif %}
        {% endif %}
      </div>
      
       <div class="mb-2">
         {% if member.is_all_qualified %}
           <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800" title="Qualificado para todas as funcoes: {{ member.qualifications|join:', ' }}">Todas ({{ member.qualification_codes|length }})</span>
         {% elif member.qualification_codes %}
           {% for code in member.qualification_codes %}<span class="inline-flex items-center px-1.5 py-0.5 rounded text-xs font-mono font-medium bg-slate-100 text-slate-700">{{ code }}</span>{% endfor %}
         {% else %}
           <span class="text-xs text-slate">Sem qualificacoes</span>
         {% endif %}
       </div>
      
       <div class="flex items-center gap-3 text-xs">
         {% if member.stats and member.stats.reliability_score is not None %}
           <div class="flex items-center gap-2">
             <div class="w-16 h-2 bg-slate-200 rounded-full overflow-hidden">
               <div class="h-full bg-green-500 transition-all duration-300" style="width: {{ member.stats.reliability_score|floatformat:1 }}%;"></div>
             </div>
             <span class="font-medium text-slate-700 tabular-nums">{{ member.stats.reliability_score|floatformat:0 }}%</span>
           </div>
         {% else %}
           <span class="text-slate">Conf: n/d</span>
         {% endif %}
         <span class="text-slate">·</span>
         <span class="tabular-nums">30d: {{ member.stats.services_last_30_days|default:"0" }}</span>
         <span class="text-slate">·</span>
         <span class="tabular-nums">90d: {{ member.stats.services_last_90_days|default:"0" }}</span>
       </div>
    </a>
  {% empty %}
    <div class="card text-sm text-slate">Nenhuma pessoa encontrada com os filtros atuais.</div>
  {% endfor %}
</div>
```

### templates\people\acolyte_assign_multiple_slots.html
```html
{% extends "base.html" %}
{% load extras %}

{% block title %}Atribuir multiplos slots - {{ acolyte.display_name }}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Breadcrumb -->
    <div class="mb-6">
        <div class="flex items-center gap-2 text-sm text-slate mb-2">
            <a href="{% url 'people_directory' %}" class="hover:text-ink">Pessoas</a>
            <span>/</span>
            <a href="{% url 'people_acolyte_detail' acolyte.id %}" class="hover:text-ink">{{ acolyte.display_name }}</a>
            <span>/</span>
            <span class="text-ink">Atribuir multiplos slots</span>
        </div>
        
        <h1 class="text-2xl font-semibold text-ink">Atribuir {{ acolyte.display_name }} a multiplos slots</h1>
    </div>

    <!-- Stats Card -->
    {% if stats %}
    <div class="card mb-6">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div>
                <div class="text-xs text-slate uppercase tracking-widest mb-1">Total</div>
                <div class="text-2xl font-semibold text-ink">{{ stats.total_served }}</div>
            </div>
            <div>
                <div class="text-xs text-slate uppercase tracking-widest mb-1">Pendentes</div>
                <div class="text-2xl font-semibold text-sun-600">{{ stats.pending_confirmations }}</div>
            </div>
            <div>
                <div class="text-xs text-slate uppercase tracking-widest mb-1">Ultima escala</div>
                <div class="text-sm text-ink">
                    {% if stats.last_served %}
                        {{ stats.last_served|date:"d/m/Y" }}
                    {% else %}
                        Nunca
                    {% endif %}
                </div>
            </div>
            <div>
                <div class="text-xs text-slate uppercase tracking-widest mb-1">Proxima escala</div>
                <div class="text-sm text-ink">
                    {% if stats.next_scheduled %}
                        {{ stats.next_scheduled|date:"d/m/Y" }}
                    {% else %}
                        Nenhuma
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Filters -->
    <form method="get" class="card mb-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
                <label class="label">Data inicial</label>
                <input type="date" name="start" value="{{ start_date|date:'Y-m-d' }}" class="input w-full">
            </div>
            <div>
                <label class="label">Data final</label>
                <input type="date" name="end" value="{{ end_date|date:'Y-m-d' }}" class="input w-full">
            </div>
            <div>
                <label class="label">Comunidade</label>
                <select name="community" class="input w-full">
                    <option value="">Todas</option>
                    {% for community in communities %}
                    <option value="{{ community.id }}" {% if community.id|stringformat:"s" == community_id|stringformat:"s" %}selected{% endif %}>
                        {{ community.code }}
                    </option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="mt-4 flex justify-end">
            <button type="submit" class="btn-primary">Filtrar</button>
        </div>
    </form>

    <!-- Slot Selection Form -->
    {% if slots %}
    <form method="post" action="{% url 'acolyte_assign_to_multiple_slots_submit' acolyte.id %}" id="multi-assign-form">
        {% csrf_token %}
        
        <div class="card mb-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-ink">Slots disponiveis ({{ slots|length }})</h2>
                <button type="button" id="select-all-btn" class="text-sm text-moss hover:text-moss-700">
                    Selecionar todos
                </button>
            </div>
            
            <div class="space-y-2 max-h-96 overflow-y-auto">
                {% for slot in slots %}
                <label class="slot-checkbox block p-3 border border-sand-200 rounded-lg cursor-pointer hover:border-moss hover:bg-moss/5 transition-all">
                    <input type="checkbox" name="slots" value="{{ slot.id }}" class="mr-3 rounded border-sand-300 text-moss focus:ring-moss">
                    <span class="inline-flex items-start justify-between flex-1 gap-3">
                        <span class="flex-1 min-w-0">
                            <span class="font-medium text-ink block mb-1">
                                {{ slot.mass_instance.starts_at|date:"d/m/Y H:i" }}
                            </span>
                            <span class="text-sm text-slate">
                                {{ slot.mass_instance.community.code }} - {{ slot.position_type.name }}
                            </span>
                        </span>
                        {% with days_until=slot.mass_instance.starts_at|timeuntil %}
                        <span class="text-xs {% if 'dia' in days_until or 'hour' in days_until %}text-red-600{% else %}text-slate{% endif %}">
                            {{ days_until }}
                        </span>
                        {% endwith %}
                    </span>
                </label>
                {% endfor %}
            </div>
        </div>

        <div class="card mb-6">
            <label class="label">Observacoes</label>
            <textarea name="notes" rows="3" class="input w-full" placeholder="Opcional - sera aplicado a todas as atribuicoes"></textarea>
        </div>

        <div class="flex flex-col-reverse sm:flex-row justify-end gap-3">
            <a href="{% url 'people_acolyte_detail' acolyte.id %}" class="btn-secondary">
                Cancelar
            </a>
            <button type="submit" class="btn-primary" id="submit-btn" disabled>
                Atribuir slots selecionados
            </button>
        </div>
    </form>
    {% else %}
    <div class="card text-center py-12">
        <p class="text-slate mb-2">Nenhum slot disponivel para este acolito.</p>
        <p class="text-sm text-slate">Verifique os filtros ou aguarde novas missas serem criadas.</p>
        <a href="{% url 'people_acolyte_detail' acolyte.id %}" class="btn-secondary mt-6">
            Voltar ao perfil
        </a>
    </div>
    {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const checkboxes = document.querySelectorAll('input[name="slots"]');
    const submitBtn = document.getElementById('submit-btn');
    const selectAllBtn = document.getElementById('select-all-btn');
    
    function updateSubmitButton() {
        const anyChecked = Array.from(checkboxes).some(cb => cb.checked);
        submitBtn.disabled = !anyChecked;
        
        const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
        if (checkedCount > 0) {
            submitBtn.textContent = `Atribuir ${checkedCount} slot${checkedCount > 1 ? 's' : ''} selecionado${checkedCount > 1 ? 's' : ''}`;
        } else {
            submitBtn.textContent = 'Atribuir slots selecionados';
        }
    }
    
    checkboxes.forEach(cb => {
        cb.addEventListener('change', updateSubmitButton);
    });
    
    if (selectAllBtn) {
        selectAllBtn.addEventListener('click', function() {
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);
            checkboxes.forEach(cb => {
                cb.checked = !allChecked;
            });
            selectAllBtn.textContent = allChecked ? 'Selecionar todos' : 'Desmarcar todos';
            updateSubmitButton();
        });
    }
    
    // Confirm before submitting if many slots selected
    document.getElementById('multi-assign-form').addEventListener('submit', function(e) {
        const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
        if (checkedCount > 5) {
            if (!confirm(`Tem certeza que deseja atribuir ${checkedCount} slots?`)) {
                e.preventDefault();
            }
        }
    });
});
</script>
{% endblock %}
```

### templates\people\acolyte_detail.html
```html
{% extends "base.html" %}
{% load static %}

{% block title %}{{ acolyte.display_name }}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="mb-6">
        <div class="flex items-center gap-2 text-sm text-ink-500 mb-2">
            <a href="{% url 'people_directory' %}" class="hover:text-ink-700">Pessoas</a>
            <span>/</span>
            <span class="text-ink-700">{{ acolyte.display_name }}</span>
        </div>
        
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            <div>
                <h1 class="text-2xl font-semibold text-ink-900">{{ acolyte.display_name }}</h1>
                {% if user %}
                <p class="text-ink-500 text-sm">{{ user.email }}</p>
                {% endif %}
            </div>
            
            <div class="flex items-center gap-2">
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {% if acolyte.active %}bg-moss-100 text-moss-800{% else %}bg-red-100 text-red-800{% endif %}">
                    {% if acolyte.active %}Ativo{% else %}Inativo{% endif %}
                </span>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800">
                    {{ acolyte.get_experience_level_display }}
                </span>
                {% if acolyte.scheduling_mode == "reserve" %}
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-sun-100 text-sun-800">
                    Reserva
                </span>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <div class="border-b border-sand-200 mb-6">
        <nav class="flex gap-6" aria-label="Tabs">
            {% for tab in tabs %}
            <a href="{% url 'people_acolyte_detail' acolyte.id %}?tab={{ tab.id }}"
               hx-get="{% url 'people_acolyte_detail' acolyte.id %}?tab={{ tab.id }}"
               hx-target="#tab-content"
               hx-push-url="true"
               data-tab="{{ tab.id }}"
               class="tab-link relative pb-3 text-sm font-medium transition-colors
                      {% if current_tab == tab.id %}
                      text-moss-700
                      {% else %}
                      text-ink-500 hover:text-ink-700
                      {% endif %}">
                {{ tab.label }}
                {% if tab.id == "schedule" and pending_confirmations > 0 %}
                <span class="ml-1.5 inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-xs font-medium text-white bg-sun-500 rounded-full">
                    {{ pending_confirmations }}
                </span>
                {% endif %}
                {% if tab.id == "swaps" and open_swaps > 0 %}
                <span class="ml-1.5 inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-xs font-medium text-white bg-sun-500 rounded-full">
                    {{ open_swaps }}
                </span>
                {% endif %}
                {% if current_tab == tab.id %}
                <span class="absolute bottom-0 left-0 right-0 h-0.5 bg-moss-600"></span>
                {% endif %}
            </a>
            {% endfor %}
        </nav>
    </div>
    
    <!-- Tab Content -->
    <div id="tab-content">
        {% if current_tab == "overview" %}
            {% include "people/acolyte_tabs/overview.html" %}
        {% elif current_tab == "schedule" %}
            {% include "people/acolyte_tabs/schedule.html" %}
        {% elif current_tab == "availability" %}
            {% include "people/acolyte_tabs/availability.html" %}
        {% elif current_tab == "preferences" %}
            {% include "people/acolyte_tabs/preferences.html" %}
        {% elif current_tab == "qualifications" %}
            {% include "people/acolyte_tabs/qualifications.html" %}
        {% elif current_tab == "credits" %}
            {% include "people/acolyte_tabs/credits.html" %}
        {% elif current_tab == "swaps" %}
            {% include "people/acolyte_tabs/swaps.html" %}
        {% elif current_tab == "notifications" %}
            {% include "people/acolyte_tabs/notifications.html" %}
        {% elif current_tab == "audit" %}
            {% include "people/acolyte_tabs/audit.html" %}
        {% endif %}
    </div>
</div>

<!-- Modal Container -->
<div id="modal-container" class="hidden fixed inset-0 z-50 overflow-y-auto">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="fixed inset-0 bg-ink-900/50 transition-opacity" onclick="document.getElementById('modal-container').classList.add('hidden')"></div>
        <div class="relative bg-white rounded-lg shadow-xl max-w-lg w-full">
            <div id="modal-content">
                <!-- Modal content loaded here via HTMX -->
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        document.getElementById('modal-container').classList.add('hidden');
    }
});

document.body.addEventListener('htmx:afterSwap', function(evt) {
    if (evt.detail.target.id === 'tab-content') {
        const url = new URL(window.location.href);
        const currentTab = url.searchParams.get('tab') || 'overview';
        
        document.querySelectorAll('.tab-link').forEach(link => {
            const linkTab = link.dataset.tab;
            const indicator = link.querySelector('span.absolute');
            
            if (linkTab === currentTab) {
                link.classList.remove('text-ink-500', 'hover:text-ink-700');
                link.classList.add('text-moss-700');
                if (!indicator) {
                    const span = document.createElement('span');
                    span.className = 'absolute bottom-0 left-0 right-0 h-0.5 bg-moss-600';
                    link.appendChild(span);
                }
            } else {
                link.classList.add('text-ink-500', 'hover:text-ink-700');
                link.classList.remove('text-moss-700');
                if (indicator) {
                    indicator.remove();
                }
            }
        });
    }
});
</script>
{% endblock %}
```

### templates\people\create.html
```html
{% extends 'base.html' %}
{% block title %}Nova pessoa{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card">
    <h2 class="font-serif text-xl mb-2">Nova pessoa</h2>
    <p class="text-sm text-slate">Crie um membro completo com perfil pastoral, acesso e qualificacoes em um unico fluxo.</p>
  </div>

  <form method="post" class="card space-y-6">
    {% csrf_token %}
    {% if form.non_field_errors %}
      <div class="form-error">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
        </svg>
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <div class="grid gap-4 sm:grid-cols-2">
       <div>
         <label class="label">Nome completo</label>
         {{ form.full_name }}
         {% if form.full_name.errors %}
           <div class="form-error">
             <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
             </svg>
             {{ form.full_name.errors|join:", " }}
           </div>
         {% endif %}
         {% if form.full_name.help_text %}<p class="form-help">{{ form.full_name.help_text }}</p>{% endif %}
       </div>
      <div>
        <label class="label">Telefone</label>
        {{ form.phone }}
        {% if form.phone.errors %}<div class="text-xs text-red-600 mt-1">{{ form.phone.errors|join:", " }}</div>{% endif %}
      </div>
    </div>

    <div class="space-y-4">
       <div class="flex items-center gap-3">
         {{ form.has_login }}
         <label for="{{ form.has_login.id_for_label }}" class="text-sm font-medium text-slate cursor-pointer">Tem acesso ao sisteman/d</label>
       </div>
      <div id="login-section" class="grid gap-4 sm:grid-cols-2">
        <div>
          <label class="label">Email</label>
          {{ form.email }}
          {% if form.email.errors %}<div class="text-xs text-red-600 mt-1">{{ form.email.errors|join:", " }}</div>{% endif %}
        </div>
        <div>
          <label class="label">Senha</label>
          {{ form.password }}
          {% if form.password.errors %}<div class="text-xs text-red-600 mt-1">{{ form.password.errors|join:", " }}</div>{% endif %}
           <div class="flex items-center gap-3 mt-2">
             {{ form.send_invite }}
             <label for="{{ form.send_invite.id_for_label }}" class="text-xs font-medium text-slate cursor-pointer">Gerar senha automatica e enviar convite por email</label>
           </div>
        </div>
      </div>
    </div>

    <div class="space-y-4">
       <div class="flex items-center gap-3">
         {{ form.is_acolyte }}
         <label for="{{ form.is_acolyte.id_for_label }}" class="text-sm font-medium text-slate cursor-pointer">Serve no altarn/d</label>
       </div>
      <div id="acolyte-section" class="grid gap-4 sm:grid-cols-2">
        <div>
         <label class="label">Comunidade de origem</label>
         <div class="custom-select">
           <input type="hidden" name="community_of_origin" value="{{ form.community_of_origin.value }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if form.community_of_origin.value %}
                 {% for choice_value, choice_label in form.community_of_origin.field.choices %}
                   {% if form.community_of_origin.value == choice_value %}{{ choice_value }}{% endif %}
                 {% endfor %}
               {% else %}
                 Selecionar...
               {% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             {% for choice_value, choice_label in form.community_of_origin.field.choices %}
               <button type="button" class="custom-select-option {% if form.community_of_origin.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_value }}</button>
             {% endfor %}
           </div>
         </div>
           {% if form.community_of_origin.errors %}<div class="form-error">{{ form.community_of_origin.errors|join:", " }}</div>{% endif %}
       </div>
        <div>
         <label class="label">Nivel de experiencia</label>
         <div class="custom-select">
           <input type="hidden" name="experience_level" value="{{ form.experience_level.value }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if form.experience_level.value %}
                 {% for choice_value, choice_label in form.experience_level.field.choices %}
                   {% if form.experience_level.value == choice_value %}{{ choice_label }}{% endif %}
                 {% endfor %}
               {% else %}
                 Selecionar...
               {% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             {% for choice_value, choice_label in form.experience_level.field.choices %}
               <button type="button" class="custom-select-option {% if form.experience_level.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
             {% endfor %}
           </div>
         </div>
           {% if form.experience_level.errors %}<div class="form-error">{{ form.experience_level.errors|join:", " }}</div>{% endif %}
       </div>
         <div>
           <label class="label">Modo de escala</label>
           <div class="custom-select">
             <input type="hidden" name="scheduling_mode" value="{{ form.scheduling_mode.value }}">
             <button type="button" class="custom-select-button">
               <span class="selected-text">
                 {% if form.scheduling_mode.value %}
                   {% for choice_value, choice_label in form.scheduling_mode.field.choices %}
                     {% if form.scheduling_mode.value == choice_value %}{{ choice_label }}{% endif %}
                   {% endfor %}
                 {% else %}
                   Selecionar...
                 {% endif %}
               </span>
             </button>
             <div class="custom-select-options">
               {% for choice_value, choice_label in form.scheduling_mode.field.choices %}
                 <button type="button" class="custom-select-option {% if form.scheduling_mode.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
               {% endfor %}
             </div>
           </div>
           <p class="form-help">Reserva tecnica: so entra se nao houver outra opcao disponivel.</p>
         </div>
         <div>
           <label class="label">Familia / grupo</label>
           <div class="custom-select">
             <input type="hidden" name="family_group" value="{{ form.family_group.value }}">
             <button type="button" class="custom-select-button">
               <span class="selected-text">
                 {% if form.family_group.value %}
                   {% for choice_value, choice_label in form.family_group.field.choices %}
                     {% if form.family_group.value == choice_value %}{{ choice_label }}{% endif %}
                   {% endfor %}
                 {% else %}
                   Selecionar...
                 {% endif %}
               </span>
             </button>
             <div class="custom-select-options">
               {% for choice_value, choice_label in form.family_group.field.choices %}
                 <button type="button" class="custom-select-option {% if form.family_group.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
               {% endfor %}
             </div>
           </div>
           {% if form.family_group.errors %}<div class="form-error">{{ form.family_group.errors|join:", " }}</div>{% endif %}
         </div>
        <div>
          <label class="label">Notas</label>
          {{ form.notes }}
          {% if form.notes.errors %}<div class="text-xs text-red-600 mt-1">{{ form.notes.errors|join:", " }}</div>{% endif %}
        </div>
          <div class="sm:col-span-2">
            <label class="label">Qualificacoes iniciais</label>
            <div class="check-grid text-sm">
              {% for checkbox in form.qualifications %}
                <label class="check-item">
                  {{ checkbox.tag }}
                  <span>{{ checkbox.choice_label }}</span>
                </label>
              {% endfor %}
            </div>
            {% if form.qualifications.errors %}<div class="text-xs text-red-600 mt-1">{{ form.qualifications.errors|join:", " }}</div>{% endif %}
          </div>
           <div class="sm:col-span-2">
             <div class="custom-checkbox">
               <input type="checkbox" id="{{ form.acolyte_active.id_for_label }}" name="{{ form.acolyte_active.name }}" class="checkbox-input" {% if form.acolyte_active.value %}checked{% endif %}>
               <label for="{{ form.acolyte_active.id_for_label }}" class="checkbox-label">
                 <svg class="checkbox-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                   <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                 </svg>
               </label>
               <label for="{{ form.acolyte_active.id_for_label }}" class="checkbox-text">
                 <div class="checkbox-title">Perfil ativo</div>
                 <p class="checkbox-description">Permite que o perfil seja incluido em escalas e atribuicoes automaticas.</p>
               </label>
             </div>
           </div>
      </div>
    </div>

    <div class="space-y-4">
       <div class="flex items-center gap-3">
         {{ form.has_admin_access }}
         <label for="{{ form.has_admin_access.id_for_label }}" class="text-sm font-medium text-slate cursor-pointer">Tem acesso administrativon/d</label>
       </div>
      <div id="roles-section">
        <label class="label">Papeis na paroquia</label>
        <div class="check-grid text-sm">
          {% for checkbox in form.roles %}
            <label class="check-item">
              {{ checkbox.tag }}
              <span>{{ checkbox.choice_label }}</span>
            </label>
          {% endfor %}
        </div>
        {% if form.roles.errors %}<div class="text-xs text-red-600 mt-1">{{ form.roles.errors|join:", " }}</div>{% endif %}
      </div>
    </div>

    <div class="flex flex-wrap gap-2">
      <button class="btn-primary" type="submit">Criar pessoa</button>
      <a class="btn-secondary" href="{% url 'people_directory' %}">Voltar</a>
    </div>
  </form>
</div>

<script>
  const toggleBlocks = [
    { toggle: "id_has_login", target: "login-section" },
    { toggle: "id_is_acolyte", target: "acolyte-section" },
    { toggle: "id_has_admin_access", target: "roles-section" },
  ];

  function toggleSection(toggleId, targetId) {
    const toggle = document.getElementById(toggleId);
    const target = document.getElementById(targetId);
    if (!toggle || !target) return;

    const update = () => {
      const isOn = toggle.checked;
      target.classList.toggle("hidden", !isOn);
      target.querySelectorAll("input, select, textarea").forEach((el) => {
        el.disabled = !isOn;
        if (!isOn) {
          if (el.type === "checkbox" || el.type === "radio") {
            el.checked = false;
          } else {
            el.value = "";
          }
        }
      });
    };

    toggle.addEventListener("change", update);
    update();
  }

  toggleBlocks.forEach((item) => toggleSection(item.toggle, item.target));

  const sendInvite = document.getElementById("id_send_invite");
  const passwordInput = document.getElementById("id_password");
  if (sendInvite && passwordInput) {
    const updatePassword = () => {
      passwordInput.disabled = sendInvite.checked;
      if (sendInvite.checked) {
        passwordInput.value = "";
      }
    };
    sendInvite.addEventListener("change", updatePassword);
    updatePassword();
  }
</script>
{% endblock %}
```

### templates\people\detail.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Pessoa{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
    <div class="flex items-center gap-3">
      <div class="h-12 w-12 rounded-full bg-emerald-50 text-emerald-700 flex items-center justify-center font-semibold">
        {% if acolyte %}
          {{ acolyte.display_name|initials }}
        {% else %}
          {{ user.full_name|initials }}
        {% endif %}
      </div>
      <div>
        <div class="font-serif text-xl">
          {% if acolyte %}
            {{ acolyte.display_name }}
          {% else %}
            {{ user.full_name }}
          {% endif %}
        </div>
        <div class="text-sm text-slate">
          {% if user %}
            {{ user.email|default:"Sem email" }}
          {% else %}
            Sem login
          {% endif %}
        </div>
      </div>
    </div>
    <div class="flex flex-wrap gap-2 text-xs">
      {% if membership %}
        {% for role in membership.roles.all %}
          <span class="badge">{{ role.name }}</span>
        {% endfor %}
      {% endif %}
      {% if acolyte %}
        <span class="badge">{{ acolyte.get_experience_level_display }}</span>
        {% if acolyte.scheduling_mode == "reserve" %}
          <span class="badge">Reserva tecnica</span>
        {% endif %}
      {% endif %}
      {% if user and not user.is_active %}
        <span class="badge">Usuario inativo</span>
      {% endif %}
      {% if acolyte and not acolyte.active %}
        <span class="badge">Acolito inativo</span>
      {% endif %}
    </div>
    <div class="flex flex-wrap gap-4 text-sm text-slate">
      <div>30 dias: <span class="text-ink font-medium">{{ stats.services_last_30_days|default:"n/d" }}</span></div>
      <div>90 dias: <span class="text-ink font-medium">{{ stats.services_last_90_days|default:"n/d" }}</span></div>
      <div>Confiabilidade: <span class="text-ink font-medium">{{ stats.reliability_score|default:"n/d" }}</span></div>
      <div>Creditos: <span class="text-ink font-medium">{{ stats.credit_balance|default:"n/d" }}</span></div>
    </div>
  </div>

  <div class="grid gap-6 lg:grid-cols-2">
    <div class="space-y-6">
      {% if user_form %}
        <form method="post" class="card space-y-4">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="user" />
          <h3 class="font-semibold">Identidade</h3>
          <div class="grid gap-4 sm:grid-cols-2">
            <div>
              <label class="label">Nome</label>
              {{ user_form.full_name }}
              {% if user_form.full_name.errors %}<div class="text-xs text-red-600 mt-1">{{ user_form.full_name.errors|join:", " }}</div>{% endif %}
            </div>
            <div>
              <label class="label">Email</label>
              {{ user_form.email }}
              {% if user_form.email.errors %}<div class="text-xs text-red-600 mt-1">{{ user_form.email.errors|join:", " }}</div>{% endif %}
            </div>
            <div>
              <label class="label">Telefone</label>
              {{ user_form.phone }}
            </div>
            <div class="sm:mt-6">
              <label class="check-inline">
                <div class="custom-checkbox">
                  <input type="checkbox" id="{{ user_form.is_active.id_for_label }}" name="{{ user_form.is_active.name }}" class="checkbox-input" {% if user_form.is_active.value %}checked{% endif %}>
                  <label for="{{ user_form.is_active.id_for_label }}" class="checkbox-label">
                    <svg class="checkbox-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                  </label>
                  <label for="{{ user_form.is_active.id_for_label }}" class="checkbox-text">
                    <div class="checkbox-title">Conta ativa</div>
                    <p class="checkbox-description">Permite que o usuario faca login e acesse o sistema.</p>
                  </label>
                </div>
              </label>
            </div>
          </div>
          <button class="btn-primary" type="submit">Salvar identidade</button>
        </form>
      {% endif %}

      {% if user %}
        <form method="post" class="card space-y-4">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="membership" />
          <h3 class="font-semibold">Papeis na paroquia</h3>
          <label class="check-inline">
            <div class="custom-checkbox">
              <input type="checkbox" id="{{ membership_form.active.id_for_label }}" name="{{ membership_form.active.name }}" class="checkbox-input" {% if membership_form.active.value %}checked{% endif %}>
              <label for="{{ membership_form.active.id_for_label }}" class="checkbox-label">
                <svg class="checkbox-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>
              </label>
              <label for="{{ membership_form.active.id_for_label }}" class="checkbox-text">
                <div class="checkbox-title">Membership ativa</div>
                <p class="checkbox-description">Quando ativa, o usuario pode gerenciar esta paroquia.</p>
              </label>
            </div>
          </label>
          <div class="check-grid text-sm">
            {% for checkbox in membership_form.roles %}
              <label class="check-item">
                {{ checkbox.tag }}
                <span>{{ checkbox.choice_label }}</span>
              </label>
            {% endfor %}
          </div>
          <button class="btn-primary" type="submit">Salvar papeis</button>
        </form>
      {% endif %}

      <form method="post" class="card space-y-4">
        {% csrf_token %}
        <input type="hidden" name="form_type" value="acolyte" />
        <h3 class="font-semibold">Perfil de acolito</h3>
        {% if not acolyte %}
          <p class="text-sm text-slate">Este membro ainda nao possui perfil de acolito. Preencha abaixo para criar.</p>
        {% endif %}
        <div class="grid gap-4 sm:grid-cols-2">
          <div>
            <label class="label">Nome para escalas</label>
            {{ acolyte_form.display_name }}
          </div>
           <div>
             <label class="label">Comunidade de origem</label>
             <div class="custom-select">
               <input type="hidden" name="community_of_origin" value="{{ acolyte_form.community_of_origin.value }}">
               <button type="button" class="custom-select-button">
                 <span class="selected-text">
                   {% if acolyte_form.community_of_origin.value %}
                     {% for choice_value, choice_label in acolyte_form.community_of_origin.field.choices %}
                       {% if acolyte_form.community_of_origin.value == choice_value %}{{ choice_label|slice:":3" }}{% endif %}
                     {% endfor %}
                   {% else %}
                     Selecionar...
                   {% endif %}
                 </span>
               </button>
               <div class="custom-select-options">
                 {% for choice_value, choice_label in acolyte_form.community_of_origin.field.choices %}
                   <button type="button" class="custom-select-option {% if acolyte_form.community_of_origin.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label|slice:":3" }}</button>
                 {% endfor %}
               </div>
             </div>
           </div>
           <div>
             <label class="label">Nivel de experiencia</label>
             <div class="custom-select">
               <input type="hidden" name="experience_level" value="{{ acolyte_form.experience_level.value }}">
               <button type="button" class="custom-select-button">
                 <span class="selected-text">
                   {% if acolyte_form.experience_level.value %}
                     {% for choice_value, choice_label in acolyte_form.experience_level.field.choices %}
                       {% if acolyte_form.experience_level.value == choice_value %}{{ choice_label }}{% endif %}
                     {% endfor %}
                   {% else %}
                     Selecionar...
                   {% endif %}
                 </span>
               </button>
               <div class="custom-select-options">
                 {% for choice_value, choice_label in acolyte_form.experience_level.field.choices %}
                   <button type="button" class="custom-select-option {% if acolyte_form.experience_level.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                 {% endfor %}
               </div>
             </div>
           </div>
           <div>
             <label class="label">Modo de escala</label>
             <div class="custom-select">
               <input type="hidden" name="scheduling_mode" value="{{ acolyte_form.scheduling_mode.value }}">
               <button type="button" class="custom-select-button">
                 <span class="selected-text">
                   {% if acolyte_form.scheduling_mode.value %}
                     {% for choice_value, choice_label in acolyte_form.scheduling_mode.field.choices %}
                       {% if acolyte_form.scheduling_mode.value == choice_value %}{{ choice_label }}{% endif %}
                     {% endfor %}
                   {% else %}
                     Selecionar...
                   {% endif %}
                 </span>
               </button>
               <div class="custom-select-options">
                 {% for choice_value, choice_label in acolyte_form.scheduling_mode.field.choices %}
                   <button type="button" class="custom-select-option {% if acolyte_form.scheduling_mode.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                 {% endfor %}
               </div>
             </div>
             <p class="form-help">Reserva tecnica: so entra se nao houver outra opcao disponivel.</p>
           </div>
           <div>
             <label class="label">Familia / grupo</label>
             <div class="custom-select">
               <input type="hidden" name="family_group" value="{{ acolyte_form.family_group.value }}">
               <button type="button" class="custom-select-button">
                 <span class="selected-text">
                   {% if acolyte_form.family_group.value %}
                     {% for choice_value, choice_label in acolyte_form.family_group.field.choices %}
                       {% if acolyte_form.family_group.value == choice_value %}{{ choice_label }}{% endif %}
                     {% endfor %}
                   {% else %}
                     Selecionar...
                   {% endif %}
                 </span>
               </button>
               <div class="custom-select-options">
                 {% for choice_value, choice_label in acolyte_form.family_group.field.choices %}
                   <button type="button" class="custom-select-option {% if acolyte_form.family_group.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                 {% endfor %}
               </div>
             </div>
           </div>
          <div class="sm:col-span-2">
            <label class="label">Notas</label>
            {{ acolyte_form.notes }}
          </div>
           <div class="sm:col-span-2">
              <label class="inline-flex cursor-pointer p-4 bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                <input type="checkbox" id="{{ acolyte_form.active.id_for_label }}" name="{{ acolyte_form.active.name }}" class="sr-only peer" {% if acolyte_form.active.value %}checked{% endif %}>
                <div class="shrink-0 relative w-9 h-5 bg-gray-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-green-600"></div>
                <div class="ms-3 select-none">
                  <p class="text-sm font-medium text-gray-900 mb-1">Perfil ativo</p>
                  <p class="text-sm font-normal text-gray-600">Desativar remove escalas futuras e libera as vagas.</p>
                </div>
              </label>
           </div>
        </div>
        <button class="btn-primary" type="submit">Salvar perfil</button>
      </form>

      {% if acolyte %}
        <form method="post" class="card space-y-4">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="qualifications" />
          <h3 class="font-semibold">Qualificacoes</h3>
          <div class="check-grid text-sm">
            {% for checkbox in qual_form.qualifications %}
              <label class="check-item">
                {{ checkbox.tag }}
                <span>{{ checkbox.choice_label }}</span>
              </label>
            {% endfor %}
          </div>
          <button class="btn-primary" type="submit">Salvar qualificacoes</button>
        </form>
      {% endif %}
    </div>

    <div class="space-y-6">
      {% if acolyte %}
        <div class="card space-y-4">
          <h3 class="font-semibold">Disponibilidade</h3>
          <div class="space-y-2">
            <div class="text-xs uppercase tracking-wider text-slate">Rotina semanal</div>
            {% for rule in weekly_rules %}
              <div class="flex flex-wrap items-center justify-between gap-2 border border-black/5 rounded-lg p-3 text-sm">
                <div>
                  <div class="font-medium">{{ rule.get_day_of_week_display|default:"Qualquer dia" }}</div>
                  <div class="text-xs text-slate">
                    {{ rule.get_rule_type_display }}
                    {% if rule.start_time or rule.end_time %} - {{ rule.start_time|default:"--:--" }} - {{ rule.end_time|default:"--:--" }}{% endif %}
                    {% if rule.community %} - {{ rule.community.code }}{% endif %}
                  </div>
                </div>
                <form method="post">
                  {% csrf_token %}
                  <input type="hidden" name="form_type" value="delete_availability" />
                  <input type="hidden" name="rule_id" value="{{ rule.id }}" />
                  <button class="btn-secondary" type="submit">Remover</button>
                </form>
              </div>
            {% empty %}
              <p class="text-sm text-slate">Nenhuma regra semanal cadastrada.</p>
            {% endfor %}
          </div>
           <details class="mt-4">
             <summary class="cursor-pointer inline-flex items-center gap-2 text-sm px-4 py-2 rounded-full border border-black/10 bg-white">
               Adicionar rotina
             </summary>
             <form method="post" class="space-y-3 mt-3">
               {% csrf_token %}
               <input type="hidden" name="form_type" value="weekly_availability" />
               <div class="grid gap-3 sm:grid-cols-2">
                  <div>
                    <label class="label">Tipo</label>
                    <div class="custom-select">
                      <input type="hidden" name="rule_type" value="{{ weekly_form.rule_type.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if weekly_form.rule_type.value %}
                            {% for choice_value, choice_label in weekly_form.rule_type.field.choices %}
                              {% if weekly_form.rule_type.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in weekly_form.rule_type.field.choices %}
                          <button type="button" class="custom-select-option {% if weekly_form.rule_type.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                  <div>
                    <label class="label">Dia</label>
                    <div class="custom-select">
                      <input type="hidden" name="day_of_week" value="{{ weekly_form.day_of_week.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if weekly_form.day_of_week.value %}
                            {% for choice_value, choice_label in weekly_form.day_of_week.field.choices %}
                              {% if weekly_form.day_of_week.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in weekly_form.day_of_week.field.choices %}
                          <button type="button" class="custom-select-option {% if weekly_form.day_of_week.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                 <div>
                   <label class="label">Inicio</label>
                   {{ weekly_form.start_time }}
                 </div>
                 <div>
                   <label class="label">Fim</label>
                   {{ weekly_form.end_time }}
                 </div>
                  <div class="sm:col-span-2">
                    <label class="label">Comunidade (opcional)</label>
                    <div class="custom-select">
                      <input type="hidden" name="community" value="{{ weekly_form.community.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if weekly_form.community.value %}
                            {% for choice_value, choice_label in weekly_form.community.field.choices %}
                              {% if weekly_form.community.value == choice_value %}{{ choice_label|slice:":3" }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in weekly_form.community.field.choices %}
                          <button type="button" class="custom-select-option {% if weekly_form.community.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label|slice:":3" }}</button>
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                 <div class="sm:col-span-2">
                   <label class="label">Notas</label>
                   {{ weekly_form.notes }}
                 </div>
               </div>
               <button class="btn-secondary">Salvar rotina</button>
             </form>
           </details>

          <div class="space-y-2">
            <div class="text-xs uppercase tracking-wider text-slate">Ausencias por data</div>
            {% for absence in date_absences %}
              <div class="flex flex-wrap items-center justify-between gap-2 border border-black/5 rounded-lg p-3 text-sm">
                <div>
                  <div class="font-medium">{{ absence.start_date|date:"d/m/Y" }}{% if absence.end_date and absence.end_date != absence.start_date %} - {{ absence.end_date|date:"d/m/Y" }}{% endif %}</div>
                  <div class="text-xs text-slate">{{ absence.notes|default:"Sem observacao" }}</div>
                </div>
                <form method="post">
                  {% csrf_token %}
                  <input type="hidden" name="form_type" value="delete_availability" />
                  <input type="hidden" name="rule_id" value="{{ absence.id }}" />
                  <button class="btn-secondary" type="submit">Remover</button>
                </form>
              </div>
            {% empty %}
              <p class="text-sm text-slate">Nenhuma ausencia registrada.</p>
            {% endfor %}
          </div>
           <details class="mt-4">
             <summary class="cursor-pointer inline-flex items-center gap-2 text-sm px-4 py-2 rounded-full border border-black/10 bg-white">
               Adicionar ausencia
             </summary>
             <form method="post" class="space-y-3 mt-3">
               {% csrf_token %}
               <input type="hidden" name="form_type" value="date_absence" />
               <div class="grid gap-3 sm:grid-cols-2">
                 <div>
                   <label class="label">Data inicio</label>
                   {{ date_absence_form.start_date }}
                 </div>
                 <div>
                   <label class="label">Data fim (opcional)</label>
                   {{ date_absence_form.end_date }}
                 </div>
                 <div class="sm:col-span-2">
                   <label class="label">Motivo</label>
                   {{ date_absence_form.notes }}
                 </div>
               </div>
               <button class="btn-secondary">Salvar ausencia</button>
             </form>
           </details>
        </div>

         <div class="card space-y-4">
           <div>
             <h3 class="font-semibold">Preferencias atuais</h3>
             <p class="text-sm text-slate">Resumo simples para facilitar a leitura.</p>
           </div>
           <div class="mt-4 space-y-2">
             {% for preference in preferences %}
               <div class="border border-black/5 rounded-lg p-3 flex items-center justify-between gap-3">
                 <div>
                   <div class="font-medium">{{ preference|preference_summary }}</div>
                   <div class="flex items-center gap-2 text-xs uppercase tracking-wide text-slate mt-1">
                     <span class="px-2 py-0.5 rounded-full bg-sand text-ink/70">{{ preference.weight|preference_priority_label }}</span>
                     {% with detail=preference|preference_detail %}
                       {% if detail %}
                         <span>{{ detail }}</span>
                       {% endif %}
                     {% endwith %}
                   </div>
                 </div>
                 <form method="post">
                   {% csrf_token %}
                   <input type="hidden" name="form_type" value="delete_preference" />
                   <input type="hidden" name="pref_id" value="{{ preference.id }}" />
                   <button class="btn-secondary" type="submit">Remover</button>
                 </form>
               </div>
             {% empty %}
               <p class="text-sm text-slate">Nenhuma preferencia cadastrada.</p>
             {% endfor %}
           </div>

           <div class="border-t border-black/5 pt-4 mt-6">
             <div>
               <h4 class="font-semibold">Adicionar preferencia</h4>
               <p class="text-sm text-slate">Prioridade alta reforca, mas nao garante.</p>
             </div>
             <form method="post" class="space-y-3 mt-4" id="pref-form">
               {% csrf_token %}
               <input type="hidden" name="form_type" value="preference" />
               {{ preference_form.weight.as_hidden }}
               <div class="grid gap-3 sm:grid-cols-2">
                  <div class="sm:col-span-2">
                    <label class="label">Tipo</label>
                    <div class="custom-select">
                      <input type="hidden" name="preference_type" value="{{ preference_form.preference_type.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if preference_form.preference_type.value %}
                            {% for choice_value, choice_label in preference_form.preference_type.field.choices %}
                              {% if preference_form.preference_type.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in preference_form.preference_type.field.choices %}
                          <button type="button" class="custom-select-option {% if preference_form.preference_type.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                    {% if preference_form.preference_type.errors %}
                      <div class="form-error">{{ preference_form.preference_type.errors.0 }}</div>
                    {% endif %}
                  </div>
                 <div class="sm:col-span-2">
                   <label class="label">Prioridade</label>
                   {% with weight_value=preference_form.weight.value|default:50 %}
                     <div class="flex flex-wrap gap-2" id="pref_priority_group">
                       <button type="button" data-priority="25"
                         class="px-4 py-2 rounded-full border text-sm {% if weight_value|stringformat:"s" == "25" %}bg-ink text-white border-ink{% else %}border-black/10 text-slate{% endif %}">
                         Baixa
                       </button>
                       <button type="button" data-priority="50"
                         class="px-4 py-2 rounded-full border text-sm {% if weight_value|stringformat:"s" == "50" %}bg-ink text-white border-ink{% else %}border-black/10 text-slate{% endif %}">
                         Media
                       </button>
                       <button type="button" data-priority="100"
                         class="px-4 py-2 rounded-full border text-sm {% if weight_value|stringformat:"s" == "100" %}bg-ink text-white border-ink{% else %}border-black/10 text-slate{% endif %}">
                         Alta
                       </button>
                     </div>
                   {% endwith %}
                 </div>
                  <div class="sm:col-span-2 hidden" data-pref-field="target_community">
                    <label class="label">Comunidade</label>
                    <div class="custom-select">
                      <input type="hidden" name="target_community" value="{{ preference_form.target_community.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if preference_form.target_community.value %}
                            {% for choice_value, choice_label in preference_form.target_community.field.choices %}
                              {% if preference_form.target_community.value == choice_value %}{{ choice_label|slice:":3" }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in preference_form.target_community.field.choices %}
                          <button type="button" class="custom-select-option {% if preference_form.target_community.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label|slice:":3" }}</button>
                        {% endfor %}
                      </div>
                    </div>
                    {% if preference_form.target_community.errors %}
                      <div class="form-error">{{ preference_form.target_community.errors.0 }}</div>
                    {% endif %}
                  </div>
                  <div class="sm:col-span-2 hidden" data-pref-field="target_position">
                    <label class="label">Posicao</label>
                    <div class="custom-select">
                      <input type="hidden" name="target_position" value="{{ preference_form.target_position.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if preference_form.target_position.value %}
                            {% for choice_value, choice_label in preference_form.target_position.field.choices %}
                              {% if preference_form.target_position.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in preference_form.target_position.field.choices %}
                          <button type="button" class="custom-select-option {% if preference_form.target_position.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                    {% if preference_form.target_position.errors %}
                      <div class="form-error">{{ preference_form.target_position.errors.0 }}</div>
                    {% endif %}
                  </div>
                  <div class="sm:col-span-2 hidden" data-pref-field="target_function">
                    <label class="label">Funcao</label>
                    <div class="custom-select">
                      <input type="hidden" name="target_function" value="{{ preference_form.target_function.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if preference_form.target_function.value %}
                            {% for choice_value, choice_label in preference_form.target_function.field.choices %}
                              {% if preference_form.target_function.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in preference_form.target_function.field.choices %}
                          <button type="button" class="custom-select-option {% if preference_form.target_function.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                    {% if preference_form.target_function.errors %}
                      <div class="form-error">{{ preference_form.target_function.errors.0 }}</div>
                    {% endif %}
                  </div>
                  <div class="sm:col-span-2 hidden" data-pref-field="target_template">
                    <label class="label">Modelo</label>
                    <div class="custom-select">
                      <input type="hidden" name="target_template" value="{{ preference_form.target_template.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if preference_form.target_template.value %}
                            {% for choice_value, choice_label in preference_form.target_template.field.choices %}
                              {% if preference_form.target_template.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in preference_form.target_template.field.choices %}
                          <button type="button" class="custom-select-option {% if preference_form.target_template.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                    {% if preference_form.target_template.errors %}
                      <div class="form-error">{{ preference_form.target_template.errors.0 }}</div>
                    {% endif %}
                  </div>
                  <div class="sm:col-span-2 hidden" data-pref-field="target_acolyte">
                    <label class="label">Acolito</label>
                    <div class="custom-select">
                      <input type="hidden" name="target_acolyte" value="{{ preference_form.target_acolyte.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if preference_form.target_acolyte.value %}
                            {% for choice_value, choice_label in preference_form.target_acolyte.field.choices %}
                              {% if preference_form.target_acolyte.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in preference_form.target_acolyte.field.choices %}
                          <button type="button" class="custom-select-option {% if preference_form.target_acolyte.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                    {% if preference_form.target_acolyte.errors %}
                      <div class="form-error">{{ preference_form.target_acolyte.errors.0 }}</div>
                    {% endif %}
                  </div>
                  <div class="hidden" data-pref-field="weekday">
                    <label class="label">Dia da semana</label>
                    <div class="custom-select">
                      <input type="hidden" name="weekday" value="{{ preference_form.weekday.value }}">
                      <button type="button" class="custom-select-button">
                        <span class="selected-text">
                          {% if preference_form.weekday.value %}
                            {% for choice_value, choice_label in preference_form.weekday.field.choices %}
                              {% if preference_form.weekday.value == choice_value %}{{ choice_label }}{% endif %}
                            {% endfor %}
                          {% else %}
                            Selecionar...
                          {% endif %}
                        </span>
                      </button>
                      <div class="custom-select-options">
                        {% for choice_value, choice_label in preference_form.weekday.field.choices %}
                          <button type="button" class="custom-select-option {% if preference_form.weekday.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                        {% endfor %}
                      </div>
                    </div>
                    {% if preference_form.weekday.errors %}
                      <div class="form-error">{{ preference_form.weekday.errors.0 }}</div>
                    {% endif %}
                  </div>
                 <div class="hidden" data-pref-field="start_time">
                   <label class="label">Horario inicio</label>
                   {{ preference_form.start_time }}
                   {{ preference_form.start_time.errors }}
                 </div>
                 <div class="hidden" data-pref-field="end_time">
                   <label class="label">Horario fim</label>
                   {{ preference_form.end_time }}
                   {{ preference_form.end_time.errors }}
                 </div>
               </div>
               <button class="btn-secondary" type="submit">Salvar preferencia</button>
             </form>
           </div>
         </div>
      {% endif %}

      <div class="card space-y-3">
        <h3 class="font-semibold">Escalas</h3>
        <div>
          <div class="text-xs uppercase tracking-wider text-slate">Proximas</div>
          <div class="space-y-2 mt-2">
            {% for assignment in upcoming %}
              <a class="block border border-black/5 rounded-lg p-3 text-sm hover:bg-sand" href="{% url 'mass_detail' assignment.slot.mass_instance.id %}">
                <div class="text-slate text-xs">{{ assignment.slot.mass_instance.starts_at|date:"d/m H:i" }}</div>
                <div class="font-medium">{{ assignment.slot.mass_instance.community.code }} - {{ assignment.slot.position_type.name }}</div>
              </a>
            {% empty %}
              <p class="text-sm text-slate">Sem escalas futuras.</p>
            {% endfor %}
          </div>
        </div>
        <div>
          <div class="text-xs uppercase tracking-wider text-slate">Recentes</div>
          <div class="space-y-2 mt-2">
            {% for assignment in recent %}
              <a class="block border border-black/5 rounded-lg p-3 text-sm hover:bg-sand" href="{% url 'mass_detail' assignment.slot.mass_instance.id %}">
                <div class="text-slate text-xs">{{ assignment.slot.mass_instance.starts_at|date:"d/m H:i" }}</div>
                <div class="font-medium">{{ assignment.slot.mass_instance.community.code }} - {{ assignment.slot.position_type.name }}</div>
              </a>
            {% empty %}
              <p class="text-sm text-slate">Sem historico recente.</p>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  (function () {
    const acolyteActiveInput = document.getElementById("{{ acolyte_form.active.id_for_label }}");
    const acolyteForm = acolyteActiveInput ? acolyteActiveInput.closest("form") : null;
    const originalActive = acolyteActiveInput
      ? acolyteActiveInput.closest(".toggle-switch")?.dataset.originalActive === "1"
      : false;
    const typeSelect = document.getElementById("id_preference_type");
    const weightInput = document.getElementById("id_weight");
    const priorityButtons = document.querySelectorAll("[data-priority]");
    const groups = document.querySelectorAll("[data-pref-field]");
    const mapping = {
      preferred_community: ["target_community"],
      avoid_community: ["target_community"],
      preferred_position: ["target_position"],
      avoid_position: ["target_position"],
      preferred_function: ["target_function"],
      avoid_function: ["target_function"],
      preferred_mass_template: ["target_template"],
      preferred_partner: ["target_acolyte"],
      avoid_partner: ["target_acolyte"],
      preferred_timeslot: ["weekday", "start_time", "end_time"],
    };

    function resetField(el) {
      if (el.tagName === "SELECT") {
        el.selectedIndex = 0;
        return;
      }
      if (el.type === "checkbox" || el.type === "radio") {
        el.checked = false;
        return;
      }
      el.value = "";
    }

    function updateFields() {
      if (!typeSelect) {
        return;
      }
      const allowed = mapping[typeSelect.value] || [];
      groups.forEach((group) => {
        const field = group.getAttribute("data-pref-field");
        const show = allowed.includes(field);
        group.classList.toggle("hidden", !show);
        group.querySelectorAll("select, input, textarea").forEach((el) => {
          el.disabled = !show;
          if (!show) {
            resetField(el);
          }
        });
      });
    }

    function setPriority(value) {
      if (!weightInput) {
        return;
      }
      weightInput.value = value;
      priorityButtons.forEach((btn) => {
        const isActive = btn.dataset.priority === value;
        btn.classList.toggle("bg-ink", isActive);
        btn.classList.toggle("text-white", isActive);
        btn.classList.toggle("border-ink", isActive);
        btn.classList.toggle("border-black/10", !isActive);
        btn.classList.toggle("text-slate", !isActive);
      });
    }

    if (typeSelect) {
      typeSelect.addEventListener("change", updateFields);
      updateFields();
    }
    priorityButtons.forEach((btn) => {
      btn.addEventListener("click", () => setPriority(btn.dataset.priority));
    });
    if (weightInput) {
      setPriority(weightInput.value || "50");
    }

    if (acolyteForm && acolyteActiveInput && originalActive) {
      acolyteForm.addEventListener("submit", (event) => {
        if (!acolyteActiveInput.checked) {
          const confirmed = window.confirm("Desativar remove escalas futuras deste acolito. Confirmar?");
          if (!confirmed) {
            event.preventDefault();
          }
        }
      });
    }
  })();
</script>
{% endblock %}
```

### templates\people\directory.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Pessoas{% endblock %}
{% block content %}
<div class="space-y-6">
   <div class="card flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
     <div>
       <h2 class="font-serif text-xl">Pessoas</h2>
       <p class="text-sm text-slate">Gerencie membros, acessos e perfis de acolitos em um unico lugar.</p>
     </div>
     <a class="btn-primary" href="{% url 'people_create' %}">Nova pessoa</a>
   </div>

   <!-- Search and Filters Section -->
   <div class="card space-y-4">
     <!-- Search Bar -->
     <div class="flex flex-col sm:flex-row gap-4 items-start sm:items-center">
       <form method="get" class="flex-1 max-w-md">
         <input
           id="search"
           name="q"
           placeholder="Buscar pessoas..."
           value="{{ filters.q }}"
           class="w-full px-3 py-2 border border-sand-200 rounded-lg focus:ring-2 focus:ring-moss-500 focus:border-transparent"
           hx-get="{% url 'people_directory' %}"
           hx-trigger="input changed delay:500ms"
           hx-target="#people-list"
           hx-swap="innerHTML"
         />
       </form>
       <button
         class="btn-secondary flex items-center gap-2"
         onclick="document.getElementById('advanced-filters').classList.toggle('hidden')"
         type="button"
       >
         <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
         </svg>
         Filtros avançados
       </button>
       <a class="btn-secondary" href="{% url 'people_directory' %}">Limpar</a>
     </div>

     <!-- Advanced Filters (Hidden by default) -->
     <div id="advanced-filters" class="hidden">
       <form method="get" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
         <input type="hidden" name="q" value="{{ filters.q }}" />
         <div>
           <label class="label">Comunidade</label>
           <div class="custom-select">
              <input type="hidden" name="community" value="{% if filters.community %}{{ filters.community }}{% endif %}">
             <button type="button" class="custom-select-button">
               <span class="selected-text">
                 {% if filters.community %}
                   {% for community in communities %}
                     {% if filters.community == community.id|stringformat:"s" %}{{ community.code }}{% endif %}
                   {% endfor %}
                 {% else %}
                   Todas
                 {% endif %}
               </span>
             </button>
             <div class="custom-select-options">
               <button type="button" class="custom-select-option {% if not filters.community %}selected{% endif %}" data-value="">Todas</button>
               {% for community in communities %}
                 <button type="button" class="custom-select-option {% if filters.community == community.id|stringformat:"s" %}selected{% endif %}" data-value="{{ community.id }}">{{ community.code }}</button>
               {% endfor %}
             </div>
           </div>
         </div>
         <div>
           <label class="label">Experiencia</label>
           <div class="custom-select">
              <input type="hidden" name="experience" value="{% if filters.experience %}{{ filters.experience }}{% endif %}">
             <button type="button" class="custom-select-button">
               <span class="selected-text">
                 {% for value,label in experience_choices %}
                   {% if filters.experience == value %}{{ label }}{% endif %}
                 {% endfor %}
                 {% if not filters.experience %}Todas{% endif %}
               </span>
             </button>
             <div class="custom-select-options">
               <button type="button" class="custom-select-option {% if not filters.experience %}selected{% endif %}" data-value="">Todas</button>
               {% for value,label in experience_choices %}
                 <button type="button" class="custom-select-option {% if filters.experience == value %}selected{% endif %}" data-value="{{ value }}">{{ label }}</button>
               {% endfor %}
             </div>
           </div>
         </div>
         <div>
           <label class="label">Status</label>
           <div class="custom-select">
              <input type="hidden" name="status" value="{% if filters.status %}{{ filters.status }}{% endif %}">
             <button type="button" class="custom-select-button">
               <span class="selected-text">
                 {% if filters.status == "active" %}Ativo{% elif filters.status == "inactive" %}Inativo{% else %}Todos{% endif %}
               </span>
             </button>
             <div class="custom-select-options">
               <button type="button" class="custom-select-option {% if not filters.status %}selected{% endif %}" data-value="">Todos</button>
               <button type="button" class="custom-select-option {% if filters.status == "active" %}selected{% endif %}" data-value="active">Ativo</button>
               <button type="button" class="custom-select-option {% if filters.status == "inactive" %}selected{% endif %}" data-value="inactive">Inativo</button>
             </div>
           </div>
         </div>
         <div>
           <label class="label">Papel</label>
           <div class="custom-select">
              <input type="hidden" name="role" value="{% if filters.role %}{{ filters.role }}{% endif %}">
             <button type="button" class="custom-select-button">
               <span class="selected-text">
                 {% if filters.role %}
                   {% for role in roles %}
                     {% if filters.role == role.code %}{{ role.name }}{% endif %}
                   {% endfor %}
                 {% else %}
                   Todos
                 {% endif %}
               </span>
             </button>
             <div class="custom-select-options">
               <button type="button" class="custom-select-option {% if not filters.role %}selected{% endif %}" data-value="">Todos</button>
               {% for role in roles %}
                 <button type="button" class="custom-select-option {% if filters.role == role.code %}selected{% endif %}" data-value="{{ role.code }}">{{ role.name }}</button>
               {% endfor %}
             </div>
           </div>
         </div>
         <div class="flex items-end">
           <button class="btn-primary" type="submit">Aplicar</button>
         </div>
       </form>
     </div>
   </div>

   <div id="people-list" class="space-y-3">
     {% include "people/_people_list.html" %}
  </div>
</div>
{% endblock %}
```

### templates\replacements\center.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Substituicoes{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="grid sm:grid-cols-3 gap-4">
    <div class="card">
      <div class="text-sm text-slate">Substituicoes pendentes</div>
      <div class="text-3xl font-serif">{{ pending_in_window }}</div>
    </div>
    <div class="card">
      <div class="text-sm text-slate">Vagas abertas (consolidacao)</div>
      <div class="text-3xl font-serif">{{ open_slots }}</div>
    </div>
    <div class="card">
      <div class="text-sm text-slate">Confirmacoes pendentes</div>
      <div class="text-3xl font-serif">{{ pending_confirmations }}</div>
    </div>
  </div>

  <div class="card">
    <div class="flex items-center justify-between mb-4">
      <h2 class="font-serif text-xl">Substituicoes pendentes</h2>
    </div>
    <div class="space-y-3">
      {% for item in replacements %}
        <div class="border border-black/5 rounded-xl p-4 space-y-3">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div>
              <div class="text-sm text-slate">{{ item.slot.mass_instance.starts_at|date:"d/m H:i" }}</div>
              <div class="font-medium">{{ item.slot.mass_instance.community.code }} - {{ item.slot.position_type.name }}</div>
              <div class="text-xs text-slate mt-1">Em {{ item.slot.mass_instance.starts_at|timeuntil }}</div>
              {% if item.notes %}
                <div class="text-xs text-slate mt-1">{{ item.notes }}</div>
              {% endif %}
            </div>
            <div class="flex items-center gap-2">
              {% if item.slot.is_locked %}
                <span class="badge">Bloqueada</span>
              {% endif %}
              <span class="badge">Pendente</span>
            </div>
          </div>
          <div class="flex flex-wrap items-center gap-2">
            {% for acolyte in suggestions|get_list_item:item.id %}
              <form method="post" action="{% url 'replacement_assign' item.id %}">
                {% csrf_token %}
                <input type="hidden" name="acolyte_id" value="{{ acolyte.id }}" />
                <button class="btn-secondary" type="submit">Atribuir {{ acolyte.display_name }}</button>
              </form>
            {% empty %}
              <span class="text-sm text-slate">Sem sugestoes automaticas.</span>
            {% endfor %}
            <a class="btn-secondary" href="{% url 'replacement_pick' item.id %}">Escolher outro</a>
            <a class="btn-secondary" href="{% url 'replacement_resolve' item.id %}">Marcar como resolvida</a>
          </div>
        </div>
      {% empty %}
        <p class="text-sm text-slate">Nenhuma substituicao pendente.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
```

### templates\replacements\pick.html
```html
{% extends 'base.html' %}
{% block title %}Escolher acolito{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <div class="text-sm text-slate">{{ replacement.slot.mass_instance.starts_at|date:"d/m/Y H:i" }}</div>
    <h2 class="font-serif text-xl">Substituicao</h2>
    <p class="text-slate">{{ replacement.slot.mass_instance.community.code }} - {{ replacement.slot.position_type.name }}</p>
  </div>

  <div class="card">
    {% url 'replacement_center' as fallback_url %}
    <form method="get" class="flex flex-wrap items-center gap-3">
      <input class="flex-1" type="text" name="q" value="{{ query }}" placeholder="Buscar acolito" />
      <button class="btn-secondary" type="submit">Buscar</button>
      <a class="btn-secondary" href="{{ back_url|default:fallback_url }}">Voltar</a>
    </form>
  </div>

  <div class="card">
    <h3 class="font-semibold mb-3">Atribuir substituicao</h3>
    <div class="space-y-2">
      {% for candidate in candidates %}
        <form method="post" action="{% url 'replacement_assign' replacement.id %}" class="border border-black/5 rounded-lg p-3 flex items-center justify-between gap-3">
          {% csrf_token %}
          <div>
            <div class="font-medium">{{ candidate.acolyte.display_name }}</div>
            {% if candidate.acolyte.community_of_origin %}
              <div class="text-sm text-slate">{{ candidate.acolyte.community_of_origin.code }}</div>
            {% endif %}
            {% if candidate.score %}
              <div class="text-xs text-slate">Score: {{ candidate.score|floatformat:1 }}</div>
            {% endif %}
            {% if candidate.reason %}
              <div class="text-xs text-slate">{{ candidate.reason }}</div>
            {% endif %}
          </div>
          <input type="hidden" name="acolyte_id" value="{{ candidate.acolyte.id }}" />
          <button class="btn-primary" type="submit">Atribuir</button>
        </form>
      {% empty %}
        <p class="text-sm text-slate">Nenhum acolito encontrado para este filtro.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
```

### templates\replacements\resolve.html
```html
{% extends 'base.html' %}
{% block title %}Resolver substituicao{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <div class="text-sm text-slate">{{ replacement.slot.mass_instance.starts_at|date:"d/m/Y H:i" }}</div>
    <h2 class="font-serif text-xl">Resolver substituicao</h2>
    <p class="text-slate">{{ replacement.slot.mass_instance.community.code }} - {{ replacement.slot.position_type.name }}</p>
    {% if replacement.notes %}
      <p class="text-sm text-slate mt-2">{{ replacement.notes }}</p>
    {% endif %}
  </div>

  <div class="card">
    <form method="post" class="space-y-4">
      {% csrf_token %}
      <div>
        <label class="text-sm font-medium">Motivo da resolucao</label>
        <div class="mt-2 space-y-2">
          {% for radio in form.resolution_type %}
            <label class="flex items-center gap-2 text-sm">
              {{ radio.tag }} {{ radio.choice_label }}
            </label>
          {% endfor %}
        </div>
        {% if form.resolution_type.errors %}
          <p class="text-sm text-red-600 mt-1">{{ form.resolution_type.errors|join:", " }}</p>
        {% endif %}
      </div>

      <div>
        <label class="text-sm font-medium" for="{{ form.notes.id_for_label }}">Observacoes (opcional)</label>
        {{ form.notes }}
        {% if form.notes.errors %}
          <p class="text-sm text-red-600 mt-1">{{ form.notes.errors|join:", " }}</p>
        {% endif %}
      </div>

      <div class="rounded-lg border border-black/10 bg-sand/60 p-3">
        <p class="text-xs text-slate mb-2">Use apenas quando a missa realmente nao vai acontecer.</p>
        <label class="flex items-center gap-2 text-sm">
          {{ form.confirm_cancel_mass }}
          Confirmo o cancelamento da missa
        </label>
      </div>

      <div class="text-xs text-slate">
        Se a vaga continuar aberta, ela ainda aparecera como pendencia na consolidacao.
      </div>

      <div class="flex flex-wrap gap-2">
        <button class="btn-primary" type="submit">Confirmar resolucao</button>
        <a class="btn-secondary" href="{% url 'replacement_center' %}">Voltar</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
```

### templates\reports\frequency.html
```html
{% extends 'base.html' %}
{% block title %}Relatorio de frequencia{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card space-y-4">
    <div class="flex flex-wrap items-center justify-between gap-3">
      <div>
        <h2 class="font-serif text-xl">Relatorio de frequencia</h2>
        <p class="text-sm text-slate">Resumo de servicos por acolito no periodo.</p>
      </div>
    </div>
    <form method="get" class="grid sm:grid-cols-3 gap-3">
      <div>
        <label class="label">Data inicio</label>
        <input type="date" name="start" value="{{ start_date|date:'Y-m-d' }}" />
      </div>
      <div>
        <label class="label">Data final</label>
        <input type="date" name="end" value="{{ end_date|date:'Y-m-d' }}" />
      </div>
      <div class="flex items-end">
        <button class="btn-primary" type="submit">Atualizar</button>
      </div>
    </form>
    <div class="text-xs text-slate">Media do periodo (ativas): {{ avg_total|floatformat:1 }} | Media recebidas: {{ avg_received|floatformat:1 }}</div>
    <div class="text-xs text-slate">Total considera escalas ativas no momento do servico. Recebidas incluem recusas/cancelamentos/cedencias. Futuras contam a partir de hoje.</div>
  </div>

  <div class="card overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="text-left text-xs text-slate uppercase tracking-widest">
          <th class="py-2 pr-3">Acolito</th>
          <th class="py-2 pr-3">Total</th>
          <th class="py-2 pr-3">Recebidas</th>
          <th class="py-2 pr-3">Futuras</th>
          <th class="py-2 pr-3">Total geral</th>
          <th class="py-2 pr-3">Ultimos 30</th>
          <th class="py-2 pr-3">Ultimos 90</th>
          <th class="py-2 pr-3">Confiabilidade</th>
          <th class="py-2 pr-3">Creditos</th>
          <th class="py-2 pr-3">Rejeitou</th>
          <th class="py-2 pr-3">Cancelou</th>
          <th class="py-2 pr-3">Cedeu</th>
          <th class="py-2 pr-3">Aloc. bruta</th>
          <th class="py-2 pr-3">Aloc. ajust.</th>
          <th class="py-2 pr-3">Conta</th>
        </tr>
      </thead>
      <tbody>
        {% for row in rows %}
          <tr class="border-t border-black/5">
            <td class="py-2 pr-3 font-medium">{{ row.acolyte.display_name }}</td>
            <td class="py-2 pr-3">
              <div class="flex items-center gap-2">
                <span class="font-medium">{{ row.total }}</span>
                <div class="h-2 w-24 bg-sand rounded-full overflow-hidden">
                  <div class="h-2 bg-moss" style="width: {% widthratio row.total max_total 100 %}%"></div>
                </div>
              </div>
            </td>
            <td class="py-2 pr-3">{{ row.received }}</td>
            <td class="py-2 pr-3">{{ row.future }}</td>
            <td class="py-2 pr-3">{{ row.total_all_time }}</td>
            <td class="py-2 pr-3">{{ row.services_30 }}</td>
            <td class="py-2 pr-3">{{ row.services_90 }}</td>
            <td class="py-2 pr-3">{{ row.reliability|floatformat:0 }}%</td>
            <td class="py-2 pr-3">{{ row.credit }}</td>
            <td class="py-2 pr-3">{{ row.declined }}</td>
            <td class="py-2 pr-3">{{ row.canceled }}</td>
            <td class="py-2 pr-3">{{ row.ceded }}</td>
            <td class="py-2 pr-3">{{ row.allocation_raw }}</td>
            <td class="py-2 pr-3">{{ row.allocation_adjusted }}</td>
            <td class="py-2 pr-3">
              {% if row.has_user %}
                <span class="text-xs uppercase tracking-widest">Vinculado</span>
              {% else %}
                <span class="text-xs text-slate">Sem login</span>
              {% endif %}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td class="py-4 text-sm text-slate" colspan="15">Nenhum dado no periodo.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
```

### templates\roster\_open_slots_table.html
```html
{% load extras %}
{% if slots %}
<div class="card">
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="text-left text-xs text-slate uppercase tracking-widest border-b border-black/5">
          <th class="py-3 pr-4">Data</th>
          <th class="py-3 pr-4">Hora</th>
          <th class="py-3 pr-4">Comunidade</th>
          <th class="py-3 pr-4">Posicao</th>
          <th class="py-3 pr-4">Urgencia</th>
          <th class="py-3 pr-4 text-right">Acoes</th>
        </tr>
      </thead>
      <tbody>
        {% for slot in slots %}
        <tr class="border-t border-black/5 hover:bg-sand/30 transition-colors" id="slot-row-{{ slot.id }}">
          <td class="py-3 pr-4">{{ slot.mass_instance.starts_at|date:"d/m/Y" }}</td>
          <td class="py-3 pr-4">{{ slot.mass_instance.starts_at|date:"H:i" }}</td>
          <td class="py-3 pr-4">
            <span class="font-medium">{{ slot.mass_instance.community.code }}</span>
          </td>
          <td class="py-3 pr-4">{{ slot.position_type.name }}</td>
          <td class="py-3 pr-4">
            {% with days_until=slot.mass_instance.starts_at|timeuntil %}
              {% if 'dia' in days_until or 'hour' in days_until or 'minute' in days_until %}
                <span class="text-xs px-2 py-1 bg-red-100 text-red-700 rounded">{{ days_until }}</span>
              {% else %}
                <span class="text-xs text-slate">{{ days_until }}</span>
              {% endif %}
            {% endwith %}
          </td>
          <td class="py-3 pr-4 text-right">
            <div class="flex items-center justify-end gap-2">
              <button type="button" 
                      class="text-sm px-3 py-1 border border-moss hover:bg-moss hover:text-white transition-colors rounded"
                      hx-get="{% url 'roster_open_slot_get_candidates' slot.id %}"
                      hx-target="#modal-container"
                      hx-swap="innerHTML"
                      onclick="document.getElementById('modal-container').classList.remove('hidden')">
                Atribuir
              </button>
              <button type="button"
                      class="text-sm px-3 py-1 border border-slate hover:bg-slate hover:text-white transition-colors rounded"
                      hx-post="{% url 'roster_open_slot_mark_external' slot.id %}"
                      hx-target="#slot-row-{{ slot.id }}"
                      hx-swap="delete"
                      hx-confirm="Marcar este slot como coberto externamente?">
                Externo
              </button>
              <a href="{% url 'mass_detail' slot.mass_instance.id %}" 
                 class="text-sm text-slate hover:text-ink">
                Ver missa
              </a>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% if page_obj.has_other_pages %}
  <div class="flex items-center justify-between mt-4 pt-4 border-t border-black/5">
    <div class="text-sm text-slate">
      Pagina {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
    </div>
    <div class="flex gap-2">
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
           class="btn-secondary">
          Anterior
        </a>
      {% endif %}
      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
           class="btn-primary">
          Proxima
        </a>
      {% endif %}
    </div>
  </div>
  {% endif %}
</div>
{% else %}
<div class="card text-center py-12">
  <p class="text-slate">Nenhum slot aberto encontrado com os filtros selecionados.</p>
</div>
{% endif %}
```

### templates\roster\_slot_candidates.html
```html
{% load extras %}
<div class="p-6 max-h-[80vh] overflow-y-auto">
    <div class="flex items-center justify-between mb-6">
        <div>
            <h3 class="text-lg font-semibold text-ink">Atribuir slot</h3>
            <p class="text-sm text-slate mt-1">
                {{ slot.mass_instance.starts_at|date:"d/m/Y H:i" }} - {{ slot.mass_instance.community.code }} - {{ slot.position_type.name }}
            </p>
        </div>
        <button type="button" class="text-slate hover:text-ink transition-colors"
                onclick="document.getElementById('modal-container').classList.add('hidden')">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
        </button>
    </div>
    
    {% if candidates %}
    <form method="post" action="{% url 'roster_open_slot_assign' slot.id %}" id="assign-candidate-form"
          hx-post="{% url 'roster_open_slot_assign' slot.id %}"
          hx-target="#slot-row-{{ slot.id }}"
          hx-swap="delete">
        {% csrf_token %}
        <input type="hidden" name="acolyte_id" id="selected-acolyte-id" value="">
        
        <div class="mb-6">
            <label class="label mb-3">Acolitos recomendados</label>
            <div class="space-y-2 max-h-96 overflow-y-auto">
                {% for candidate in candidates %}
                <label class="candidate-option block p-3 border border-sand-200 rounded-lg cursor-pointer hover:border-moss hover:bg-moss/5 transition-all">
                    <input type="radio" name="candidate_radio" value="{{ candidate.acolyte.id }}" class="sr-only candidate-radio">
                    <div class="flex items-start justify-between gap-3">
                        <div class="flex-1 min-w-0">
                            <div class="font-medium text-ink mb-1">
                                {{ candidate.acolyte.display_name }}
                            </div>
                            <div class="text-xs text-slate space-y-1">
                                {% if candidate.score %}
                                <div>Score: {{ candidate.score|floatformat:1 }}</div>
                                {% endif %}
                                {% if candidate.reason %}
                                <div>{{ candidate.reason }}</div>
                                {% endif %}
                                {% if candidate.last_served %}
                                <div>Ultima escala: {{ candidate.last_served|date:"d/m/Y" }}</div>
                                {% endif %}
                            </div>
                        </div>
                        {% if candidate.conflicts %}
                        <div class="text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded">
                            Conflitos
                        </div>
                        {% endif %}
                    </div>
                </label>
                {% endfor %}
            </div>
        </div>
        
        <div class="mb-6">
            <label class="label">Observacoes</label>
            <textarea name="notes" rows="2" class="input w-full" placeholder="Opcional"></textarea>
        </div>
        
        <div class="flex flex-col-reverse sm:flex-row justify-end gap-3">
            <button type="button" class="btn-secondary"
                    onclick="document.getElementById('modal-container').classList.add('hidden')">
                Cancelar
            </button>
            <button type="submit" class="btn-primary" id="confirm-assign-btn" disabled>
                Confirmar
            </button>
        </div>
    </form>
    {% else %}
    <div class="text-center py-12">
        <p class="text-slate mb-2">Nenhum candidato encontrado para este slot.</p>
        <p class="text-sm text-slate">Verifique se ha acolitos qualificados disponiveis.</p>
        <button type="button" class="btn-secondary mt-6"
                onclick="document.getElementById('modal-container').classList.add('hidden')">
            Fechar
        </button>
    </div>
    {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const radios = document.querySelectorAll('.candidate-radio');
    const hiddenInput = document.getElementById('selected-acolyte-id');
    const confirmBtn = document.getElementById('confirm-assign-btn');
    const candidateOptions = document.querySelectorAll('.candidate-option');
    
    radios.forEach((radio, index) => {
        radio.addEventListener('change', function() {
            hiddenInput.value = this.value;
            confirmBtn.disabled = false;
            
            candidateOptions.forEach(opt => opt.classList.remove('border-moss', 'bg-moss/10'));
            if (this.checked) {
                candidateOptions[index].classList.add('border-moss', 'bg-moss/10');
            }
        });
    });
    
    // Close modal after successful assignment
    document.getElementById('assign-candidate-form').addEventListener('htmx:afterSwap', function() {
        document.getElementById('modal-container').classList.add('hidden');
    });
});
</script>
```

### templates\roster\index.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Escala geral{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card space-y-4">
    <div class="flex flex-wrap items-center justify-between gap-3">
      <div>
        <h2 class="font-serif text-xl">Visao geral das escalas</h2>
        <p class="text-sm text-slate">Uma visao compacta para encontrar buracos e agir rapido.</p>
      </div>
      <div class="flex flex-wrap gap-2">
        <a class="btn-secondary" href="{% url 'roster_export_pdf' %}?start={{ start_date|date:'Y-m-d' }}&end={{ end_date|date:'Y-m-d' }}{% if community_id %}&community={{ community_id }}{% endif %}{% if kind %}&kind={{ kind }}{% endif %}">Exportar PDF</a>
        <button class="btn-secondary" type="button" data-whatsapp-url="{% url 'roster_export_whatsapp' %}?start={{ start_date|date:'Y-m-d' }}&end={{ end_date|date:'Y-m-d' }}{% if community_id %}&community={{ community_id }}{% endif %}{% if kind %}&kind={{ kind }}{% endif %}">Copiar WhatsApp</button>
      </div>
    </div>
    <form method="get" class="grid sm:grid-cols-5 gap-3">
      <div>
        <label class="label">Data inicio</label>
        <input type="date" name="start" value="{{ start_date|date:'Y-m-d' }}" />
      </div>
      <div>
        <label class="label">Data final</label>
        <input type="date" name="end" value="{{ end_date|date:'Y-m-d' }}" />
      </div>
       <div>
         <label class="label">Comunidade</label>
         <div class="custom-select">
           <input type="hidden" name="community" value="{{ community_id }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if community_id %}
                 {% for community in communities %}
                   {% if community_id|stringformat:"s" == community.id|stringformat:"s" %}{{ community.code }}{% endif %}
                 {% endfor %}
               {% else %}
                 Todas
               {% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             <button type="button" class="custom-select-option {% if not community_id %}selected{% endif %}" data-value="">Todas</button>
             {% for community in communities %}
               <button type="button" class="custom-select-option {% if community_id|stringformat:"s" == community.id|stringformat:"s" %}selected{% endif %}" data-value="{{ community.id }}">{{ community.code }}</button>
             {% endfor %}
           </div>
         </div>
       </div>
       <div>
         <label class="label">Tipo</label>
         <div class="custom-select">
           <input type="hidden" name="kind" value="{{ kind }}">
           <button type="button" class="custom-select-button">
             <span class="selected-text">
               {% if kind == "template" %}Templates{% elif kind == "event" %}Eventos{% else %}Todos{% endif %}
             </span>
           </button>
           <div class="custom-select-options">
             <button type="button" class="custom-select-option {% if not kind %}selected{% endif %}" data-value="">Todos</button>
             <button type="button" class="custom-select-option {% if kind == "template" %}selected{% endif %}" data-value="template">Templates</button>
             <button type="button" class="custom-select-option {% if kind == "event" %}selected{% endif %}" data-value="event">Eventos</button>
           </div>
         </div>
       </div>
      <div class="flex items-end">
        <button class="btn-primary" type="submit">Filtrar</button>
      </div>
    </form>
    <div class="flex flex-wrap gap-2 text-xs">
      {% for preset in presets %}
        <a class="btn-secondary" href="?start={{ preset.start|date:'Y-m-d' }}&end={{ preset.end|date:'Y-m-d' }}{% if community_id %}&community={{ community_id }}{% endif %}{% if kind %}&kind={{ kind }}{% endif %}">{{ preset.label }}</a>
      {% endfor %}
    </div>
  </div>

  {% if not days %}
    <div class="card">
      <p class="text-sm text-slate">Nenhuma missa encontrada no periodo selecionado.</p>
    </div>
  {% endif %}

  {% for day in days %}
    <div class="card">
      <div class="flex items-center justify-between">
        <div>
          <h3 class="font-semibold">{{ day.date|date:"d/m/Y" }}</h3>
          <p class="text-xs text-slate">{{ day.date|date:"l" }}</p>
        </div>
      </div>
      <div class="overflow-x-auto mt-4">
        <table class="min-w-full text-sm">
          <thead>
            <tr class="text-left text-xs text-slate uppercase tracking-widest">
              <th class="py-2 pr-3">Hora</th>
              <th class="py-2 pr-3">Comunidade</th>
              <th class="py-2 pr-3">Rotulo</th>
              {% for column in columns %}
                <th class="py-2 pr-3" title="{{ column.title }}">{{ column.label }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for item in day.items %}
              {% with instance=item.instance %}
                <tr class="border-t border-black/5 {% if instance.status == 'canceled' %}text-slate{% endif %}">
                  <td class="py-2 pr-3">{{ instance.starts_at|date:"H:i" }}</td>
                  <td class="py-2 pr-3">{{ instance.community.code }}</td>
                  <td class="py-2 pr-3">{{ instance.liturgy_label|default:"Missa" }}</td>
                  {% for column in columns %}
                    {% with slot=item.slot_map|get_item:column.key %}
                      <td class="py-2 pr-3">
                        {% if instance.status == "canceled" %}
                          <span class="text-xs uppercase tracking-widest">Cancelada</span>
                        {% elif not slot %}
                          <span class="text-slate">N/A</span>
                        {% elif slot.externally_covered %}
                          <span class="text-xs uppercase tracking-widest">Externo</span>
                        {% elif not slot.required %}
                          <span class="text-slate">N/A</span>
                        {% else %}
                          {% with active=slot.active_assignment %}
                            {% if active %}
                              <a class="text-ink hover:underline" href="{% url 'mass_detail' instance.id %}">{{ active.acolyte.display_name }}</a>
                              {% if slot.is_locked %}
                                <span class="ml-2 badge">Consolidada</span>
                              {% endif %}
                            {% else %}
                              <a class="inline-flex items-center gap-2 px-2 py-1 rounded-lg bg-red-50 text-red-700 border border-red-200" href="{% url 'slot_assign' instance.id slot.id %}">
                                ABERTO
                              </a>
                              {% if slot.is_locked %}
                                <span class="ml-2 badge">Consolidada</span>
                              {% endif %}
                            {% endif %}
                          {% endwith %}
                        {% endif %}
                      </td>
                    {% endwith %}
                  {% endfor %}
                </tr>
              {% endwith %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  {% endfor %}
</div>

<script>
  document.querySelectorAll("[data-whatsapp-url]").forEach(function(btn) {
    btn.addEventListener("click", async function() {
      const url = btn.getAttribute("data-whatsapp-url");
      try {
        const response = await fetch(url, { credentials: "same-origin" });
        const text = await response.text();
        await navigator.clipboard.writeText(text);
        btn.textContent = "Copiado";
        setTimeout(() => { btn.textContent = "Copiar WhatsApp"; }, 1600);
      } catch (err) {
        alert("Nao foi possivel copiar. Abra o link e copie manualmente.");
      }
    });
  });
</script>
{% endblock %}
```

### templates\roster\open_slots.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Slots Abertos{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="card">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
      <div>
        <h2 class="font-serif text-xl">Slots Abertos</h2>
        <p class="text-sm text-slate">Preencha rapidamente posicoes em aberto</p>
      </div>
    </div>

    <div class="grid grid-cols-3 gap-4 mb-6">
      <div class="p-4 bg-red-50 border border-red-200 rounded-lg">
        <div class="text-2xl font-semibold text-red-700">{{ total_open_slots }}</div>
        <div class="text-sm text-red-600">Abertos</div>
      </div>
      <div class="p-4 bg-amber-50 border border-amber-200 rounded-lg">
        <div class="text-2xl font-semibold text-amber-700">{{ urgent_slots }}</div>
        <div class="text-sm text-amber-600">Urgentes</div>
      </div>
      <div class="p-4 bg-moss-50 border border-moss-200 rounded-lg">
        <div class="text-2xl font-semibold text-moss-700">{{ fill_rate }}%</div>
        <div class="text-sm text-moss-600">Preenchimento</div>
      </div>
    </div>

    <form method="get" class="grid sm:grid-cols-6 gap-3 mb-4">
      <div>
        <label class="label">Data inicio</label>
        <input type="date" name="start" value="{{ start_date|date:'Y-m-d' }}" class="input w-full">
      </div>
      <div>
        <label class="label">Data final</label>
        <input type="date" name="end" value="{{ end_date|date:'Y-m-d' }}" class="input w-full">
      </div>
      <div>
        <label class="label">Comunidade</label>
        <div class="custom-select">
          <input type="hidden" name="community" value="{{ community_id }}">
          <button type="button" class="custom-select-button">
            <span class="selected-text">
              {% if community_id %}
                {% for community in communities %}
                  {% if community_id|stringformat:"s" == community.id|stringformat:"s" %}{{ community.code }}{% endif %}
                {% endfor %}
              {% else %}
                Todas
              {% endif %}
            </span>
          </button>
          <div class="custom-select-options">
            <button type="button" class="custom-select-option {% if not community_id %}selected{% endif %}" data-value="">Todas</button>
            {% for community in communities %}
              <button type="button" class="custom-select-option {% if community_id|stringformat:"s" == community.id|stringformat:"s" %}selected{% endif %}" data-value="{{ community.id }}">{{ community.code }}</button>
            {% endfor %}
          </div>
        </div>
      </div>
      <div>
        <label class="label">Posicao</label>
        <div class="custom-select">
          <input type="hidden" name="position" value="{{ position_id }}">
          <button type="button" class="custom-select-button">
            <span class="selected-text">
              {% if position_id %}
                {% for position in positions %}
                  {% if position_id|stringformat:"s" == position.id|stringformat:"s" %}{{ position.name }}{% endif %}
                {% endfor %}
              {% else %}
                Todas
              {% endif %}
            </span>
          </button>
          <div class="custom-select-options">
            <button type="button" class="custom-select-option {% if not position_id %}selected{% endif %}" data-value="">Todas</button>
            {% for position in positions %}
              <button type="button" class="custom-select-option {% if position_id|stringformat:"s" == position.id|stringformat:"s" %}selected{% endif %}" data-value="{{ position.id }}">{{ position.name }}</button>
            {% endfor %}
          </div>
        </div>
      </div>
      <div class="flex items-end">
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="checkbox" name="urgent" value="1" {% if urgent_only %}checked{% endif %} class="rounded border-sand-200">
          <span class="text-sm">Urgentes</span>
        </label>
      </div>
      <div class="flex items-end">
        <button class="btn-primary w-full" type="submit">Filtrar</button>
      </div>
    </form>
  </div>

  <div id="slots-container">
    {% include "roster/_open_slots_table.html" %}
  </div>
</div>

<!-- Modal Container for HTMX -->
<div id="modal-container" class="hidden fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
    <div class="fixed inset-0 bg-ink/40 backdrop-blur-sm transition-opacity" aria-hidden="true" onclick="document.getElementById('modal-container').classList.add('hidden')"></div>
    <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
    <div class="inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-soft transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full border border-black/5">
      <!-- Modal content will be loaded here via HTMX -->
    </div>
  </div>
</div>
{% endblock %}
```

### templates\scheduling\_jobs_list.html
```html
{% load extras %}
<div class="card" id="schedule-jobs">
  <h3 class="font-semibold mb-3">Ultimos jobs</h3>
  <div class="space-y-2">
    {% for job in jobs %}
      <a class="border border-black/5 rounded-lg p-3 flex items-center justify-between hover:bg-sand" href="{% url 'schedule_job_detail' job.id %}">
        <div>
          <div class="text-sm text-slate">{{ job.created_at|date:"d/m H:i" }}</div>
          <div class="font-medium">{{ job.status|job_status_label }}</div>
        </div>
        <span class="badge">
          {{ job.summary_json.coverage|default:"-" }} coberturas
          {% if job.summary_json.unfilled_slots_count %}
            / {{ job.summary_json.unfilled_slots_count }} sem cobertura
          {% endif %}
        </span>
      </a>
    {% empty %}
      <p class="text-sm text-slate">Nenhum job executado ainda.</p>
    {% endfor %}
  </div>
</div>
```

### templates\scheduling\dashboard.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Escalonar{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <h2 class="font-serif text-xl mb-2">Gerar escala</h2>
    <p class="text-sm text-slate mb-4">Cria um job para otimizar os proximos {{ active_parish.horizon_days }} dias.</p>
    <form method="post" class="flex items-center gap-3">
      {% csrf_token %}
      <button class="btn-primary" name="action" value="run">Gerar / Recalcular</button>
    </form>
  </div>

  <div class="card">
    <h3 class="font-semibold mb-3">Publicar escala</h3>
    <div class="flex flex-wrap items-center gap-2 mb-4">
      {% for preset in publish_presets %}
        <a class="btn-secondary" href="?start_date={{ preset.start|date:'Y-m-d' }}&end_date={{ preset.end|date:'Y-m-d' }}">{{ preset.label }}</a>
      {% endfor %}
    </div>
    <form method="post" action="{% url 'scheduling_publish_preview' %}" class="grid sm:grid-cols-3 gap-3">
      {% csrf_token %}
      <div>
        <label class="label">Data inicial</label>
        <input type="date" name="start_date" value="{{ start_date|date:'Y-m-d' }}" />
      </div>
      <div>
        <label class="label">Data final</label>
        <input type="date" name="end_date" value="{{ end_date|date:'Y-m-d' }}" />
      </div>
      <div class="flex items-end">
        <button class="btn-secondary w-full">Revisar publicacao</button>
      </div>
    </form>
  </div>

  <div class="grid sm:grid-cols-2 gap-4">
    <div class="card">
      <div class="text-sm text-slate">Vagas abertas (consolidacao)</div>
      <div class="text-3xl font-serif">{{ urgent_open }}</div>
    </div>
    <div class="card">
      <div class="text-sm text-slate">Confirmacoes pendentes</div>
      <div class="text-3xl font-serif">{{ pending_confirmations }}</div>
    </div>
  </div>

  <div
    hx-get="{% url 'scheduling_dashboard' %}?partial=jobs"
    hx-trigger="load, every 5s"
    hx-swap="outerHTML"
  >
    {% include 'scheduling/_jobs_list.html' %}
  </div>
</div>
{% endblock %}
```

### templates\scheduling\job_detail.html
```html
{% extends 'base.html' %}
{% load extras %}
{% block title %}Detalhes do job{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <h2 class="font-serif text-xl mb-2">Job {{ job.id }}</h2>
    <div class="text-sm text-slate">Status: {{ job.status|job_status_label }}</div>
    <div class="text-sm text-slate">Criado: {{ job.created_at|date:"d/m H:i" }}</div>
    {% if job.started_at %}<div class="text-sm text-slate">Inicio: {{ job.started_at|date:"d/m H:i" }}</div>{% endif %}
    {% if job.finished_at %}<div class="text-sm text-slate">Fim: {{ job.finished_at|date:"d/m H:i" }}</div>{% endif %}
  </div>

  <div class="card grid sm:grid-cols-3 gap-4">
    <div>
      <div class="text-xs uppercase text-slate">Cobertura</div>
      <div class="font-medium">{{ summary.coverage|default:"-" }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">Preferencia</div>
      <div class="font-medium">{{ summary.preference_score|default:"-" }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">Fairness</div>
      <div class="font-medium">{{ summary.fairness_std|default:"-" }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">Mudancas</div>
      <div class="font-medium">{{ summary.changes|default:"-" }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">Slots exigidos</div>
      <div class="font-medium">{{ summary.required_slots_count|default:"-" }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">Sem cobertura</div>
      <div class="font-medium">{{ summary.unfilled_slots_count|default:"0" }}</div>
    </div>
  </div>

  {% if unfilled %}
    <div class="card">
      <h3 class="font-semibold mb-3">Slots sem cobertura</h3>
      <div class="space-y-2">
        {% for item in unfilled %}
          <div class="border border-black/5 rounded-lg p-3">
            <div class="font-medium">{{ item.starts_at }}</div>
            <div class="text-sm text-slate">
              {% if item.community %}
                {{ item.community.code }} - {{ item.community.name }}
              {% else %}
                Comunidade nao informada
              {% endif %}
              {% if item.position %} | {{ item.position.name }}{% endif %}
              {% if item.slot_index %} ({{ item.slot_index }}){% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  {% endif %}

  {% url 'scheduling_dashboard' as fallback_url %}
  <a class="btn-secondary" href="{{ back_url|default:fallback_url }}">Voltar</a>
</div>
{% endblock %}
```

### templates\scheduling\publish_preview.html
```html
{% extends 'base.html' %}
{% block title %}Confirmar publicacao{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card">
    <h2 class="font-serif text-xl mb-2">Confirmar publicacao</h2>
    <p class="text-sm text-slate">Revise os impactos antes de publicar.</p>
  </div>

  <div class="card grid sm:grid-cols-2 gap-4">
    <div>
      <div class="text-xs uppercase text-slate">Periodo</div>
      <div class="font-medium">{{ start_date|date:"d/m/Y" }} a {{ end_date|date:"d/m/Y" }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">Escalas a publicar</div>
      <div class="font-medium">{{ assignments_count }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">Acolitos impactados</div>
      <div class="font-medium">{{ acolytes_count }}</div>
    </div>
    <div>
      <div class="text-xs uppercase text-slate">E-mails previstos</div>
      <div class="font-medium">{{ emails_count }}</div>
    </div>
    <div class="sm:col-span-2">
      <div class="text-xs uppercase text-slate">Vagas abertas no periodo</div>
      <div class="font-medium">{{ open_slots_count }}</div>
      {% if open_slots_count %}
        <p class="text-sm text-slate mt-1">Existem vagas abertas. Voce pode publicar mesmo assim, mas algumas confirmacoes ficarao pendentes.</p>
      {% endif %}
    </div>
  </div>

  <form method="post" action="{% url 'scheduling_publish_apply' %}" class="flex items-center gap-3">
    {% csrf_token %}
    <input type="hidden" name="start_date" value="{{ start_date|date:'Y-m-d' }}" />
    <input type="hidden" name="end_date" value="{{ end_date|date:'Y-m-d' }}" />
    <button class="btn-primary" type="submit">Confirmar publicacao</button>
    <a class="btn-secondary" href="{% url 'scheduling_dashboard' %}">Cancelar</a>
  </form>
</div>
{% endblock %}
```

### templates\settings\parish.html
```html
{% extends 'base.html' %}
{% block title %}Configuracoes{% endblock %}
{% block content %}
<div class="grid gap-6">
  <div class="card max-w-3xl">
    <h2 class="font-serif text-xl mb-2">Configuracoes da paroquia</h2>
    <p class="text-sm text-slate">Ajuste janelas de consolidacao, pesos e regras operacionais.</p>
  </div>

  <form method="post" class="card max-w-3xl space-y-6">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="label">Consolidacao (dias)</label>
        {{ form.consolidation_days }}
        <p class="text-xs text-slate mt-1">Ate quantos dias no futuro os acolitos podem confirmar presenca (7-90).</p>
      </div>
      <div>
        <label class="label">Horizonte (dias)</label>
        {{ form.horizon_days }}
        {% if form.horizon_days.errors %}
          <p class="text-xs text-red-600 mt-1">{{ form.horizon_days.errors|join:", " }}</p>
        {% endif %}
        <p class="text-xs text-slate mt-1">Intervalo maximo para gerar escalas futuras.</p>
      </div>
      <div>
        <label class="label">Duracao padrao da missa (min)</label>
        {{ form.default_mass_duration_minutes }}
      </div>
      <div>
        <label class="label">Descanso minimo entre missas (min)</label>
        {{ form.min_rest_minutes_between_masses }}
      </div>
    </div>

    <div class="check-grid">
      <label class="check-item">
        {{ form.swap_requires_approval }}
        <span class="text-sm">Exigir aprovacao da coordenacao para trocas</span>
      </label>
      <label class="check-item">
        {{ form.claim_require_coordination }}
        <span class="text-sm">Exigir aprovacao da coordenacao para transferencias</span>
      </label>
      <label class="check-item">
        {{ form.notify_on_cancellation }}
        <span class="text-sm">Notificar coordenacao em cancelamentos</span>
      </label>
      <label class="check-item">
        {{ form.auto_assign_on_decline }}
        <span class="text-sm">Auto atribuir substituto ao recusar</span>
      </label>
      <label class="check-item">
        {{ form.claim_auto_approve_enabled }}
        <span class="text-sm">Auto aprovar solicitacoes sem resposta</span>
      </label>
    </div>

    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="label">Auto aprovar antes da missa (horas)</label>
        {{ form.claim_auto_approve_hours }}
        <p class="text-xs text-slate mt-1">Se o titular nao confirmar ate este prazo.</p>
      </div>
    </div>

    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="label">Penalidade de estabilidade</label>
        {{ form.stability_penalty }}
      </div>
      <div>
        <label class="label">Penalidade de fairness</label>
        {{ form.fairness_penalty }}
      </div>
      <div>
        <label class="label">Peso de credito</label>
        {{ form.credit_weight }}
      </div>
      <div>
        <label class="label">Penalidade reserva tecnica</label>
        {{ form.reserve_penalty }}
        <p class="text-xs text-slate mt-1">Usado para acolitos marcados como reserva.</p>
      </div>
      <div>
        <label class="label">Tempo maximo do solver (s)</label>
        {{ form.max_solve_seconds }}
      </div>
      <div>
        <label class="label">Maximo por semana</label>
        {{ form.max_services_per_week }}
      </div>
      <div>
        <label class="label">Maximo fins de semana seguidos</label>
        {{ form.max_consecutive_weekends }}
      </div>
      <div>
        <label class="label">Penalidade de rotacao</label>
        {{ form.rotation_penalty }}
      </div>
      <div>
        <label class="label">Janela de rotacao (dias)</label>
        {{ form.rotation_days }}
      </div>
      <div>
        <label class="label">Bonus comunidade de origem</label>
        {{ form.home_community_bonus }}
      </div>
      <div>
        <label class="label">Penalidade comunidade recente</label>
        {{ form.community_recent_penalty }}
      </div>
      <div>
        <label class="label">Janela comunidade recente (dias)</label>
        {{ form.community_recent_window_days }}
      </div>
      <div>
        <label class="label">Bonus de escassez</label>
        {{ form.scarcity_bonus }}
      </div>
      <div>
        <label class="label">Fator comunidade em eventos</label>
        {{ form.event_series_community_factor }}
      </div>
      <div>
        <label class="label">Politica para missa avulsa</label>
        {{ form.single_mass_community_policy }}
      </div>
      <div>
        <label class="label">Prazo de interesse (horas)</label>
        {{ form.interest_deadline_hours }}
      </div>
      <div>
        <label class="label">Fallback pool interessados</label>
        {{ form.interested_pool_fallback }}
      </div>
    </div>

    <details class="border border-black/5 rounded-xl p-4">
      <summary class="cursor-pointer font-medium">Avancado: JSON de pesos</summary>
      <div class="mt-3">
        <label class="label">schedule_weights</label>
        {{ form.schedule_weights_json }}
        {% if form.schedule_weights_json.errors %}
          <p class="text-xs text-red-600 mt-1">{{ form.schedule_weights_json.errors|join:", " }}</p>
        {% endif %}
        <p class="text-xs text-slate mt-1">Use apenas se precisar ajustar pesos nao listados acima.</p>
      </div>
    </details>

    <div class="flex items-center gap-3">
      <button class="btn-primary" type="submit">Salvar configuracoes</button>
      <button class="btn-secondary" type="submit" name="action" value="reset">Restaurar padroes</button>
      <a class="btn-secondary" href="{% url 'dashboard' %}">Voltar</a>
    </div>
  </form>
</div>
{% endblock %}
```

### templates\structure\communities_form.html
```html
{% extends 'base.html' %}
{% block title %}{% if community %}Editar comunidade{% else %}Nova comunidade{% endif %}{% endblock %}
{% block content %}
<div class="card max-w-2xl">
  <h2 class="font-serif text-xl mb-4">{% if community %}Editar comunidade{% else %}Nova comunidade{% endif %}</h2>
  <form method="post" class="space-y-4">
    {% csrf_token %}
    {{ form.non_field_errors }}
    {% if next_url %}
      <input type="hidden" name="next" value="{{ next_url }}">
    {% endif %}
    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="label">Codigo</label>
        {{ form.code }}
        <p class="text-xs text-slate mt-1">Use um codigo curto para aparecer na agenda (ex.: MAT).</p>
      </div>
      <div>
        <label class="label">Nome</label>
        {{ form.name }}
      </div>
      <div class="sm:col-span-2">
        <label class="label">Endereco</label>
        {{ form.address }}
      </div>
      <div class="sm:col-span-2">
        <div class="custom-checkbox">
          <input type="checkbox" id="{{ form.active.id_for_label }}" name="{{ form.active.name }}" class="checkbox-input" {% if form.active.value %}checked{% endif %}>
          <label for="{{ form.active.id_for_label }}" class="checkbox-label">
            <svg class="checkbox-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </label>
          <label for="{{ form.active.id_for_label }}" class="checkbox-text">
            <div class="checkbox-title">Comunidade ativa</div>
            <p class="checkbox-description">Quando ativa, a comunidade pode ser selecionada para eventos e missas.</p>
          </label>
        </div>
      </div>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <button class="btn-primary">Salvar</button>
      <a class="btn-secondary" href="{% url 'structure_communities_list' %}">Voltar</a>
    </div>
  </form>
</div>
{% endblock %}
```

### templates\structure\communities_list.html
```html
{% extends 'base.html' %}
{% block title %}Comunidades{% endblock %}
{% block content %}
<div class="card">
  <div class="flex items-center justify-between mb-4">
    <h2 class="font-serif text-xl">Comunidades</h2>
    <a class="btn-primary" href="{% url 'structure_community_create' %}">Nova comunidade</a>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="text-left text-slate">
          <th class="py-2 pr-4">Codigo</th>
          <th class="py-2 pr-4">Nome</th>
          <th class="py-2 pr-4">Status</th>
          <th class="py-2">Acoes</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-black/5">
        {% for community in communities %}
          <tr>
            <td class="py-2 pr-4">{{ community.code }}</td>
            <td class="py-2 pr-4">
              <a class="text-ink hover:underline" href="{% url 'structure_community_edit' community.id %}">{{ community.name }}</a>
            </td>
            <td class="py-2 pr-4">{{ community.active|yesno:"ativo,inativo" }}</td>
            <td class="py-2">
              <div class="flex items-center gap-2">
                <a class="btn-secondary" href="{% url 'structure_community_edit' community.id %}">Editar</a>
                <form method="post" action="{% url 'structure_community_toggle' community.id %}">
                  {% csrf_token %}
                  <button class="btn-secondary" type="submit">
                    {% if community.active %}Desativar{% else %}Ativar{% endif %}
                  </button>
                </form>
              </div>
            </td>
          </tr>
        {% empty %}
          <tr><td class="py-2 text-slate" colspan="4">Nenhuma comunidade cadastrada.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
```

### templates\structure\requirement_profiles_form.html
```html
{% extends 'base.html' %}
{% block title %}{% if profile %}Editar perfil{% else %}Novo perfil{% endif %}{% endblock %}
{% block content %}
<div class="space-y-8">
  <div>
    <h1 class="font-serif text-3xl text-moss mb-2">{% if profile %}Editar perfil{% else %}Criar perfil{% endif %}</h1>
    <p class="text-slate">Configure um perfil de requisitos para definir quantas funções cada missa necessita.</p>
  </div>

  <form method="post" class="card">
    {% csrf_token %}
    {% if form.non_field_errors %}
      <div class="form-error">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
        </svg>
        {{ form.non_field_errors }}
      </div>
    {% endif %}
    {% if formset.non_form_errors %}
      <div class="form-error">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
        </svg>
        {{ formset.non_form_errors }}
      </div>
    {% endif %}
    {% if next_url %}
      <input type="hidden" name="next" value="{{ next_url }}">
    {% endif %}

    <div class="grid sm:grid-cols-2 gap-6">
      <div>
        <label class="label">Nome do perfil</label>
        {{ form.name }}
        {% if form.name.errors %}
          <div class="form-error">{{ form.name.errors.0 }}</div>
        {% endif %}
      </div>
      <div>
        <label class="label">Mínimo de seniors por missa</label>
        {{ form.min_senior_per_mass }}
        {% if form.min_senior_per_mass.errors %}
          <div class="form-error">{{ form.min_senior_per_mass.errors.0 }}</div>
        {% endif %}
      </div>
      <div class="sm:col-span-2">
        <label class="label">Notas</label>
        {{ form.notes }}
        {% if form.notes.errors %}
          <div class="form-error">{{ form.notes.errors.0 }}</div>
        {% endif %}
      </div>
      <div class="sm:col-span-2 mt-6">
        <div class="custom-checkbox">
          <input type="checkbox" id="{{ form.active.id_for_label }}" name="{{ form.active.name }}" class="checkbox-input" {% if form.active.value %}checked{% endif %}>
          <label for="{{ form.active.id_for_label }}" class="checkbox-label">
            <svg class="checkbox-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </label>
          <label for="{{ form.active.id_for_label }}" class="checkbox-text">
            <div class="checkbox-title">Perfil ativo</div>
            <p class="checkbox-description">Habilita o perfil de requisitos para uso em escalas automáticas.</p>
          </label>
        </div>
      </div>
      </div>
    </div>

    <div class="mt-8 card">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-8 h-8 bg-moss/10 rounded-lg flex items-center justify-center">
          <svg class="w-5 h-5 text-moss" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
          </svg>
        </div>
        <div>
          <h3 class="font-semibold text-lg text-ink">Composição do perfil</h3>
          <p class="text-sm text-slate">Defina as funções e quantidades necessárias para cada missa</p>
        </div>
      </div>

      {{ formset.management_form }}
      <div class="space-y-4" id="profile-rows">
        {% for form in formset %}
          <div class="border border-black/8 rounded-xl p-5 bg-sand/20 profile-row">
            <div class="grid sm:grid-cols-[2fr_1fr_auto] gap-4 items-end">
              <div>
                <label class="label">Função na escala</label>
                <div class="custom-select">
                  <input type="hidden" name="{{ form.position_type.name }}" value="{{ form.position_type.value }}">
                  <button type="button" class="custom-select-button">
                    <span class="selected-text">
                      {% if form.position_type.value %}
                        {% for choice_value, choice_label in form.position_type.field.choices %}
                          {% if form.position_type.value == choice_value %}{{ choice_label }}{% endif %}
                        {% endfor %}
                      {% else %}
                        Selecionar função...
                      {% endif %}
                    </span>
                  </button>
                  <div class="custom-select-options">
                    {% for choice_value, choice_label in form.position_type.field.choices %}
                      <button type="button" class="custom-select-option {% if form.position_type.value == choice_value %}selected{% endif %}" data-value="{{ choice_value }}">{{ choice_label }}</button>
                    {% endfor %}
                  </div>
                </div>
              </div>
              <div>
                <label class="label">Quantidade</label>
                {{ form.quantity }}
              </div>
              <div class="flex items-center gap-2">
                {% if form.DELETE %}
                  <label class="inline-flex items-center gap-2 text-sm text-slate cursor-pointer hover:text-red-600 transition-colors">
                    {{ form.DELETE }}
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                    Remover
                  </label>
                {% endif %}
              </div>
            </div>
            {{ form.id }}
          </div>
        {% endfor %}
      </div>

      <div class="mt-6 pt-4 border-t border-black/5">
        <button type="button" class="btn-secondary inline-flex items-center gap-2" id="add-role-row">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
          </svg>
          Adicionar função
        </button>
      </div>
    </div>

    <div class="mt-8 flex items-center justify-between pt-6 border-t border-black/5">
      <a class="btn-secondary" href="{% url 'structure_requirement_profiles_list' %}">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        Voltar
      </a>
      <button class="btn-primary">Salvar perfil</button>
    </div>
  </form>
</div>

<template id="empty-form-template">
  <div class="border border-black/8 rounded-xl p-5 bg-sand/20 profile-row">
    <div class="grid sm:grid-cols-[2fr_1fr_auto] gap-4 items-end">
      <div>
        <label class="label">Função na escala</label>
        <div class="custom-select">
          <input type="hidden" name="{{ formset.empty_form.position_type.name }}" value="">
          <button type="button" class="custom-select-button">
            <span class="selected-text">Selecionar função...</span>
          </button>
          <div class="custom-select-options">
            {% for choice_value, choice_label in formset.empty_form.position_type.field.choices %}
              <button type="button" class="custom-select-option" data-value="{{ choice_value }}">{{ choice_label }}</button>
            {% endfor %}
          </div>
        </div>
      </div>
      <div>
        <label class="label">Quantidade</label>
        {{ formset.empty_form.quantity }}
      </div>
      <div class="flex items-center gap-2">
        <label class="inline-flex items-center gap-2 text-sm text-slate cursor-pointer hover:text-red-600 transition-colors">
          {{ formset.empty_form.DELETE }}
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
          </svg>
          Remover
        </label>
      </div>
    </div>
    {{ formset.empty_form.id }}
  </div>
</template>

<script>
  (function () {
    const addButton = document.getElementById("add-role-row");
    const container = document.getElementById("profile-rows");
    const totalInput = document.getElementById("id_positions-TOTAL_FORMS");
    const template = document.getElementById("empty-form-template");
    if (!addButton || !container || !totalInput || !template) return;
    addButton.addEventListener("click", () => {
      const index = parseInt(totalInput.value, 10);
      const clone = template.innerHTML.replace(/__prefix__/g, index);
      const wrapper = document.createElement("div");
      wrapper.innerHTML = clone;
      container.appendChild(wrapper.firstElementChild);
      totalInput.value = index + 1;
    });
  })();
</script>
{% endblock %}
```

### templates\structure\requirement_profiles_list.html
```html
{% extends 'base.html' %}
{% block title %}Perfis de requisitos{% endblock %}
{% block content %}
<div class="card">
  <div class="flex items-center justify-between mb-4">
    <h2 class="font-serif text-xl">Perfis de requisitos</h2>
    <a class="btn-primary" href="{% url 'requirement_profile_create' %}">Criar perfil</a>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="text-left text-slate">
          <th class="py-2 pr-4">Nome</th>
          <th class="py-2 pr-4">Funcoes</th>
          <th class="py-2 pr-4">Min. senior</th>
          <th class="py-2 pr-4">Status</th>
          <th class="py-2">Acoes</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-black/5">
        {% for profile in profiles %}
          <tr>
            <td class="py-2 pr-4">
              <a class="text-ink hover:underline" href="{% url 'structure_requirement_profile_edit' profile.id %}">
                {{ profile.name }}
              </a>
            </td>
            <td class="py-2 pr-4">{{ profile.position_count }}</td>
            <td class="py-2 pr-4">{{ profile.min_senior_per_mass }}</td>
            <td class="py-2 pr-4">{{ profile.active|yesno:"ativo,inativo" }}</td>
            <td class="py-2">
              <div class="flex items-center gap-2">
                <a class="btn-secondary" href="{% url 'structure_requirement_profile_edit' profile.id %}">Editar</a>
                <form method="post" action="{% url 'structure_requirement_profile_toggle' profile.id %}">
                  {% csrf_token %}
                  <button class="btn-secondary" type="submit">
                    {% if profile.active %}Desativar{% else %}Ativar{% endif %}
                  </button>
                </form>
              </div>
            </td>
          </tr>
        {% empty %}
          <tr><td class="py-2 text-slate" colspan="5">Nenhum perfil cadastrado.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
```

### templates\structure\roles_form.html
```html
{% extends 'base.html' %}
{% block title %}{% if role %}Editar funcao{% else %}Nova funcao{% endif %}{% endblock %}
{% block content %}
<div class="card max-w-3xl">
  <h2 class="font-serif text-xl mb-4">{% if role %}Editar funcao{% else %}Nova funcao{% endif %}</h2>
  <form method="post" class="space-y-4">
    {% csrf_token %}
    {{ form.non_field_errors }}
    {% if next_url %}
      <input type="hidden" name="next" value="{{ next_url }}">
    {% endif %}
    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="label">Nome</label>
        {{ form.name }}
        <p class="text-xs text-slate mt-1">Nome exibido na escala e nos perfis.</p>
      </div>
      <div>
        <label class="label">Codigo (opcional)</label>
        {{ form.code }}
        <p class="text-xs text-slate mt-1">Se vazio, geramos automaticamente. Use ate 10 caracteres.</p>
      </div>
      <div class="sm:col-span-2">
        <div class="custom-checkbox">
          <input type="checkbox" id="{{ form.active.id_for_label }}" name="{{ form.active.name }}" class="checkbox-input" {% if form.active.value %}checked{% endif %}>
          <label for="{{ form.active.id_for_label }}" class="checkbox-label">
            <svg class="checkbox-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
          </label>
          <label for="{{ form.active.id_for_label }}" class="checkbox-text">
            <div class="checkbox-title">Função ativa</div>
            <p class="checkbox-description">Permite que a função seja atribuída em escalas e apareça nas opções disponíveis.</p>
          </label>
        </div>
      </div>
    </div>
    <details class="mt-2 rounded-xl border border-black/5 bg-white/70 px-4 py-3">
      <summary class="cursor-pointer text-sm font-medium text-ink">Composicao avancada</summary>
      <p class="text-xs text-slate mt-1">As funcoes indicam as habilidades exigidas para esta vaga.</p>
      <div class="mt-4">
        <label class="label">Funcoes adicionais</label>
        {% if form.extra_functions.errors %}
          <div class="text-xs text-red-600 mt-1">{{ form.extra_functions.errors }}</div>
        {% endif %}
        <div class="check-grid text-sm">
          {% for option in form.extra_functions %}
            <label class="check-item">
              {{ option.tag }}
              <span class="text-ink">{{ option.choice_label }}</span>
            </label>
          {% endfor %}
        </div>
        <p class="form-help">{{ form.extra_functions.help_text }}</p>
      </div>
    </details>
    <div class="flex items-center gap-3">
      <button class="btn-primary">Salvar</button>
      <a class="btn-secondary" href="{% url 'structure_roles_list' %}">Voltar</a>
    </div>
  </form>
</div>
{% endblock %}
```

### templates\structure\roles_list.html
```html
{% extends 'base.html' %}
{% block title %}Funcoes na escala{% endblock %}
{% block content %}
<div class="card">
  <div class="flex items-center justify-between mb-4">
    <div>
      <h2 class="font-serif text-xl">Funcoes na escala</h2>
      {% if inactive_count %}
        <a class="text-xs text-slate hover:text-ink" href="{% if show_inactive %}{% url 'structure_roles_list' %}{% else %}?show_inactive=1{% endif %}">
          {% if show_inactive %}Ocultar inativas{% else %}Mostrar inativas ({{ inactive_count }}){% endif %}
        </a>
      {% endif %}
    </div>
    <a class="btn-primary" href="{% url 'structure_role_create' %}">Adicionar funcao</a>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="text-left text-slate">
          <th class="py-2 pr-4">Codigo</th>
          <th class="py-2 pr-4">Nome</th>
          <th class="py-2 pr-4">Composicao</th>
          <th class="py-2 pr-4">Status</th>
          <th class="py-2">Acoes</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-black/5">
        {% for role in roles %}
          <tr>
            <td class="py-2 pr-4">{{ role.code }}</td>
            <td class="py-2 pr-4">
              <a class="text-ink hover:underline" href="{% url 'structure_role_edit' role.id %}">{{ role.name }}</a>
            </td>
            <td class="py-2 pr-4 text-xs text-slate">
              {% if role.functions.all %}
                {% for fn in role.functions.all %}
                  {{ fn.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              {% else %}
                -
              {% endif %}
            </td>
            <td class="py-2 pr-4">{{ role.active|yesno:"ativo,inativo" }}</td>
            <td class="py-2">
              <div class="flex items-center gap-2">
                <a class="btn-secondary" href="{% url 'structure_role_edit' role.id %}">Editar</a>
                <form method="post" action="{% url 'structure_role_toggle' role.id %}">
                  {% csrf_token %}
                  <button class="btn-secondary" type="submit">
                    {% if role.active %}Desativar{% else %}Ativar{% endif %}
                  </button>
                </form>
                <form method="post" action="{% url 'structure_role_delete' role.id %}" onsubmit="return confirm('Excluir esta funcao? Essa acao nao pode ser desfeita.');">
                  {% csrf_token %}
                  <button class="text-xs font-medium text-red-600 hover:text-red-700" type="submit">Excluir</button>
                </form>
              </div>
            </td>
          </tr>
        {% empty %}
          <tr><td class="py-2 text-slate" colspan="5">Nenhuma funcao cadastrada.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
```

### templates\base.html
```html
{% load static %}
{% load extras %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Acoli{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ["Alegreya Sans", "sans-serif"],
            serif: ["Fraunces", "serif"],
          },
          colors: {
            ink: "#0b1f26",
            slate: "#5a6a72",
            sand: "#f3efe6",
            moss: "#0f5e4d",
            sun: "#d9a441",
          },
          boxShadow: {
            soft: "0 12px 30px rgba(10, 24, 32, 0.12)",
          },
        },
      },
    };
  </script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Alegreya+Sans:wght@400;500;600;700&family=Fraunces:wght@600;700&display=swap" />
  <link rel="stylesheet" href="{% static 'css/app.css' %}" />
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body class="bg-white text-ink min-h-screen" hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
  <div class="absolute inset-0 pointer-events-none"></div>
  <div class="relative">
    <header class="sticky top-0 z-40 bg-white/90 backdrop-blur-md border-b border-black/8 shadow-soft">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-20">
          <div class="flex items-center gap-6">
            <a href="{% url 'dashboard' %}" class="font-serif text-2xl text-moss hover:text-sun transition-colors duration-200">Acoli</a>
            {% if active_parish %}
              <div class="hidden sm:flex items-center text-sm text-slate border-l border-black/10 pl-6">
                <span class="font-medium text-ink">{{ active_parish.name }}</span>
                <span class="mx-3 text-black/20">•</span>
                <span>{{ active_parish.city }}</span>
              </div>
            {% endif %}
          </div>
          <div class="flex items-center gap-4">
            {% if request.user.is_authenticated %}
              <div class="flex items-center gap-2">
                <span class="inline-flex h-8 w-8 items-center justify-center rounded-full border border-sand-200 bg-sand-100 text-xs font-semibold text-ink">
                  {{ request.user.full_name|default:request.user.email|initials }}
                </span>
                <span class="hidden sm:block max-w-[160px] truncate text-sm font-medium text-ink">
                  {{ request.user.full_name|default:request.user.email }}
                </span>
              </div>
              {% if request.resolver_match and request.resolver_match.url_name == "dashboard" and is_admin and acolyte %}
                <div class="inline-flex rounded-full border border-sand-200 bg-sand-50 p-1 text-[11px] font-medium sm:text-xs">
                  <a
                    href="?view=admin"
                    class="rounded-full px-2 py-1 transition-colors sm:px-3 {% if dashboard_view == 'admin' %}bg-white text-ink shadow-sm{% else %}text-slate hover:text-ink{% endif %}">
                    Admin
                  </a>
                  <a
                    href="?view=acolyte"
                    class="rounded-full px-2 py-1 transition-colors sm:px-3 {% if dashboard_view == 'acolyte' %}bg-white text-ink shadow-sm{% else %}text-slate hover:text-ink{% endif %}">
                    Acolito
                  </a>
                </div>
              {% endif %}
            {% endif %}
            {% if parish_memberships %}
              <div class="relative group">
                <button class="text-sm px-4 py-2 rounded-xl border border-black/12 bg-white/80 hover:bg-white hover:border-black/20 transition-all duration-200 shadow-sm hover:shadow-md">Trocar paroquia</button>
                <div class="absolute right-0 mt-3 w-64 bg-white shadow-soft rounded-xl p-3 hidden group-hover:block border border-black/5">
                  {% for membership in parish_memberships %}
                    <a class="block text-sm px-4 py-3 rounded-lg hover:bg-sand transition-colors duration-150" href="{% url 'switch_parish' membership.parish_id %}">{{ membership.parish.name }}</a>
                  {% endfor %}
                </div>
              </div>
            {% endif %}
            {% if request.user.is_authenticated %}
              <a class="text-sm text-slate hover:text-ink transition-colors duration-200" href="{% url 'logout_confirm' %}">Sair</a>
            {% endif %}
          </div>
        </div>
      </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 grid lg:grid-cols-[220px_1fr] gap-6">
      <nav class="hidden lg:flex flex-col gap-3 text-sm bg-white/50 backdrop-blur-sm rounded-2xl p-6 shadow-soft border border-white/20">
        <a class="nav-link" href="{% url 'dashboard' %}">Painel</a>
        <a class="nav-link" href="{% url 'calendar_month' %}">Calendario</a>
        <a class="nav-link" href="{% url 'my_assignments' %}">Minhas escalas</a>
        <a class="nav-link" href="{% url 'my_preferences' %}">Preferencias</a>
        <a class="nav-link" href="{% url 'swap_requests' %}">Trocas</a>
        <a class="nav-link" href="{% url 'event_interest' %}">Eventos</a>
        {% if can_manage_parish %}
          <div class="pt-6 text-xs uppercase tracking-widest text-slate font-medium border-t border-black/10 mt-4">Administração</div>
          <a class="nav-link" href="{% url 'people_directory' %}">Pessoas</a>
          <a class="nav-link" href="{% url 'template_list' %}">Horarios fixos</a>
          <a class="nav-link" href="{% url 'event_series_list' %}">Programacao liturgica</a>
          <a class="nav-link" href="{% url 'roster_view' %}">Escala geral</a>
          <a class="nav-link" href="{% url 'roster_open_slots' %}">Slots abertos</a>
          <a class="nav-link" href="{% url 'scheduling_dashboard' %}">Escalonar</a>
          <a class="nav-link" href="{% url 'replacement_center' %}">Substituicoes</a>
          <a class="nav-link" href="{% url 'reports_frequency' %}">Relatorios</a>
          <a class="nav-link" href="{% url 'audit_log' %}">Auditoria</a>
          <div class="pt-4 text-xs uppercase tracking-widest text-slate font-medium border-t border-black/10 mt-4">Estrutura</div>
          <a class="nav-link" href="{% url 'structure_communities_list' %}">Comunidades</a>
          <a class="nav-link" href="{% url 'structure_roles_list' %}">Funcoes na escala</a>
          <a class="nav-link" href="{% url 'structure_requirement_profiles_list' %}">Perfis de requisitos</a>
          <a class="nav-link" href="{% url 'parish_settings' %}">Configuracoes</a>
        {% endif %}
      </nav>

      <main>
        <!-- Toast Notifications Container -->
        <div id="toast-container" class="fixed top-24 right-6 z-50 space-y-2 pointer-events-none">
          <!-- Toasts will be injected here -->
        </div>
        {% include 'partials/_messages.html' %}

        {% block content %}{% endblock %}
      </main>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="fixed bottom-0 inset-x-0 bg-white/95 backdrop-blur-md border-t border-black/8 flex sm:hidden justify-around py-2.5 text-xs z-40">
      <a href="{% url 'dashboard' %}" class="flex flex-col items-center gap-0.5 px-4 py-1.5 rounded-lg transition-colors duration-150 {% if request.resolver_match.url_name == 'dashboard' %}text-moss{% else %}text-ink{% endif %}">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
        </svg>
        <span class="font-medium">Painel</span>
      </a>
      <a href="{% url 'my_assignments' %}" class="flex flex-col items-center gap-0.5 px-4 py-1.5 rounded-lg transition-colors duration-150 {% if request.resolver_match.url_name == 'my_assignments' %}text-moss{% else %}text-ink{% endif %}">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
        </svg>
        <span class="font-medium">Escalas</span>
      </a>
      <a href="{% url 'event_interest' %}" class="flex flex-col items-center gap-0.5 px-4 py-1.5 rounded-lg transition-colors duration-150 {% if request.resolver_match.url_name == 'event_interest' %}text-moss{% else %}text-ink{% endif %}">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
        </svg>
        <span class="font-medium">Eventos</span>
      </a>
      <button id="mobile-more-btn" type="button" aria-expanded="false" aria-controls="mobile-more-sheet" class="flex flex-col items-center gap-0.5 px-4 py-1.5 rounded-lg transition-colors duration-150 text-ink">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z" />
        </svg>
        <span class="font-medium">Mais</span>
      </button>
    </nav>

    <!-- Mobile Bottom Sheet -->
    <div id="mobile-more-backdrop" class="fixed inset-0 bg-black/20 backdrop-blur-sm z-40 hidden sm:hidden opacity-0 transition-opacity duration-200" aria-hidden="true"></div>
    <div id="mobile-more-sheet" role="dialog" aria-modal="true" aria-label="Menu adicional" class="fixed inset-x-0 bottom-0 z-50 sm:hidden translate-y-full transition-transform duration-200 ease-out">
      <div class="bg-white/95 backdrop-blur-md rounded-t-2xl shadow-soft border-t border-black/8 pb-20">
        <!-- Drag handle -->
        <div class="flex justify-center pt-3 pb-2">
          <div class="w-10 h-1 bg-black/10 rounded-full"></div>
        </div>
        <!-- Menu items -->
        <div class="px-6 pb-4 space-y-1">
          <a href="{% url 'calendar_month' %}" class="flex items-center gap-4 px-4 py-3 rounded-xl transition-colors duration-150 {% if request.resolver_match.url_name == 'calendar_month' %}bg-moss-50 text-moss{% else %}text-ink hover:bg-sand/60{% endif %}">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z" />
            </svg>
            <span class="font-medium">Calendario</span>
          </a>
          <a href="{% url 'my_preferences' %}" class="flex items-center gap-4 px-4 py-3 rounded-xl transition-colors duration-150 {% if request.resolver_match.url_name == 'my_preferences' %}bg-moss-50 text-moss{% else %}text-ink hover:bg-sand/60{% endif %}">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span class="font-medium">Preferencias</span>
          </a>
          <a href="{% url 'swap_requests' %}" class="flex items-center gap-4 px-4 py-3 rounded-xl transition-colors duration-150 {% if request.resolver_match.url_name == 'swap_requests' %}bg-moss-50 text-moss{% else %}text-ink hover:bg-sand/60{% endif %}">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" />
            </svg>
            <span class="font-medium">Trocas</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Mobile Bottom Sheet JS -->
    <script>
    (function() {
      const btn = document.getElementById('mobile-more-btn');
      const sheet = document.getElementById('mobile-more-sheet');
      const backdrop = document.getElementById('mobile-more-backdrop');
      if (!btn || !sheet || !backdrop) return;

      function openSheet() {
        backdrop.classList.remove('hidden');
        requestAnimationFrame(() => {
          backdrop.classList.remove('opacity-0');
          backdrop.classList.add('opacity-100');
          sheet.classList.remove('translate-y-full');
          sheet.classList.add('translate-y-0');
        });
        btn.setAttribute('aria-expanded', 'true');
      }

      function closeSheet() {
        backdrop.classList.remove('opacity-100');
        backdrop.classList.add('opacity-0');
        sheet.classList.remove('translate-y-0');
        sheet.classList.add('translate-y-full');
        btn.setAttribute('aria-expanded', 'false');
        setTimeout(() => backdrop.classList.add('hidden'), 200);
      }

      function toggle() {
        const isOpen = btn.getAttribute('aria-expanded') === 'true';
        isOpen ? closeSheet() : openSheet();
      }

      btn.addEventListener('click', toggle);
      backdrop.addEventListener('click', closeSheet);
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && btn.getAttribute('aria-expanded') === 'true') closeSheet();
      });
    })();
    </script>
   </div>

   <!-- Global Confirmation Modal -->
   <div id="confirm-modal" class="hidden fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
     <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
       <div class="fixed inset-0 bg-ink/40 backdrop-blur-sm transition-opacity" aria-hidden="true" onclick="window.closeConfirmModal()"></div>
       <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
       <div class="inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-soft transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full border border-black/5">
         <div class="bg-white px-6 pt-6 pb-4">
           <div class="sm:flex sm:items-start">
             <div class="mt-3 text-center sm:mt-0 sm:text-left w-full">
               <h3 class="text-lg font-semibold text-ink-900 mb-2" id="modal-title">
                 <!-- Title will be injected -->
               </h3>
               <div class="mt-2">
                 <p class="text-sm text-slate" id="modal-body">
                   <!-- Message will be injected -->
                 </p>
               </div>
             </div>
           </div>
         </div>
         <div class="bg-sand-50 px-6 py-4 sm:flex sm:flex-row-reverse gap-3">
           <button type="button" id="modal-confirm-btn" class="btn-primary w-full sm:w-auto">
             Confirmar
           </button>
           <button type="button" onclick="window.closeConfirmModal()" class="btn-secondary w-full sm:w-auto mt-3 sm:mt-0">
             Cancelar
           </button>
         </div>
       </div>
     </div>
   </div>

   <script>
     // ===== Toast Notification System =====
      window.showToast = function(message, type = 'success') {
        const container = document.getElementById('toast-container');
        const toast = document.createElement('div');
       
       const bgColors = {
         success: 'bg-moss-50 border-moss-200 text-moss-800',
         error: 'bg-red-50 border-red-200 text-red-800',
         warning: 'bg-sun-50 border-sun-200 text-sun-800',
         info: 'bg-slate-50 border-slate-200 text-slate-800'
       };
       
       toast.className = `pointer-events-auto transform transition-all duration-300 ease-out translate-x-full opacity-0 rounded-xl border ${bgColors[type] || bgColors.success} px-4 py-3 text-sm shadow-soft backdrop-blur-sm max-w-sm`;
       toast.textContent = message;
       
       container.appendChild(toast);
       
       // Trigger animation
       requestAnimationFrame(() => {
         requestAnimationFrame(() => {
           toast.classList.remove('translate-x-full', 'opacity-0');
         });
       });
       
       // Auto dismiss after 4 seconds
        setTimeout(() => {
          toast.classList.add('translate-x-full', 'opacity-0');
          setTimeout(() => toast.remove(), 300);
        }, 4000);
      };

      if (window.pendingToasts && window.pendingToasts.length) {
        window.pendingToasts.forEach(([message, type]) => window.showToast(message, type));
        window.pendingToasts = [];
      }

     // ===== Confirmation Modal System =====
     window.showConfirmModal = function(message, onConfirm, title = 'Confirmar ação') {
       const modal = document.getElementById('confirm-modal');
       const modalTitle = document.getElementById('modal-title');
       const modalBody = document.getElementById('modal-body');
       const confirmBtn = document.getElementById('modal-confirm-btn');
       
       modalTitle.textContent = title;
       modalBody.textContent = message;
       
       // Remove old listeners by cloning the button
       const newConfirmBtn = confirmBtn.cloneNode(true);
       confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
       
       newConfirmBtn.addEventListener('click', function() {
         window.closeConfirmModal();
         onConfirm();
       });
       
       modal.classList.remove('hidden');
       document.body.style.overflow = 'hidden';
     };

     window.closeConfirmModal = function() {
       const modal = document.getElementById('confirm-modal');
       modal.classList.add('hidden');
       document.body.style.overflow = '';
     };

     // Close modal on ESC key
     document.addEventListener('keydown', function(e) {
       if (e.key === 'Escape') {
         window.closeConfirmModal();
       }
     });

      // ===== HTMX Confirmation Integration =====
      document.addEventListener('htmx:confirm', function(e) {
        // Only show modal if the element explicitly has hx-confirm attribute
        if (!e.detail.elt.hasAttribute('hx-confirm')) {
          return;
        }
        
        e.preventDefault();
        const message = e.detail.question || 'Tem certeza que deseja realizar esta ação?';
        
        window.showConfirmModal(message, function() {
          e.detail.issueRequest(true);
        });
      });

     // ===== HTMX Success Flash Effect =====
      document.addEventListener('htmx:afterSwap', function(e) {
        // Check if response has success message header
        const successMsg = e.detail.xhr.getResponseHeader('HX-Success-Message');
        if (!successMsg) {
          return;
        }

        window.showToast(successMsg, 'success');

        // Flash effect on updated elements
        const target = e.detail.target;
        if (target) {
          target.classList.add('htmx-success-flash');
          setTimeout(() => target.classList.remove('htmx-success-flash'), 1000);
        }
      });

       // ===== Custom Select Functionality =====
       window.initCustomSelects = function(root = document) {
        root.querySelectorAll('.custom-select:not([data-custom-select-init])').forEach(function(select) {
          const button = select.querySelector('.custom-select-button');
          const options = select.querySelector('.custom-select-options');
          const hiddenInput = select.querySelector('input[type="hidden"]');
          const nativeSelect = select.querySelector('select');

          // Store HTMX config for manual trigger
          let htmxConfig = null;
          if (button && hiddenInput) {
            const dataAttrs = ["data-hx-get", "data-hx-target", "data-hx-include", "data-hx-vals", "data-hx-swap", "data-hx-push-url", "data-hx-select", "data-hx-indicator"];
            const hasHtmx = dataAttrs.some(attr => button.hasAttribute(attr));
            if (hasHtmx) {
              htmxConfig = {};
              dataAttrs.forEach(attr => {
                const dataAttr = attr;
                const hxAttr = attr.replace('data-hx-', 'hx-');
                if (button.hasAttribute(dataAttr)) {
                  htmxConfig[hxAttr] = button.getAttribute(dataAttr);
                  button.removeAttribute(dataAttr);
                }
              });
            }
          }

          if (button) {
            button.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopImmediatePropagation();
              select.classList.toggle('open');
            });
          }

          select.querySelectorAll('.custom-select-option').forEach(function(option) {
            option.addEventListener('click', function(e) {
              e.preventDefault();
              const value = this.getAttribute('data-value');
              const text = this.textContent.trim();

              // Update button text
              const selectedText = button ? button.querySelector('.selected-text') : null;
              if (selectedText) {
                selectedText.textContent = text;
              }

              const updateField = function(field) {
                if (!field) {
                  return;
                }
                field.value = value;
                field.dispatchEvent(new Event('change', { bubbles: true }));
              };

              // Update hidden input/native select
              updateField(hiddenInput);
              updateField(nativeSelect);

              // Manual HTMX trigger if config exists
              if (window.htmx && htmxConfig && htmxConfig['hx-get']) {
                const vals = htmxConfig['hx-vals'] ? JSON.parse(htmxConfig['hx-vals']) : {};
                const include = htmxConfig['hx-include'] ? htmxConfig['hx-include'].split(',').map(s => s.trim()) : [];
                const values = {};
                include.forEach(selector => {
                  const el = document.querySelector(selector);
                  if (el && el.name) {
                    values[el.name] = el.value;
                  }
                });
                Object.assign(values, vals);
                window.htmx.ajax('GET', htmxConfig['hx-get'], {
                  target: htmxConfig['hx-target'] || '#tab-content',
                  values: values,
                  swap: htmxConfig['hx-swap'] || 'innerHTML'
                });
              }

              // Update selected state
              select.querySelectorAll('.custom-select-option').forEach(function(opt) {
                opt.classList.remove('selected');
              });
              this.classList.add('selected');

              // Close dropdown
              select.classList.remove('open');
            });
          });

          // Mark as initialized
          select.setAttribute('data-custom-select-init', 'true');
        });
      }

      document.addEventListener('DOMContentLoaded', function() {
        initCustomSelects();
      });

      // Re-initialize after HTMX swaps
      document.body.addEventListener('htmx:afterSwap', function(evt) {
        if (evt.detail.target.id === 'tab-content' || evt.detail.target.id === 'modal-container' || evt.detail.target.id === 'modal-content') {
          initCustomSelects(evt.detail.target);
        }
      });

      // Close dropdowns when clicking outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.custom-select')) {
          document.querySelectorAll('.custom-select.open').forEach(function(select) {
            select.classList.remove('open');
          });
        }
      });
   </script>
</body>
</html>
```

### templates\dashboard.html
```html
{% extends 'base.html' %}
{% block title %}Painel{% endblock %}
{% block content %}
{% if no_parishes %}
  <div class="card">
    <h2 class="font-serif text-xl mb-2">Nenhuma paroquia cadastrada</h2>
    <p class="text-sm text-slate mb-3">Crie uma paroquia para comecar a operar o sistema.</p>
    <a class="btn-secondary" href="/admin/">Abrir Django admin</a>
  </div>
{% elif missing_parish %}
  <div class="card">Nenhuma paroquia ativa. Contate o administrador.</div>
{% else %}
  {% if dashboard_view == "admin" %}
    <!-- Admin View -->
    <div class="space-y-8">
      <!-- Risk Radar -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="card text-center">
          <div class="text-4xl font-serif text-moss mb-2">{{ open_slots_count }}</div>
          <div class="text-sm text-ink font-medium">Vagas abertas (14 dias)</div>
          <div class="text-xs text-slate mt-1">Posicoes essenciais ainda vazias</div>
        </div>
        <div class="card text-center">
          <div class="text-4xl font-serif text-moss mb-2">{{ pending_replacements }}</div>
          <div class="text-sm text-ink font-medium">Substituicoes pendentes</div>
          <div class="text-xs text-slate mt-1">Solicitacoes de reposicao aguardando</div>
        </div>
        <div class="card text-center">
          <div class="text-4xl font-serif text-moss mb-2">{{ pending_swaps }}</div>
          <div class="text-sm text-ink font-medium">Trocas pendentes</div>
          <div class="text-xs text-slate mt-1">Solicitacoes de troca aguardando aprovacao</div>
        </div>
       </div>

       <!-- Pending Swap Approvals -->
       {% if pending_swap_approvals %}
       <div class="card">
         <div class="mb-6">
           <h3 class="text-xl font-serif text-moss">Trocas aguardando aprovação</h3>
           <p class="text-sm text-slate mt-2">Trocas aceitas pelos acólitos que precisam da sua aprovação para serem efetivadas.</p>
         </div>
         <div class="space-y-3">
            {% for swap in pending_swap_approvals %}
              <div id="dashboard-swap-{{ swap.id }}" class="flex items-start justify-between gap-4 p-4 border border-sand-200 rounded-lg">
                <div class="flex-1 min-w-0">
                  <div class="text-sm text-ink-600 mb-1">
                    {{ swap.mass_instance.starts_at|date:"H:i" }} · {{ swap.mass_instance.community.short_name|default:swap.mass_instance.community.name }} · {{ swap.mass_instance.starts_at|date:"d/m/Y" }}
                  </div>
                  <div class="text-base font-medium text-ink mb-1">
                    {% if swap.swap_type == "role_swap" %}
                      Trocar {{ swap.from_slot.position_type.name }} → {{ swap.to_slot.position_type.name }}
                    {% else %}
                      Troca de acólito
                    {% endif %}
                  </div>
                  <div class="text-sm text-ink-600">
                    Aprovado por {{ swap.target_acolyte.user.full_name|default:swap.target_acolyte.display_name }} · Solicitado por {{ swap.requestor_acolyte.user.full_name|default:swap.requestor_acolyte.display_name }}
                  </div>
                </div>
                <div class="flex gap-2">
                  <button
                    hx-post="{% url 'swap_request_approve' swap.id %}"
                    hx-target="#dashboard-swap-{{ swap.id }}"
                    hx-swap="outerHTML"
                    class="btn-primary text-sm px-3 py-2">
                    Aprovar
                  </button>
                  <button
                    hx-post="{% url 'swap_request_cancel' swap.id %}"
                    hx-target="#dashboard-swap-{{ swap.id }}"
                    hx-swap="outerHTML"
                    hx-confirm="Tem certeza que deseja cancelar esta troca?"
                    class="btn-danger text-sm px-3 py-2">
                    Cancelar
                  </button>
                </div>
              </div>
           {% empty %}
             <div class="text-center py-6 text-slate">Nenhuma troca aguardando aprovação</div>
           {% endfor %}
         </div>
         <div class="mt-4 text-center">
           <a href="{% url 'swap_requests' %}?all=true" class="text-sm text-ink-600 hover:text-ink-800 underline">Ver todas as trocas</a>
         </div>
       </div>
       {% endif %}

       <!-- Upcoming Masses -->
      <div class="card">
        <div class="mb-6">
          <h3 class="text-xl font-serif text-moss">Proximas missas</h3>
          <p class="text-sm text-slate mt-2">Alertas de escala incompleta e confirmacoes pendentes.</p>
        </div>
        <div class="space-y-4">
          {% for mass in upcoming_masses %}
            <a href="{% url 'mass_detail' mass.id %}" class="group block rounded-xl border border-black/5 bg-white/80 p-5 transition-all hover:bg-white hover:shadow-soft">
              <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                <div class="space-y-2">
                  <div class="text-xs uppercase tracking-wide text-slate">{{ mass.starts_at|date:"l, d/m/Y" }}</div>
                  <div class="text-base font-medium text-ink">{{ mass.community.code }} - {{ mass.liturgy_label|default:"Missa" }}</div>
                  <div class="flex flex-wrap gap-x-4 gap-y-2 text-xs text-slate">
                    {% if mass.open_slots_count %}
                      <div class="flex items-center gap-2">
                        <span class="h-2 w-2 rounded-full bg-sun"></span>
                        <span>Escala incompleta: <span class="font-medium text-ink">{{ mass.open_slots_count }} vaga{{ mass.open_slots_count|pluralize }}</span></span>
                      </div>
                    {% endif %}
                    {% if mass.active_assignments_count %}
                      <div class="flex items-center gap-2">
                        <span class="h-2 w-2 rounded-full bg-moss"></span>
                        <span>Confirmacoes: <span class="font-medium text-ink">{{ mass.confirmed_assignments_count }}/{{ mass.active_assignments_count }}</span></span>
                      </div>
                    {% else %}
                      <div class="flex items-center gap-2">
                        <span class="h-2 w-2 rounded-full bg-slate"></span>
                        <span>Sem acolitos escalados</span>
                      </div>
                    {% endif %}
                    {% if mass.pending_confirmations_count %}
                      <div class="flex items-center gap-2">
                        <span class="h-2 w-2 rounded-full bg-sun"></span>
                        <span>Confirmacoes pendentes: <span class="font-medium text-ink">{{ mass.pending_confirmations_count }}</span></span>
                      </div>
                    {% endif %}
                    {% if mass.is_soon and mass.open_slots_count %}
                      <div class="flex items-center gap-2">
                        <span class="h-2 w-2 rounded-full bg-sun"></span>
                        <span class="font-medium text-ink">Missa proxima sem escala</span>
                      </div>
                    {% endif %}
                  </div>
                </div>
                <div class="text-2xl font-serif text-moss">{{ mass.starts_at|date:"H:i" }}</div>
              </div>
            </a>
          {% empty %}
            <div class="text-center py-8 text-slate">Nenhuma missa proxima agendada</div>
          {% endfor %}
        </div>
      </div>
    </div>
  {% else %}
    <!-- Acolyte View -->
    <div class="space-y-8">

      <!-- Hero Assignment -->
      {% if hero_assignment %}
        {% include "acolytes/_partials/dashboard_hero_assignment.html" %}
      {% else %}
        <div class="rounded-2xl bg-white/80 p-10 text-center shadow-soft border border-white/70">
          <div class="text-lg text-ink font-medium">Nenhuma escala proxima</div>
          <div class="text-sm text-slate mt-2">Suas proximas atribuicoes aparecem aqui</div>
        </div>
      {% endif %}

      <!-- Pending Actions (Inbox) -->
      {% if pending_assignments or incoming_swaps %}
        <div class="rounded-2xl bg-sun-50/70 p-6 shadow-soft border border-sun-100">
          <div class="mb-6 space-y-2">
            <div class="text-xs uppercase tracking-[0.2em] text-slate">Acoes pendentes</div>
            <h2 class="font-serif text-2xl text-ink">Resolva antes de fechar</h2>
          </div>
          <div class="space-y-3">
            {% for assignment in pending_assignments %}
              {% include "acolytes/_partials/dashboard_pending_row.html" %}
            {% endfor %}
            {% for swap in incoming_swaps %}
              <div id="swap-{{ swap.id }}" class="flex flex-col gap-3 rounded-xl bg-white/80 px-4 py-4 sm:flex-row sm:items-center sm:justify-between">
                <div class="space-y-1">
                  <div class="text-sm text-slate">{{ swap.mass_instance.starts_at|date:"D, d M • H:i" }}</div>
                  <div class="text-base text-ink font-medium">Troca solicitada</div>
                  <div class="text-sm text-slate">{{ swap.requested_position.name }}</div>
                </div>
                <div class="flex w-full gap-2 sm:w-auto">
                  <button hx-post="{% url 'swap_request_accept' swap.id %}" hx-target="#swap-{{ swap.id }}" hx-swap="outerHTML" class="btn-primary flex-1 sm:flex-none">Aceitar</button>
                  <button hx-post="{% url 'swap_request_reject' swap.id %}" hx-target="#swap-{{ swap.id }}" hx-swap="outerHTML" class="btn-secondary flex-1 sm:flex-none">Recusar</button>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      {% endif %}

      <!-- Future Assignments (Horizon) -->
      {% if horizon_assignments %}
        <div class="rounded-2xl bg-white/80 p-6 shadow-soft border border-white/70">
          <div class="mb-6 flex items-center justify-between">
            <h2 class="font-serif text-2xl text-ink">Agenda futura</h2>
            <span class="text-xs uppercase tracking-[0.2em] text-slate">Proximas semanas</span>
          </div>
          <div class="divide-y divide-sand-100">
            {% for assignment in horizon_assignments %}
              <div class="flex flex-col gap-3 py-4 sm:flex-row sm:items-center sm:justify-between">
                <div class="flex items-center gap-4">
                  <div class="text-sm font-medium text-ink">{{ assignment.slot.mass_instance.starts_at|date:"d M" }}</div>
                  <div>
                    <div class="text-base text-ink font-medium">{{ assignment.slot.mass_instance.community.code }} - {{ assignment.slot.position_type.name }}</div>
                    <div class="text-sm text-slate">{{ assignment.slot.mass_instance.starts_at|date:"H:i" }}</div>
                  </div>
                </div>
                {% if assignment.confirmation_status == 'confirmed' %}
                  <span class="text-xs font-medium uppercase tracking-[0.2em] text-moss">Confirmado</span>
                {% else %}
                  <span class="text-xs font-medium uppercase tracking-[0.2em] text-sun">Pendente</span>
                {% endif %}
              </div>
            {% endfor %}
          </div>
        </div>
      {% endif %}
    </div>
  {% endif %}
{% endif %}
{% endblock %}
```

### templates\login.html
```html
{% extends 'base.html' %}
{% block title %}Entrar{% endblock %}
{% block content %}
<div class="max-w-md mx-auto bg-white rounded-2xl shadow-soft p-8">
  <h1 class="font-serif text-2xl mb-2">Bem-vindo</h1>
  <p class="text-slate text-sm mb-6">Acesse sua conta para ver suas escalas e o calendario.</p>
  <form method="post" class="space-y-4">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div>
      <label class="label">Email</label>
      {{ form.username }}
    </div>
    <div>
      <label class="label">Senha</label>
      {{ form.password }}
    </div>
    <button class="btn-primary w-full">Entrar</button>
  </form>
</div>
{% endblock %}
```

### templates\logout.html
```html
{% extends 'base.html' %}
{% block title %}Sessao encerrada{% endblock %}
{% block content %}
<div class="max-w-md mx-auto bg-white rounded-2xl shadow-soft p-8 text-center">
  <div class="w-16 h-16 bg-moss/10 rounded-full flex items-center justify-center mx-auto mb-6">
    <svg class="w-8 h-8 text-moss" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
    </svg>
  </div>
  <h1 class="font-serif text-2xl mb-2">Sessao encerrada</h1>
  <p class="text-slate text-sm mb-6">Voce saiu da sua conta com sucesso.</p>
  <a href="{% url 'login' %}" class="btn-primary inline-block">Entrar novamente</a>
</div>
{% endblock %}
```

### templates\logout_confirm.html
```html
{% extends 'base.html' %}
{% block title %}Sair{% endblock %}
{% block content %}
<div class="max-w-md mx-auto bg-white rounded-2xl shadow-soft p-8">
  <h1 class="font-serif text-2xl mb-2">Sair da conta</h1>
  <p class="text-slate text-sm mb-6">Tem certeza que deseja encerrar sua sessao?</p>
  <form method="post" action="{% url 'logout' %}">
    {% csrf_token %}
    <div class="flex gap-3">
      <button type="submit" class="btn-primary flex-1">Sair</button>
      <a href="{% url 'dashboard' %}" class="btn-secondary flex-1 text-center">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
```

### web\templatetags\extras.py
```python
from django import template
import json

register = template.Library()


@register.filter
def index(sequence, idx):
    try:
        return sequence[idx]
    except Exception:
        return None


@register.filter
def get_item(mapping, key):
    if not mapping:
        return None
    return mapping.get(key)


@register.filter
def get_list_item(mapping, key):
    if not mapping:
        return []
    return mapping.get(key, [])


@register.filter
def weekday_label(value):
    labels = {
        0: "Seg",
        1: "Ter",
        2: "Qua",
        3: "Qui",
        4: "Sex",
        5: "Sab",
        6: "Dom",
    }
    if value is None or value == "":
        return "Qualquer dia"
    return labels.get(value, str(value))


def _format_time(value):
    if not value:
        return None
    return value.strftime("%H:%M")


@register.filter
def preference_priority_label(weight):
    if weight is None:
        return "Media"
    if weight >= 75:
        return "Alta"
    if weight <= 35:
        return "Baixa"
    return "Media"


@register.filter
def preference_summary(pref):
    if not pref:
        return ""
    mapping = {
        "preferred_community": ("Preferir comunidade", pref.target_community),
        "avoid_community": ("Evitar comunidade", pref.target_community),
        "preferred_position": ("Preferir posicao", pref.target_position),
        "avoid_position": ("Evitar posicao", pref.target_position),
        "preferred_function": ("Preferir funcao", pref.target_function),
        "avoid_function": ("Evitar funcao", pref.target_function),
        "preferred_mass_template": ("Preferir modelo", pref.target_template),
        "preferred_partner": ("Preferir parceiro", pref.target_acolyte),
        "avoid_partner": ("Evitar parceiro", pref.target_acolyte),
        "preferred_timeslot": ("Preferir horario", None),
    }
    label, target = mapping.get(pref.preference_type, (pref.get_preference_type_display(), None))
    if target:
        name = getattr(target, "display_name", None) or getattr(target, "name", None) or str(target)
        return f"{label}: {name}"
    return label


@register.filter
def preference_detail(pref):
    if not pref:
        return ""
    if pref.preference_type == "preferred_timeslot":
        parts = []
        if pref.weekday is not None:
            parts.append(weekday_label(pref.weekday))
        start = _format_time(pref.start_time)
        end = _format_time(pref.end_time)
        if start or end:
            parts.append(f"{start or '--:--'}-{end or '--:--'}")
        if not start and not end:
            parts.append("Qualquer horario")
        return " | ".join(parts)
    return ""


@register.filter
def initials(value):
    if not value:
        return "--"
    parts = [part for part in str(value).strip().split() if part]
    if not parts:
        return "--"
    if len(parts) == 1:
        return parts[0][:2].upper()
    return f"{parts[0][0]}{parts[-1][0]}".upper()


def _normalize_choice(value):
    if value is None:
        return ""
    return str(value).strip()


def _map_choice_label(mapping, value):
    key = _normalize_choice(value)
    if not key:
        return ""
    key_lower = key.lower()
    return mapping.get(key_lower, mapping.get(key, key))


@register.filter
def choice_label(choices, value):
    if not choices:
        return ""
    target = _normalize_choice(value)
    if not target:
        return ""
    for choice_value, choice_label in choices:
        if isinstance(choice_label, (list, tuple)):
            for nested_value, nested_label in choice_label:
                if _normalize_choice(nested_value) == target:
                    return str(nested_label)
        elif _normalize_choice(choice_value) == target:
            return str(choice_label)
    return ""


@register.filter
def mass_status_label(value):
    mapping = {
        "scheduled": "Agendada",
        "canceled": "Cancelada",
    }
    return _map_choice_label(mapping, value)


@register.filter
def slot_status_label(value):
    mapping = {
        "open": "Aberta",
        "assigned": "Atribuida",
        "finalized": "Finalizada",
    }
    return _map_choice_label(mapping, value)


@register.filter
def assignment_state_label(value):
    mapping = {
        "proposed": "Proposta",
        "published": "Publicada",
        "locked": "Consolidada",
    }
    return _map_choice_label(mapping, value)


@register.filter
def confirmation_status_label(value):
    mapping = {
        "pending": "Pendente",
        "confirmed": "Confirmada",
        "declined": "Recusada",
        "canceled_by_acolyte": "Cancelada pelo acolito",
        "replaced": "Substituida",
        "no_show": "Nao compareceu",
    }
    return _map_choice_label(mapping, value)


@register.filter
def assignment_end_reason_label(value):
    mapping = {
        "declined": "Recusado",
        "canceled": "Cancelado",
        "replaced": "Substituido",
        "replaced_by_solver": "Substituido pelo sistema",
        "manual_unassign": "Removido manualmente",
        "moved_to_another_slot": "Movido para outra posicao",
        "swap": "Trocado",
    }
    return _map_choice_label(mapping, value)


@register.filter
def swap_status_label(value):
    mapping = {
        "pending": "Pendente",
        "awaiting_approval": "Aguardando aprovacao",
        "accepted": "Aceita",
        "rejected": "Recusada",
        "canceled": "Cancelada",
    }
    return _map_choice_label(mapping, value)


@register.filter
def swap_type_label(value):
    mapping = {
        "acolyte_swap": "Troca de acolito",
        "role_swap": "Troca de funcao",
    }
    return _map_choice_label(mapping, value)


@register.filter
def job_status_label(value):
    mapping = {
        "pending": "Pendente",
        "running": "Executando",
        "success": "Concluido",
        "failed": "Falhou",
    }
    return _map_choice_label(mapping, value)


@register.filter
def pprint(value):
    """Pretty print JSON data for audit diffs."""
    if not value:
        return ""
    if isinstance(value, str):
        try:
            value = json.loads(value)
        except (json.JSONDecodeError, TypeError):
            return value
    try:
        return json.dumps(value, indent=2, ensure_ascii=False)
    except (TypeError, ValueError):
        return str(value)
```

### web\tests\test_acolyte_link.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import MembershipRole, Parish, ParishMembership


class AcolyteLinkRedirectTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.admin = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        role_admin = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.admin, active=True)
        membership.roles.add(role_admin)

    def _login(self):
        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_acolyte_link_redirects_to_people_create(self):
        self._login()
        response = self.client.get("/acolytes/link/")
        self.assertEqual(response.status_code, 302)
        self.assertIn("/people/new/", response["Location"])
```

### web\tests\test_assignments.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    AcolyteQualification,
    Assignment,
    AssignmentSlot,
    Confirmation,
    Community,
    MassInstance,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
    ReplacementRequest,
)

User = get_user_model()


class AssignmentLifecycleTests(TestCase):
    def test_decline_deactivates_assignment(self):
        User = get_user_model()
        user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, user=user, display_name="Acolito")
        ParishMembership.objects.create(parish=parish, user=user, active=True)
        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte)

        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.post(f"/assignments/{assignment.id}/decline/")
        self.assertEqual(response.status_code, 302)
        assignment.refresh_from_db()
        slot.refresh_from_db()
        self.assertFalse(assignment.is_active)
        self.assertEqual(slot.status, "open")

    def test_confirm_inactive_assignment_is_blocked(self):
        User = get_user_model()
        user = User.objects.create_user(email="user2@example.com", full_name="User", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, user=user, display_name="Acolito")
        ParishMembership.objects.create(parish=parish, user=user, active=True)
        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, is_active=False)

        self.client.login(email="user2@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.post(f"/assignments/{assignment.id}/confirm/")
        self.assertEqual(response.status_code, 302)
        self.assertFalse(Confirmation.objects.filter(parish=parish, assignment=assignment).exists())

    def test_decline_inactive_assignment_is_blocked(self):
        User = get_user_model()
        user = User.objects.create_user(email="user3@example.com", full_name="User", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, user=user, display_name="Acolito")
        ParishMembership.objects.create(parish=parish, user=user, active=True)
        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, is_active=False)

        self.client.login(email="user3@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.post(f"/assignments/{assignment.id}/decline/")
        self.assertEqual(response.status_code, 302)
        self.assertFalse(Confirmation.objects.filter(parish=parish, assignment=assignment).exists())

    def test_cancel_assignment_blocked_when_mass_canceled(self):
        User = get_user_model()
        user = User.objects.create_user(email="user4@example.com", full_name="User", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=parish, user=user, display_name="Acolito")
        ParishMembership.objects.create(parish=parish, user=user, active=True)
        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=3),
            status="canceled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, is_active=True)

        self.client.login(email="user4@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.post(f"/assignments/{assignment.id}/cancel/")
        self.assertEqual(response.status_code, 302)
        assignment.refresh_from_db()
        self.assertTrue(assignment.is_active)
        self.assertFalse(ReplacementRequest.objects.filter(parish=parish, slot=slot).exists())

    def test_assign_manual_conflict_shows_modal(self):
        parish = Parish.objects.create(name="Test Parish", city="Test City")
        user = User.objects.create_user(email="admin@example.com", password="pass")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=parish, user=user, active=True)
        membership.roles.add(role)
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Test Acolyte")
        community = Community.objects.create(parish=parish, code="COM", name="Test Community")
        mass = MassInstance.objects.create(
            parish=parish, community=community, starts_at=timezone.now()
        )
        position1 = PositionType.objects.create(parish=parish, code="POS1", name="Position 1")
        position2 = PositionType.objects.create(parish=parish, code="POS2", name="Position 2")
        slot1 = AssignmentSlot.objects.create(
            parish=parish, mass_instance=mass, position_type=position1, slot_index=1, required=True
        )
        slot2 = AssignmentSlot.objects.create(
            parish=parish, mass_instance=mass, position_type=position2, slot_index=1, required=True
        )
        
        # Add qualifications for the acolyte
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position1, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position2, qualified=True)
        
        # Assign to slot1
        Assignment.objects.create(parish=parish, slot=slot1, acolyte=acolyte, is_active=True)

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        # Try to assign to slot2 - should redirect to mass_detail with conflict params
        response = self.client.post(f"/calendar/{mass.id}/slots/{slot2.id}/assign/", {"acolyte_id": acolyte.id}, follow=True)
        self.assertEqual(response.status_code, 200)
        
        # Check modal is shown
        self.assertTrue(response.context.get('show_conflict_modal'))
        self.assertEqual(response.context.get('conflict_acolyte'), acolyte)
        self.assertContains(response, "Position 1")
        self.assertContains(response, acolyte.display_name)

    def test_move_acolyte_success(self):
        parish = Parish.objects.create(name="Test Parish", city="Test City")
        user = User.objects.create_user(email="admin@example.com", password="pass")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=parish, user=user, active=True)
        membership.roles.add(role)
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Test Acolyte")
        community = Community.objects.create(parish=parish, code="COM", name="Test Community")
        mass = MassInstance.objects.create(
            parish=parish, community=community, starts_at=timezone.now()
        )
        position1 = PositionType.objects.create(parish=parish, code="POS1", name="Position 1")
        position2 = PositionType.objects.create(parish=parish, code="POS2", name="Position 2")
        slot1 = AssignmentSlot.objects.create(
            parish=parish, mass_instance=mass, position_type=position1, slot_index=1, required=True
        )
        slot2 = AssignmentSlot.objects.create(
            parish=parish, mass_instance=mass, position_type=position2, slot_index=1, required=True
        )
        
        # Add qualifications for the acolyte
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position1, qualified=True)
        AcolyteQualification.objects.create(parish=parish, acolyte=acolyte, position_type=position2, qualified=True)
        
        # Assign to slot1
        assignment1 = Assignment.objects.create(parish=parish, slot=slot1, acolyte=acolyte, is_active=True)

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        # Move to slot2 - normal form submission returns redirect
        response = self.client.post(
            f"/calendar/{mass.id}/slots/{slot2.id}/move/",
            {"current_slot_id": slot1.id, "acolyte_id": acolyte.id}
        )
        self.assertEqual(response.status_code, 302)
        self.assertEqual(response.url, f"/calendar/{mass.id}/")
        
        # Verify the move was successful
        assignment1.refresh_from_db()
        self.assertFalse(assignment1.is_active)
        slot2.refresh_from_db()
        self.assertEqual(slot2.status, "assigned")
        active_assignment = slot2.get_active_assignment()
        self.assertEqual(active_assignment.acolyte_id, acolyte.id)
```

### web\tests\test_audit_log.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import AuditEvent, MembershipRole, Parish, ParishMembership


class AuditLogViewTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.admin_user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.admin_user, active=True)
        membership.roles.add(role)
        ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        AuditEvent.objects.create(
            parish=self.parish,
            actor_user=self.admin_user,
            entity_type="Parish",
            entity_id=str(self.parish.id),
            action_type="update",
            diff_json={},
        )

    def _set_active_parish(self, client):
        session = client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_admin_can_view_audit_log(self):
        self.client.login(email="admin@example.com", password="pass")
        self._set_active_parish(self.client)
        response = self.client.get("/audit/")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Configuracoes atualizadas")

    def test_non_admin_cannot_view_audit_log(self):
        self.client.login(email="user@example.com", password="pass")
        self._set_active_parish(self.client)
        response = self.client.get("/audit/")
        self.assertEqual(response.status_code, 403)
```

### web\tests\test_calendar_feed.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    AssignmentSlot,
    CalendarFeedToken,
    Community,
    MassInstance,
    Parish,
    ParishMembership,
    PositionType,
)


class CalendarFeedTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        self.acolyte = AcolyteProfile.objects.create(parish=self.parish, user=self.user, display_name="Acolito")

        self.instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        self.slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=self.instance,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(
            parish=self.parish,
            slot=self.slot,
            acolyte=self.acolyte,
            assignment_state="published",
        )

    def test_calendar_feed_requires_token(self):
        response = self.client.get("/calendar/my.ics")
        self.assertEqual(response.status_code, 404)

    def test_calendar_feed_returns_ics(self):
        token = CalendarFeedToken.objects.create(parish=self.parish, user=self.user, token="tok123")
        response = self.client.get(f"/calendar/my.ics?token={token.token}")
        self.assertEqual(response.status_code, 200)
        self.assertIn("text/calendar", response["Content-Type"])
        body = response.content.decode("utf-8")
        self.assertIn("BEGIN:VEVENT", body)
        expected_uid = f"UID:acoli-{self.parish.id}-{self.instance.id}-{self.position.id}-{self.slot.slot_index}@acoli"
        self.assertIn(expected_uid, body)
        self.assertIn("DTSTAMP:", body)
        self.assertIn("Z", body)

    def test_calendar_feed_token_creation(self):
        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()
        response = self.client.post("/calendar/feed/token/")
        self.assertEqual(response.status_code, 302)
        self.assertTrue(CalendarFeedToken.objects.filter(parish=self.parish, user=self.user).exists())
```

### web\tests\test_dashboard.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import AssignmentSlot, Community, MassInstance, Parish, ParishMembership, PositionType


class DashboardCountsTests(TestCase):
    def test_unfilled_ignores_optional_slots(self):
        User = get_user_model()
        user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        parish = Parish.objects.create(name="Parish")
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        ParishMembership.objects.create(parish=parish, user=user, active=True)

        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            status="open",
            required=False,
            slot_index=1,
        )
        AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            status="open",
            required=True,
            slot_index=2,
        )

        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.get("/")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context["unfilled"], 1)
```

### web\tests\test_event_series_forms.py
```python
from datetime import date, time

from django.test import TestCase

from core.models import Community, Parish, RequirementProfile
from web.forms import EventOccurrenceForm, EventSeriesBasicsForm


class EventSeriesFormTests(TestCase):
    def setUp(self):
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.profile = RequirementProfile.objects.create(parish=self.parish, name="Simple")

    def test_series_type_other_requires_custom_value(self):
        form = EventSeriesBasicsForm(
            data={
                "series_type": "Outro",
                "title": "Festa",
                "start_date": date.today(),
                "end_date": date.today(),
                "default_time": "19:00",
                "candidate_pool": "all",
            },
            parish=self.parish,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("series_type_other", form.errors)

        form = EventSeriesBasicsForm(
            data={
                "series_type": "Outro",
                "series_type_other": "Festa local",
                "title": "Festa",
                "start_date": date.today(),
                "end_date": date.today(),
                "default_time": "19:00",
                "candidate_pool": "all",
            },
            parish=self.parish,
        )
        self.assertTrue(form.is_valid())
        self.assertEqual(form.cleaned_data["series_type"], "Festa local")

    def test_move_existing_requires_move_fields(self):
        form = EventOccurrenceForm(
            data={
                "date": date.today(),
                "time": time(19, 0),
                "community": self.community.id,
                "requirement_profile": self.profile.id,
                "label": "Festa",
                "conflict_action": "move_existing",
            },
            parish=self.parish,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("move_to_date", form.errors)
        self.assertIn("move_to_time", form.errors)
        self.assertIn("move_to_community", form.errors)
```

### web\tests\test_event_series_views.py
```python
from datetime import date

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import Community, EventSeries, MembershipRole, Parish, ParishMembership


class EventSeriesViewTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.admin = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")

        admin_role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        acolyte_role = MembershipRole.objects.create(code="ACOLYTE", name="Acolyte")
        admin_membership = ParishMembership.objects.create(parish=self.parish, user=self.admin, active=True)
        admin_membership.roles.add(admin_role)
        user_membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        user_membership.roles.add(acolyte_role)

        self.series = EventSeries.objects.create(
            parish=self.parish,
            series_type="Festa",
            title="Festa",
            start_date=date.today(),
            end_date=date.today(),
            default_community=self.community,
            candidate_pool="all",
            is_active=True,
        )

    def _login_as(self, user):
        self.client.login(email=user.email, password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_event_series_list_requires_admin(self):
        self._login_as(self.user)
        response = self.client.get("/events/")
        self.assertEqual(response.status_code, 403)

    def test_event_series_list_admin_ok(self):
        self._login_as(self.admin)
        response = self.client.get("/events/")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Festa")

    def test_event_series_detail_admin_ok(self):
        self._login_as(self.admin)
        response = self.client.get(f"/events/{self.series.id}/")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Festa")

    def test_event_series_detail_requires_admin(self):
        self._login_as(self.user)
        response = self.client.get(f"/events/{self.series.id}/")
        self.assertEqual(response.status_code, 403)

    def test_event_series_archive_hides_series(self):
        self._login_as(self.admin)
        response = self.client.post(f"/events/{self.series.id}/archive/")
        self.assertEqual(response.status_code, 302)
        self.series.refresh_from_db()
        self.assertFalse(self.series.is_active)
        list_response = self.client.get("/events/")
        self.assertNotContains(list_response, "Festa")
        archived_response = self.client.get("/events/?status=archived")
        self.assertContains(archived_response, "Festa")

    def test_event_series_unarchive_restores_visibility(self):
        self._login_as(self.admin)
        self.series.is_active = False
        self.series.save(update_fields=["is_active"])
        response = self.client.post(f"/events/{self.series.id}/unarchive/")
        self.assertEqual(response.status_code, 302)
        self.series.refresh_from_db()
        self.assertTrue(self.series.is_active)
        list_response = self.client.get("/events/")
        self.assertContains(list_response, "Festa")

    def test_event_series_delete_removes_masses(self):
        self._login_as(self.admin)
        self.series.is_active = False
        self.series.save(update_fields=["is_active"])
        from core.models import MassInstance

        MassInstance.objects.create(
            parish=self.parish,
            event_series=self.series,
            community=self.community,
            starts_at=timezone.now(),
            status="scheduled",
        )
        response = self.client.post(f"/events/{self.series.id}/delete/")
        self.assertEqual(response.status_code, 302)
        self.assertFalse(EventSeries.objects.filter(id=self.series.id).exists())
        self.assertEqual(MassInstance.objects.filter(parish=self.parish).count(), 0)
```

### web\tests\test_forms.py
```python
from datetime import time

from django.test import TestCase
from core.models import (
    AcolyteAvailabilityRule,
    AcolyteProfile,
    Community,
    FunctionType,
    MassTemplate,
    Parish,
    PositionType,
)
from web.forms import AcolytePreferenceForm, DateAbsenceForm, MassTemplateForm, WeeklyAvailabilityForm


class AvailabilityFormTests(TestCase):
    def test_weekly_accepts_any_day(self):
        form = WeeklyAvailabilityForm(data={"rule_type": "unavailable", "day_of_week": ""})
        self.assertTrue(form.is_valid())
        self.assertIsNone(form.cleaned_data["day_of_week"])

    def test_weekly_valid_with_day(self):
        form = WeeklyAvailabilityForm(data={"rule_type": "unavailable", "day_of_week": 1})
        self.assertTrue(form.is_valid())

    def test_weekly_rejects_invalid_time_range(self):
        form = WeeklyAvailabilityForm(
            data={"rule_type": "unavailable", "day_of_week": 1, "start_time": "12:00", "end_time": "10:00"}
        )
        self.assertFalse(form.is_valid())
        self.assertIn("end_time", form.errors)

    def test_date_absence_requires_start_date(self):
        form = DateAbsenceForm(data={})
        self.assertFalse(form.is_valid())
        self.assertIn("start_date", form.errors)

    def test_date_absence_sets_end_date(self):
        form = DateAbsenceForm(data={"start_date": "2026-02-10"})
        self.assertTrue(form.is_valid())
        self.assertEqual(form.cleaned_data["end_date"], form.cleaned_data["start_date"])

    def test_weekly_rejects_overlap(self):
        parish = Parish.objects.create(name="Parish")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteAvailabilityRule.objects.create(
            parish=parish,
            acolyte=acolyte,
            rule_type="unavailable",
            day_of_week=1,
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        form = WeeklyAvailabilityForm(
            data={
                "rule_type": "unavailable",
                "day_of_week": 1,
                "start_time": "10:00",
                "end_time": "12:00",
            },
            acolyte=acolyte,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("__all__", form.errors)

    def test_weekly_allows_touching_intervals(self):
        parish = Parish.objects.create(name="Parish")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteAvailabilityRule.objects.create(
            parish=parish,
            acolyte=acolyte,
            rule_type="unavailable",
            day_of_week=1,
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        form = WeeklyAvailabilityForm(
            data={
                "rule_type": "unavailable",
                "day_of_week": 1,
                "start_time": "11:00",
                "end_time": "12:00",
            },
            acolyte=acolyte,
        )
        self.assertTrue(form.is_valid())

    def test_weekly_rejects_overlap_with_any_day(self):
        parish = Parish.objects.create(name="Parish")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteAvailabilityRule.objects.create(
            parish=parish,
            acolyte=acolyte,
            rule_type="unavailable",
            day_of_week=None,
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        form = WeeklyAvailabilityForm(
            data={
                "rule_type": "unavailable",
                "day_of_week": 1,
                "start_time": "10:00",
                "end_time": "12:00",
            },
            acolyte=acolyte,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("__all__", form.errors)

    def test_weekly_rejects_any_day_over_specific(self):
        parish = Parish.objects.create(name="Parish")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteAvailabilityRule.objects.create(
            parish=parish,
            acolyte=acolyte,
            rule_type="unavailable",
            day_of_week=2,
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        form = WeeklyAvailabilityForm(
            data={
                "rule_type": "unavailable",
                "day_of_week": "",
                "start_time": "10:00",
                "end_time": "12:00",
            },
            acolyte=acolyte,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("__all__", form.errors)

    def test_weekly_rejects_duplicate_rule(self):
        parish = Parish.objects.create(name="Parish")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteAvailabilityRule.objects.create(
            parish=parish,
            acolyte=acolyte,
            rule_type="unavailable",
            day_of_week=3,
            start_time=time(9, 0),
            end_time=time(11, 0),
        )
        form = WeeklyAvailabilityForm(
            data={
                "rule_type": "unavailable",
                "day_of_week": 3,
                "start_time": "09:00",
                "end_time": "11:00",
            },
            acolyte=acolyte,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("__all__", form.errors)

    def test_weekly_rejects_overlap_with_full_day_rule(self):
        parish = Parish.objects.create(name="Parish")
        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        AcolyteAvailabilityRule.objects.create(
            parish=parish,
            acolyte=acolyte,
            rule_type="unavailable",
            day_of_week=4,
        )
        form = WeeklyAvailabilityForm(
            data={
                "rule_type": "unavailable",
                "day_of_week": 4,
                "start_time": "10:00",
                "end_time": "12:00",
            },
            acolyte=acolyte,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("__all__", form.errors)


class PreferenceFormTests(TestCase):
    def setUp(self):
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        self.function = FunctionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        self.acolyte = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito")
        self.template = MassTemplate.objects.create(
            parish=self.parish,
            title="Missa",
            community=self.community,
            weekday=0,
            time=time(9, 0),
        )

    def _build_form(self, data):
        return AcolytePreferenceForm(data=data, parish=self.parish)

    def test_preference_requires_target_community(self):
        form = self._build_form({"preference_type": "preferred_community", "weight": 50})
        self.assertFalse(form.is_valid())
        self.assertIn("target_community", form.errors)

    def test_preference_requires_target_position(self):
        form = self._build_form({"preference_type": "preferred_position", "weight": 50})
        self.assertFalse(form.is_valid())
        self.assertIn("target_position", form.errors)

    def test_preference_requires_target_function(self):
        form = self._build_form({"preference_type": "preferred_function", "weight": 50})
        self.assertFalse(form.is_valid())
        self.assertIn("target_function", form.errors)

    def test_preference_requires_target_template(self):
        form = self._build_form({"preference_type": "preferred_mass_template", "weight": 50})
        self.assertFalse(form.is_valid())
        self.assertIn("target_template", form.errors)

    def test_preference_requires_target_partner(self):
        form = self._build_form({"preference_type": "preferred_partner", "weight": 50})
        self.assertFalse(form.is_valid())
        self.assertIn("target_acolyte", form.errors)

    def test_preference_timeslot_requires_criteria(self):
        form = self._build_form({"preference_type": "preferred_timeslot", "weight": 50})
        self.assertFalse(form.is_valid())
        self.assertIn("__all__", form.errors)

    def test_preference_timeslot_accepts_weekday(self):
        form = self._build_form({"preference_type": "preferred_timeslot", "weekday": 2, "weight": 50})
        self.assertTrue(form.is_valid())

    def test_preference_cleans_irrelevant_fields(self):
        form = self._build_form(
            {
                "preference_type": "preferred_community",
                "target_community": self.community.id,
                "target_function": self.function.id,
                "weekday": 1,
                "weight": 50,
            }
        )
        self.assertTrue(form.is_valid())
        self.assertIsNone(form.cleaned_data["target_function"])
        self.assertIsNone(form.cleaned_data["weekday"])

    def test_preference_rejects_foreign_parish_target(self):
        other_parish = Parish.objects.create(name="Other")
        other_community = Community.objects.create(parish=other_parish, code="OUT", name="Outra")
        form = self._build_form(
            {
                "preference_type": "preferred_community",
                "target_community": other_community.id,
                "weight": 50,
            }
        )
        self.assertFalse(form.is_valid())
        self.assertIn("target_community", form.errors)


class MassTemplateFormTests(TestCase):
    def test_mass_template_rejects_foreign_parish(self):
        parish_a = Parish.objects.create(name="Parish A")
        parish_b = Parish.objects.create(name="Parish B")
        community_b = Community.objects.create(parish=parish_b, code="B", name="B")
        form = MassTemplateForm(
            data={
                "title": "Missa",
                "community": community_b.id,
                "weekday": 0,
                "time": "09:00",
                "active": True,
            },
            parish=parish_a,
        )
        self.assertFalse(form.is_valid())
        self.assertIn("community", form.errors)
```

### web\tests\test_mass_detail.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    AcolyteQualification,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
)
from core.services.replacements import assign_replacement_request, create_replacement_request


class MassDetailHistoryTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_mass_detail_shows_replacement_history(self):
        position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        acolyte_a = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito A")
        acolyte_b = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito B")
        AcolyteQualification.objects.create(parish=self.parish, acolyte=acolyte_a, position_type=position, qualified=True)
        AcolyteQualification.objects.create(parish=self.parish, acolyte=acolyte_b, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(parish=self.parish, slot=slot, acolyte=acolyte_a, assignment_state="published")
        replacement = create_replacement_request(self.parish, slot)
        assign_replacement_request(self.parish, replacement.id, acolyte_b)

        response = self.client.get(f"/calendar/{instance.id}/")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Acolito A")
        self.assertContains(response, "Acolito B")

    def test_mass_detail_limits_recent_history_per_slot(self):
        position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito A")
        AcolyteQualification.objects.create(parish=self.parish, acolyte=acolyte, position_type=position, qualified=True)

        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        for idx in range(7):
            Assignment.objects.create(
                parish=self.parish,
                slot=slot,
                acolyte=acolyte,
                assignment_state="published",
                is_active=False,
            )
        Assignment.objects.create(parish=self.parish, slot=slot, acolyte=acolyte, assignment_state="published")

        response = self.client.get(f"/calendar/{instance.id}/")
        self.assertEqual(response.status_code, 200)
        slots = response.context["slots"]
        target = next(item for item in slots if item.id == slot.id)
        self.assertLessEqual(len(target.recent_assignments), 5)
```

### web\tests\test_mass_templates.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import Community, MembershipRole, Parish, ParishMembership


class MassTemplateFormTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_mass_template_form_shows_profile_callout_when_empty(self):
        response = self.client.get("/templates/new/")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Nenhum perfil cadastrado.")
```

### web\tests\test_parish_settings.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import MembershipRole, Parish, ParishMembership, AuditEvent
from web.forms import ParishSettingsForm


class ParishSettingsTests(TestCase):
    def test_update_parish_settings(self):
        User = get_user_model()
        user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        parish = Parish.objects.create(name="Parish", consolidation_days=14, horizon_days=60)
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        membership = ParishMembership.objects.create(parish=parish, user=user, active=True)
        membership.roles.add(role)

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.post(
            "/settings/",
            {
                "consolidation_days": 10,
                "horizon_days": 45,
                "default_mass_duration_minutes": 60,
                "min_rest_minutes_between_masses": 0,
                "swap_requires_approval": "on",
                "notify_on_cancellation": "on",
                "auto_assign_on_decline": "",
                "stability_penalty": 10,
                "fairness_penalty": 2,
                "credit_weight": 1,
                "max_solve_seconds": 10,
                "max_services_per_week": 3,
                "max_consecutive_weekends": 2,
                "rotation_penalty": 3,
                "rotation_days": 60,
            },
        )
        self.assertEqual(response.status_code, 302)
        parish.refresh_from_db()
        self.assertEqual(parish.consolidation_days, 10)
        self.assertEqual(parish.horizon_days, 45)
        self.assertTrue(AuditEvent.objects.filter(parish=parish, entity_type="Parish").exists())

    def test_horizon_must_be_after_consolidation(self):
        parish = Parish.objects.create(name="Parish", consolidation_days=14, horizon_days=60)
        form = ParishSettingsForm(
            data={
                "consolidation_days": 40,
                "horizon_days": 20,
                "default_mass_duration_minutes": 60,
                "min_rest_minutes_between_masses": 0,
            },
            parish=parish,
        )
        form.fields["consolidation_days"].validators = []
        form.fields["horizon_days"].validators = []
        form.fields["consolidation_days"].min_value = None
        form.fields["consolidation_days"].max_value = None
        form.fields["horizon_days"].min_value = None
        self.assertFalse(form.is_valid())
        self.assertIn("O horizonte precisa ser maior ou igual a consolidacao.", form.errors.get("horizon_days", []))

    def test_reset_defaults(self):
        User = get_user_model()
        user = User.objects.create_user(email="admin3@example.com", full_name="Admin", password="pass")
        parish = Parish.objects.create(name="Parish", consolidation_days=14, horizon_days=60, schedule_weights={"stability_penalty": 99})
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        membership = ParishMembership.objects.create(parish=parish, user=user, active=True)
        membership.roles.add(role)

        self.client.login(email="admin3@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.post("/settings/", {"action": "reset"})
        self.assertEqual(response.status_code, 302)
        parish.refresh_from_db()
        self.assertEqual(parish.schedule_weights, ParishSettingsForm.DEFAULT_SCHEDULE_WEIGHTS)

    def test_update_parish_settings_extended_weights(self):
        User = get_user_model()
        user = User.objects.create_user(email="admin4@example.com", full_name="Admin", password="pass")
        parish = Parish.objects.create(name="Parish", consolidation_days=14, horizon_days=60, schedule_weights={})
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        membership = ParishMembership.objects.create(parish=parish, user=user, active=True)
        membership.roles.add(role)

        self.client.login(email="admin4@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.post(
            "/settings/",
            {
                "consolidation_days": 10,
                "horizon_days": 45,
                "default_mass_duration_minutes": 60,
                "min_rest_minutes_between_masses": 0,
                "home_community_bonus": 55,
                "community_recent_penalty": 7,
                "community_recent_window_days": 20,
                "scarcity_bonus": 12,
                "event_series_community_factor": 0.3,
                "single_mass_community_policy": "special",
                "interest_deadline_hours": 24,
                "interested_pool_fallback": "strict",
            },
        )
        self.assertEqual(response.status_code, 302)
        parish.refresh_from_db()
        weights = parish.schedule_weights
        self.assertEqual(weights.get("home_community_bonus"), 55)
        self.assertEqual(weights.get("community_recent_penalty"), 7)
        self.assertEqual(weights.get("community_recent_window_days"), 20)
        self.assertEqual(weights.get("scarcity_bonus"), 12)
        self.assertAlmostEqual(weights.get("event_series_community_factor"), 0.3)
        self.assertEqual(weights.get("single_mass_community_policy"), "special")
        self.assertEqual(weights.get("interest_deadline_hours"), 24)
        self.assertEqual(weights.get("interested_pool_fallback"), "strict")
```

### web\tests\test_people.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import (
    AcolyteProfile,
    Community,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
    MassInstance,
    AssignmentSlot,
    Assignment,
    AcolyteQualification,
)
from django.utils import timezone
from datetime import timedelta


class PeopleTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.role_admin = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        self.role_acolyte = MembershipRole.objects.create(code="ACOLYTE", name="Acolyte")
        self.role_system = MembershipRole.objects.create(code="SYSTEM_ADMIN", name="System admin")
        self.admin = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.admin, active=True)
        membership.roles.add(self.role_admin)

    def _login(self, user=None):
        if not user:
            user = self.admin
        self.client.login(email=user.email, password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_people_directory_requires_admin(self):
        User = get_user_model()
        user = User.objects.create_user(email="acolyte@example.com", full_name="Acolyte", password="pass")
        membership = ParishMembership.objects.create(parish=self.parish, user=user, active=True)
        membership.roles.add(self.role_acolyte)
        self._login(user)
        response = self.client.get("/people/")
        self.assertEqual(response.status_code, 403)

    def test_people_directory_lists_user_and_acolyte(self):
        User = get_user_model()
        user_only = User.objects.create_user(email="member@example.com", full_name="Member", password="pass")
        ParishMembership.objects.create(parish=self.parish, user=user_only, active=True)
        AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito sem login")
        self._login()
        response = self.client.get("/people/")
        self.assertContains(response, "Member")
        self.assertContains(response, "Acolito sem login")

    def test_people_create_acolyte_only(self):
        self._login()
        response = self.client.post(
            "/people/new/",
            {
                "full_name": "Novo Acolito",
                "phone": "",
                "is_acolyte": "on",
                "community_of_origin": self.community.id,
                "experience_level": "intermediate",
            },
        )
        self.assertEqual(response.status_code, 302)
        acolyte = AcolyteProfile.objects.filter(parish=self.parish, display_name="Novo Acolito").first()
        self.assertIsNotNone(acolyte)
        self.assertIsNone(acolyte.user)

    def test_people_create_admin_user(self):
        self._login()
        response = self.client.post(
            "/people/new/",
            {
                "full_name": "Novo Admin",
                "has_login": "on",
                "email": "novo@example.com",
                "password": "pass1234",
                "has_admin_access": "on",
                "roles": [self.role_admin.id],
            },
        )
        self.assertEqual(response.status_code, 302)
        user = get_user_model().objects.get(email="novo@example.com")
        membership = ParishMembership.objects.get(parish=self.parish, user=user)
        self.assertTrue(membership.roles.filter(code="PARISH_ADMIN").exists())

    def test_people_create_blocks_system_admin(self):
        self._login()
        response = self.client.post(
            "/people/new/",
            {
                "full_name": "Novo Admin",
                "has_login": "on",
                "email": "forbidden@example.com",
                "password": "pass1234",
                "has_admin_access": "on",
                "roles": [self.role_system.id],
            },
        )
        self.assertEqual(response.status_code, 200)
        self.assertFalse(get_user_model().objects.filter(email="forbidden@example.com").exists())

    def test_deactivate_acolyte_removes_future_assignments(self):
        self._login()
        position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        acolyte = AcolyteProfile.objects.create(
            parish=self.parish,
            display_name="Acolito A",
            community_of_origin=self.community,
            experience_level="intermediate",
            active=True,
        )
        AcolyteQualification.objects.create(parish=self.parish, acolyte=acolyte, position_type=position, qualified=True)
        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=7),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(parish=self.parish, mass_instance=instance, position_type=position)
        assignment = Assignment.objects.create(
            parish=self.parish, slot=slot, acolyte=acolyte, is_active=True
        )

        response = self.client.post(
            f"/people/acolyte/{acolyte.id}/",
            {
                "form_type": "acolyte",
                "display_name": acolyte.display_name,
                "community_of_origin": self.community.id,
                "experience_level": "intermediate",
                "scheduling_mode": "normal",
                "notes": "",
            },
        )
        self.assertEqual(response.status_code, 302)
        assignment.refresh_from_db()
        slot.refresh_from_db()
        self.assertFalse(assignment.is_active)
        self.assertEqual(slot.status, "open")
```

### web\tests\test_permissions.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import Community, Parish, ParishMembership


class WebPermissionsTests(TestCase):
    def setUp(self):
        self.user = get_user_model().objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        ParishMembership.objects.create(parish=self.parish, user=self.user)

    def test_acolyte_cannot_access_templates(self):
        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()
        response = self.client.get("/templates/")
        self.assertEqual(response.status_code, 403)
```

### web\tests\test_preferences_view.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteAvailabilityRule,
    AcolyteProfile,
    Community,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
    RequirementProfile,
    RequirementProfilePosition,
    MassInstance,
)


class PreferencesViewTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        role = MembershipRole.objects.create(code="ACOLYTE", name="Acolyte")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)
        self.acolyte = AcolyteProfile.objects.create(parish=self.parish, user=self.user, display_name="Acolito")

        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_weekly_deduplicates_rules(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="unavailable",
            day_of_week=1,
            community=self.community,
        )
        response = self.client.post(
            "/preferences/",
            {
                "form_type": "weekly_availability",
                "rule_type": "unavailable",
                "day_of_week": 1,
                "community": self.community.id,
            },
        )
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Voce ja possui uma regra igual.")
        self.assertEqual(
            AcolyteAvailabilityRule.objects.filter(parish=self.parish, acolyte=self.acolyte).count(), 1
        )

    def test_weekly_create_redirects(self):
        response = self.client.post(
            "/preferences/",
            {
                "form_type": "weekly_availability",
                "rule_type": "unavailable",
                "day_of_week": 1,
                "community": self.community.id,
            },
        )
        self.assertEqual(response.status_code, 302)
        self.assertEqual(
            AcolyteAvailabilityRule.objects.filter(parish=self.parish, acolyte=self.acolyte).count(), 1
        )

    def test_date_absence_deduplicates_rules(self):
        start_date = timezone.now().date()
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="unavailable",
            start_date=start_date,
            end_date=start_date,
        )
        response = self.client.post(
            "/preferences/",
            {
                "form_type": "date_absence",
                "start_date": start_date.isoformat(),
            },
        )
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Voce ja possui uma regra igual.")
        self.assertEqual(
            AcolyteAvailabilityRule.objects.filter(parish=self.parish, acolyte=self.acolyte).count(), 1
        )

    def test_weekly_overlap_shows_message(self):
        AcolyteAvailabilityRule.objects.create(
            parish=self.parish,
            acolyte=self.acolyte,
            rule_type="unavailable",
            day_of_week=1,
            start_time=timezone.datetime.strptime("09:00", "%H:%M").time(),
            end_time=timezone.datetime.strptime("11:00", "%H:%M").time(),
        )
        response = self.client.post(
            "/preferences/",
            {
                "form_type": "weekly_availability",
                "rule_type": "unavailable",
                "day_of_week": 1,
                "start_time": "10:00",
                "end_time": "12:00",
            },
        )
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Ja existe uma regra semelhante nesse dia/horario.")

    def test_preferences_diagnostics_when_no_qualification(self):
        position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        profile = RequirementProfile.objects.create(parish=self.parish, name="Perfil")
        RequirementProfilePosition.objects.create(profile=profile, position_type=position, quantity=1)
        MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            requirement_profile=profile,
            starts_at=timezone.now() + timezone.timedelta(days=5),
            status="scheduled",
        )
        response = self.client.get("/preferences/")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Sem qualificacoes definidas")
```

### web\tests\test_replacement_resolve.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    Community,
    MassInstance,
    MassOverride,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
    AssignmentSlot,
    ReplacementRequest,
)


class ReplacementResolveTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)

    def _login(self):
        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_resolve_cancel_mass_creates_override(self):
        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="open",
        )
        other_slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=self.position,
            slot_index=2,
            required=True,
            status="assigned",
        )
        acolyte = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito")
        assignment = Assignment.objects.create(parish=self.parish, slot=other_slot, acolyte=acolyte)
        replacement = ReplacementRequest.objects.create(parish=self.parish, slot=slot, status="pending")
        other_replacement = ReplacementRequest.objects.create(parish=self.parish, slot=other_slot, status="assigned")

        self._login()
        response = self.client.post(
            f"/replacements/{replacement.id}/resolve/",
            {"resolution_type": "mass_canceled", "notes": "Teste", "confirm_cancel_mass": "on"},
        )
        self.assertEqual(response.status_code, 302)

        instance.refresh_from_db()
        slot.refresh_from_db()
        other_slot.refresh_from_db()
        assignment.refresh_from_db()
        replacement.refresh_from_db()
        other_replacement.refresh_from_db()
        self.assertEqual(instance.status, "canceled")
        self.assertFalse(slot.required)
        self.assertFalse(other_slot.required)
        self.assertEqual(slot.status, "finalized")
        self.assertEqual(other_slot.status, "finalized")
        self.assertFalse(assignment.is_active)
        self.assertEqual(replacement.status, "resolved")
        self.assertEqual(other_replacement.status, "resolved")
        self.assertTrue(MassOverride.objects.filter(parish=self.parish, instance=instance, override_type="cancel_instance").exists())

    def test_resolve_slot_not_required_updates_slot(self):
        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="open",
        )
        replacement = ReplacementRequest.objects.create(parish=self.parish, slot=slot, status="pending")

        self._login()
        response = self.client.post(
            f"/replacements/{replacement.id}/resolve/",
            {"resolution_type": "slot_not_required", "notes": "Sem necessidade"},
        )
        self.assertEqual(response.status_code, 302)

        slot.refresh_from_db()
        replacement.refresh_from_db()
        self.assertFalse(slot.required)
        self.assertEqual(slot.status, "finalized")
        self.assertEqual(replacement.status, "resolved")

    def test_resolve_covered_externally_marks_slot(self):
        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="open",
        )
        replacement = ReplacementRequest.objects.create(parish=self.parish, slot=slot, status="pending")

        self._login()
        response = self.client.post(
            f"/replacements/{replacement.id}/resolve/",
            {"resolution_type": "covered_externally", "notes": "Coberto pelo coral"},
        )
        self.assertEqual(response.status_code, 302)

        slot.refresh_from_db()
        replacement.refresh_from_db()
        self.assertTrue(slot.externally_covered)
        self.assertFalse(slot.required)
        self.assertEqual(slot.status, "finalized")
        self.assertEqual(slot.external_coverage_notes, "Coberto pelo coral")
        self.assertEqual(replacement.status, "resolved")

    def test_resolve_other_keeps_slot_open(self):
        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=self.position,
            slot_index=1,
            required=False,
            status="finalized",
            externally_covered=True,
            external_coverage_notes="Coberto",
        )
        replacement = ReplacementRequest.objects.create(parish=self.parish, slot=slot, status="pending")

        self._login()
        response = self.client.post(
            f"/replacements/{replacement.id}/resolve/",
            {"resolution_type": "other", "notes": "Outro motivo"},
        )
        self.assertEqual(response.status_code, 302)

        slot.refresh_from_db()
        replacement.refresh_from_db()
        self.assertTrue(slot.required)
        self.assertEqual(slot.status, "open")
        self.assertFalse(slot.externally_covered)
        self.assertEqual(slot.external_coverage_notes, "")
        self.assertEqual(replacement.status, "resolved")
```

### web\tests\test_reports_frequency.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
)


class FrequencyReportTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)

        self.acolyte_a = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito A")
        self.acolyte_b = AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito B")

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_frequency_counts_assignments(self):
        now = timezone.now()
        instance_a = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=now + timedelta(days=1),
            status="scheduled",
        )
        slot_a = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance_a,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(
            parish=self.parish,
            slot=slot_a,
            acolyte=self.acolyte_a,
            assignment_state="published",
        )

        instance_b = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=now + timedelta(days=2),
            status="scheduled",
        )
        slot_b = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance_b,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(
            parish=self.parish,
            slot=slot_b,
            acolyte=self.acolyte_a,
            assignment_state="published",
        )

        instance_c = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=now + timedelta(days=3),
            status="scheduled",
        )
        slot_c = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance_c,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        Assignment.objects.create(
            parish=self.parish,
            slot=slot_c,
            acolyte=self.acolyte_b,
            assignment_state="published",
        )

        start = timezone.localdate()
        end = start + timedelta(days=10)
        response = self.client.get(f"/reports/frequency/?start={start.isoformat()}&end={end.isoformat()}")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "Acolito A")
        self.assertContains(response, "Acolito B")
```

### web\tests\test_roster.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    AssignmentSlot,
    Community,
    MassInstance,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
    RequirementProfile,
    RequirementProfilePosition,
)


class RosterViewTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)
        AcolyteProfile.objects.create(parish=self.parish, display_name="Acolito")

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_roster_marks_open_and_external_and_na(self):
        position_open = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        position_external = PositionType.objects.create(parish=self.parish, code="TUR", name="Turiferario")
        position_na = PositionType.objects.create(parish=self.parish, code="NAV", name="Naveteiro")

        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=1),
            status="scheduled",
        )
        AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=position_open,
            slot_index=1,
            required=True,
            status="open",
        )
        AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=position_external,
            slot_index=1,
            required=False,
            externally_covered=True,
            status="finalized",
        )
        AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=position_na,
            slot_index=1,
            required=False,
            status="finalized",
        )

        start = timezone.localdate()
        end = start + timedelta(days=2)
        response = self.client.get(f"/roster/?start={start.isoformat()}&end={end.isoformat()}")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "ABERTO")
        self.assertContains(response, "Externo")
        self.assertContains(response, "N/A")

    def test_roster_creates_missing_slots_from_profile(self):
        position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        profile = RequirementProfile.objects.create(parish=self.parish, name="Dominical")
        RequirementProfilePosition.objects.create(profile=profile, position_type=position, quantity=1)

        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=1),
            status="scheduled",
            requirement_profile=profile,
        )

        start = timezone.localdate()
        end = start + timedelta(days=2)
        response = self.client.get(f"/roster/?start={start.isoformat()}&end={end.isoformat()}")
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, "ABERTO")

    def test_roster_requires_admin(self):
        User = get_user_model()
        user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        role = MembershipRole.objects.create(code="ACOLYTE", name="Acolyte")
        membership = ParishMembership.objects.create(parish=self.parish, user=user, active=True)
        membership.roles.add(role)

        client = self.client
        client.logout()
        client.login(email="user@example.com", password="pass")
        session = client.session
        session["active_parish_id"] = self.parish.id
        session.save()

        response = client.get("/roster/")
        self.assertEqual(response.status_code, 403)


class RosterExportTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

        position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=1),
            status="scheduled",
        )
        AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="open",
        )

    def test_export_pdf_returns_pdf(self):
        start = timezone.localdate()
        end = start + timedelta(days=2)
        response = self.client.get(f"/roster/export/pdf/?start={start.isoformat()}&end={end.isoformat()}")
        self.assertEqual(response.status_code, 200)
        self.assertIn("application/pdf", response["Content-Type"])

    def test_export_whatsapp_returns_text(self):
        start = timezone.localdate()
        end = start + timedelta(days=2)
        response = self.client.get(f"/roster/export/whatsapp/?start={start.isoformat()}&end={end.isoformat()}")
        self.assertEqual(response.status_code, 200)
        self.assertIn("ABERTO", response.content.decode("utf-8"))
```

### web\tests\test_scheduling_dashboard.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    AssignmentSlot,
    Community,
    Confirmation,
    MassInstance,
    MembershipRole,
    Parish,
    ParishMembership,
    PositionType,
)


class SchedulingDashboardTests(TestCase):
    def test_pending_confirmations_ignore_inactive(self):
        User = get_user_model()
        user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        parish = Parish.objects.create(name="Parish", consolidation_days=14)
        community = Community.objects.create(parish=parish, code="MAT", name="Matriz")
        position = PositionType.objects.create(parish=parish, code="LIB", name="Libriferario")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Parish admin")
        membership = ParishMembership.objects.create(parish=parish, user=user, active=True)
        membership.roles.add(role)

        acolyte = AcolyteProfile.objects.create(parish=parish, display_name="Acolito")
        instance = MassInstance.objects.create(
            parish=parish,
            community=community,
            starts_at=timezone.now() + timedelta(days=2),
            status="scheduled",
        )
        slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        active_assignment = Assignment.objects.create(parish=parish, slot=slot, acolyte=acolyte, is_active=True)
        Confirmation.objects.create(parish=parish, assignment=active_assignment, status="pending")

        inactive_slot = AssignmentSlot.objects.create(
            parish=parish,
            mass_instance=instance,
            position_type=position,
            slot_index=2,
            required=True,
            status="assigned",
        )
        inactive_assignment = Assignment.objects.create(parish=parish, slot=inactive_slot, acolyte=acolyte, is_active=False)
        Confirmation.objects.create(parish=parish, assignment=inactive_assignment, status="pending")

        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = parish.id
        session.save()

        response = self.client.get("/scheduling/")
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context["pending_confirmations"], 1)
```

### web\tests\test_smoke.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import Community, Parish, ParishMembership


class SmokeTests(TestCase):
    def setUp(self):
        self.user = get_user_model().objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        ParishMembership.objects.create(parish=self.parish, user=self.user)

    def test_dashboard_loads(self):
        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()
        response = self.client.get("/")
        self.assertEqual(response.status_code, 200)
```

### web\tests\test_structure_views.py
```python
from django.contrib.auth import get_user_model
from django.test import TestCase

from core.models import (
    AssignmentSlot,
    Community,
    FunctionType,
    MembershipRole,
    MassInstance,
    Parish,
    ParishMembership,
    PositionType,
    PositionTypeFunction,
    RequirementProfile,
    RequirementProfilePosition,
)
from django.utils import timezone


class StructureViewsTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="admin@example.com", full_name="Admin", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        role = MembershipRole.objects.create(code="PARISH_ADMIN", name="Admin")
        membership = ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        membership.roles.add(role)
        self.client.login(email="admin@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

    def test_community_create(self):
        response = self.client.post(
            "/structure/communities/new/",
            {"code": "MAT", "name": "Matriz", "address": "Rua A", "active": True},
        )
        self.assertEqual(response.status_code, 302)
        self.assertTrue(Community.objects.filter(parish=self.parish, code="MAT").exists())

    def test_role_create_creates_position_and_function(self):
        response = self.client.post(
            "/structure/roles/new/",
            {"name": "Libriferario", "code": "LIB", "active": True},
        )
        self.assertEqual(response.status_code, 302)
        position = PositionType.objects.get(parish=self.parish, code="LIB")
        function = FunctionType.objects.get(parish=self.parish, code="LIB")
        self.assertEqual(position.name, "Libriferario")
        self.assertTrue(PositionTypeFunction.objects.filter(position_type=position, function_type=function).exists())

    def test_requirement_profile_create(self):
        position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario", active=True)
        payload = {
            "name": "Dominical",
            "notes": "",
            "min_senior_per_mass": 0,
            "active": True,
            "positions-TOTAL_FORMS": 1,
            "positions-INITIAL_FORMS": 0,
            "positions-MIN_NUM_FORMS": 0,
            "positions-MAX_NUM_FORMS": 1000,
            "positions-0-position_type": position.id,
            "positions-0-quantity": 1,
        }
        response = self.client.post("/structure/requirement-profiles/new/", payload)
        self.assertEqual(response.status_code, 302)
        profile = RequirementProfile.objects.get(parish=self.parish, name="Dominical")
        self.assertTrue(
            RequirementProfilePosition.objects.filter(profile=profile, position_type=position, quantity=1).exists()
        )

    def test_structure_requires_admin(self):
        User = get_user_model()
        user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        role = MembershipRole.objects.create(code="ACOLYTE", name="Acolyte")
        membership = ParishMembership.objects.create(parish=self.parish, user=user, active=True)
        membership.roles.add(role)

        self.client.logout()
        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

        response = self.client.get("/structure/communities/")
        self.assertEqual(response.status_code, 403)

    def test_role_delete_blocked_when_has_assignments(self):
        role = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario", active=True)
        community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz", active=True)
        instance = MassInstance.objects.create(parish=self.parish, community=community, starts_at=timezone.now())
        AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=role,
            slot_index=1,
        )
        response = self.client.post(f"/structure/roles/{role.id}/delete/", follow=True)
        self.assertEqual(response.status_code, 200)
        self.assertTrue(PositionType.objects.filter(id=role.id).exists())
        self.assertContains(response, "Nao e possivel excluir esta funcao")

    def test_role_delete_unused(self):
        role = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario", active=True)
        response = self.client.post(f"/structure/roles/{role.id}/delete/")
        self.assertEqual(response.status_code, 302)
        self.assertFalse(PositionType.objects.filter(id=role.id).exists())
```

### web\tests\test_swaps.py
```python
from datetime import timedelta

from django.contrib.auth import get_user_model
from django.test import TestCase
from django.utils import timezone

from core.models import (
    AcolyteProfile,
    Assignment,
    AssignmentSlot,
    Community,
    MassInstance,
    Parish,
    PositionType,
    SwapRequest,
    ParishMembership,
)


class SwapAuthorizationTests(TestCase):
    def setUp(self):
        User = get_user_model()
        self.user = User.objects.create_user(email="user@example.com", full_name="User", password="pass")
        self.parish = Parish.objects.create(name="Parish")
        self.community = Community.objects.create(parish=self.parish, code="MAT", name="Matriz")
        self.position = PositionType.objects.create(parish=self.parish, code="LIB", name="Libriferario")
        self.acolyte = AcolyteProfile.objects.create(parish=self.parish, user=self.user, display_name="Acolito")
        ParishMembership.objects.create(parish=self.parish, user=self.user, active=True)
        instance = MassInstance.objects.create(
            parish=self.parish,
            community=self.community,
            starts_at=timezone.now() + timedelta(days=3),
            status="scheduled",
        )
        self.slot = AssignmentSlot.objects.create(
            parish=self.parish,
            mass_instance=instance,
            position_type=self.position,
            slot_index=1,
            required=True,
            status="assigned",
        )
        self.assignment = Assignment.objects.create(parish=self.parish, slot=self.slot, acolyte=self.acolyte)
        self.swap = SwapRequest.objects.create(
            parish=self.parish,
            swap_type="acolyte_swap",
            requestor_acolyte=self.acolyte,
            mass_instance=instance,
            from_slot=self.slot,
            status="pending",
            open_to_admin=True,
        )

    def test_non_admin_cannot_accept_open_swap(self):
        self.client.login(email="user@example.com", password="pass")
        session = self.client.session
        session["active_parish_id"] = self.parish.id
        session.save()

        response = self.client.post(f"/swap-requests/{self.swap.id}/accept/")
        self.assertEqual(response.status_code, 302)
        self.swap.refresh_from_db()
        self.assertTrue(self.swap.open_to_admin)
        self.assertEqual(self.swap.status, "pending")
```

### web\tests\test_templatetags.py
```python
from django.test import SimpleTestCase

from web.templatetags.extras import (
    assignment_end_reason_label,
    confirmation_status_label,
    get_item,
    get_list_item,
    slot_status_label,
)


class TemplateTagTests(SimpleTestCase):
    def test_get_item_returns_none_when_missing(self):
        self.assertIsNone(get_item(None, "key"))
        self.assertIsNone(get_item({}, "key"))
        self.assertEqual(get_item({"key": "value"}, "key"), "value")

    def test_get_list_item_returns_empty_list_when_missing(self):
        self.assertEqual(get_list_item(None, "key"), [])
        self.assertEqual(get_list_item({}, "key"), [])
        self.assertEqual(get_list_item({"key": [1, 2]}, "key"), [1, 2])

    def test_choice_labels_normalize_case(self):
        self.assertEqual(slot_status_label("Assigned"), "Atribuida")
        self.assertEqual(slot_status_label("ASSIGNED"), "Atribuida")
        self.assertEqual(assignment_end_reason_label("replaced_by_solver"), "Substituido pelo sistema")
        self.assertEqual(assignment_end_reason_label("moved_to_another_slot"), "Movido para outra posicao")
        self.assertEqual(confirmation_status_label("PENDING"), "Pendente")
```

### web\apps.py
```python
from django.apps import AppConfig


class WebConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "web"
```

### web\forms.py
```python
from datetime import time as dt_time
import re

from django import forms
from django.forms import inlineformset_factory
from django.forms.models import BaseInlineFormSet
from django.db.models import Q
from django.contrib.auth import get_user_model

from core.models import (
    AcolyteAvailabilityRule,
    AcolyteCreditLedger,
    AcolyteIntent,
    AcolytePreference,
    AcolyteProfile,
    AcolyteQualification,
    AssignmentSlot,
    Community,
    EventOccurrence,
    EventSeries,
    FamilyGroup,
    FunctionType,
    MassTemplate,
    MassInstance,
    MembershipRole,
    ParishMembership,
    RequirementProfile,
    RequirementProfilePosition,
    PositionType,
)
from notifications.models import NotificationPreference

import json

WEEKDAY_CHOICES = [
    (0, "Seg"),
    (1, "Ter"),
    (2, "Qua"),
    (3, "Qui"),
    (4, "Sex"),
    (5, "Sab"),
    (6, "Dom"),
]


def normalize_code(value):
    if not value:
        return ""
    value = value.strip().upper().replace(" ", "_")
    value = re.sub(r"[^A-Z0-9_]", "", value)
    return value


def generate_unique_code(parish, name, model, max_len, exclude_id=None):
    base = normalize_code(name) or "ROLE"
    base = base[:max_len]
    code = base
    suffix = 1
    qs = model.objects.filter(parish=parish)
    if exclude_id:
        qs = qs.exclude(id=exclude_id)
    while qs.filter(code=code).exists():
        tail = str(suffix)
        code = f"{base[: max_len - len(tail)]}{tail}"
        suffix += 1
    return code


class MassTemplateForm(forms.ModelForm):
    class Meta:
        model = MassTemplate
        fields = ["title", "community", "weekday", "time", "rrule_text", "default_requirement_profile", "notes", "active"]

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        if self.parish:
            self.fields["community"].queryset = Community.objects.filter(parish=self.parish, active=True)
            self.fields["default_requirement_profile"].queryset = RequirementProfile.objects.filter(
                parish=self.parish, active=True
            )

    def clean(self):
        cleaned = super().clean()
        if not self.parish:
            return cleaned
        community = cleaned.get("community")
        profile = cleaned.get("default_requirement_profile")
        if community and community.parish_id != self.parish.id:
            self.add_error("community", "Selecione uma comunidade valida para esta paroquia.")
        if profile and profile.parish_id != self.parish.id:
            self.add_error("default_requirement_profile", "Selecione um perfil valido para esta paroquia.")
        return cleaned


class EventSeriesBasicsForm(forms.Form):
    SERIES_TYPE_CHOICES = [
        ("Solenidade", "Solenidade"),
        ("Festa", "Festa"),
        ("Memoria", "Memoria"),
        ("Triduo", "Triduo"),
        ("Novena", "Novena"),
        ("Oitava", "Oitava"),
        ("Missa especial", "Missa especial"),
        ("Outro", "Outro"),
    ]

    series_type = forms.ChoiceField(choices=SERIES_TYPE_CHOICES)
    series_type_other = forms.CharField(max_length=40, required=False)
    title = forms.CharField(max_length=200)
    start_date = forms.DateField(
        widget=forms.DateInput(attrs={"type": "date"}, format="%Y-%m-%d"),
        input_formats=["%Y-%m-%d"],
    )
    end_date = forms.DateField(
        widget=forms.DateInput(attrs={"type": "date"}, format="%Y-%m-%d"),
        input_formats=["%Y-%m-%d"],
    )
    default_time = forms.TimeField(
        widget=forms.TimeInput(attrs={"type": "time"}, format="%H:%M"),
        input_formats=["%H:%M"],
    )
    candidate_pool = forms.ChoiceField(
        choices=[("all", "Todos os acolitos"), ("interested_only", "Somente interessados (opt-in)")]
    )
    interest_deadline_at = forms.DateTimeField(
        required=False,
        widget=forms.DateTimeInput(attrs={"type": "datetime-local"}, format="%Y-%m-%dT%H:%M"),
        input_formats=["%Y-%m-%dT%H:%M"],
    )
    default_community = forms.ModelChoiceField(queryset=Community.objects.none(), required=False)
    default_requirement_profile = forms.ModelChoiceField(queryset=RequirementProfile.objects.none(), required=False)

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        self.parish = parish
        if parish:
            self.fields["default_community"].queryset = Community.objects.filter(parish=parish, active=True)
            self.fields["default_requirement_profile"].queryset = RequirementProfile.objects.filter(parish=parish, active=True)

    def clean(self):
        cleaned = super().clean()
        if self.parish:
            community = cleaned.get("default_community")
            profile = cleaned.get("default_requirement_profile")
            if community and community.parish_id != self.parish.id:
                self.add_error("default_community", "Selecione uma comunidade valida para esta paroquia.")
            if profile and profile.parish_id != self.parish.id:
                self.add_error("default_requirement_profile", "Selecione um perfil valido para esta paroquia.")
        start_date = cleaned.get("start_date")
        end_date = cleaned.get("end_date")
        if start_date and end_date and end_date < start_date:
            self.add_error("end_date", "Data final deve ser maior ou igual a data inicial.")
        if cleaned.get("series_type") == "Outro":
            other = (cleaned.get("series_type_other") or "").strip()
            if not other:
                self.add_error("series_type_other", "Informe o tipo da celebracao.")
            else:
                cleaned["series_type"] = other
        if cleaned.get("candidate_pool") != "interested_only":
            cleaned["interest_deadline_at"] = None
        return cleaned


class EventOccurrenceForm(forms.Form):
    date = forms.DateField(widget=forms.HiddenInput)
    time = forms.TimeField(widget=forms.TimeInput(attrs={"type": "time"}))
    community = forms.ModelChoiceField(queryset=Community.objects.none())
    requirement_profile = forms.ModelChoiceField(queryset=RequirementProfile.objects.none(), required=False)
    label = forms.CharField(max_length=200, required=False)
    conflict_action = forms.ChoiceField(choices=EventOccurrence.CONFLICT_CHOICES)
    move_to_date = forms.DateField(required=False, widget=forms.DateInput(attrs={"type": "date"}))
    move_to_time = forms.TimeField(required=False, widget=forms.TimeInput(attrs={"type": "time"}))
    move_to_community = forms.ModelChoiceField(queryset=Community.objects.none(), required=False)

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        self.parish = parish
        if parish:
            community_qs = Community.objects.filter(parish=parish, active=True)
            self.fields["community"].queryset = community_qs
            self.fields["move_to_community"].queryset = community_qs
            self.fields["requirement_profile"].queryset = RequirementProfile.objects.filter(parish=parish, active=True)

    def clean(self):
        cleaned = super().clean()
        if not self.parish:
            return cleaned
        community = cleaned.get("community")
        move_to_community = cleaned.get("move_to_community")
        profile = cleaned.get("requirement_profile")
        if community and community.parish_id != self.parish.id:
            self.add_error("community", "Selecione uma comunidade valida para esta paroquia.")
        if move_to_community and move_to_community.parish_id != self.parish.id:
            self.add_error("move_to_community", "Selecione uma comunidade valida para esta paroquia.")
        if profile and profile.parish_id != self.parish.id:
            self.add_error("requirement_profile", "Selecione um perfil valido para esta paroquia.")
        conflict_action = cleaned.get("conflict_action")
        move_to_date = cleaned.get("move_to_date")
        move_to_time = cleaned.get("move_to_time")
        if conflict_action == "move_existing":
            if not move_to_date:
                self.add_error("move_to_date", "Informe a data para mover a missa.")
            if not move_to_time:
                self.add_error("move_to_time", "Informe o horario para mover a missa.")
            if not move_to_community:
                self.add_error("move_to_community", "Informe a comunidade para mover a missa.")
        else:
            cleaned["move_to_date"] = None
            cleaned["move_to_time"] = None
            cleaned["move_to_community"] = None
        return cleaned


class MassInstanceUpdateForm(forms.ModelForm):
    class Meta:
        model = MassInstance
        fields = ["liturgy_label", "requirement_profile"]

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        if parish:
            self.fields["requirement_profile"].queryset = RequirementProfile.objects.filter(parish=parish, active=True)


class MassInstanceMoveForm(forms.Form):
    starts_at = forms.DateTimeField(
        input_formats=["%Y-%m-%dT%H:%M"],
        widget=forms.DateTimeInput(attrs={"type": "datetime-local"}),
    )
    community = forms.ModelChoiceField(queryset=Community.objects.none())

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        if parish:
            self.fields["community"].queryset = Community.objects.filter(parish=parish, active=True)


class MassInstanceCancelForm(forms.Form):
    reason = forms.CharField(max_length=200, required=False)


class AcolyteAvailabilityRuleForm(forms.ModelForm):
    class Meta:
        model = AcolyteAvailabilityRule
        fields = [
            "rule_type",
            "day_of_week",
            "start_time",
            "end_time",
            "community",
            "start_date",
            "end_date",
            "notes",
        ]
        widgets = {
            "start_date": forms.DateInput(attrs={"type": "date"}),
            "end_date": forms.DateInput(attrs={"type": "date"}),
            "start_time": forms.TimeInput(attrs={"type": "time"}),
            "end_time": forms.TimeInput(attrs={"type": "time"}),
        }

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        self.fields["day_of_week"].choices = [("", "Qualquer dia")] + WEEKDAY_CHOICES
        if self.parish:
            self.fields["community"].queryset = Community.objects.filter(parish=self.parish, active=True)

    def clean_day_of_week(self):
        value = self.cleaned_data.get("day_of_week")
        if value in ("", None):
            return None
        return value

    def clean(self):
        cleaned = super().clean()
        if self.parish:
            community = cleaned.get("community")
            if community and community.parish_id != self.parish.id:
                self.add_error("community", "Selecione uma comunidade valida para esta paroquia.")
        return cleaned


class WeeklyAvailabilityForm(forms.ModelForm):
    class Meta:
        model = AcolyteAvailabilityRule
        fields = ["rule_type", "day_of_week", "start_time", "end_time", "community", "notes"]
        widgets = {
            "start_time": forms.TimeInput(attrs={"type": "time"}),
            "end_time": forms.TimeInput(attrs={"type": "time"}),
        }

    def __init__(self, *args, **kwargs):
        self.acolyte = kwargs.pop("acolyte", None)
        super().__init__(*args, **kwargs)
        self.fields["day_of_week"].choices = [("", "Qualquer dia")] + WEEKDAY_CHOICES
        self.fields["day_of_week"].required = False
        self.fields["rule_type"].choices = [
            ("unavailable", "Indisponivel"),
            ("available_only", "Disponivel apenas"),
        ]
        if self.acolyte:
            self.fields["community"].queryset = Community.objects.filter(parish=self.acolyte.parish, active=True)

    def clean(self):
        cleaned = super().clean()
        day_of_week = cleaned.get("day_of_week")
        start_time = cleaned.get("start_time")
        end_time = cleaned.get("end_time")
        if day_of_week in ("", None):
            cleaned["day_of_week"] = None
        if start_time and end_time and start_time >= end_time:
            self.add_error("end_time", "Horario final deve ser depois do inicio.")
        if self.acolyte and not self.errors:
            community = cleaned.get("community")
            if community and community.parish_id != self.acolyte.parish_id:
                self.add_error("community", "Selecione uma comunidade valida para esta paroquia.")
                return cleaned
            base_filters = {
                "parish": self.acolyte.parish,
                "acolyte": self.acolyte,
                "rule_type": cleaned.get("rule_type"),
                "community": cleaned.get("community"),
            }
            day_value = cleaned.get("day_of_week")
            if day_value is None:
                day_filter = Q()
                duplicate_filter = Q(day_of_week__isnull=True)
            else:
                day_filter = Q(day_of_week=day_value) | Q(day_of_week__isnull=True)
                duplicate_filter = Q(day_of_week=day_value)

            duplicates = AcolyteAvailabilityRule.objects.filter(
                parish=self.acolyte.parish,
                acolyte=self.acolyte,
                rule_type=cleaned.get("rule_type"),
                community=cleaned.get("community"),
                start_time=cleaned.get("start_time"),
                end_time=cleaned.get("end_time"),
            ).filter(duplicate_filter)
            if self.instance and self.instance.pk:
                duplicates = duplicates.exclude(pk=self.instance.pk)
            if duplicates.exists():
                self.add_error(None, "Voce ja possui uma regra igual.")
                return cleaned

            qs = AcolyteAvailabilityRule.objects.filter(**base_filters).filter(day_filter)
            if self.instance and self.instance.pk:
                qs = qs.exclude(pk=self.instance.pk)
            new_start = cleaned.get("start_time") or dt_time.min
            new_end = cleaned.get("end_time") or dt_time.max
            for rule in qs:
                existing_start = rule.start_time or dt_time.min
                existing_end = rule.end_time or dt_time.max
                if rule.start_time and rule.end_time and rule.start_time >= rule.end_time:
                    continue
                if existing_start < new_end and new_start < existing_end:
                    self.add_error(None, "Ja existe uma regra semelhante nesse dia/horario.")
                    break
        return cleaned


class DateAbsenceForm(forms.ModelForm):
    class Meta:
        model = AcolyteAvailabilityRule
        fields = ["start_date", "end_date", "notes"]
        widgets = {
            "start_date": forms.DateInput(attrs={"type": "date"}),
            "end_date": forms.DateInput(attrs={"type": "date"}),
        }

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.fields["start_date"].required = True

    def clean(self):
        cleaned = super().clean()
        start_date = cleaned.get("start_date")
        end_date = cleaned.get("end_date")
        if not start_date:
            self.add_error("start_date", "Informe a data de inicio.")
            return cleaned
        if not end_date:
            cleaned["end_date"] = start_date
            end_date = start_date
        if end_date and start_date and end_date < start_date:
            self.add_error("end_date", "Data final deve ser maior ou igual a data inicial.")
        return cleaned


class AcolytePreferenceForm(forms.ModelForm):
    class Meta:
        model = AcolytePreference
        fields = [
            "preference_type",
            "target_community",
            "target_position",
            "target_function",
            "target_template",
            "target_acolyte",
            "weekday",
            "start_time",
            "end_time",
            "weight",
        ]
        widgets = {
            "start_time": forms.TimeInput(attrs={"type": "time"}),
            "end_time": forms.TimeInput(attrs={"type": "time"}),
        }

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        self.fields["weekday"].choices = [("", "Qualquer dia")] + WEEKDAY_CHOICES
        self.fields["preference_type"].choices = [
            ("preferred_community", "Preferir comunidade"),
            ("avoid_community", "Evitar comunidade"),
            ("preferred_timeslot", "Preferir horario"),
            ("preferred_mass_template", "Preferir modelo"),
            ("preferred_position", "Preferir posicao"),
            ("avoid_position", "Evitar posicao"),
            ("preferred_function", "Preferir funcao"),
            ("avoid_function", "Evitar funcao"),
            ("preferred_partner", "Preferir parceiro"),
            ("avoid_partner", "Evitar parceiro"),
        ]
        if self.parish:
            self.fields["target_community"].queryset = Community.objects.filter(parish=self.parish, active=True)
            self.fields["target_position"].queryset = self.parish.positiontype_set.filter(active=True)
            self.fields["target_function"].queryset = self.parish.functiontype_set.filter(active=True)
            self.fields["target_template"].queryset = self.parish.masstemplate_set.filter(active=True)
            self.fields["target_acolyte"].queryset = self.parish.acolytes.filter(active=True)

    def clean_weekday(self):
        value = self.cleaned_data.get("weekday")
        if value in ("", None):
            return None
        return value

    def clean(self):
        cleaned = super().clean()
        pref_type = cleaned.get("preference_type")
        if not pref_type:
            return cleaned

        weight = cleaned.get("weight")
        if weight in (None, ""):
            cleaned["weight"] = 50

        target_fields = {
            "target_community",
            "target_position",
            "target_function",
            "target_template",
            "target_acolyte",
        }
        required_target = {
            "preferred_community": "target_community",
            "avoid_community": "target_community",
            "preferred_position": "target_position",
            "avoid_position": "target_position",
            "preferred_function": "target_function",
            "avoid_function": "target_function",
            "preferred_mass_template": "target_template",
            "preferred_partner": "target_acolyte",
            "avoid_partner": "target_acolyte",
        }
        allowed_targets = set()
        if pref_type in required_target:
            allowed_targets.add(required_target[pref_type])

        for field in target_fields - allowed_targets:
            cleaned[field] = None

        if pref_type == "preferred_timeslot":
            weekday = cleaned.get("weekday")
            start_time = cleaned.get("start_time")
            end_time = cleaned.get("end_time")
            if not weekday and not start_time and not end_time:
                self.add_error(None, "Informe dia ou horario.")
            if start_time and end_time and start_time >= end_time:
                self.add_error("end_time", "Horario final deve ser depois do inicio.")
        else:
            cleaned["weekday"] = None
            cleaned["start_time"] = None
            cleaned["end_time"] = None

        required_field = required_target.get(pref_type)
        if required_field and not cleaned.get(required_field):
            self.add_error(required_field, "Campo obrigatorio.")

        if self.parish:
            target_community = cleaned.get("target_community")
            target_position = cleaned.get("target_position")
            target_function = cleaned.get("target_function")
            target_template = cleaned.get("target_template")
            target_acolyte = cleaned.get("target_acolyte")
            if target_community and target_community.parish_id != self.parish.id:
                self.add_error("target_community", "Selecione uma comunidade valida para esta paroquia.")
            if target_position and target_position.parish_id != self.parish.id:
                self.add_error("target_position", "Selecione uma posicao valida para esta paroquia.")
            if target_function and target_function.parish_id != self.parish.id:
                self.add_error("target_function", "Selecione uma funcao valida para esta paroquia.")
            if target_template and target_template.parish_id != self.parish.id:
                self.add_error("target_template", "Selecione um modelo valido para esta paroquia.")
            if target_acolyte and target_acolyte.parish_id != self.parish.id:
                self.add_error("target_acolyte", "Selecione um acolito valido para esta paroquia.")

        return cleaned


class SwapRequestForm(forms.Form):
    swap_type = forms.ChoiceField(choices=[("acolyte_swap", "Trocar acolito"), ("role_swap", "Trocar funcao")])
    target_acolyte = forms.ModelChoiceField(queryset=AcolyteProfile.objects.none(), required=False)
    to_slot = forms.ModelChoiceField(queryset=AssignmentSlot.objects.none(), required=False)
    notes = forms.CharField(required=False, max_length=200)

    def __init__(self, *args, **kwargs):
        acolytes_qs = kwargs.pop("acolytes_qs", None)
        slots_qs = kwargs.pop("slots_qs", None)
        super().__init__(*args, **kwargs)
        if acolytes_qs is not None:
            self.fields["target_acolyte"].queryset = acolytes_qs
        if slots_qs is not None:
            self.fields["to_slot"].queryset = slots_qs


class SwapAssignForm(forms.Form):
    target_acolyte = forms.ModelChoiceField(queryset=AcolyteProfile.objects.none())

    def __init__(self, *args, **kwargs):
        acolytes_qs = kwargs.pop("acolytes_qs", None)
        super().__init__(*args, **kwargs)
        if acolytes_qs is not None:
            self.fields["target_acolyte"].queryset = acolytes_qs


class ParishSettingsForm(forms.Form):
    DEFAULT_SCHEDULE_WEIGHTS = {
        "stability_penalty": 10,
        "fairness_penalty": 1,
        "credit_weight": 1,
        "max_solve_seconds": 15,
        "rotation_days": 60,
        "rotation_penalty": 3,
        "reserve_penalty": 1000,
        "home_community_bonus": 40,
        "community_recent_penalty": 6,
        "community_recent_window_days": 30,
        "scarcity_bonus": 15,
        "event_series_community_factor": 0.4,
        "single_mass_community_policy": "recurring",
        "interest_deadline_hours": 48,
        "interested_pool_fallback": "relax_to_all",
    }
    consolidation_days = forms.IntegerField(min_value=7, max_value=90)
    horizon_days = forms.IntegerField(min_value=30, max_value=90)
    default_mass_duration_minutes = forms.IntegerField(min_value=45, max_value=120)
    min_rest_minutes_between_masses = forms.IntegerField(min_value=0, max_value=60)
    swap_requires_approval = forms.BooleanField(required=False)
    notify_on_cancellation = forms.BooleanField(required=False)
    auto_assign_on_decline = forms.BooleanField(required=False)
    stability_penalty = forms.IntegerField(min_value=0, max_value=100, required=False)
    fairness_penalty = forms.IntegerField(min_value=0, max_value=100, required=False)
    credit_weight = forms.IntegerField(min_value=0, max_value=50, required=False)
    max_solve_seconds = forms.IntegerField(min_value=5, max_value=60, required=False)
    max_services_per_week = forms.IntegerField(min_value=0, max_value=10, required=False)
    max_consecutive_weekends = forms.IntegerField(min_value=0, max_value=10, required=False)
    rotation_penalty = forms.IntegerField(min_value=0, max_value=20, required=False)
    rotation_days = forms.IntegerField(min_value=0, max_value=120, required=False)
    reserve_penalty = forms.IntegerField(min_value=0, max_value=10000, required=False)
    home_community_bonus = forms.IntegerField(min_value=0, max_value=200, required=False)
    community_recent_penalty = forms.IntegerField(min_value=0, max_value=50, required=False)
    community_recent_window_days = forms.IntegerField(min_value=0, max_value=180, required=False)
    scarcity_bonus = forms.IntegerField(min_value=0, max_value=100, required=False)
    event_series_community_factor = forms.FloatField(min_value=0, max_value=1, required=False)
    single_mass_community_policy = forms.ChoiceField(
        choices=[
            ("recurring", "Tratar como recorrente"),
            ("special", "Tratar como evento"),
        ],
        required=False,
    )
    interest_deadline_hours = forms.IntegerField(min_value=0, max_value=168, required=False)
    interested_pool_fallback = forms.ChoiceField(
        choices=[
            ("relax_to_all", "Abrir para todos"),
            ("strict", "Manter fechado"),
            ("relax_to_preferred", "Somente preferidos"),
        ],
        required=False,
    )
    claim_auto_approve_enabled = forms.BooleanField(required=False)
    claim_auto_approve_hours = forms.IntegerField(min_value=0, max_value=168, required=False)
    claim_require_coordination = forms.BooleanField(required=False)
    schedule_weights_json = forms.CharField(required=False, widget=forms.Textarea(attrs={"rows": 4}))

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        if parish:
            weights = parish.schedule_weights or {}
            self.fields["consolidation_days"].initial = parish.consolidation_days
            self.fields["horizon_days"].initial = parish.horizon_days
            self.fields["default_mass_duration_minutes"].initial = parish.default_mass_duration_minutes
            self.fields["min_rest_minutes_between_masses"].initial = parish.min_rest_minutes_between_masses
            self.fields["swap_requires_approval"].initial = parish.swap_requires_approval
            self.fields["notify_on_cancellation"].initial = parish.notify_on_cancellation
            self.fields["auto_assign_on_decline"].initial = parish.auto_assign_on_decline
            self.fields["claim_auto_approve_enabled"].initial = parish.claim_auto_approve_enabled
            self.fields["claim_auto_approve_hours"].initial = parish.claim_auto_approve_hours
            self.fields["claim_require_coordination"].initial = parish.claim_require_coordination
            self.fields["stability_penalty"].initial = weights.get("stability_penalty", 10)
            self.fields["fairness_penalty"].initial = weights.get("fairness_penalty", 1)
            self.fields["credit_weight"].initial = weights.get("credit_weight", 1)
            self.fields["max_solve_seconds"].initial = weights.get("max_solve_seconds", 15)
            self.fields["max_services_per_week"].initial = weights.get("max_services_per_week")
            self.fields["max_consecutive_weekends"].initial = weights.get("max_consecutive_weekends")
            self.fields["rotation_penalty"].initial = weights.get("rotation_penalty", 3)
            self.fields["rotation_days"].initial = weights.get("rotation_days", 60)
            self.fields["reserve_penalty"].initial = weights.get("reserve_penalty", 1000)
            self.fields["home_community_bonus"].initial = weights.get("home_community_bonus", 40)
            self.fields["community_recent_penalty"].initial = weights.get("community_recent_penalty", 6)
            self.fields["community_recent_window_days"].initial = weights.get("community_recent_window_days", 30)
            self.fields["scarcity_bonus"].initial = weights.get("scarcity_bonus", 15)
            self.fields["event_series_community_factor"].initial = weights.get("event_series_community_factor", 0.4)
            self.fields["single_mass_community_policy"].initial = weights.get("single_mass_community_policy", "recurring")
            self.fields["interest_deadline_hours"].initial = weights.get("interest_deadline_hours", 48)
            self.fields["interested_pool_fallback"].initial = weights.get("interested_pool_fallback", "relax_to_all")
            self.fields["schedule_weights_json"].initial = json.dumps(weights, ensure_ascii=True, indent=2)

    def clean(self):
        cleaned = super().clean()
        consolidation = cleaned.get("consolidation_days")
        horizon = cleaned.get("horizon_days")
        if consolidation and horizon and horizon < consolidation:
            self.add_error("horizon_days", "O horizonte precisa ser maior ou igual a consolidacao.")
        raw_json = cleaned.get("schedule_weights_json")
        if raw_json:
            try:
                cleaned["schedule_weights"] = json.loads(raw_json)
            except json.JSONDecodeError:
                self.add_error("schedule_weights_json", "JSON invalido.")
        return cleaned

    def save(self, parish, actor=None):
        parish.consolidation_days = self.cleaned_data["consolidation_days"]
        parish.horizon_days = self.cleaned_data["horizon_days"]
        parish.default_mass_duration_minutes = self.cleaned_data["default_mass_duration_minutes"]
        parish.min_rest_minutes_between_masses = self.cleaned_data["min_rest_minutes_between_masses"]
        parish.swap_requires_approval = self.cleaned_data["swap_requires_approval"]
        parish.notify_on_cancellation = self.cleaned_data["notify_on_cancellation"]
        parish.auto_assign_on_decline = self.cleaned_data["auto_assign_on_decline"]
        parish.claim_auto_approve_enabled = self.cleaned_data.get("claim_auto_approve_enabled") or False
        if self.cleaned_data.get("claim_auto_approve_hours") is not None:
            parish.claim_auto_approve_hours = self.cleaned_data.get("claim_auto_approve_hours")
        parish.claim_require_coordination = self.cleaned_data.get("claim_require_coordination") or False

        weights = parish.schedule_weights or {}
        if "schedule_weights" in self.cleaned_data:
            weights = self.cleaned_data["schedule_weights"]
        else:
            for key in [
                "stability_penalty",
                "fairness_penalty",
                "credit_weight",
                "max_solve_seconds",
                "max_services_per_week",
                "max_consecutive_weekends",
                "rotation_penalty",
                "rotation_days",
                "reserve_penalty",
                "home_community_bonus",
                "community_recent_penalty",
                "community_recent_window_days",
                "scarcity_bonus",
                "event_series_community_factor",
                "single_mass_community_policy",
                "interest_deadline_hours",
                "interested_pool_fallback",
            ]:
                if self.cleaned_data.get(key) is not None:
                    value = self.cleaned_data[key]
                    if key == "event_series_community_factor":
                        weights[key] = float(value)
                    elif key in {"single_mass_community_policy", "interested_pool_fallback"}:
                        weights[key] = value
                    else:
                        weights[key] = int(value)
        parish.schedule_weights = weights
        parish.save(
            update_fields=[
                "consolidation_days",
                "horizon_days",
                "default_mass_duration_minutes",
                "min_rest_minutes_between_masses",
                "swap_requires_approval",
                "notify_on_cancellation",
                "auto_assign_on_decline",
                "claim_auto_approve_enabled",
                "claim_auto_approve_hours",
                "claim_require_coordination",
                "schedule_weights",
                "updated_at",
            ]
        )
        return parish


class CommunityForm(forms.ModelForm):
    class Meta:
        model = Community
        fields = ["code", "name", "address", "active"]

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)

    def clean_code(self):
        value = normalize_code(self.cleaned_data.get("code"))
        if not value:
            raise forms.ValidationError("Informe um codigo.")
        if self.parish:
            qs = Community.objects.filter(parish=self.parish, code=value)
            if self.instance and self.instance.pk:
                qs = qs.exclude(pk=self.instance.pk)
            if qs.exists():
                raise forms.ValidationError("Codigo ja utilizado nesta paroquia.")
        return value


class RoleForm(forms.Form):
    name = forms.CharField(max_length=100)
    code = forms.CharField(max_length=20, required=False)
    active = forms.BooleanField(required=False, initial=True)
    extra_functions = forms.ModelMultipleChoiceField(
        queryset=FunctionType.objects.none(),
        required=False,
        widget=forms.CheckboxSelectMultiple(
            attrs={
                "class": "peer h-4 w-4 shrink-0 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500 p-0 mt-0.5",
            }
        ),
        help_text="Marque as funcoes secundarias necessarias para esta vaga.",
    )

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        self.position_type = kwargs.pop("position_type", None)
        super().__init__(*args, **kwargs)
        primary = None
        if self.position_type:
            primary = FunctionType.objects.filter(
                parish=self.position_type.parish, code=self.position_type.code
            ).first()
        if self.parish:
            qs = FunctionType.objects.filter(parish=self.parish, active=True)
            if primary:
                qs = qs.exclude(id=primary.id)
            self.fields["extra_functions"].queryset = qs
        if self.position_type:
            self.fields["name"].initial = self.position_type.name
            self.fields["code"].initial = self.position_type.code
            self.fields["active"].initial = self.position_type.active
            extras = self.position_type.functions.exclude(id=primary.id) if primary else self.position_type.functions.all()
            self.fields["extra_functions"].initial = extras

    def clean_code(self):
        value = normalize_code(self.cleaned_data.get("code"))
        if not value:
            return value
        if len(value) > 10:
            raise forms.ValidationError("Use ate 10 caracteres.")
        if self.parish:
            qs = PositionType.objects.filter(parish=self.parish, code=value)
            if self.position_type:
                qs = qs.exclude(pk=self.position_type.pk)
            if qs.exists():
                raise forms.ValidationError("Codigo ja utilizado por outra funcao na escala.")
        return value


class RequirementProfileForm(forms.ModelForm):
    class Meta:
        model = RequirementProfile
        fields = ["name", "notes", "min_senior_per_mass", "active"]


class RequirementProfilePositionForm(forms.ModelForm):
    class Meta:
        model = RequirementProfilePosition
        fields = ["position_type", "quantity"]

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        self.fields["quantity"].min_value = 1
        if parish:
            self.fields["position_type"].queryset = PositionType.objects.filter(parish=parish, active=True)


class BaseRequirementProfilePositionFormSet(BaseInlineFormSet):
    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)

    def _construct_form(self, i, **kwargs):
        if self.parish:
            kwargs["parish"] = self.parish
        return super()._construct_form(i, **kwargs)

    def clean(self):
        super().clean()
        seen = set()
        for form in self.forms:
            if not hasattr(form, "cleaned_data"):
                continue
            if form.cleaned_data.get("DELETE"):
                continue
            position = form.cleaned_data.get("position_type")
            if not position:
                continue
            if position.id in seen:
                raise forms.ValidationError("Nao repita a mesma funcao no perfil.")
            seen.add(position.id)


RequirementProfilePositionFormSet = inlineformset_factory(
    RequirementProfile,
    RequirementProfilePosition,
    form=RequirementProfilePositionForm,
    formset=BaseRequirementProfilePositionFormSet,
    extra=1,
    can_delete=True,
)


class AcolyteLinkForm(forms.Form):
    ALLOWED_ROLE_CODES = ["PARISH_ADMIN", "ACOLYTE_COORDINATOR", "PASTOR", "SECRETARY", "ACOLYTE"]
    email = forms.EmailField()
    full_name = forms.CharField(required=False)
    password = forms.CharField(required=False, widget=forms.PasswordInput)
    acolyte = forms.ModelChoiceField(queryset=AcolyteProfile.objects.none())
    roles = forms.ModelMultipleChoiceField(queryset=MembershipRole.objects.none(), required=False)

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        actor = kwargs.pop("actor", None)
        super().__init__(*args, **kwargs)
        if parish:
            self.fields["acolyte"].queryset = AcolyteProfile.objects.filter(parish=parish, active=True)
            roles_qs = MembershipRole.objects.filter(code__in=self.ALLOWED_ROLE_CODES).order_by("code")
            if actor and getattr(actor, "is_system_admin", False):
                self.fields["roles"].queryset = roles_qs
            else:
                self.fields["roles"].queryset = roles_qs

    def clean(self):
        cleaned = super().clean()
        email = cleaned.get("email")
        full_name = cleaned.get("full_name")
        password = cleaned.get("password")
        if not email:
            return cleaned
        User = get_user_model()
        user_exists = User.objects.filter(email=email).exists()
        if not user_exists and (not full_name or not password):
            raise forms.ValidationError("Informe nome e senha para criar o usuario.")
        return cleaned


class AcolyteCreateLoginForm(forms.Form):
    email = forms.EmailField()
    password = forms.CharField(widget=forms.PasswordInput)
    send_invite = forms.BooleanField(required=False)

    def clean_email(self):
        email = self.cleaned_data['email']
        User = get_user_model()
        if User.objects.filter(email=email).exists():
            raise forms.ValidationError("Este email ja esta em uso.")
        return email


class ReplacementResolveForm(forms.Form):
    resolution_type = forms.ChoiceField(
        choices=[
            ("mass_canceled", "Missa cancelada"),
            ("slot_not_required", "Funcao nao necessaria"),
            ("covered_externally", "Coberto externamente"),
            ("other", "Outro motivo"),
        ]
    )
    notes = forms.CharField(required=False, widget=forms.Textarea(attrs={"rows": 3}))
    confirm_cancel_mass = forms.BooleanField(required=False)


class PeopleUserForm(forms.ModelForm):
    class Meta:
        model = get_user_model()
        fields = ["full_name", "email", "phone", "is_active"]

    def clean_email(self):
        email = self.cleaned_data.get("email")
        if not email:
            return email
        qs = get_user_model().objects.filter(email=email)
        if self.instance:
            qs = qs.exclude(id=self.instance.id)
        if qs.exists():
            raise forms.ValidationError("Email ja utilizado por outro usuario.")
        return email


class PeopleMembershipForm(forms.Form):
    ALLOWED_ROLE_CODES = AcolyteLinkForm.ALLOWED_ROLE_CODES
    active = forms.BooleanField(required=False)
    roles = forms.ModelMultipleChoiceField(
        queryset=MembershipRole.objects.none(),
        required=False,
        widget=forms.CheckboxSelectMultiple,
    )

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        roles_qs = MembershipRole.objects.filter(code__in=self.ALLOWED_ROLE_CODES).order_by("code")
        self.fields["roles"].queryset = roles_qs
        if parish is None:
            return


class PeopleAcolyteForm(forms.ModelForm):
    class Meta:
        model = AcolyteProfile
        fields = [
            "display_name",
            "community_of_origin",
            "experience_level",
            "scheduling_mode",
            "family_group",
            "notes",
            "active",
        ]

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        if parish:
            self.fields["community_of_origin"].queryset = Community.objects.filter(parish=parish, active=True)
            self.fields["family_group"].queryset = FamilyGroup.objects.filter(parish=parish)


class PeopleQualificationsForm(forms.Form):
    qualifications = forms.ModelMultipleChoiceField(
        queryset=PositionType.objects.none(),
        required=False,
        widget=forms.CheckboxSelectMultiple,
    )

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        if parish:
            self.fields["qualifications"].queryset = PositionType.objects.filter(parish=parish, active=True)


class PeopleCreateForm(forms.Form):
    ALLOWED_ROLE_CODES = AcolyteLinkForm.ALLOWED_ROLE_CODES

    full_name = forms.CharField()
    phone = forms.CharField(required=False)
    email = forms.EmailField(required=False)
    has_login = forms.BooleanField(required=False)
    password = forms.CharField(required=False, widget=forms.PasswordInput)
    send_invite = forms.BooleanField(required=False)

    is_acolyte = forms.BooleanField(required=False)
    community_of_origin = forms.ModelChoiceField(queryset=Community.objects.none(), required=False)
    experience_level = forms.ChoiceField(choices=AcolyteProfile.EXPERIENCE_CHOICES, required=False)
    scheduling_mode = forms.ChoiceField(choices=AcolyteProfile.SCHEDULING_MODE_CHOICES, required=False)
    family_group = forms.ModelChoiceField(queryset=FamilyGroup.objects.none(), required=False)
    notes = forms.CharField(required=False, widget=forms.Textarea(attrs={"rows": 3}))
    acolyte_active = forms.BooleanField(required=False, initial=True)

    has_admin_access = forms.BooleanField(required=False)
    roles = forms.ModelMultipleChoiceField(
        queryset=MembershipRole.objects.none(),
        required=False,
        widget=forms.CheckboxSelectMultiple,
    )
    qualifications = forms.ModelMultipleChoiceField(
        queryset=PositionType.objects.none(),
        required=False,
        widget=forms.CheckboxSelectMultiple,
    )

    def __init__(self, *args, **kwargs):
        parish = kwargs.pop("parish", None)
        super().__init__(*args, **kwargs)
        if parish:
            self.fields["community_of_origin"].queryset = Community.objects.filter(parish=parish, active=True)
            self.fields["family_group"].queryset = FamilyGroup.objects.filter(parish=parish)
            self.fields["roles"].queryset = MembershipRole.objects.filter(
                code__in=self.ALLOWED_ROLE_CODES
            ).order_by("code")
            self.fields["qualifications"].queryset = PositionType.objects.filter(parish=parish, active=True)

    def clean(self):
        cleaned = super().clean()
        has_login = cleaned.get("has_login")
        email = cleaned.get("email")
        password = cleaned.get("password")
        send_invite = cleaned.get("send_invite")
        is_acolyte = cleaned.get("is_acolyte")
        community = cleaned.get("community_of_origin")
        experience = cleaned.get("experience_level")
        has_admin_access = cleaned.get("has_admin_access")
        roles = cleaned.get("roles")

        if has_login and not email:
            self.add_error("email", "Informe o email para criar acesso.")
        if has_login and not password and not send_invite:
            self.add_error("password", "Defina uma senha ou marque envio de convite.")
        if is_acolyte:
            if not community:
                self.add_error("community_of_origin", "Selecione a comunidade de origem.")
            if not experience:
                self.add_error("experience_level", "Defina o nivel de experiencia.")
            if not cleaned.get("scheduling_mode"):
                cleaned["scheduling_mode"] = "normal"
        if has_admin_access and not roles:
            self.add_error("roles", "Selecione pelo menos um papel.")
        if not has_login:
            cleaned["email"] = ""
            cleaned["password"] = ""
        if not has_admin_access:
            cleaned["roles"] = []
        if not is_acolyte:
            cleaned["qualifications"] = []
        return cleaned


class AcolyteIntentForm(forms.ModelForm):
    """Form to edit an acolyte's intent (desired frequency and willingness level)."""
    
    class Meta:
        model = AcolyteIntent
        fields = ["desired_frequency_per_month", "willingness_level"]
        widgets = {
            "desired_frequency_per_month": forms.NumberInput(attrs={"min": 0, "max": 12}),
            "willingness_level": forms.Select(),
        }
        labels = {
            "desired_frequency_per_month": "Frequencia desejada (por mes)",
            "willingness_level": "Nivel de disponibilidade",
        }

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        self.acolyte = kwargs.pop("acolyte", None)
        super().__init__(*args, **kwargs)


class CreditAdjustmentForm(forms.Form):
    """Form to manually adjust an acolyte's credit balance."""
    
    delta = forms.IntegerField(
        label="Valor do ajuste",
        help_text="Use valores positivos para adicionar creditos, negativos para remover.",
        widget=forms.NumberInput(attrs={"class": "input", "placeholder": "Ex: 10 ou -5"}),
    )
    notes = forms.CharField(
        label="Justificativa",
        required=True,
        widget=forms.Textarea(attrs={"rows": 3, "class": "input", "placeholder": "Motivo do ajuste..."}),
    )

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        self.acolyte = kwargs.pop("acolyte", None)
        super().__init__(*args, **kwargs)

    def clean_delta(self):
        delta = self.cleaned_data.get("delta")
        if delta == 0:
            raise forms.ValidationError("O valor do ajuste deve ser diferente de zero.")
        return delta


class NotificationPreferenceForm(forms.ModelForm):
    """Form to edit notification preferences for a user."""
    
    class Meta:
        model = NotificationPreference
        fields = ["email_enabled", "email_digest", "whatsapp_enabled"]
        labels = {
            "email_enabled": "Receber notificacoes por email",
            "email_digest": "Receber resumo diario (em vez de notificacoes individuais)",
            "whatsapp_enabled": "Receber notificacoes por WhatsApp",
        }

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        self.user = kwargs.pop("user", None)
        super().__init__(*args, **kwargs)


class AssignToSlotForm(forms.Form):
    """Form to assign an acolyte to a specific slot."""
    
    slot = forms.ModelChoiceField(
        queryset=AssignmentSlot.objects.none(),
        label="Slot disponivel",
        widget=forms.Select(attrs={"class": "custom-select"}),
    )
    notes = forms.CharField(
        label="Observacoes",
        required=False,
        widget=forms.Textarea(attrs={"rows": 2, "class": "input"}),
    )

    def __init__(self, *args, **kwargs):
        self.parish = kwargs.pop("parish", None)
        self.acolyte = kwargs.pop("acolyte", None)
        super().__init__(*args, **kwargs)
        if self.parish and self.acolyte:
            # Get open slots for positions the acolyte is qualified for
            qualified_positions = AcolyteQualification.objects.filter(
                parish=self.parish, acolyte=self.acolyte, qualified=True
            ).values_list("position_type_id", flat=True)
            self.fields["slot"].queryset = AssignmentSlot.objects.filter(
                parish=self.parish,
                status="open",
                position_type_id__in=qualified_positions,
            ).select_related(
                "mass_instance", "position_type", "mass_instance__community"
            ).order_by("mass_instance__starts_at")
```

### web\urls.py
```python
from django.urls import path

from accounts.urls import urlpatterns as account_urls
from web import views

urlpatterns = [
    path("", views.dashboard, name="dashboard"),
    path("calendar/", views.calendar_month, name="calendar_month"),
    path("calendar/<int:instance_id>/", views.mass_detail, name="mass_detail"),
    path("calendar/<int:instance_id>/update/", views.mass_update, name="mass_update"),
    path("calendar/<int:instance_id>/move/", views.mass_move, name="mass_move"),
    path("calendar/<int:instance_id>/cancel/", views.mass_cancel, name="mass_cancel"),
    path("calendar/<int:instance_id>/slots/<int:slot_id>/assign/", views.slot_assign, name="slot_assign"),
    path("calendar/<int:instance_id>/slots/<int:slot_id>/move/", views.move_acolyte, name="move_acolyte"),
    path("calendar/<int:instance_id>/slots/<int:slot_id>/replace/", views.slot_replace, name="slot_replace"),
    path(
        "calendar/<int:instance_id>/slots/<int:slot_id>/confirm/",
        views.slot_confirm_assignment,
        name="slot_confirm_assignment",
    ),
    path(
        "calendar/<int:instance_id>/slots/<int:slot_id>/claim/",
        views.position_claim_create,
        name="position_claim_create",
    ),
    path(
        "calendar/<int:instance_id>/slots/<int:slot_id>/remove/",
        views.slot_remove_assignment,
        name="slot_remove_assignment",
    ),
    path("templates/", views.template_list, name="template_list"),
    path("templates/new/", views.template_create, name="template_create"),
    path("templates/generate/", views.generate_instances, name="generate_instances"),
    path("structure/communities/", views.structure_communities_list, name="structure_communities_list"),
    path("structure/communities/new/", views.structure_community_create, name="structure_community_create"),
    path("structure/communities/<int:community_id>/edit/", views.structure_community_edit, name="structure_community_edit"),
    path("structure/communities/<int:community_id>/toggle/", views.structure_community_toggle, name="structure_community_toggle"),
    path("structure/roles/", views.structure_roles_list, name="structure_roles_list"),
    path("structure/roles/new/", views.structure_role_create, name="structure_role_create"),
    path("structure/roles/<int:role_id>/edit/", views.structure_role_edit, name="structure_role_edit"),
    path("structure/roles/<int:role_id>/toggle/", views.structure_role_toggle, name="structure_role_toggle"),
    path("structure/roles/<int:role_id>/delete/", views.structure_role_delete, name="structure_role_delete"),
    path(
        "structure/requirement-profiles/",
        views.structure_requirement_profiles_list,
        name="structure_requirement_profiles_list",
    ),
    path(
        "structure/requirement-profiles/new/",
        views.structure_requirement_profile_create,
        name="requirement_profile_create",
    ),
    path(
        "structure/requirement-profiles/<int:profile_id>/edit/",
        views.structure_requirement_profile_edit,
        name="structure_requirement_profile_edit",
    ),
    path(
        "structure/requirement-profiles/<int:profile_id>/toggle/",
        views.structure_requirement_profile_toggle,
        name="structure_requirement_profile_toggle",
    ),
    path("roster/", views.roster_view, name="roster_view"),
    path("roster/export/pdf/", views.roster_export_pdf, name="roster_export_pdf"),
    path("roster/export/whatsapp/", views.roster_export_whatsapp, name="roster_export_whatsapp"),
    path("roster/open-slots/", views.roster_open_slots, name="roster_open_slots"),
    path("roster/open-slots/<int:slot_id>/assign/", views.roster_open_slot_assign, name="roster_open_slot_assign"),
    path("roster/open-slots/<int:slot_id>/mark-external/", views.roster_open_slot_mark_external, name="roster_open_slot_mark_external"),
    path("roster/open-slots/<int:slot_id>/candidates/", views.roster_open_slot_get_candidates, name="roster_open_slot_get_candidates"),
    path("events/", views.event_series_list, name="event_series_list"),
    path("events/new/", views.event_series_create, name="event_series_create"),
    path("events/new/days/", views.event_series_days, name="event_series_days"),
    path("events/<int:series_id>/", views.event_series_detail, name="event_series_detail"),
    path("events/<int:series_id>/edit/", views.event_series_edit, name="event_series_edit"),
    path("events/<int:series_id>/occurrences/", views.event_series_occurrences, name="event_series_occurrences"),
    path("events/<int:series_id>/archive/", views.event_series_archive, name="event_series_archive"),
    path("events/<int:series_id>/unarchive/", views.event_series_unarchive, name="event_series_unarchive"),
    path("events/<int:series_id>/delete/", views.event_series_delete, name="event_series_delete"),
    path("scheduling/", views.scheduling_dashboard, name="scheduling_dashboard"),
    path("scheduling/publish/preview/", views.scheduling_publish_preview, name="scheduling_publish_preview"),
    path("scheduling/publish/apply/", views.scheduling_publish_apply, name="scheduling_publish_apply"),
    path("scheduling/jobs/<int:job_id>/", views.schedule_job_detail, name="schedule_job_detail"),
    path("audit/", views.audit_log, name="audit_log"),
    path("reports/frequency/", views.reports_frequency, name="reports_frequency"),
    path("replacements/", views.replacement_center, name="replacement_center"),
    path("replacements/<int:request_id>/assign/", views.replacement_assign, name="replacement_assign"),
    path("replacements/<int:request_id>/pick/", views.replacement_pick, name="replacement_pick"),
    path("replacements/<int:request_id>/resolve/", views.replacement_resolve, name="replacement_resolve"),
    path("acolytes/", views.acolyte_list, name="acolyte_list"),
    path("acolytes/link/", views.acolyte_link, name="acolyte_link"),
    path("people/", views.people_directory, name="people_directory"),
    path("people/new/", views.people_create, name="people_create"),
    path("people/user/<int:user_id>/", views.people_user_detail, name="people_user_detail"),
    path("people/acolyte/<int:acolyte_id>/", views.people_acolyte_detail, name="people_acolyte_detail"),
    # Acolyte hub actions
    path("people/acolyte/<int:acolyte_id>/intent/", views.acolyte_update_intent, name="acolyte_update_intent"),
    path("people/acolyte/<int:acolyte_id>/credits/adjust/", views.acolyte_adjust_credits, name="acolyte_adjust_credits"),
    path("people/acolyte/<int:acolyte_id>/notifications/", views.acolyte_update_notifications, name="acolyte_update_notifications"),
    path("people/acolyte/<int:acolyte_id>/notifications/<int:notification_id>/resend/", views.acolyte_resend_notification, name="acolyte_resend_notification"),
    path("people/acolyte/<int:acolyte_id>/assign/", views.acolyte_assign_to_slot, name="acolyte_assign_to_slot"),
    path("people/acolyte/<int:acolyte_id>/slots/", views.acolyte_open_slots, name="acolyte_open_slots"),
    path("people/acolyte/<int:acolyte_id>/assign-multiple-slots/", views.acolyte_assign_to_multiple_slots, name="acolyte_assign_to_multiple_slots"),
    path("people/acolyte/<int:acolyte_id>/assign-multiple-slots/submit/", views.acolyte_assign_to_multiple_slots_submit, name="acolyte_assign_to_multiple_slots_submit"),
    path("people/acolyte/<int:acolyte_id>/assignments/<int:assignment_id>/remove/", views.acolyte_remove_assignment, name="acolyte_remove_assignment"),
    path("people/acolyte/<int:acolyte_id>/assignments/<int:assignment_id>/confirm/", views.acolyte_confirm_assignment, name="acolyte_confirm_assignment"),
    path("assignments/", views.my_assignments, name="my_assignments"),
    path("preferences/", views.my_preferences, name="my_preferences"),
    path("calendar/my.ics", views.calendar_feed, name="calendar_feed"),
    path("calendar/feed/token/", views.calendar_feed_token, name="calendar_feed_token"),
    path("preferences/availability/<int:rule_id>/delete/", views.delete_availability, name="delete_availability"),
    path("preferences/preferences/<int:pref_id>/delete/", views.delete_preference, name="delete_preference"),
    path("swap-requests/", views.swap_requests, name="swap_requests"),
    path("swap-requests/new/<int:assignment_id>/", views.swap_request_create, name="swap_request_create"),
    path("swap-requests/<int:swap_id>/assign/", views.swap_request_assign, name="swap_request_assign"),
    path("swap-requests/<int:swap_id>/accept/", views.swap_request_accept, name="swap_request_accept"),
    path("swap-requests/<int:swap_id>/reject/", views.swap_request_reject, name="swap_request_reject"),
    path("swap-requests/<int:swap_id>/approve/", views.swap_request_approve, name="swap_request_approve"),
    path("swap-requests/<int:swap_id>/cancel/", views.swap_request_cancel, name="swap_request_cancel"),
    path("claims/<int:claim_id>/choose/", views.position_claim_choose, name="position_claim_choose"),
    path("claims/<int:claim_id>/reject/", views.position_claim_reject, name="position_claim_reject"),
    path("claims/<int:claim_id>/cancel/", views.position_claim_cancel, name="position_claim_cancel"),
    path("claims/<int:claim_id>/approve/", views.position_claim_approve, name="position_claim_approve"),
    path("events/interest/", views.event_interest, name="event_interest"),
    path("settings/", views.parish_settings, name="parish_settings"),
    path("assignments/<int:assignment_id>/confirm/", views.confirm_assignment, name="confirm_assignment"),
    path("assignments/<int:assignment_id>/decline/", views.decline_assignment, name="decline_assignment"),
    path("assignments/<int:assignment_id>/cancel/", views.cancel_assignment, name="cancel_assignment"),
    path("parish/switch/<int:parish_id>/", views.switch_parish, name="switch_parish"),
] + account_urls
```

### .env.example
```
DEBUG=1
SECRET_KEY=change-me
ALLOWED_HOSTS=localhost,127.0.0.1
DATABASE_URL=postgres://user:pass@localhost:5432/acoli
EMAIL_HOST=
EMAIL_PORT=587
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=
EMAIL_USE_TLS=1
DEFAULT_FROM_EMAIL=acoli@example.com
APP_BASE_URL=http://localhost:8000
```

### delete_mass.py
```python
import os
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "acoli.settings")
import django
django.setup()

from core.models import MassInstance, Community
c = Community.objects.get(code='NSL')
mi = MassInstance.objects.filter(parish__isnull=False, community=c, starts_at__date='2026-02-08', starts_at__hour=8, starts_at__minute=15)
print('Found:', mi.count(), 'instances')
if mi.exists():
    m = mi.first()
    print('ID:', m.id, 'Status:', m.status)
    m.delete()
    print('Deleted')
else:
    print('No instance found')
```

### fix_slots.py
```python
import os
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "acoli.settings")
import django
django.setup()

from core.models import AssignmentSlot

# Fix slot statuses
slots = AssignmentSlot.objects.filter(required=True, status='assigned')
for slot in slots:
    if not slot.active_assignment:
        slot.status = 'open'
        slot.save()
        print(f"Fixed slot {slot.id} status to 'open'")

print("Slot statuses fixed.")
```

### gunicorn.conf.py
```python
import multiprocessing

workers = 2
threads = 4
max_requests = 1000
max_requests_jitter = 50
```

### limpar.py
```python
# salvar como limpar.py (no root do projeto, ao lado de manage.py)
# Uso:
#  python limpar.py --dry-run        # apenas mostra o que seria feito
#  python limpar.py                 # executar (será pedido confirmar)
#  python limpar.py --undo          # reverte a partir do backup mais recente
#
# Requisitos: executar no virtualenv do projeto; DJANGO_SETTINGS_MODULE será definido automaticamente
# pelo script para 'acoli.settings' (ajuste se seu settings estiver em outro lugar).
import os
import sys
import json
import argparse
import shutil
import datetime
import pytz
from pathlib import Path
# --- bootstrap django ---
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "acoli.settings")
import django
django.setup()
from django.conf import settings
from django.db import transaction, connection, models
from django.utils import timezone
from django.core import serializers
from django.apps import apps
# Models (app 'core' conforme repo)
MassInstance = apps.get_model("core", "MassInstance")
AssignmentSlot = apps.get_model("core", "AssignmentSlot")
Assignment = apps.get_model("core", "Assignment")
Confirmation = apps.get_model("core", "Confirmation")
PositionClaimRequest = apps.get_model("core", "PositionClaimRequest")
ReplacementRequest = apps.get_model("core", "ReplacementRequest")
SwapRequest = apps.get_model("core", "SwapRequest")
MassInterest = apps.get_model("core", "MassInterest")
MassOverride = apps.get_model("core", "MassOverride")
AcolyteCreditLedger = apps.get_model("core", "AcolyteCreditLedger")
AuditEvent = apps.get_model("core", "AuditEvent")
# Config
CUTOFF_DATE = datetime.date(2026, 1, 27)  # exclusão: starts_at < CUTOFF_DATE are past
BACKUP_ROOT = Path("maintenance_backups")
TIMEZONE = pytz.timezone(settings.TIME_ZONE if getattr(settings, "TIME_ZONE", None) else "UTC")
def make_backup_dir():
    ts = timezone.now().astimezone(TIMEZONE).strftime("%Y%m%dT%H%M%S")
    path = BACKUP_ROOT / f"clear_masses_{CUTOFF_DATE.isoformat()}_{ts}"
    path.mkdir(parents=True, exist_ok=False)
    return path
def serialize_qs(qs, path):
    # writes JSON list of objects (Django serializers) preserving PK
    data = serializers.serialize("json", qs, use_natural_primary_keys=False)
    path.write_text(data, encoding="utf-8")
    return path
def load_json_file(path):
    return json.loads(path.read_text(encoding="utf-8"))
def detect_db_vendor():
    return connection.vendor  # 'postgresql', 'sqlite', 'mysql', etc.
def adjust_postgres_sequences(backup_meta):
    # backup_meta includes list of (app_label, model_name) that we restored
    vendor = detect_db_vendor()
    if vendor != "postgresql":
        return
    with connection.cursor() as cur:
        for model_ref in backup_meta.get("models_restored", []):
            app_label, model_name = model_ref.split(".")
            model = apps.get_model(app_label, model_name)
            table = model._meta.db_table
            pk = model._meta.pk.column
            seq_sql = f"SELECT pg_get_serial_sequence('{table}','{pk}')"
            cur.execute(seq_sql)
            seq = cur.fetchone()[0]
            if seq:
                cur.execute(f"SELECT COALESCE(MAX({pk}), 0) FROM {table}")
                maxid = cur.fetchone()[0]
                cur.execute(f"SELECT setval('{seq}', %s, true)", [maxid])
    return
def confirm_prompt(msg):
    resp = input(msg + " [type YES to proceed]: ")
    return resp.strip() == "YES"
def dry_run_report():
    tznow = timezone.now().astimezone(TIMEZONE)
    cutoff_dt = datetime.datetime.combine(CUTOFF_DATE, datetime.time.min).astimezone(TIMEZONE)
    print("Dry run (no changes). Cutoff datetime:", cutoff_dt.isoformat())
    past_masses_qs = MassInstance.objects.filter(starts_at__lt=cutoff_dt)
    future_masses_qs = MassInstance.objects.filter(starts_at__gte=cutoff_dt)
    print("Past MassInstances (will be deleted):", past_masses_qs.count())
    print("Future MassInstances (kept), assignments to be cleaned:", end=" ")
    future_slots = AssignmentSlot.objects.filter(mass_instance__in=future_masses_qs)
    future_assignments = Assignment.objects.filter(slot__in=future_slots, is_active=True)
    print(future_assignments.count())
    # counts of dependent objects for info
    past_mass_ids = list(past_masses_qs.values_list("id", flat=True)[:1000])
    # estimations for audit events referencing these entities:
    audit_past = AuditEvent.objects.filter(entity_type="MassInstance", entity_id__in=[str(i) for i in past_mass_ids]).count()
    print("AuditEvents referencing past MassInstance (sample count):", audit_past)
    print("Summary: will backup then delete all past MassInstance and related cascaded rows.")
    print("And will delete Assignment/Confirmation/AcolyteCreditLedger/AuditEvent related to future assignments.")
    return
def collect_and_backup(backup_dir):
    tznow = timezone.now().astimezone(TIMEZONE)
    cutoff_dt = datetime.datetime.combine(CUTOFF_DATE, datetime.time.min).astimezone(TIMEZONE)
    # Querysets
    past_masses_qs = MassInstance.objects.filter(starts_at__lt=cutoff_dt)
    past_mass_ids = list(past_masses_qs.values_list("id", flat=True))
    future_masses_qs = MassInstance.objects.filter(starts_at__gte=cutoff_dt)
    # Slots linked to past masses (but these will be deleted by cascade when mass deleted)
    past_slots_qs = AssignmentSlot.objects.filter(mass_instance__in=past_mass_ids)
    past_slot_ids = list(past_slots_qs.values_list("id", flat=True))
    # Assignments linked to past slots (also cascade)
    past_assignments_qs = Assignment.objects.filter(slot__in=past_slot_ids)
    past_assignment_ids = list(past_assignments_qs.values_list("id", flat=True))
    # Future slots + assignments to clean
    future_slot_qs = AssignmentSlot.objects.filter(mass_instance__in=future_masses_qs)
    future_slot_ids = list(future_slot_qs.values_list("id", flat=True))
    future_assignments_qs = Assignment.objects.filter(slot__in=future_slot_ids)
    future_assignment_ids = list(future_assignments_qs.values_list("id", flat=True))
    # Dependent objects we want to backup (both past cascaded rows and future assignments specifics)
    confirmations_qs = Confirmation.objects.filter(assignment__in=past_assignment_ids + future_assignment_ids)
    claims_qs = PositionClaimRequest.objects.filter(slot__in=past_slot_ids + future_slot_ids)
    replacement_qs = ReplacementRequest.objects.filter(slot__in=past_slot_ids + future_slot_ids)
    swap_qs = SwapRequest.objects.filter(mass_instance__in=past_mass_ids)
    massinterest_qs = MassInterest.objects.filter(mass_instance__in=past_mass_ids)
    massoverride_qs = MassOverride.objects.filter(instance__in=past_mass_ids)
    ledger_qs = AcolyteCreditLedger.objects.filter(related_assignment__in=past_assignment_ids + future_assignment_ids)
    audit_qs = AuditEvent.objects.filter(
        models.Q(entity_type="MassInstance", entity_id__in=[str(i) for i in past_mass_ids]) |
        models.Q(entity_type="Assignment", entity_id__in=[str(i) for i in past_assignment_ids + future_assignment_ids]) |
        models.Q(entity_type="AssignmentSlot", entity_id__in=[str(i) for i in past_slot_ids + future_slot_ids])
    )
    # For safety, also backup any ReplacementRequest referencing future/past slots
    # Build metadata
    meta = {
        "created_at": tznow.isoformat(),
        "cutoff_date": CUTOFF_DATE.isoformat(),
        "counts": {
            "past_masses": past_masses_qs.count(),
            "past_slots": past_slots_qs.count(),
            "past_assignments": past_assignments_qs.count(),
            "future_assignments_total": future_assignments_qs.count(),
            "confirmations": confirmations_qs.count(),
            "claims": claims_qs.count(),
            "replacement_requests": replacement_qs.count(),
            "swap_requests": swap_qs.count(),
            "mass_interest": massinterest_qs.count(),
            "mass_override": massoverride_qs.count(),
            "ledger_rows": ledger_qs.count(),
            "audit_events": audit_qs.count(),
        },
        "models_included": [
            "core.MassInstance",
            "core.AssignmentSlot",
            "core.Assignment",
            "core.Confirmation",
            "core.PositionClaimRequest",
            "core.ReplacementRequest",
            "core.SwapRequest",
            "core.MassInterest",
            "core.MassOverride",
            "core.AcolyteCreditLedger",
            "core.AuditEvent",
        ]
    }
    # Serialize in dependency-safe order:
    # 1) MassInstance (past)
    # 2) AssignmentSlot (past)
    # 3) Assignment (past)
    # 4) Confirmation (past+future assignments)
    # 5) ReplacementRequest, SwapRequest, MassInterest, MassOverride (past)
    # 6) PositionClaimRequest (both)
    # 7) AcolyteCreditLedger rows referencing assignments
    # 8) AuditEvent referencing the entities
    #
    # Note: we backup future assignment rows (assignments + confirmations) to allow undo for cleaning future slots.
    serializers_dir = backup_dir / "serializers"
    serializers_dir.mkdir()
    def dump(qs, name):
        path = serializers_dir / f"{name}.json"
        print("Backing up:", name, "->", path, "count=", qs.count())
        serialize_qs(qs, path)
        return path
    dump(past_masses_qs, "past_massinstance")
    dump(past_slots_qs, "past_assignmentslot")
    dump(past_assignments_qs, "past_assignment")
    dump(future_assignments_qs, "future_assignment_active")
    dump(confirmations_qs, "confirmation")
    dump(replacement_qs, "replacementrequest")
    dump(swap_qs, "swaprequest")
    dump(massinterest_qs, "massinterest")
    dump(massoverride_qs, "massoverride")
    dump(claims_qs, "positionclaimrequest")
    dump(ledger_qs, "acolytecreditledger")
    dump(audit_qs, "auditevent")
    # Write metadata
    meta_path = backup_dir / "meta.json"
    meta_path.write_text(json.dumps(meta, indent=2, default=str), encoding="utf-8")
    print("Backup metadata written to", meta_path)
    return meta
def apply_changes(backup_dir):
    tznow = timezone.now().astimezone(TIMEZONE)
    cutoff_dt = datetime.datetime.combine(CUTOFF_DATE, datetime.time.min).astimezone(TIMEZONE)
    # 1) Delete past MassInstance in batches
    print("Deleting past MassInstance rows in batches...")
    batch = 500
    while True:
        with transaction.atomic():
            ids = list(MassInstance.objects.filter(starts_at__lt=cutoff_dt).order_by("id").values_list("id", flat=True)[:batch])
            if not ids:
                break
            print("Deleting batch of MassInstance ids:", ids[:5], "..." if len(ids)>5 else "")
            MassInstance.objects.filter(id__in=ids).delete()
    print("Past MassInstance rows deleted.")
    # 2) For future masses: delete assignments linked to their slots (hard delete)
    print("Cleaning assignments for future mass instances (deleting Assignment rows)...")
    future_slot_qs = AssignmentSlot.objects.filter(mass_instance__starts_at__gte=cutoff_dt)
    batch = 1000
    while True:
        with transaction.atomic():
            assign_ids = list(Assignment.objects.filter(slot__in=future_slot_qs).order_by("id").values_list("id", flat=True)[:batch])
            if not assign_ids:
                break
            print("Deleting batch of Assignment ids:", assign_ids[:5], "..." if len(assign_ids)>5 else "")
            Assignment.objects.filter(id__in=assign_ids).delete()
    print("Future assignments deleted (confirmations and CASCADE rows removed).")
    # 3) Remove AcolyteCreditLedger rows that referenced the deleted assignments (we backuped)
    print("Deleting AcolyteCreditLedger rows where related_assignment is NULL-safe handled (we deleted related assignments).")
    # if any ledgers remain whose related_assignment is NULL and you prefer deletion, optionally delete them:
    # ledger_delete_count = AcolyteCreditLedger.objects.filter(related_assignment__isnull=True, created_at__gte=some_threshold).delete()
    # We keep ledgers that had unrelated reasons. (By default we already backup and user wanted hard delete of assignment records; ledger rows referencing them were deleted earlier in backup restore plan.)
    print("All requested deletes completed. Note: some FK relations may have been SET_NULL by DB (e.g., related_assignment -> NULL).")
def restore_from_backup(backup_dir):
    serializers_dir = backup_dir / "serializers"
    meta_path = backup_dir / "meta.json"
    if not meta_path.exists():
        raise RuntimeError("backup meta not found in " + str(backup_dir))
    meta = json.loads(meta_path.read_text(encoding="utf-8"))
    # Helper to load serialized objects (Django serializers) and bulk_create them reusing PKs
    def load_and_create(model, filename):
        path = serializers_dir / filename
        if not path.exists():
            print("No backup for", filename, "- skipping.")
            return 0
        objs = list(serializers.deserialize("json", path.read_text(encoding="utf-8")))
        created = 0
        with transaction.atomic():
            for item in objs:
                obj = item.object
                obj.save(force_insert=True)  # force_insert to use original PK
                created += 1
        print(f"Restored {created} rows for {filename}")
        return created
    # Restore in dependency order reversed of deletion:
    # 1) MassInstance and related -> BUT since some models have FK to massinstance, restore massinstance first
    # NOTE: we restored MassInstance, then slots, then assignments, confirmations, claims, replacements, swaps, ledger, audit
    load_and_create(MassInstance, "past_massinstance.json")
    load_and_create(AssignmentSlot, "past_assignmentslot.json")
    load_and_create(Assignment, "past_assignment.json")
    load_and_create("core.Assignment", "future_assignment_active.json")  # future assignments to restore
    # confirmations
    load_and_create(Confirmation, "confirmation.json")
    load_and_create(ReplacementRequest, "replacementrequest.json")
    load_and_create(SwapRequest, "swaprequest.json")
    load_and_create(MassInterest, "massinterest.json")
    load_and_create(MassOverride, "massoverride.json")
    load_and_create(PositionClaimRequest, "positionclaimrequest.json")
    load_and_create(AcolyteCreditLedger, "acolytecreditledger.json")
    load_and_create(AuditEvent, "auditevent.json")
    # Adjust sequences if Postgres
    adjust_postgres_sequences({"models_restored": meta.get("models_included", [])})
    print("Restore complete. Please validate counts and integrity.")
def find_latest_backup():
    if not BACKUP_ROOT.exists():
        return None
    candidates = sorted(BACKUP_ROOT.glob("clear_masses_*"), key=lambda p: p.stat().st_mtime, reverse=True)
    return candidates[0] if candidates else None
def main():
    parser = argparse.ArgumentParser(description="Limpar missas passadas e limpar assignments futuros (hard delete).")
    parser.add_argument("--dry-run", action="store_true", help="mostrar contagens e não alterar nada")
    parser.add_argument("--apply", action="store_true", help="executar a operação (caso omitido, script pedirá confirmação interativa)")
    parser.add_argument("--undo", action="store_true", help="restaurar a partir do backup mais recente")
    args = parser.parse_args()
    if args.dry_run:
        dry_run_report()
        return
    if args.undo:
        latest = find_latest_backup()
        if not latest:
            print("Nenhum backup encontrado em", BACKUP_ROOT)
            return
        print("Restaurando a partir do backup:", latest)
        # Skip confirmation for automation
        try:
            restore_from_backup(latest)
            print("Undo concluído com sucesso.")
        except Exception as e:
            print("Erro durante restore:", e)
        return
    # apply flow
    if not settings.DEBUG:
        print("ALERTA: settings.DEBUG is not True. Esto é potencialmente perigoso. Abortando por segurança.")
        proceed = input("Se você entende o risco e conecta localmente, digite 'I_ACCEPT_RISK' para continuar: ")
        if proceed.strip() != "I_ACCEPT_RISK":
            print("Abortado.")
            return
    print("Preparando backup dos dados que serão removidos...")
    backup_dir = make_backup_dir()
    meta = collect_and_backup(backup_dir)
    print("\nBackup criado em:", backup_dir)
    print("Resumo das contagens:", meta["counts"])
    if not args.apply:
        # interactive confirm
        if not confirm_prompt("Confirma agora executar as deleções HARD conforme planejado?"):
            print("Operação cancelada. Backup permanece em", backup_dir)
            return
    # Execute deletions
    try:
        apply_changes(backup_dir)
    except Exception as e:
        print("Erro durante aplicação das mudanças:", e)
        print("Você pode restaurar com: python limpar.py --undo")
        return
    print("Operação concluída. Backup disponível em:", backup_dir)
    print("Para desfazer, execute: python limpar.py --undo")
    return
if __name__ == "__main__":
    main()
```

### manage.py
```python
#!/usr/bin/env python
import os
import sys


def main():
    os.environ.setdefault("DJANGO_SETTINGS_MODULE", "acoli.settings")
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == "__main__":
    main()
```

### README.md
```markdown
# Acoli

Sistema de escalas para acolitos com multi-paroquia, agendamento otimizado e fluxo de confirmacoes.

## Stack
- Django 5 + DRF
- PostgreSQL (Heroku Postgres Essential)
- HTMX + Tailwind (via CDN) para UI
- OR-Tools CP-SAT para o solver global
- WhiteNoise para estaticos

## Setup local
1) Crie um virtualenv e instale dependencias:

```bash
python -m venv .venv
. .venv/bin/activate
pip install -r requirements.txt
```

2) Configure variaveis de ambiente (use `.env.example` como base).

3) Rode migracoes e carregue dados iniciais:

```bash
python manage.py migrate
python manage.py loaddata fixtures/seed_parish.json
python manage.py createsuperuser
```

4) Vincule o superuser a uma paroquia (PARISH_ADMIN ou COORDINATOR):
- Acesse `/admin/` e crie um `ParishMembership` para o usuario.
- Ou use a tela "Pessoas" para adicionar o papel.

5) Inicie o servidor:

```bash
python manage.py runserver
```

## Variaveis de ambiente
- `SECRET_KEY`
- `DEBUG`
- `ALLOWED_HOSTS`
- `DATABASE_URL`
- `DB_CONN_MAX_AGE`
- `CSRF_TRUSTED_ORIGINS`
- `EMAIL_HOST`, `EMAIL_PORT`, `EMAIL_HOST_USER`, `EMAIL_HOST_PASSWORD`, `EMAIL_USE_TLS`
- `DEFAULT_FROM_EMAIL`
- `APP_BASE_URL` (usado para links absolutos em emails)

## API (DRF)
- Para clientes sem sessao, envie `X-Parish-ID` (ou `?parish_id=`) nas requisicoes `/api/*`.
- O usuario precisa ter membership ativa na paroquia (ou ser system admin via `is_system_admin`).

## Calendario (ICS)
- Apos gerar o link em "Minhas escalas", use `/calendar/my.ics?token=...` para assinar o calendario.

## Comandos de manutencao
- `python manage.py generate_mass_instances --days 60`
- `python manage.py sync_slots --days 60`
- `python manage.py lock_consolidation_window`
- `python manage.py recompute_acolyte_stats`
- `python manage.py run_global_scheduler`
- `python manage.py send_notifications`

Para solicitar um job de escalonamento pelo admin, use a tela "Escalonar" ou crie um `ScheduleJobRequest` via admin/ORM.

## Heroku (Basic + Postgres Essential)
1) Crie o app e banco:

```bash
heroku create acoli
heroku addons:create heroku-postgresql:essential-0
```

2) Configure variaveis:

```bash
heroku config:set SECRET_KEY=... ALLOWED_HOSTS=acoli.herokuapp.com APP_BASE_URL=https://acoli.herokuapp.com
```

3) Deploy:

```bash
git push heroku main
heroku run python manage.py migrate
heroku run python manage.py loaddata fixtures/seed_parish.json
```

4) Configure Heroku Scheduler:
- `python manage.py generate_mass_instances --days 60` (diario)
- `python manage.py sync_slots --days 60` (diario)
- `python manage.py lock_consolidation_window` (diario)
- `python manage.py recompute_acolyte_stats` (diario)
- `python manage.py run_global_scheduler` (noturno)
- `python manage.py send_notifications` (a cada 10-15 min)

## Testes
```bash
python manage.py test
```

## Docs
- Arquitetura: `docs/ARCHITECTURE_NOTES.md`
- Guia do usuario: `docs/USER_GUIDE.md`
```

### requirements.txt
```text
Django==5.0.7
djangorestframework==3.15.2
django-htmx==1.17.3
dj-database-url==2.2.0
psycopg[binary]==3.2.13
whitenoise==6.7.0
python-dateutil==2.9.0.post0
ortools==9.12.4544
gunicorn==22.0.0
reportlab==4.1.0
```

### runtime.txt
```text
python-3.12.4
```
